# Saved in Folder: UVA14
# NOTE: For checking code run "Food reactive", "C,N,P,W Reactive"

# UVA data for C & N Footprints with: 
# ***tabs, C/N comparison graph, fewer categories, commuting sources, food categories

# https://shiny.rstudio.com/tutorial/written-tutorial/lesson7/
# http://shiny.rstudio.com/articles/shinyapps.html
# https://www.r-graph-gallery.com/4-tricks-for-working-with-r-leaflet-and-shiny/
# https://github.com/rstudio/leaflet/issues/215
# Weblink: https://pennino82.shinyapps.io/Campus_Footprint/

# Log in to Shinyapps.io: https://www.shinyapps.io/admin/#/dashboard
# setwd('C:/Users/MPennino/OneDrive - Environmental Protection Agency (EPA)/R/Shiny')

### I got it to publish on the web, not just locally when: 
# 1. Make sure the data files don't have a file path but just use the workding directory (see below)
# 1.b comment out the file path directory and the setwd()
# 2. click runApp() button on upper right 
# 3. Click publish from the pop up app viewer
# 4. In the next pop up is says: 
#   Publish from: ...shiny/ "APP NAME" (make sure all files are selected)
#   > Publish to Account: Pennino82: shinyapps.io 
#   > Update: "APP NAME"


library(shiny)
library(shinyjs)
library(shinyWidgets)
library(dplyr, warn.conflicts = FALSE)
library(tidyr)
library(stringr)
library(forcats)
library(RColorBrewer)
library(ggrepel)
library(ggplot2)
library(htmltools)
library(htmlwidgets)
library(shinydashboard)
library(rsconnect)
library(gridExtra)
library(leaflet.extras)
library(DT)
library(data.table)

# Suppress summarise info
options(dplyr.summarise.inform = FALSE)

#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# STEP_1 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

#*****************************************************************************************************
#Processing Dataset
# proj_dir = 'C:/Users/MPennino/OneDrive - Environmental Protection Agency (EPA)/R/Shiny/IEFT/'
# uva1 = read.csv(paste0(proj_dir,'Campus_Footprint_2016/UVA14/UVA_Inventories.csv'))
# gwp = read.csv(paste0(proj_dir,'Campus_Footprint_2016/UVA14/GWP.csv'))
# N_Convers = read.csv(paste0(proj_dir,'Campus_Footprint_2016/UVA14/N_Conversions.csv'))
# food = read.csv(paste0(proj_dir,'Campus_Footprint_2016/UVA14/Food_data.csv'))

uva1 = read.csv(paste0(getwd(),'/UVA_Inventories.csv'))  
gwp = read.csv(paste0(getwd(),'/GWP.csv')) # GWP file has all of the global warming potentials for refrigerants and chemicals
N_Convers = read.csv(paste0(getwd(),'/N_Conversions.csv'))# N Conversion factors (%)
food = read.csv(paste0(getwd(),'/Food_data.csv')) 

uva1$UVA.2016.inventory.data = as.numeric(as.character(uva1$UVA.2016.inventory.data))

#***************************************************************************
# Inventory Prep
#***************************************************************************

# Rename inventory column
names(uva1)[which(colnames(uva1)=="UVA.2016.inventory.data")] = "inventory"

# Add in Row for Net kWh for Energy use (energy + sold - purchased)
net_kWh = sum(uva1[uva1$Sub_category == 
                     'Electricity, Steam, and Chilled Water',]$inventory,na.rm=T) + 
  sum(uva1[uva1$Sub_category == 'Sold',]$inventory,na.rm=T) - 
  sum(uva1[uva1$Sub_category == 'Purchased',]$inventory,na.rm=T)

net_kWh_rw = uva1[uva1$Sub_category == 'Electricity, Steam, and Chilled Water' & 
                    uva1$Source == 'Electricity',] 

net_kWh_rw$Category = 'Purchased Electricity'
net_kWh_rw$Sub_category = 'Purchased Electricity'
net_kWh_rw$Source = 'Purchased Electricity'
net_kWh_rw$inventory = net_kWh

# Add on Net kWh energy and remove other energy categories
uva = rbind(uva1,net_kWh_rw)


#***************************************************************************
# Remove Unneeded Categories
uva = uva[uva$Category != 'Electricity, Steam, and Chilled Water',]
uva = uva[uva$Category != 'Renewable Energy',]
uva = uva[uva$Category != 'Paper',]
uva = uva[uva$Category != 'Solid Waste',]
uva = uva[uva$Category != 'Student Travel to/from Home',]
uva = uva[uva$Category != 'Study Abroad',]
uva = uva[uva$Scope != 'Sinks',]

# keep only rows where inventory values are non-NA
uva = uva[complete.cases(uva[,c("inventory")]),] 
#test = uva[uva$Source == 'Purchased Electricity',]

# Remove rows with zero for inventory value
uva_ef = uva[uva$inventory !=0,] 

#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# STEP_2 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

# Save order for categories
catorder = c('Purchased Electricity',
             'Food',
             'On-Campus Stationary Sources',
             'Direct Transportation Sources',
             'Commuting',
             'Directly Financed Outsourced Travel',
             'Agriculture Sources',
             'Refrigerants & Chemicals',
             'Wastewater'
)

worder = c('Purchased Electricity',
           'Food',
           'On-Campus Stationary Sources',
           'Direct Transportation Sources',
           'Commuting',
           'Directly Financed Outsourced Travel',
           'Agriculture Sources',
           'Refrigerants & Chemicals',
           'Wastewater',
           'Direct Water Use')

sorder = c('Automobile',
           'Bike',
           'Carpool',
           'Commuter Rail',
           'Light Rail',
           'Public Bus',
           'Walk')


forder = c("Spices",
           "Sugars",
           "Oils",
           "Coffee and tea",
           "Liquids",
           "Nuts",
           "Beans",
           "Potatoes",
           "Fruits",
           "Vegetables",
           "Grains",
           "Eggs",
           "Cheese",
           "Milk",
           "Fish",
           "Chicken",
           "Pork",
           "Beef")

eorder = c("Coal (Steam Coal)",
           "Distillate BioHeat",
           "Distillate Oil (#1-4)",
           "Ethanol",
           "Grass Pellets",
           "Incinerated Waste",
           "LPG (Propane)",
           "Natural Gas",
           "Other",
           "Residual BioHeat",
           "Residual Oil (#5-6)",
           "Solar - Electric",
           "Solar - Thermal",
           "Wind",
           "Wood Chips",
           "Wood Pellets")

#***************************************************************************************************
# Main Sidebar Panels
#***************************************************************************************************

# C,N,P,W All Footprints
sidebar_foot = list(
  h3("Projected increase or decrease in Category (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'sctr1a_proj',label = "Purchased Electricity",min=-100,max=100,value=0,step=1,post=" %"),
  #sliderInput(inputId = 'sctr2a_proj',label = "Food (inactive - use food tab instead)",min=-100,max=100,value=0,step=1,post=" %"),
  #sliderInput(inputId = 'sctr3a_proj',label = "On-Campus Stationary Sources (inactive - use separate tab instead)",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'sctr4a_proj',label = "Direct Transportation Sources",min=-100,max=100,value=0,step=1,post=" %"),
  #sliderInput(inputId = 'sctr5a_proj',label = "Commuting (inactive - use Commuting tab instead)",min=-100,max=100,value=0,step=1,post=" %"),
  #sliderInput(inputId = 'sctr6a_proj',label = "Directly Financed Outsourced Travel",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'sctr6a_proj',label = "Agriculture Sources",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'sctr7a_proj',label = "Refrigerants & Chemicals",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'sctr8a_proj',label = "Wastewater",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'sctr9a_proj',label = "Direct Water Use",min=-100,max=100,value=0,step=1,post=" %"))

# Commuting
sidebar_fac = list(
  h3("Faculty: Projected increase or decrease in Source (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'fac1a_proj',label = "Automobile",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'fac2a_proj',label = "Bike",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'fac3a_proj',label = "Carpool",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'fac4a_proj',label = "Commuter Rail",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'fac5a_proj',label = "Light Rail",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'fac6a_proj',label = "Public Bus",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'fac7a_proj',label = "Walk",min=-100,max=100,value=0,step=1,post=" %"))

sidebar_staf = list(
  h3("Staff: Projected increase or decrease in Source (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'staf1a_proj',label = "Automobile",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'staf2a_proj',label = "Bike",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'staf3a_proj',label = "Carpool",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'staf4a_proj',label = "Commuter Rail",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'staf5a_proj',label = "Light Rail",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'staf6a_proj',label = "Public Bus",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'staf7a_proj',label = "Walk",min=-100,max=100,value=0,step=1,post=" %"))

sidebar_stud = list(
  h3("Students: Projected increase or decrease in Source (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'stud1a_proj',label = "Automobile",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'stud2a_proj',label = "Bike",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'stud3a_proj',label = "Carpool",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'stud4a_proj',label = "Commuter Rail",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'stud5a_proj',label = "Light Rail",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'stud6a_proj',label = "Public Bus",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'stud7a_proj',label = "Walk",min=-100,max=100,value=0,step=1,post=" %"))


# Food Footprint
sidebar_food = list(
  h3("Projected increase or decrease in Category (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'cat1a_proj',label = "Spices",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'cat2a_proj',label = "Sugars",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'cat3a_proj',label = "Oils",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'cat4a_proj',label = "Coffee and tea",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'cat5a_proj',label = "Liquids",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'cat6a_proj',label = "Nuts",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'cat7a_proj',label = "Beans",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'cat8a_proj',label = "Potatoes",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'cat9a_proj',label = "Fruits",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'cat10a_proj',label = "Vegetables",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'cat11a_proj',label = "Grains",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'cat12a_proj',label = "Eggs",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'cat13a_proj',label = "Cheese",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'cat14a_proj',label = "Milk",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'cat15a_proj',label = "Fish",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'cat16a_proj',label = "Chicken",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'cat17a_proj',label = "Pork",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'cat18a_proj',label = "Beef",min=-100,max=100,value=0,step=1,post=" %"))

# Energy
sidebar_energy = list(
  h3("Projected increase or decrease in Source (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'enrgy1a_proj',label = "Coal (Steam Coal)",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy2a_proj',label = "Distillate BioHeat",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy3a_proj',label = "Distillate Oil (#1-4)",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy4a_proj',label = "Ethanol",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy5a_proj',label = "Grass Pellets",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy6a_proj',label = "Incinerated Waste",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy7a_proj',label = "LPG (Propane)",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy8a_proj',label = "Natural Gas",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy9a_proj',label = "Other",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy10a_proj',label = "Residual BioHeat",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy11a_proj',label = "Residual Oil (#5-6)",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy12a_proj',label = "Solar - Electric",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy13a_proj',label = "Solar - Thermal",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy14a_proj',label = "Wind",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy15a_proj',label = "Wood Chips",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy16a_proj',label = "Wood Pellets",min=-100,max=100,value=0,step=1,post=" %"))

#***************************************************************************************************
# Scenario 1 Sidebar Panels (Business as Usual Growth to 2025)
#***************************************************************************************************

# C,N,P,W All Footprints
sidebar_foot1 = list(
  h3("Projected increase or decrease in Category (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'sctr1b_proj',label = "Purchased Electricity",min=22,max=22,value=22,step=1,post=" %"),
  #sliderInput(inputId = 'sctr2b_proj',label = "Food (inactive - use food tab instead)",min=-100,max=100,value=0,step=1,post=" %"),
  #sliderInput(inputId = 'sctr3b_proj',label = "On-Campus Stationary Sources (inactive - use separate tab instead)",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'sctr4b_proj',label = "Direct Transportation Sources",min=12,max=12,value=12,step=1,post=" %"),
  #sliderInput(inputId = 'sctr5b_proj',label = "Commuting (inactive - use Commuting tab instead)",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'sctr6b_proj',label = "Agriculture Sources",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'sctr7b_proj',label = "Refrigerants & Chemicals",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'sctr8b_proj',label = "Wastewater",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'sctr9b_proj',label = "Direct Water Use",min=-0,max=0,value=0,step=1,post=" %"))

# Commuting
sidebar_fac1 = list(
  h3("Faculty: Projected increase or decrease in Source (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'fac1b_proj',label = "Automobile",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac2b_proj',label = "Bike",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac3b_proj',label = "Carpool",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac4b_proj',label = "Commuter Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac5b_proj',label = "Light Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac6b_proj',label = "Public Bus",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac7b_proj',label = "Walk",min=12,max=12,value=12,step=1,post=" %"))

sidebar_staf1 = list(
  h3("Staff: Projected increase or decrease in Source (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'staf1b_proj',label = "Automobile",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf2b_proj',label = "Bike",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf3b_proj',label = "Carpool",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf4b_proj',label = "Commuter Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf5b_proj',label = "Light Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf6b_proj',label = "Public Bus",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf7b_proj',label = "Walk",min=12,max=12,value=12,step=1,post=" %"))

sidebar_stud1 = list(
  h3("Students: Projected increase or decrease in Source (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'stud1b_proj',label = "Automobile",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud2b_proj',label = "Bike",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud3b_proj',label = "Carpool",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud4b_proj',label = "Commuter Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud5b_proj',label = "Light Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud6b_proj',label = "Public Bus",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud7b_proj',label = "Walk",min=12,max=12,value=12,step=1,post=" %"))


# Food Footprint
sidebar_food1 = list(
  h3("Projected increase or decrease in Category (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'cat1b_proj',label = "Spices",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat2b_proj',label = "Sugars",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat3b_proj',label = "Oils",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat4b_proj',label = "Coffee and tea",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat5b_proj',label = "Liquids",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat6b_proj',label = "Nuts",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat7b_proj',label = "Beans",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat8b_proj',label = "Potatoes",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat9b_proj',label = "Fruits",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat10b_proj',label = "Vegetables",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat11b_proj',label = "Grains",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat12b_proj',label = "Eggs",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat13b_proj',label = "Cheese",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat14b_proj',label = "Milk",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat15b_proj',label = "Fish",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat16b_proj',label = "Chicken",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat17b_proj',label = "Pork",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat18b_proj',label = "Beef",min=18,max=18,value=18,step=1,post=" %"))

# Energy
sidebar_energy1 = list(
  h3("Projected increase or decrease in Source (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'enrgy1b_proj',label = "Coal (Steam Coal)",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy2b_proj',label = "Distillate BioHeat",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy3b_proj',label = "Distillate Oil (#1-4)",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy4b_proj',label = "Ethanol",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy5b_proj',label = "Grass Pellets",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy6b_proj',label = "Incinerated Waste",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy7b_proj',label = "LPG (Propane)",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy8b_proj',label = "Natural Gas",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy9b_proj',label = "Other",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy10b_proj',label = "Residual BioHeat",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy11b_proj',label = "Residual Oil (#5-6)",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy12b_proj',label = "Solar - Electric",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy13b_proj',label = "Solar - Thermal",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy14b_proj',label = "Wind",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy15b_proj',label = "Wood Chips",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy16b_proj',label = "Wood Pellets",min=19,max=19,value=19,step=1,post=" %"))

#***************************************************************************************************
# Scenario 2 Sidebar Panels (15% Vegetarian Meals)
#***************************************************************************************************

# C,N,P,W All Footprints
sidebar_foot2 = list(
  h3("Projected increase or decrease in Category (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'sctr1c_proj',label = "Purchased Electricity",min=22,max=22,value=22,step=1,post=" %"),
  #sliderInput(inputId = 'sctr2c_proj',label = "Food (inactive - use food tab instead)",min=-100,max=100,value=0,step=1,post=" %"),
  #sliderInput(inputId = 'sctr3c_proj',label = "On-Campus Stationary Sources (inactive - use separate tab instead)",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'sctr4c_proj',label = "Direct Transportation Sources",min=12,max=12,value=12,step=1,post=" %"),
  #sliderInput(inputId = 'sctr5c_proj',label = "Commuting (inactive - use Commuting tab instead)",min=-100,max=100,value=0,step=1,post=" %"),
  #sliderInput(inputId = 'sctr6c_proj',label = "Directly Financed Outsourced Travel",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'sctr6c_proj',label = "Agriculture Sources",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'sctr7c_proj',label = "Refrigerants & Chemicals",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'sctr8c_proj',label = "Wastewater",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'sctr9c_proj',label = "Direct Water Use",min=-0,max=0,value=0,step=1,post=" %"))

# Commuting
sidebar_fac2 = list(
  h3("Faculty: Projected increase or decrease in Source (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'fac1c_proj',label = "Automobile",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac2c_proj',label = "Bike",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac3c_proj',label = "Carpool",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac4c_proj',label = "Commuter Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac5c_proj',label = "Light Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac6c_proj',label = "Public Bus",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac7c_proj',label = "Walk",min=12,max=12,value=12,step=1,post=" %"))

sidebar_staf2 = list(
  h3("Staff: Projected increase or decrease in Source (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'staf1c_proj',label = "Automobile",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf2c_proj',label = "Bike",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf3c_proj',label = "Carpool",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf4c_proj',label = "Commuter Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf5c_proj',label = "Light Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf6c_proj',label = "Public Bus",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf7c_proj',label = "Walk",min=12,max=12,value=12,step=1,post=" %"))

sidebar_stud2 = list(
  h3("Students: Projected increase or decrease in Source (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'stud1c_proj',label = "Automobile",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud2c_proj',label = "Bike",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud3c_proj',label = "Carpool",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud4c_proj',label = "Commuter Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud5c_proj',label = "Light Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud6c_proj',label = "Public Bus",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud7c_proj',label = "Walk",min=12,max=12,value=12,step=1,post=" %"))


# Food Footprint
sidebar_food2 = list(
  h3("Projected increase or decrease in Category (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'cat1c_proj',label = "Spices",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat2c_proj',label = "Sugars",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat3c_proj',label = "Oils",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat4c_proj',label = "Coffee and tea",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat5c_proj',label = "Liquids",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat6c_proj',label = "Nuts",min=22,max=22,value=22,step=1,post=" %"),
  sliderInput(inputId = 'cat7c_proj',label = "Beans",min=22,max=22,value=22,step=1,post=" %"),
  sliderInput(inputId = 'cat8c_proj',label = "Potatoes",min=22,max=22,value=22,step=1,post=" %"),
  sliderInput(inputId = 'cat9c_proj',label = "Fruits",min=22,max=22,value=22,step=1,post=" %"),
  sliderInput(inputId = 'cat10c_proj',label = "Vegetables",min=22,max=22,value=22,step=1,post=" %"),
  sliderInput(inputId = 'cat11c_proj',label = "Grains",min=22,max=22,value=22,step=1,post=" %"),
  sliderInput(inputId = 'cat12c_proj',label = "Eggs",min=22,max=22,value=22,step=1,post=" %"),
  sliderInput(inputId = 'cat13c_proj',label = "Cheese",min=22,max=22,value=22,step=1,post=" %"),
  sliderInput(inputId = 'cat14c_proj',label = "Milk",min=22,max=22,value=22,step=1,post=" %"),
  sliderInput(inputId = 'cat15c_proj',label = "Fish",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'cat16c_proj',label = "Chicken",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'cat17c_proj',label = "Pork",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'cat18c_proj',label = "Beef",min=0,max=0,value=0,step=1,post=" %"))

# Energy
sidebar_energy2 = list(
  h3("Projected increase or decrease in Source (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'enrgy1c_proj',label = "Coal (Steam Coal)",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy2c_proj',label = "Distillate BioHeat",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy3c_proj',label = "Distillate Oil (#1-4)",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy4c_proj',label = "Ethanol",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy5c_proj',label = "Grass Pellets",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy6c_proj',label = "Incinerated Waste",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy7c_proj',label = "LPG (Propane)",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy8c_proj',label = "Natural Gas",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy9c_proj',label = "Other",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy10c_proj',label = "Residual BioHeat",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy11c_proj',label = "Residual Oil (#5-6)",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy12c_proj',label = "Solar - Electric",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy13c_proj',label = "Solar - Thermal",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy14c_proj',label = "Wind",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy15c_proj',label = "Wood Chips",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy16c_proj',label = "Wood Pellets",min=19,max=19,value=19,step=1,post=" %"))

#***************************************************************************************************
# Scenario 3 Sidebar Panels (Replacement of 20% Beef with Chicken)
#***************************************************************************************************

# C,N,P,W All Footprints
sidebar_foot3 = list(
  h3("Projected increase or decrease in Category (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'sctr1d_proj',label = "Purchased Electricity",min=22,max=22,value=22,step=1,post=" %"),
  #sliderInput(inputId = 'sctr2d_proj',label = "Food (inactive - use food tab instead)",min=-100,max=100,value=0,step=1,post=" %"),
  #sliderInput(inputId = 'sctr3d_proj',label = "On-Campus Stationary Sources (inactive - use separate tab instead)",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'sctr4d_proj',label = "Direct Transportation Sources",min=12,max=12,value=12,step=1,post=" %"),
  #sliderInput(inputId = 'sctr5d_proj',label = "Commuting (inactive - use Commuting tab instead)",min=-100,max=100,value=0,step=1,post=" %"),
  #sliderInput(inputId = 'sctr6d_proj',label = "Directly Financed Outsourced Travel",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'sctr6d_proj',label = "Agriculture Sources",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'sctr7d_proj',label = "Refrigerants & Chemicals",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'sctr8d_proj',label = "Wastewater",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'sctr9d_proj',label = "Direct Water Use",min=0,max=0,value=0,step=1,post=" %"))

# Commuting
sidebar_fac3 = list(
  h3("Faculty: Projected increase or decrease in Source (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'fac1d_proj',label = "Automobile",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac2d_proj',label = "Bike",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac3d_proj',label = "Carpool",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac4d_proj',label = "Commuter Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac5d_proj',label = "Light Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac6d_proj',label = "Public Bus",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac7d_proj',label = "Walk",min=12,max=12,value=12,step=1,post=" %"))

sidebar_staf3 = list(
  h3("Staff: Projected increase or decrease in Source (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'staf1d_proj',label = "Automobile",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf2d_proj',label = "Bike",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf3d_proj',label = "Carpool",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf4d_proj',label = "Commuter Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf5d_proj',label = "Light Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf6d_proj',label = "Public Bus",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf7d_proj',label = "Walk",min=12,max=12,value=12,step=1,post=" %"))

sidebar_stud3 = list(
  h3("Students: Projected increase or decrease in Source (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'stud1d_proj',label = "Automobile",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud2d_proj',label = "Bike",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud3d_proj',label = "Carpool",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud4d_proj',label = "Commuter Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud5d_proj',label = "Light Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud6d_proj',label = "Public Bus",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud7d_proj',label = "Walk",min=12,max=12,value=12,step=1,post=" %"))


# Food Footprint
sidebar_food3 = list(
  h3("Projected increase or decrease in Category (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'cat1d_proj',label = "Spices",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat2d_proj',label = "Sugars",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat3d_proj',label = "Oils",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat4d_proj',label = "Coffee and tea",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat5d_proj',label = "Liquids",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat6d_proj',label = "Nuts",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat7d_proj',label = "Beans",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat8d_proj',label = "Potatoes",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat9d_proj',label = "Fruits",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat10d_proj',label = "Vegetables",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat11d_proj',label = "Grains",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat12d_proj',label = "Eggs",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat13d_proj',label = "Cheese",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat14d_proj',label = "Milk",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat15d_proj',label = "Fish",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat16d_proj',label = "Chicken",min=28,max=28,value=28,step=1,post=" %"),
  sliderInput(inputId = 'cat17d_proj',label = "Pork",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat18d_proj',label = "Beef",min=-6,max=-6,value=-6,step=1,post=" %"))

# Energy
sidebar_energy3 = list(
  h3("Projected increase or decrease in Source (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'enrgy1d_proj',label = "Coal (Steam Coal)",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy2d_proj',label = "Distillate BioHeat",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy3d_proj',label = "Distillate Oil (#1-4)",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy4d_proj',label = "Ethanol",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy5d_proj',label = "Grass Pellets",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy6d_proj',label = "Incinerated Waste",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy7d_proj',label = "LPG (Propane)",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy8d_proj',label = "Natural Gas",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy9d_proj',label = "Other",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy10d_proj',label = "Residual BioHeat",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy11d_proj',label = "Residual Oil (#5-6)",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy12d_proj',label = "Solar - Electric",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy13d_proj',label = "Solar - Thermal",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy14d_proj',label = "Wind",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy15d_proj',label = "Wood Chips",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy16d_proj',label = "Wood Pellets",min=19,max=19,value=19,step=1,post=" %"))

#***************************************************************************************************
# Scenario 4 Sidebar Panels (Fuel Optimization)
#***************************************************************************************************

# C,N,P,W All Footprints
sidebar_foot4 = list(
  h3("Projected increase or decrease in Category (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'sctr1e_proj',label = "Purchased Electricity",min=22,max=22,value=22,step=1,post=" %"),
  #sliderInput(inputId = 'sctr2e_proj',label = "Food (inactive - use food tab instead)",min=-100,max=100,value=0,step=1,post=" %"),
  #sliderInput(inputId = 'sctr3e_proj',label = "On-Campus Stationary Sources (inactive - use separate tab instead)",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'sctr4e_proj',label = "Direct Transportation Sources",min=12,max=12,value=12,step=1,post=" %"),
  #sliderInput(inputId = 'sctr5e_proj',label = "Commuting (inactive - use Commuting tab instead)",min=-100,max=100,value=0,step=1,post=" %"),
  #sliderInput(inputId = 'sctr6e_proj',label = "Directly Financed Outsourced Travel",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'sctr6e_proj',label = "Agriculture Sources",min=-0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'sctr7e_proj',label = "Refrigerants & Chemicals",min=-0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'sctr8e_proj',label = "Wastewater",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'sctr9e_proj',label = "Direct Water Use",min=-0,max=0,value=0,step=1,post=" %"))

# Commuting
sidebar_fac4 = list(
  h3("Faculty: Projected increase or decrease in Source (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'fac1e_proj',label = "Automobile",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac2e_proj',label = "Bike",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac3e_proj',label = "Carpool",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac4e_proj',label = "Commuter Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac5e_proj',label = "Light Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac6e_proj',label = "Public Bus",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac7e_proj',label = "Walk",min=12,max=12,value=12,step=1,post=" %"))

sidebar_staf4 = list(
  h3("Staff: Projected increase or decrease in Source (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'staf1e_proj',label = "Automobile",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf2e_proj',label = "Bike",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf3e_proj',label = "Carpool",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf4e_proj',label = "Commuter Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf5e_proj',label = "Light Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf6e_proj',label = "Public Bus",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf7e_proj',label = "Walk",min=12,max=12,value=12,step=1,post=" %"))

sidebar_stud4 = list(
  h3("Students: Projected increase or decrease in Source (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'stud1e_proj',label = "Automobile",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud2e_proj',label = "Bike",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud3e_proj',label = "Carpool",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud4e_proj',label = "Commuter Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud5e_proj',label = "Light Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud6e_proj',label = "Public Bus",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud7e_proj',label = "Walk",min=12,max=12,value=12,step=1,post=" %"))


# Food Footprint
sidebar_food4 = list(
  h3("Projected increase or decrease in Category (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'cat1e_proj',label = "Spices",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat2e_proj',label = "Sugars",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat3e_proj',label = "Oils",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat4e_proj',label = "Coffee and tea",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat5e_proj',label = "Liquids",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat6e_proj',label = "Nuts",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat7e_proj',label = "Beans",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat8e_proj',label = "Potatoes",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat9e_proj',label = "Fruits",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat10e_proj',label = "Vegetables",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat11e_proj',label = "Grains",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat12e_proj',label = "Eggs",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat13e_proj',label = "Cheese",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat14e_proj',label = "Milk",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat15e_proj',label = "Fish",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat16e_proj',label = "Chicken",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat17e_proj',label = "Pork",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat18e_proj',label = "Beef",min=18,max=18,value=18,step=1,post=" %"))

# Energy
sidebar_energy4 = list(
  h3("Projected increase or decrease in Source (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'enrgy1e_proj',label = "Coal (Steam Coal)",min=-100,max=-100,value=-100,step=1,post=" %"),
  sliderInput(inputId = 'enrgy2e_proj',label = "Distillate BioHeat",min=-0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy3e_proj',label = "Distillate Oil (#1-4)",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy4e_proj',label = "Ethanol",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy5e_proj',label = "Grass Pellets",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy6e_proj',label = "Incinerated Waste",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy7e_proj',label = "LPG (Propane)",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy8e_proj',label = "Natural Gas",min=45,max=45,value=45,step=1,post=" %"),
  sliderInput(inputId = 'enrgy9e_proj',label = "Other",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy10e_proj',label = "Residual BioHeat",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy11e_proj',label = "Residual Oil (#5-6)",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy12e_proj',label = "Solar - Electric",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy13e_proj',label = "Solar - Thermal",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy14e_proj',label = "Wind",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy15e_proj',label = "Wood Chips",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy16e_proj',label = "Wood Pellets",min=0,max=0,value=0,step=1,post=" %"))


#***************************************************************************************************
# Scenario 5 All 3 Scenarios
#***************************************************************************************************

# C,N,P,W All Footprints
sidebar_foot5 = list(
  h3("Projected increase or decrease in Category (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'sctr1f_proj',label = "Purchased Electricity",min=-56,max=-56,value=-56,step=1,post=" %"),
  #sliderInput(inputId = 'sctr2f_proj',label = "Food (inactive - use food tab instead)",min=-100,max=100,value=0,step=1,post=" %"),
  #sliderInput(inputId = 'sctr3f_proj',label = "On-Campus Stationary Sources (inactive - use separate tab instead)",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'sctr4f_proj',label = "Direct Transportation Sources",min=-4,max=-4,value=-4,step=1,post=" %"),
  #sliderInput(inputId = 'sctr5f_proj',label = "Commuting (inactive - use Commuting tab instead)",min=-100,max=100,value=0,step=1,post=" %"),
  sliderInput(inputId = 'sctr6f_proj',label = "Agriculture Sources",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'sctr7f_proj',label = "Refrigerants & Chemicals",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'sctr8f_proj',label = "Wastewater",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'sctr9f_proj',label = "Direct Water Use",min=-0,max=0,value=0,step=1,post=" %"))

# Commuting
sidebar_fac5 = list(
  h3("Faculty: Projected increase or decrease in Source (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'fac1f_proj',label = "Automobile",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac2f_proj',label = "Bike",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac3f_proj',label = "Carpool",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac4f_proj',label = "Commuter Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac5f_proj',label = "Light Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac6f_proj',label = "Public Bus",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'fac7f_proj',label = "Walk",min=12,max=12,value=12,step=1,post=" %"))

sidebar_staf5 = list(
  h3("Staff: Projected increase or decrease in Source (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'staf1f_proj',label = "Automobile",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf2f_proj',label = "Bike",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf3f_proj',label = "Carpool",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf4f_proj',label = "Commuter Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf5f_proj',label = "Light Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf6f_proj',label = "Public Bus",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'staf7f_proj',label = "Walk",min=12,max=12,value=12,step=1,post=" %"))

sidebar_stud5 = list(
  h3("Students: Projected increase or decrease in Source (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'stud1f_proj',label = "Automobile",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud2f_proj',label = "Bike",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud3f_proj',label = "Carpool",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud4f_proj',label = "Commuter Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud5f_proj',label = "Light Rail",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud6f_proj',label = "Public Bus",min=12,max=12,value=12,step=1,post=" %"),
  sliderInput(inputId = 'stud7f_proj',label = "Walk",min=12,max=12,value=12,step=1,post=" %"))


# Food Footprint
sidebar_food5 = list(
  h3("Projected increase or decrease in Category (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'cat1f_proj',label = "Spices",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat2f_proj',label = "Sugars",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat3f_proj',label = "Oils",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat4f_proj',label = "Coffee and tea",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat5f_proj',label = "Liquids",min=18,max=18,value=18,step=1,post=" %"),
  sliderInput(inputId = 'cat6f_proj',label = "Nuts",min=22,max=22,value=22,step=1,post=" %"),
  sliderInput(inputId = 'cat7f_proj',label = "Beans",min=27,max=27,value=27,step=1,post=" %"),
  sliderInput(inputId = 'cat8f_proj',label = "Potatoes",min=22,max=22,value=22,step=1,post=" %"),
  sliderInput(inputId = 'cat9f_proj',label = "Fruits",min=20,max=20,value=20,step=1,post=" %"),
  sliderInput(inputId = 'cat10f_proj',label = "Vegetables",min=24,max=24,value=24,step=1,post=" %"),
  sliderInput(inputId = 'cat11f_proj',label = "Grains",min=23,max=23,value=23,step=1,post=" %"),
  sliderInput(inputId = 'cat12f_proj',label = "Eggs",min=22,max=22,value=22,step=1,post=" %"),
  sliderInput(inputId = 'cat13f_proj',label = "Cheese",min=22,max=22,value=22,step=1,post=" %"),
  sliderInput(inputId = 'cat14f_proj',label = "Milk",min=24,max=24,value=24,step=1,post=" %"),
  sliderInput(inputId = 'cat15f_proj',label = "Fish",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'cat16f_proj',label = "Chicken",min=4,max=4,value=4,step=1,post=" %"),
  sliderInput(inputId = 'cat17f_proj',label = "Pork",min=-11,max=-11,value=-11,step=1,post=" %"),
  sliderInput(inputId = 'cat18f_proj',label = "Beef",min=-51,max=-51,value=-51,step=1,post=" %"))

# Energy
sidebar_energy5 = list(
  h3("Projected increase or decrease in Source (% change)"),
  # Input: Slider for the number of bins ----
  sliderInput(inputId = 'enrgy1f_proj',label = "Coal (Steam Coal)",min=-100,max=-100,value=-100,step=1,post=" %"),
  sliderInput(inputId = 'enrgy2f_proj',label = "Distillate BioHeat",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy3f_proj',label = "Distillate Oil (#1-4)",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy4f_proj',label = "Ethanol",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy5f_proj',label = "Grass Pellets",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy6f_proj',label = "Incinerated Waste",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy7f_proj',label = "LPG (Propane)",min=19,max=19,value=19,step=1,post=" %"),
  sliderInput(inputId = 'enrgy8f_proj',label = "Natural Gas",min=39,max=39,value=39,step=1,post=" %"),
  sliderInput(inputId = 'enrgy9f_proj',label = "Other",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy10f_proj',label = "Residual BioHeat",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy11f_proj',label = "Residual Oil (#5-6)",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy12f_proj',label = "Solar - Electric",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy13f_proj',label = "Solar - Thermal",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy14f_proj',label = "Wind",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy15f_proj',label = "Wood Chips",min=0,max=0,value=0,step=1,post=" %"),
  sliderInput(inputId = 'enrgy16f_proj',label = "Wood Pellets",min=0,max=0,value=0,step=1,post=" %"))



#************************************************************************************
# Campus Vs. Individual
# Create Inventory DataFrames for uva1 and food 
# uva_individual = uva
# food_individual = food 
# 
# uva_individual$inventory = uva_individual$inventory * 0.01
# food_individual$UVA_inventory = food_individual$UVA_inventory * 0.01

#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# STEP_3 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

# User Interface
# Define UI for app that draws a histogram ----
ui <- fluidPage(
  
  # App title ----
  titlePanel("C, N, P, & W Footprints (UVA 2016 Data)" ), 
  #sidebarLayout(sidebarPanel(sidebar1),
  
  #**********************************************
  # Main panel for displaying outputs ----
  # tabsetPanel for multiple tabs or toggled panels
  # Sidebar layout with input and output definitions ----
  
  #mainPanel(
  tabsetPanel(
    tabPanel("User Guide",
             fluidRow(p("The Integrated Environmental Footprint Tool allows users to see how the carbon (C), 
                        nitrogen (N), phosphorus (P), and water (W) footprints at UVA change when campus 
                        consumption behaviors are changed. The baseline C, N, P, and W footprints are 
                        currently calculated based on 2016 usage data at UVA for the following categories: 
                        purchased electricity, food, on-campus stationary sources, direct transportation 
                        sources, commuting, agriculture sources, refrigerants & chemicals, wastewater, 
                        and direct water use. Additionally, the food category is split up into 18 
                        different sub-categories (e.g. beans, fruits, beef, and nuts); the on-campus 
                        stationary sources is split into sub-categories (e.g. coal and natural gas); 
                        and commuting is split into sub-categories (e.g. automobile, biking, and 
                        public bus), and is also split up by faculty, staff, and student commuting.",
                        style="text-align:justify;color:black;background-color:papayawhip;
                        padding:15px;border-radius:10px"),
                      #width=1,
                      
                      p(tags$b("How to use the IEFT:"),
                        style="text-align:justify;color:black;padding:15px;margin-top:0em"), 

                      p('First, navigate to the Input Scenario tab. The dropdown menu under 
                      "Choose a Scenario" allows you to either manually input a scenario
                      ("Manual Scenario" option) or choose a pre-programmed scenario for
                      analysis. If the "Manual Scenario" option is selected, the user can
                      adjust the slider bars for each category as desired. The "Slider
                      options" area allows the user to display and adjust different slider
                      bar options, depending on the inventory categories that require
                        manipulation.',
                        style="text-align:justify;color:black;padding:15px;margin-top:-2em"),

                      p('The tabs titled C,N,P,W Footprint Plots and C,N,P,W Footprint 
                        Tables show the output, or the overall impact of the chosen scenario 
                        on the C, N, P, and W footprints. The Commuting Footprint Output, Food 
                        Footprint Output, and On-Campus Stationary Source Footprint Output tabs 
                        show the C, N, P, and W footprints within each specific category and 
                        sub-categories rather than across all inventory categories. Each output 
                        tab containing tables allows you to choose a table to download as a .csv file.',
                        style="text-align:justify;color:black;padding:15px;margin-top:-2em"),
                      
                      p('The IEFT also includes damage cost estimates, which can be seen in Damage 
                        Cost Output. The output is divided into C damage costs and N damage costs. 
                        The N damage costs are further divided into different categories; users can 
                        view N damage costs separated by inventory category ("by Source"), N damage 
                        costs separated by sector affected ("by Sector"), N damage costs separated 
                        by the environments that are affected ("by Media"), and N damage costs 
                        separated by the type of N molecule ("by N Type")',
                        style="text-align:justify;color:black;padding:15px;margin-top:-2em"),
                      
                      p('The "Inventory Tables" tab shows the baseline inventory values for each category',
                        style="text-align:justify;color:black;padding:15px;margin-top:-2em"),
                      
                      br(),
                      tags$div(tags$b("Methodology:"),
                               style="text-align:justify;color:black;padding:15px;margin-top:-2em", 
                               tags$ul(
                                 tags$li("Uses methods of Leach et al. 2012 and Dukes et al. 2021"),
                                 tags$li("The amount or inventory of each category, sub-category, 
                                         or source that is used or consumed (e.g. coal, automobile, 
                                         beef, etc.) is multiplied by an emissions factor to 
                                         convert it to carbon dioxide equivalents for the C footprint, 
                                         NOx or N2O for the N footprint, the amount of P for the P 
                                         footprint, and the amount of blue or green water used for 
                                         the W footprint."),
                                 tags$li("The contribution of each category is summed to get the 
                                 total footprint."),
                                 tags$li("Damage costs are also calculated based on C and N footprints."))),
                      br(),
                      tags$div(tags$b("Potential future updates for the IEFT:"),
                               style="text-align:justify;color:black;padding:15px;margin-top:-2em",
                               tags$ul(
                                 tags$li("Ability to change inventory values"),
                                 tags$li("Add tab to allow for changing emissions factors manually"),
                                 tags$li("Add a red line to where you would see an X% reduction in 
                                         each environmental footprint (e.g. if institutions have a 
                                         specific goal reduction that they need to reach)."),
                               )),
             )),
   
    # tabPanel("Campus vs. Individual",
    #          sidebarPanel(selectInput(inputId = "campusVindividual",
    #                                   label = "Campus vs. Individual:",
    #                                   choices = c("Campus",
    #                                               "Individual")))),
    
    tabPanel("Input Scenario",
             sidebarPanel(# Input: Choose dataset ----
                          selectInput(inputId="scenario",
                                      label="Choose a Scenario:",
                                      choices = c("Manual Scenario",
                                                  "Business as Usual Growth to 2025",
                                                  "15% Vegetarian Meals", 
                                                  "Replacement of 20% beef with Chicken",
                                                  "Fuel Optimization",
                                                  "Implementing All Scenarios")),
                          radioButtons(inputId="slider_option",label="Slider options",
                                       choices=c("Footprint Sources",
                                                 "Faculty Commuting Sources",
                                                 "Staff Commuting Sources",
                                                 "Student Commuting Sources",
                                                 "Food Sources",
                                                 "On-Campus Stationary Sources"),
                                       selected="Footprint Sources",inline=FALSE),
                          # This changes the Slider Bar options depending on which button is selected
                          conditionalPanel("input.scenario=='Manual Scenario'",
                                           conditionalPanel(
                                             "input.slider_option=='Footprint Sources'",sidebar_foot),
                                           conditionalPanel(
                                             "input.slider_option=='Faculty Commuting Sources'",sidebar_fac),
                                           conditionalPanel(
                                             "input.slider_option=='Staff Commuting Sources'",sidebar_staf),
                                           conditionalPanel(
                                             "input.slider_option=='Student Commuting Sources'", sidebar_stud), 
                                           conditionalPanel(
                                             "input.slider_option=='Food Sources'",sidebar_food),
                                           conditionalPanel(
                                             "input.slider_option=='On-Campus Stationary Sources'",sidebar_energy)
                          ),
                          conditionalPanel("input.scenario=='Business as Usual Growth to 2025'",
                                           conditionalPanel(
                                             "input.slider_option=='Footprint Sources'",sidebar_foot1),
                                           conditionalPanel(
                                             "input.slider_option=='Faculty Commuting Sources'",sidebar_fac1),
                                           conditionalPanel(
                                             "input.slider_option=='Staff Commuting Sources'",sidebar_staf1),
                                           conditionalPanel(
                                             "input.slider_option=='Student Commuting Sources'", sidebar_stud1), 
                                           conditionalPanel(
                                             "input.slider_option=='Food Sources'",sidebar_food1),
                                           conditionalPanel(
                                             "input.slider_option=='On-Campus Stationary Sources'",sidebar_energy1)
                          ),
                          conditionalPanel("input.scenario=='15% Vegetarian Meals'",
                                           conditionalPanel(
                                             "input.slider_option=='Footprint Sources'",sidebar_foot2),
                                           conditionalPanel(
                                             "input.slider_option=='Faculty Commuting Sources'",sidebar_fac2),
                                           conditionalPanel(
                                             "input.slider_option=='Staff Commuting Sources'",sidebar_staf2),
                                           conditionalPanel(
                                             "input.slider_option=='Student Commuting Sources'", sidebar_stud2), 
                                           conditionalPanel(
                                             "input.slider_option=='Food Sources'",sidebar_food2),
                                           conditionalPanel(
                                             "input.slider_option=='On-Campus Stationary Sources'",sidebar_energy2)
                          ),
                          conditionalPanel("input.scenario=='Replacement of 20% beef with Chicken'",
                                           conditionalPanel(
                                             "input.slider_option=='Footprint Sources'",sidebar_foot3),
                                           conditionalPanel(
                                             "input.slider_option=='Faculty Commuting Sources'",sidebar_fac3),
                                           conditionalPanel(
                                             "input.slider_option=='Staff Commuting Sources'",sidebar_staf3),
                                           conditionalPanel(
                                             "input.slider_option=='Student Commuting Sources'", sidebar_stud3), 
                                           conditionalPanel(
                                             "input.slider_option=='Food Sources'",sidebar_food3),
                                           conditionalPanel(
                                             "input.slider_option=='On-Campus Stationary Sources'",sidebar_energy3)
                          ),
                          conditionalPanel("input.scenario=='Fuel Optimization'",
                                           conditionalPanel(
                                             "input.slider_option=='Footprint Sources'",sidebar_foot4),
                                           conditionalPanel(
                                             "input.slider_option=='Faculty Commuting Sources'",sidebar_fac4),
                                           conditionalPanel(
                                             "input.slider_option=='Staff Commuting Sources'",sidebar_staf4),
                                           conditionalPanel(
                                             "input.slider_option=='Student Commuting Sources'", sidebar_stud4), 
                                           conditionalPanel(
                                             "input.slider_option=='Food Sources'",sidebar_food4),
                                           conditionalPanel(
                                             "input.slider_option=='On-Campus Stationary Sources'",sidebar_energy4)
                          ),
                          conditionalPanel("input.scenario=='Implementing All Scenarios'",
                                           conditionalPanel(
                                             "input.slider_option=='Footprint Sources'",sidebar_foot5),
                                           conditionalPanel(
                                             "input.slider_option=='Faculty Commuting Sources'",sidebar_fac5),
                                           conditionalPanel(
                                             "input.slider_option=='Staff Commuting Sources'",sidebar_staf5),
                                           conditionalPanel(
                                             "input.slider_option=='Student Commuting Sources'", sidebar_stud5), 
                                           conditionalPanel(
                                             "input.slider_option=='Food Sources'",sidebar_food5),
                                           conditionalPanel(
                                             "input.slider_option=='On-Campus Stationary Sources'",sidebar_energy5)
                          )
             )
    ),
    
    tabPanel("Emission Factors",
             sidebarPanel(selectInput(inputId = "EF_Choice",
                                      label = "EF Category:",
                                      choices = c("Electricity",
                                                  "Energy",
                                                  "Food",
                                                  "Commuting")),
                          uiOutput('resetable_input'),
                          conditionalPanel("input.EF_Choice=='Electricity'",  # Units are kg/kwh
                                           textInput(inputId="Elect.CO2.EF_change",label="CO2 EF:",
                                                     value = 0.3885392, # use "" for blank
                                                     width = NULL, placeholder = NULL),
                                           textInput(inputId="Elect.CH4.EF_change",label="CH4 EF:",
                                                     value = 0.0000434, # use "" for blank
                                                     width = NULL, placeholder = NULL),
                                           textInput(inputId="Elect.N2O.EF_change",label="N2O EF:",
                                                     value = 0.00000625, # use "" for blank
                                                     width = NULL, placeholder = NULL),
                                           textInput(inputId="Elect.NOx.EF_change",label="NOx EF:",
                                                     value = 0.000264228, # use "" for blank
                                                     width = NULL, placeholder = NULL)),
                          
                          conditionalPanel("input.EF_Choice=='Energy'",
                                           textInput(inputId="Coal.CO2.EF_change",label="Coal CO2 EF:",
                                                     value = 2508.843651, # use "" for blank
                                                     width = NULL, placeholder = NULL),
                                           textInput(inputId="Coal.CH4.EF_change",label="Coal CH4 EF:",
                                                     value = 0.249049501, # use "" for blank
                                                     width = NULL, placeholder = NULL),
                                           textInput(inputId="Coal.N2O.EF_change",label="Coal N2O EF:",
                                                     value = 0.037357425, # use "" for blank
                                                     width = NULL, placeholder = NULL),
                                           textInput(inputId="Coal.NOx.EF_change",label="Coal NOx EF:",
                                                     value = 9.458129032, # use "" for blank
                                                     width = NULL, placeholder = NULL),

                                           textInput(inputId="Oil.CO2.EF_change",label="Oil CO2 EF:",
                                                     value = 10.09767348, # use "" for blank
                                                     width = NULL, placeholder = NULL),
                                           textInput(inputId="Oil.CH4.EF_change",label="Oil CH4 EF:",
                                                     value = 0.001294102, # use "" for blank
                                                     width = NULL, placeholder = NULL),
                                           textInput(inputId="Oil.N2O.EF_change",label="Oil N2O EF:",
                                                     value = 0.0000776, # use "" for blank
                                                     width = NULL, placeholder = NULL),
                                           textInput(inputId="Oil.NOx.EF_change",label="Oil NOx EF:",
                                                     value = 0.005154464, # use "" for blank
                                                     width = NULL, placeholder = NULL),

                                           textInput(inputId="Propane.CO2.EF_change",label="Propane CO2 EF:",
                                                     value = 5.22770094, # use "" for blank
                                                     width = NULL, placeholder = NULL),
                                           textInput(inputId="Propane.CH4.EF_change",label="Propane CH4 EF:",
                                                     value = 0.000893733, # use "" for blank
                                                     width = NULL, placeholder = NULL),
                                           textInput(inputId="Propane.N2O.EF_change",label="Propane N2O EF:",
                                                     value = 0.00005362, # use "" for blank
                                                     width = NULL, placeholder = NULL),
                                           textInput(inputId="Propane.NOx.EF_change",label="Propane NOx EF:",
                                                     value = 0.003151786, # use "" for blank
                                                     width = NULL, placeholder = NULL),
                                           
                                           textInput(inputId="NaturalGas.CO2.EF_change",label="NaturalGas CO2 EF:",
                                                     value = 53.02, # use "" for blank
                                                     width = NULL, placeholder = NULL),
                                           textInput(inputId="NaturalGas.CH4.EF_change",label="NaturalGas CH4 EF:",
                                                     value = 0.004739, # use "" for blank
                                                     width = NULL, placeholder = NULL),
                                           textInput(inputId="NaturalGas.N2O.EF_change",label="NaturalGas N2O EF:",
                                                     value = 0.000095, # use "" for blank
                                                     width = NULL, placeholder = NULL),
                                           textInput(inputId="NaturalGas.NOx.EF_change",label="NaturalGas NOx EF:",
                                                     value = 0.03414929, # use "" for blank
                                                     width = NULL, placeholder = NULL)),
                          
                          actionButton(inputId = "ResetEFs", label = "Reset EFs",
                                       style="color: #fff; background-color: #337ab7; border-color: #2e6da4")),
                          #actionButton(inputId = "NewEFs", label = "Apply New EFs"),
             mainPanel(
               fluidRow(
               br(),
               tags$div(tags$b("Changing the Emission Factors:"),
                        style="text-align:justify;color:black;padding:15px;margin-top:-2em", 
                        tags$ul(
                        tags$li("In this section, you can manually change the emission factor
                                values by typing into the text boxes."),
                        tags$li("The Reset button at the bottom with return the default 
                                emission factor values.")))
             # p(tags$b("Changing the Emission Factors:"),
             #   style="text-align:justify;color:black;padding:15px;margin-top:0em"),
             # p('In this section, you can manually change the emission factor values by 
             #   typing into the text boxes.  The Reset button at the bottom with return 
             #   the default emission factor values.',
             #   style="text-align:justify;color:black;padding:15px;margin-top:-2em")
             # ),
                      )
             )),
             
             
    
  
    tabPanel("Inventory Tables",
                           mainPanel(h1('Main Inventory Table'),
                                     dataTableOutput('INVENT_TABLE1'),
                                     h1('Food Inventory Table'),
                                     dataTableOutput('INVENT_TABLE2'))),
 
    
    # C,N,P,W Footprint Input
    tabPanel("C,N,P,W Footprint Plots",
               mainPanel(h1('Footprint Comparisons'),
                         plotOutput("CNPW_Plot1"),
                         h1('C Footprint'),
                         plotOutput("C_Plot1"),plotOutput("C_Plot2"),
                         h1('N Footprint'),
                         plotOutput("N_Plot1"),plotOutput("N_Plot2"),
                         h1('P Footprint'),
                         plotOutput("P_Plot1"),plotOutput("P_Plot2"),
                         h1('W Footprint'),
                         plotOutput("W_Plot1"),plotOutput("W_Plot2"))
             ),
    
    # Footprint Output Tables
    tabPanel("C,N,P,W Footprint Tables", 
             fluidRow(# Input: Choose Dataset to Download ----
                      style="color: black; background-color: lightblue; border-color: Black;padding:15px",
             #sidebarPanel(# Input: Choose Dataset to Download ----
                          selectInput(inputId="Table_CNPW", #"C,N,P,W Footprint Output", 
                                      label="Choose a Table:",
                                      choices = c("Baseline Footprint", 
                                                  "Projected Footprint", 
                                                  "% Change in Footprint",
                                                  "% Change in Footprint by Category")),
                          
                          # Download Button
                          downloadButton("downloadData", "Download")),
             mainPanel(# h1('Footprint Comparisons'),
               h1('Baseline Footprint'),
               dataTableOutput("CNPW_TABLE1"),
               h1('Projected Footprint'),
               dataTableOutput("CNPW_TABLE2"),
               h1('% Change in Footprint'),
               dataTableOutput("CNPW_TABLE3"),
               h1('% Change in Footprint by Category'),
               dataTableOutput("CNPW_TABLE4"))),#),
    
    tabPanel("Commuting Footprint Output",
             fluidRow(# Input: Choose Dataset to Download ----
                      style="color: black; background-color: lightblue; border-color: Black;padding:15px",
                          selectInput(inputId="Table_Commut",
                                      label="Choose a Table:",
                                      choices = c("Baseline Faculty Footprint",
                                                  "Projected Faculty Footprint",
                                                  "% Change in Faculty Footprint",
                                                  "Baseline Staff Footprint",
                                                  "Projected Staff Footprint",
                                                  "% Change in Staff Footprint",
                                                  "Baseline Student Footprint",
                                                  "Projected Student Footprint",
                                                  "% Change in Student Footprint")),
                          # Download Button
                          downloadButton("downloadData2", "Download")),
             mainPanel(h1('Faculty Commuting Footprints'),
                       plotOutput("Comm_SubPlot1"),
                       h1('Baseline Footprint'),
                       dataTableOutput("COMMUT_TABLE1a"),
                       h1('Projected Footprint'),
                       dataTableOutput("COMMUT_TABLE2a"),
                       h1('% Change in Faculty Commuting Footprint'),
                       dataTableOutput("COMMUT_TABLE3a")),
             mainPanel(h1('Staff Commuting Footprints'),
                       plotOutput("Comm_SubPlot2"),
                       h1('Baseline Footprint'),
                       dataTableOutput("COMMUT_TABLE1b"),
                       h1('Projected Footprint'),
                       dataTableOutput("COMMUT_TABLE2b"),
                       h1('% Change in Staff Commuting Footprint'),
                       dataTableOutput("COMMUT_TABLE3b")),
             mainPanel(h1('Student Commuting Footprints'),
                       plotOutput("Comm_SubPlot3"),
                       h1('Baseline Footprint'),
                       dataTableOutput("COMMUT_TABLE1c"),
                       h1('Projected Footprint'),
                       dataTableOutput("COMMUT_TABLE2c"),
                       h1('% Change in Student Commuting Footprint'),
                       dataTableOutput("COMMUT_TABLE3c"))),
    
    tabPanel("Food Footprint Output",
             fluidRow(# Input: Choose Dataset to Download ----
                      style="color: black; background-color: lightblue; border-color: Black;padding:15px",
                          selectInput(inputId="Table_Food", 
                                      label="Choose a Table:",
                                      choices = c("Baseline Food Footprint", 
                                                  "Projected Food Footprint", 
                                                  "% Change in Food Footprint")),
                          
                          # Download Button
                          downloadButton("downloadData3", "Download")),
             mainPanel(plotOutput("Food_Plot1"),plotOutput("Food_Plot2"),
                       h1('Baseline Footprint'),
                       dataTableOutput("Food_TABLE1"),
                       h1('Projected Footprint'),
                       dataTableOutput("Food_TABLE2"),
                       h1('% Change in Food Footprint'),
                       dataTableOutput("Food_TABLE3"))),
    
    tabPanel("On-Campus Stationary Source Footprint Output",
             fluidRow(# Input: Choose Dataset to Download ----
                      style="color: black; background-color: lightblue; border-color: Black;padding:15px",
                          selectInput(inputId="Table_Energy", 
                                      label="Choose a Table:",
                                      choices = c("Baseline Energy Footprint", 
                                                  "Projected Energy Footprint", 
                                                  "% Change in Energy Footprint")),
                          
                          # Download Button
                          downloadButton("downloadData4", "Download")),
             mainPanel(plotOutput("Energy_Plot1"),plotOutput("Energy_Plot2"),
                       h1('Baseline Footprint'),
                       dataTableOutput("Energy_TABLE1"),
                       h1('Projected Footprint'),
                       dataTableOutput("Energy_TABLE2"),
                       h1('% Change in Energy Footprint'),
                       dataTableOutput("Energy_TABLE3"))),
    
    tabPanel("Damage Cost Output",
             fluidRow(# Input: Choose Dataset to Download ----
                      style="color: black; background-color: lightblue; border-color: Black;padding:15px",
                          selectInput(inputId="Table_Cost", 
                                      label="Choose a Table:",
                                      choices = c("C Damage Costs", 
                                                  "N Damage Cost Table (used for calculations)", 
                                                  "N Damage Costs by Source",
                                                  "N Damage Costs by Sector",
                                                  "N Damage Costs by Media",
                                                  "N Damage Costs by N Type")),
                          
                          # Download Button
                          downloadButton("downloadData5", "Download")),
             mainPanel(h1('Carbon Damage Costs'),
                       plotOutput("Cost_Plot1"),
                       dataTableOutput("COST_TABLE1"),
                       h1('N Damage Cost Table (used for calculations)'),
                       dataTableOutput("COST_TABLE2a"),
                       h1('N Damage Costs by Source'),
                       plotOutput("Cost_Plot2"),
                       dataTableOutput("COST_TABLE2"),
                       h1('N Damage Costs by Sector'),
                       plotOutput("Cost_Plot3"),
                       dataTableOutput("COST_TABLE3"),
                       h1('N Damage Costs by Media'),
                       plotOutput("Cost_Plot4"),
                       dataTableOutput("COST_TABLE4"),
                       h1('N Damage Costs by N Type'),
                       plotOutput("Cost_Plot5"),
                       dataTableOutput("COST_TABLE5"))),
    
    # tabPanel("Individual",
    #          sidebarPanel(# Input: Choose dataset ----
    #                       
    #                       )),
    
    tabPanel("BAU vs. Scenarios",
             mainPanel(h1('All: BAU vs Scenario % Change'),
                       dataTableOutput('BAUvsScenario_TABLE1'),
                       h1('Food: BAU vs. Scenario % Change'),
                       dataTableOutput('BAUvsScenario_TABLE2')))
    
    
    
    
  ) # tabsetPanel
  #) # mainPanel
  #) # sidebarLayout
) # fluidPage


#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# STEP_4 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

# Use this when testing the code, keep commented otherwise
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

# names(food)[which(colnames(food)=="UVA_inventory")] = "inventory"
# names(food)[which(colnames(food)=="Food_category")] = "Category"
# 
# food$Color_codes = str_remove(food$Color_codes, '#')
# food$Color_codes = as.character(paste0('#',food$Color_codes))
# 
# food1 = food
# food2 = food
# 
# # Add Projected category
# food1$Timeframe = 'Baseline'
# food2$Timeframe = 'Projected'
# 
# FOOD = rbind(food1,food2)
# 
# # Calculuations
# # Result units = kg eCO2
# # Carbon Footprint: (inventory unit e.g. kg) * (kg eCO2 / kg food)
# FOOD$C_Footprint = FOOD$inventory * FOOD$C_footprint_food
# 
# # Result units = kg N
# # N food supply: (inventory unit e.g. kg) * N Conent is unitless?
# FOOD$N_food_supply = FOOD$inventory * FOOD$N_Content
# 
# # Result units = kg N
# # Waste N:  Food_waste (Unitless - %) * (kg N)
# FOOD$N_waste = FOOD$Food_waste * FOOD$N_food_supply
# 
# # Result units = kg N
# # Inventory unit (kg N) * (kg N loss / kg N food)
# FOOD$N_virtual = FOOD$N_food_supply * FOOD$Conventional_virtual_N_factor
# 
# # N Footprint
# # Result units = kg N
# FOOD$N_Footprint = FOOD$N_waste + FOOD$N_virtual
# 
# # P Footprint
# # Result units = kg P
# FOOD$P_Footprint = FOOD$inventory * FOOD$P_footprint_food
# 
# # W Footprint
# # Result units = gallons water (264.172 gal/m3 * kg inventory * m3 water / MT food * 1 MT/1000 kg)
# FOOD$Blue_W_Footprint = 264.172*FOOD$inventory * FOOD$Blue_W_Footprint_food / 1000
# FOOD$Green_W_Footprint = 264.172*FOOD$inventory * FOOD$Green_W_Footprint_food / 1000
# FOOD$Grey_W_Footprint = 264.172*FOOD$inventory * FOOD$Grey_W_Footprint_food / 1000
# 
# #food$Total_W_Footprint = food$Green_W_Footprint + food$Blue_W_Footprint + food$Grey_W_Footprint
# FOOD$B_Footprint = FOOD$Blue_W_Footprint
# FOOD$G_Footprint = FOOD$Green_W_Footprint
# FOOD$BG_Footprint = FOOD$Green_W_Footprint + FOOD$Blue_W_Footprint
# 
# # Convert values with na to zero
# FOOD[is.na(FOOD)] <- 0
# 
# FOOD_R = FOOD
# 
#   uva1 = uva
#   uva2 = uva
# 
#   # Add Projected category
#   uva1$Timeframe = 'Baseline'
#   uva2$Timeframe = 'Projected'
#   # Make sure they are same units before summarizing in next step
# 
#   TABLE_R = rbind(uva1,uva2)
# 
#   COMBO = TABLE_R
# 
#   #CARBON_____________________________________________________________________
#   # Result units = kg CO2
#   # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
#   COMBO$CO2_r = COMBO$inventory * COMBO$CO2.EF
# 
#   # Result units = kg eCO2
#   # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
#   COMBO$eCO2_r = COMBO$inventory * COMBO$eCO2.EF
# 
#   # Result units = kg CH4
#   # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
#   COMBO$CH4_r = COMBO$inventory * COMBO$CH4.EF
# 
#   #NITROGEN_____________________________________________________________________
#   # Result units = kg N20
#   # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
#   COMBO$N2O_r = COMBO$inventory * COMBO$N2O.EF
# 
#   # Result units = kg NOx
#   # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
#   COMBO$NOx_r = COMBO$inventory * COMBO$NOx.EF
# 
#   # Result units = kg N20
#   # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
#   COMBO$OtherN_r = COMBO$inventory * COMBO$Other.N.EF
# 
#   #INTERMEDIATE C & N _______________________________________________________________
# 
#   # calculate Footprints by category (divide by 1000 to convert from kg to MT)
#   # GWP file has all of the global warming potentials for refrigerants and chemicals
#   # Units of GWP
#   COMBO$CO2_MTCDE = COMBO$CO2_r/1000  # MT CO2e
#   COMBO$eCO2_MTCDE = COMBO$eCO2_r/1000 # MT CO2e
#   COMBO$CH4_MTCDE = COMBO$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
#   COMBO$N2O_MTCDE = COMBO$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
# 
#   # Calculations only for refrigerants and chemicals for Carbon
#   # inventory (kg) * GWP (Unitless??) / 1000 = MT CO2e
#   COMBO$Ref_Chem[COMBO$Source=='HCFC-22'] = COMBO[COMBO$Source=='HCFC-22',]$inventory * gwp[gwp$Pollutant=='HCFC-22',]$GWP/1000 # MT CO2e
#   COMBO$Ref_Chem[COMBO$Source=='HCFE-235da2'] = COMBO[COMBO$Source=='HCFE-235da2',]$inventory * gwp[gwp$Pollutant=='HCFE-235da2',]$GWP/1000 # MT CO2e
#   COMBO$Ref_Chem[COMBO$Source=='HFC-134a'] = COMBO[COMBO$Source=='HFC-134a',]$inventory * gwp[gwp$Pollutant=='HFC-134a',]$GWP/1000 # MT CO2e
#   COMBO$Ref_Chem[COMBO$Source=='HG-10'] = COMBO[COMBO$Source=='HG-10',]$inventory * gwp[gwp$Pollutant=='HG-10',]$GWP/1000 # MT CO2e
#   #COMBO$Ref_Chem[COMBO$Source=='Other'] = COMBO[COMBO$Source=='Other',]$inventory * gwp[gwp$Pollutant=='Other',]$GWP/1000 # MT CO2e
#   COMBO$Ref_Chem[COMBO$Source=='R-404a'] = COMBO[COMBO$Source=='R-404a',]$inventory * gwp[gwp$Pollutant=='R-404a',]$GWP/1000 # MT CO2e
# 
#   # intermediate N
#   COMBO$N2O_MTN = COMBO$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
#   COMBO$NOx_MTN = COMBO$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
#   COMBO$OtherN_MTN = COMBO$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
# 
#   #*****************************************************************************************************
#   # FOOTPRINT Calculations
#   #*****************************************************************************************************
# 
#   # CALCULATING FOOTPRINT C & N_____________________________________________________________________
#   # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
# 
#   COMBO$C_Footprint = rowSums(COMBO[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE','Ref_Chem')],na.rm=T)
#   COMBO$N_Footprint = rowSums(COMBO[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T)
# 
# 
#   #PHOSPHORUS FOOTPRINT_____________________________________________________________________
# 
#   # Result units = MT of P
#   # Inventory unit (e.g. US gallon) * kg P / inventory unit
#   COMBO$P_Footprint = COMBO$inventory * COMBO$P.EF /1000  # Divide by 1000 to get metric tons
# 
# 
#   #WATER FOOTPRINT ________________________________________________________________
# 
#   # Result units = gallons
#   # Inventory unit (e.g. US gallon) * (gal water / inventory unit)
# 
#   COMBO$W_Footprint1 = COMBO$inventory * COMBO$Water.EF #* 0.00378541178 us this if convert to m3
# 
# 
#   for (i in 1:nrow(COMBO)){
#     if(COMBO$Scope[i]=='Scope 1' &
#        COMBO$Category[i]=='Direct Water Use' &
#        COMBO$Sub_category[i]=='On-campus water consumption' &
#        COMBO$Source[i]=='Direct Use') {
#       COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * 1000000
#     } else if(COMBO$Scope[i]=='Scope 2' &
#               COMBO$Category[i]=='Purchased Electricity' &
#               COMBO$Sub_category[i]=='Purchased Electricity' &
#               COMBO$Source[i]=='Purchased Electricity'){
#       COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * (10^(-12))*3600000/0.00378541178
#     } else {
#       COMBO$W_Footprint[i] = COMBO$W_Footprint1[i]
#     }
#   }
# 
#   COMBO_R_ = COMBO  # Units are MT for C, N, P, & gallons for Water
# 
# 
# 
# #*****************************************************************************************************
# # FOOTPRINT DATA OUTPUT
# #*****************************************************************************************************
# 
# 
# 
#   COMBO = COMBO_R_
# 
#   # Summarize by Category___________________________________________________________________________
#   # Units are MT C, MT N, MT P, Gallons Water
# 
#   COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>%
#     group_by(Category) %>%
#     summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
#               Total_N_Footprint = sum(N_Footprint,na.rm=T),
#               Total_P_Footprint = sum(P_Footprint,na.rm=T),
#               Total_W_Footprint = sum(W_Footprint,na.rm=T))
#   COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
#     group_by(Category) %>%
#     summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
#               Total_N_Footprint = sum(N_Footprint,na.rm=T),
#               Total_P_Footprint = sum(P_Footprint,na.rm=T),
#               Total_W_Footprint = sum(W_Footprint,na.rm=T))
# 
#   COMBO1$Timeframe = 'Baseline'
#   COMBO2$Timeframe = 'Projected'
# 
# 
#   #*****************************************************************************************************
#   # ADD FOOD ONTO FOOTPRINT Calculations
#   #*****************************************************************************************************
# 
#   # Calculate total food footprints (original units = kg for C,N,P or gal for water)
#   # final units = MT (Metric Tons)
# 
#   food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
#   food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
# 
#   C_food_footprint1 = sum(food1_$C_footprint,na.rm=T)/1000
#   N_food_footprint1 = sum(food1_$N_footprint,na.rm=T)/1000
#   P_food_footprint1 = sum(food1_$P_footprint,na.rm=T)/1000
#   C_food_footprint2 = sum(food2_$C_footprint,na.rm=T)/1000
#   N_food_footprint2 = sum(food2_$N_footprint,na.rm=T)/1000
#   P_food_footprint2 = sum(food2_$P_footprint,na.rm=T)/1000
# 
#   # Units for water = gallons
#   B_food_footprint1 = sum(food1_$B_footprint,na.rm=T)
#   G_food_footprint1 = sum(food1_$G_footprint,na.rm=T)
#   BG_food_footprint1 = sum(food1_$BG_footprint,na.rm=T)
#   B_food_footprint2 = sum(food2_$B_footprint,na.rm=T)
#   G_food_footprint2 = sum(food2_$G_footprint,na.rm=T)
#   BG_food_footprint2 = sum(food2_$BG_footprint,na.rm=T)
# 
#   #Make a new 1 row dataframe
#   C_food_rw1 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint1)
#   N_food_rw1 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint1)
#   P_food_rw1 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint1)
#   B_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint1)
#   G_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint1)
#   BG_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint1)
#   C_food_rw2 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint2)
#   N_food_rw2 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint2)
#   P_food_rw2 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint2)
#   B_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint2)
#   G_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint2)
#   BG_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint2)
# 
#   food_row1 = merge(C_food_rw1,N_food_rw1,by='Category')
#   food_row1 = merge(food_row1,P_food_rw1,by='Category')
#   food_row1 = merge(food_row1,B_food_rw1,by='Category')
#   food_row1$Timeframe = "Baseline"
# 
#   food_row2 = merge(C_food_rw2,N_food_rw2,by='Category')
#   food_row2 = merge(food_row2,P_food_rw2,by='Category')
#   food_row2 = merge(food_row2,B_food_rw2,by='Category')
#   food_row2$Timeframe = "Projected"
# 
#   # add on the food row
#   COMBO_foot1 = rbind(COMBO1,food_row1)
#   COMBO_foot2 = rbind(COMBO2,food_row2)
# 
#   COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
# 
#   # Rearrange the rows to match the slider rows
#   COMBO_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
#                   COMBO_foot[COMBO_foot$Category=='Food',],
#                   COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
#                   COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
#                   COMBO_foot[COMBO_foot$Category=='Commuting',],
#                   #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
#                   COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
#                   COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
#                   COMBO_foot[COMBO_foot$Category=='Wastewater',],
#                   COMBO_foot[COMBO_foot$Category=='Direct Water Use',])
# 
# 
# 
# #*****************************************************************************************************
# # Commuting Reactive Faculty Calculations
# #*****************************************************************************************************
# 
# # Commuting all sub-categories and sources
# 
#   # Footprint Units are MT C and MT N
# 
#   commut1 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Faculty Commuting',]
#   commut2 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Faculty Commuting',]
# 
#   # Add Projected category
#   commut1$Timeframe = 'Baseline'
#   commut2$Timeframe = 'Projected'
# 
# 
#   COMMUTING_FAC_TABLE_R = rbind(commut1,commut2)
# 
# 
# 
#   COMMUTING = COMMUTING_FAC_TABLE_R
# 
#   #CARBON_____________________________________________________________________
#   # Result units = kg CO2
#   # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
#   COMMUTING$CO2_r = COMMUTING$inventory * COMMUTING$CO2.EF
# 
#   # Result units = kg eCO2
#   # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
#   COMMUTING$eCO2_r = COMMUTING$inventory * COMMUTING$eCO2.EF
# 
#   # Result units = kg CH4
#   # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
#   COMMUTING$CH4_r = COMMUTING$inventory * COMMUTING$CH4.EF
# 
#   #NITROGEN_____________________________________________________________________
#   # Result units = kg N20
#   # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
#   COMMUTING$N2O_r = COMMUTING$inventory * COMMUTING$N2O.EF
# 
#   # Result units = kg NOx
#   # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
#   COMMUTING$NOx_r = COMMUTING$inventory * COMMUTING$NOx.EF
# 
#   # Result units = kg N20
#   # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
#   COMMUTING$OtherN_r = COMMUTING$inventory * COMMUTING$Other.N.EF
# 
#   #INTERMEDIATE C & N _______________________________________________________________
# 
#   # calculate Footprints by category (divide by 1000 to convert from kg to MT)
#   # Units of GWP
#   COMMUTING$CO2_MTCDE = COMMUTING$CO2_r/1000  # MT CO2e
#   COMMUTING$eCO2_MTCDE = COMMUTING$eCO2_r/1000 # MT CO2e
#   COMMUTING$CH4_MTCDE = COMMUTING$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
#   COMMUTING$N2O_MTCDE = COMMUTING$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
# 
#   # intermediate N
#   COMMUTING$N2O_MTN = COMMUTING$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
#   COMMUTING$NOx_MTN = COMMUTING$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
#   COMMUTING$OtherN_MTN = COMMUTING$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
# 
#   #*****************************************************************************************************
#   # FOOTPRINT Calculations
#   #*****************************************************************************************************
# 
#   # CALCULATING FOOTPRINT C & N_____________________________________________________________________
#   # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
# 
#   COMMUTING$C_Footprint = rowSums(COMMUTING[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T)
#   COMMUTING$N_Footprint = rowSums(COMMUTING[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T)
# 
#   Commut_Fac_R_ = COMMUTING
# 
# 
#   COMMUTING = Commut_Fac_R_
#   #*****************************************************************************************************
#   # FOOTPRINT DATA OUTPUT
#   #*****************************************************************************************************
# 
#   # Summarize by Category___________________________________________________________________________
#   # Units are MT C, MT N, MT P, Gallons Water
# 
#   COMMUTING1_ = COMMUTING[COMMUTING$Timeframe == 'Baseline',] %>%
#     group_by(Category,Sub_category,Source) %>%
#     summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
#               Total_N_Footprint = sum(N_Footprint,na.rm=T))
#   COMMUTING2_ = COMMUTING[COMMUTING$Timeframe == 'Projected',] %>%
#     group_by(Category,Sub_category,Source) %>%
#     summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
#               Total_N_Footprint = sum(N_Footprint,na.rm=T))
# 
#   COMMUTING1_$Timeframe = 'Baseline'
#   COMMUTING2_$Timeframe = 'Projected'
# 
#   Commut_Fac_R = rbind(COMMUTING1_,COMMUTING2_)
# 
# 
# 
# #*****************************************************************************************************
# # Commuting Reactive Staff Calculations
# #*****************************************************************************************************
# 
# # Commuting all sub-categories and sources
#   # Footprint Units are MT C and MT N
# 
#   commut1 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Staff Commuting',]
#   commut2 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Staff Commuting',]
# 
#   # Add Projected category
#   commut1$Timeframe = 'Baseline'
#   commut2$Timeframe = 'Projected'
# 
# 
#   COMMUTING_STAFF_TABLE_R  = rbind(commut1,commut2)
# 
# 
#   COMMUTING = COMMUTING_STAFF_TABLE_R
# 
#   #CARBON_____________________________________________________________________
#   # Result units = kg CO2
#   # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
#   COMMUTING$CO2_r = COMMUTING$inventory * COMMUTING$CO2.EF
# 
#   # Result units = kg eCO2
#   # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
#   COMMUTING$eCO2_r = COMMUTING$inventory * COMMUTING$eCO2.EF
# 
#   # Result units = kg CH4
#   # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
#   COMMUTING$CH4_r = COMMUTING$inventory * COMMUTING$CH4.EF
# 
#   #NITROGEN_____________________________________________________________________
#   # Result units = kg N20
#   # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
#   COMMUTING$N2O_r = COMMUTING$inventory * COMMUTING$N2O.EF
# 
#   # Result units = kg NOx
#   # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
#   COMMUTING$NOx_r = COMMUTING$inventory * COMMUTING$NOx.EF
# 
#   # Result units = kg N20
#   # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
#   COMMUTING$OtherN_r = COMMUTING$inventory * COMMUTING$Other.N.EF
# 
#   #INTERMEDIATE C & N _______________________________________________________________
# 
#   # calculate Footprints by category (divide by 1000 to convert from kg to MT)
#   # Units of GWP
#   COMMUTING$CO2_MTCDE = COMMUTING$CO2_r/1000  # MT CO2e
#   COMMUTING$eCO2_MTCDE = COMMUTING$eCO2_r/1000 # MT CO2e
#   COMMUTING$CH4_MTCDE = COMMUTING$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
#   COMMUTING$N2O_MTCDE = COMMUTING$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
# 
#   # intermediate N
#   COMMUTING$N2O_MTN = COMMUTING$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
#   COMMUTING$NOx_MTN = COMMUTING$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
#   COMMUTING$OtherN_MTN = COMMUTING$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
# 
#   #*****************************************************************************************************
#   # FOOTPRINT Calculations
#   #*****************************************************************************************************
# 
#   # CALCULATING FOOTPRINT C & N_____________________________________________________________________
#   # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
# 
#   COMMUTING$C_Footprint = rowSums(COMMUTING[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T)
#   COMMUTING$N_Footprint = rowSums(COMMUTING[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T)
# 
#   Commut_Staff_R_ = COMMUTING
# 
# 
#   #*****************************************************************************************************
#   # FOOTPRINT DATA OUTPUT
#   #*****************************************************************************************************
# 
#   COMMUTING = Commut_Staff_R_
# 
#   # Summarize by Category___________________________________________________________________________
#   # Units are MT C, MT N, MT P, Gallons Water
# 
#   COMMUTING1_ = COMMUTING[COMMUTING$Timeframe == 'Baseline',] %>%
#     group_by(Category,Sub_category,Source) %>%
#     summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
#               Total_N_Footprint = sum(N_Footprint,na.rm=T))
#   COMMUTING2_ = COMMUTING[COMMUTING$Timeframe == 'Projected',] %>%
#     group_by(Category,Sub_category,Source) %>%
#     summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
#               Total_N_Footprint = sum(N_Footprint,na.rm=T))
# 
#   COMMUTING1_$Timeframe = 'Baseline'
#   COMMUTING2_$Timeframe = 'Projected'
# 
#   Commut_Staff_R = rbind(COMMUTING1_,COMMUTING2_)
# 
# 
# 
# #*****************************************************************************************************
# # Commuting Reactive Student Calculations
# #*****************************************************************************************************
# 
# # Commuting all sub-categories and sources
# 
# 
#   # Footprint Units are MT C and MT N
# 
#   commut1 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Student Commuting',]
#   commut2 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Student Commuting',]
# 
#   # Add Projected category
#   commut1$Timeframe = 'Baseline'
#   commut2$Timeframe = 'Projected'
# 
# 
#   COMMUTING_STUD_TABLE_R = rbind(commut1,commut2)
# 
# 
# 
#   COMMUTING = COMMUTING_STUD_TABLE_R
# 
#   #CARBON_____________________________________________________________________
#   # Result units = kg CO2
#   # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
#   COMMUTING$CO2_r = COMMUTING$inventory * COMMUTING$CO2.EF
# 
#   # Result units = kg eCO2
#   # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
#   COMMUTING$eCO2_r = COMMUTING$inventory * COMMUTING$eCO2.EF
# 
#   # Result units = kg CH4
#   # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
#   COMMUTING$CH4_r = COMMUTING$inventory * COMMUTING$CH4.EF
# 
#   #NITROGEN_____________________________________________________________________
#   # Result units = kg N20
#   # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
#   COMMUTING$N2O_r = COMMUTING$inventory * COMMUTING$N2O.EF
# 
#   # Result units = kg NOx
#   # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
#   COMMUTING$NOx_r = COMMUTING$inventory * COMMUTING$NOx.EF
# 
#   # Result units = kg N20
#   # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
#   COMMUTING$OtherN_r = COMMUTING$inventory * COMMUTING$Other.N.EF
# 
#   #INTERMEDIATE C & N _______________________________________________________________
# 
#   # calculate Footprints by category (divide by 1000 to convert from kg to MT)
#   # Units of GWP
#   COMMUTING$CO2_MTCDE = COMMUTING$CO2_r/1000  # MT CO2e
#   COMMUTING$eCO2_MTCDE = COMMUTING$eCO2_r/1000 # MT CO2e
#   COMMUTING$CH4_MTCDE = COMMUTING$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
#   COMMUTING$N2O_MTCDE = COMMUTING$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
# 
#   # intermediate N
#   COMMUTING$N2O_MTN = COMMUTING$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
#   COMMUTING$NOx_MTN = COMMUTING$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
#   COMMUTING$OtherN_MTN = COMMUTING$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
# 
#   #*****************************************************************************************************
#   # FOOTPRINT Calculations
#   #*****************************************************************************************************
# 
#   # CALCULATING FOOTPRINT C & N_____________________________________________________________________
#   # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
# 
#   COMMUTING$C_Footprint = rowSums(COMMUTING[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T)
#   COMMUTING$N_Footprint = rowSums(COMMUTING[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T)
# 
#   Commut_Stud_R_ = COMMUTING
# 
# 
#   COMMUTING = Commut_Stud_R_
#   #*****************************************************************************************************
#   # FOOTPRINT DATA OUTPUT
#   #*****************************************************************************************************
# 
#   # Summarize by Category___________________________________________________________________________
#   # Units are MT C, MT N, MT P, Gallons Water
# 
#   COMMUTING1_ = COMMUTING[COMMUTING$Timeframe == 'Baseline',] %>%
#     group_by(Category,Sub_category,Source) %>%
#     summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
#               Total_N_Footprint = sum(N_Footprint,na.rm=T))
#   COMMUTING2_ = COMMUTING[COMMUTING$Timeframe == 'Projected',] %>%
#     group_by(Category,Sub_category,Source) %>%
#     summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
#               Total_N_Footprint = sum(N_Footprint,na.rm=T))
# 
#   COMMUTING1_$Timeframe = 'Baseline'
#   COMMUTING2_$Timeframe = 'Projected'
# 
#   Commut_Stud_R = rbind(COMMUTING1_,COMMUTING2_)
# 
# 
# #*****************************************************************************************************
# # Energy Reactive
# #*****************************************************************************************************
# 
#   # ENGERGY
#   Energy1 = uva[uva$Category == 'On-Campus Stationary Sources',]
#   Energy2 = Energy1
# 
#   # Add Projected category
#   Energy1$Timeframe = 'Baseline'
#   Energy2$Timeframe = 'Projected'
# 
#   sectr3 ='On-Campus Stationary Sources'
# 
#   ENERGY_TABLE_R = rbind(Energy1,Energy2)
# 
#   ENERGY = ENERGY_TABLE_R
#   # FOOTPRINT CALCULATIONS
#   #CARBON_____________________________________________________________________
#   # Result units = kg CO2
#   # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
#   ENERGY$CO2_r = ENERGY$inventory * ENERGY$CO2.EF
# 
#   # Result units = kg eCO2
#   # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
#   ENERGY$eCO2_r = ENERGY$inventory * ENERGY$eCO2.EF
# 
#   # Result units = kg CH4
#   # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
#   ENERGY$CH4_r = ENERGY$inventory * ENERGY$CH4.EF
# 
#   #NITROGEN_____________________________________________________________________
#   # Result units = kg N20
#   # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
#   ENERGY$N2O_r = ENERGY$inventory * ENERGY$N2O.EF
# 
#   # Result units = kg NOx
#   # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
#   ENERGY$NOx_r = ENERGY$inventory * ENERGY$NOx.EF
# 
#   # Result units = kg N20
#   # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
#   ENERGY$OtherN_r = ENERGY$inventory * ENERGY$Other.N.EF
# 
#   #INTERMEDIATE C & N _______________________________________________________________
# 
#   # calculate Footprints by category (divide by 1000 to convert from kg to MT)
#   # Units of GWP
#   ENERGY$CO2_MTCDE = ENERGY$CO2_r/1000  # MT CO2e
#   ENERGY$eCO2_MTCDE = ENERGY$eCO2_r/1000 # MT CO2e
#   ENERGY$CH4_MTCDE = ENERGY$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
#   ENERGY$N2O_MTCDE = ENERGY$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
# 
#   # intermediate N
#   ENERGY$N2O_MTN = ENERGY$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
#   ENERGY$NOx_MTN = ENERGY$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
#   ENERGY$OtherN_MTN = ENERGY$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
# 
#   #*****************************************************************************************************
#   # FOOTPRINT Calculations
#   #*****************************************************************************************************
# 
#   # CALCULATING FOOTPRINT C & N_____________________________________________________________________
#   # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
#   ENERGY$C_Footprint = rowSums(ENERGY[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T)
#   ENERGY$N_Footprint = rowSums(ENERGY[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T)
# 
#   Energy_R_ = ENERGY
# 
#   ENERGY = Energy_R_
#   #*****************************************************************************************************
#   # FOOTPRINT DATA OUTPUT
#   #*****************************************************************************************************
# 
#   # Summarize by Category___________________________________________________________________________
#   # Units are MT C, MT N, MT P, Gallons Water
# 
#   ENERGY1 = ENERGY[ENERGY$Timeframe == 'Baseline',] %>%
#     group_by(Category,Sub_category,Source) %>%
#     summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
#               Total_N_Footprint = sum(N_Footprint,na.rm=T))
#   ENERGY2 = ENERGY[ENERGY$Timeframe == 'Projected',] %>%
#     group_by(Category,Sub_category,Source) %>%
#     summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
#               Total_N_Footprint = sum(N_Footprint,na.rm=T))
# 
#   ENERGY1$Timeframe = 'Baseline'
#   ENERGY2$Timeframe = 'Projected'
# 
#   Energy_R = rbind(ENERGY1,ENERGY2)
# 
# #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# # COSTS
# #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# COST = COMBO_R_
# COMMUT = rbind(Commut_Fac_R_,Commut_Staff_R_,Commut_Stud_R_)
# ENERGY = Energy_R_
# 
# 
# # Remove the COMMUTING and ENERGY from main dataframe
# COST = COST[COST$Category != 'Commuting',]
# COST = COST[COST$Category != 'On-Campus Stationary Sources',]
# 
# 
# # Get the dataframes to have same fields
# COST = COST[,c('Scope','Category','Sub_category','Source','Units',
#                'inventory','NOx_MTN','N2O_MTN','OtherN_MTN',
#                'C_Footprint','N_Footprint','Timeframe')]
# COMMUT = COMMUT[,c('Scope','Category','Sub_category','Source','Units',
#                    'inventory','NOx_MTN','N2O_MTN','OtherN_MTN',
#                    'C_Footprint','N_Footprint','Timeframe')]
# ENERGY = ENERGY[,c('Scope','Category','Sub_category','Source','Units',
#                    'inventory','NOx_MTN','N2O_MTN','OtherN_MTN',
#                    'C_Footprint','N_Footprint','Timeframe')]
# 
# 
# 
# #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# # CARBON COSTS ********************************************************************
# # Jana Compton: For Carbon costs, we recommend using $2-$50 per ton of CO2 equivalent
# # That covers the range we are using in our paper.
# # Units of C_Footprint are MT for COST and kg for food data
# COST$C_Cost_min = 2*COST$C_Footprint # Initial Units are MT
# COST$C_Cost_max = 50*COST$C_Footprint # Initial Units are MT
# COST$C_Cost_mid = 30*COST$C_Footprint # Initial Units are MT
# 
# COMMUT$C_Cost_min = 2*COMMUT$C_Footprint # Initial Units are MT
# COMMUT$C_Cost_max = 50*COMMUT$C_Footprint # Initial Units are MT
# COMMUT$C_Cost_mid = 30*COMMUT$C_Footprint # Initial Units are MT
# 
# ENERGY$C_Cost_min = 2*ENERGY$C_Footprint # Initial Units are MT
# ENERGY$C_Cost_max = 50*ENERGY$C_Footprint # Initial Units are MT
# ENERGY$C_Cost_mid = 30*ENERGY$C_Footprint # Initial Units are MT
# 
# # NITROGEN COSTS ******************************************************************
# # Other N  contributs to fertilizer and wastewater inventories,
# # The fertilizer component can be split into NOx, N2O, NH3, and N to Water
# # Using the following percentages 20%, 3%, 13%, 21%, respectively
# # Wastewater component contributes to the N to water
# 
# # Baseline
# N_Fert_c = 1000*COST[COST$Sub_category == 'Fertilizer' & COST$Timeframe == 'Baseline',]$OtherN_MTN
# N_Fert_NOx_c = N_Fert_c * 0.2
# N_Fert_N2O_c = N_Fert_c * 0.03
# N_Fert_NH3_c = N_Fert_c * 0.13
# N_Fert_SW_c = N_Fert_c * 0.21 # proportion that goes to SW (Houlton et al. 2013)
# N_Fert_GW_c = N_Fert_c * .79 * .33 # proportion that goes to GW (Sabota et al. 2015)
# N_Fert_coast_c = N_Fert_SW_c * .40 # proportion of SW that goes to coast (Sabota et al. 2015)
# 
# # Projected
# N_Fert_p = 1000*COST[COST$Sub_category == 'Fertilizer' & COST$Timeframe == 'Projected',]$OtherN_MTN
# N_Fert_NOx_p = N_Fert_p * 0.2
# N_Fert_N2O_p = N_Fert_p * 0.03
# N_Fert_NH3_p = N_Fert_p * 0.13
# N_Fert_SW_p = N_Fert_p * 0.21 # proportion that goes to SW (Houlton et al. 2013)
# N_Fert_GW_p = N_Fert_p * .79 * .33 # proportion that goes to GW (Sabota et al. 2015)
# N_Fert_coast_p = N_Fert_SW_p * .40 # proportion of SW that goes to coast (Sabota et al. 2015)
# 
# #********************************************************************************
# 
# COST1 = COST[COST$Timeframe == 'Baseline',]
# COST2 = COST[COST$Timeframe == 'Projected',]
# 
# # Units are MT N2O or NOx - so multiplying by 1000 to convert to kg
# # h = health/social; a = agriculure; e = Ecosystems; c = climate
# COST1$N_Cost_NOx_atm_h = 1000*COST1$NOx_MTN * 32.20 # $/kgN Human respiratory health
# COST1$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health (zero unless fertilzer - see below)
# COST1$N_Cost_NOx_atm_e = 1000*COST1$NOx_MTN * 0.43 # $/kgN visibility damages
# COST1$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages (zero unless fertilzer - see below)
# COST1$N_Cost_N2O_atm_c = 1000*COST1$N2O_MTN * 15.07 # $/kgN Greenhouse damages
# COST1$N_Cost_NOx_atm_c = 1000*COST1$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits
# COST1$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits (zero unless fertilzer - see below)
# COST1$N_Cost_NOx_ter_h = 1000*COST1$NOx_MTN * 0.12 # $/kgN Damages to structures
# COST1$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures (zero unless fertilzer - see below)
# COST1$N_Cost_NOx_ter_a = 1000*COST1$NOx_MTN * 2.11 # $/kgN Ozone damages to crops
# COST1$N_Cost_N2O_ter_a = 1000*COST1$N2O_MTN * 1.48 # $/kgN UV damages to crops
# COST1$N_Cost_NOx_ter_e = 1000*COST1$NOx_MTN * 1.24 # $/kgN Ozone damages to forests
# 
# COST1$N_Cost_NOx_atm_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 32.20 # $/kgN Human respiratory health
# COST1$N_Cost_NH3_atm_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * 6.87 # $/kgN Human respiratory health
# COST1$N_Cost_NOx_atm_e[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 0.43 # $/kgN visibility damages
# COST1$N_Cost_NH3_atm_e[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * 0.43 # $/kgN visibility damages
# COST1$N_Cost_N2O_atm_c[COST1$Sub_category == 'Fertilizer' ] = N_Fert_N2O_c * 15.07 # $/kgN Greenhouse damages
# COST1$N_Cost_NOx_atm_c[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * (-5.02) # $/kgN Climate Cooling Benefits
# COST1$N_Cost_NH3_atm_c[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * (-5.02) # $/kgN Climate Cooling Benefits
# COST1$N_Cost_NOx_ter_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 0.12 # $/kgN Damages to structures
# COST1$N_Cost_NH3_ter_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * 0.12 # $/kgN Damages to structures
# COST1$N_Cost_NOx_ter_a[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 2.11 # $/kgN Ozone damages to crops
# COST1$N_Cost_N2O_ter_a[COST1$Sub_category == 'Fertilizer' ] = N_Fert_N2O_c * 1.48 # $/kgN UV damages to crops
# COST1$N_Cost_NOx_ter_e[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 1.24 # $/kgN Ozone damages to forests
# 
# COST2$N_Cost_NOx_atm_h = 1000*COST2$NOx_MTN * 32.20 # $/kgN Human respiratory health
# COST2$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health (zero unless fertilzer - see below)
# COST2$N_Cost_NOx_atm_e = 1000*COST2$NOx_MTN * 0.43 # $/kgN visibility damages
# COST2$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages (zero unless fertilzer - see below)
# COST2$N_Cost_N2O_atm_c = 1000*COST2$N2O_MTN * 15.07 # $/kgN Greenhouse damages
# COST2$N_Cost_NOx_atm_c = 1000*COST2$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits
# COST2$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits (zero unless fertilzer - see below)
# COST2$N_Cost_NOx_ter_h = 1000*COST2$NOx_MTN * 0.12 # $/kgN Damages to structures
# COST2$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures (zero unless fertilzer - see below)
# COST2$N_Cost_NOx_ter_a = 1000*COST2$NOx_MTN * 2.11 # $/kgN Ozone damages to crops
# COST2$N_Cost_N2O_ter_a = 1000*COST2$N2O_MTN * 1.48 # $/kgN UV damages to crops
# COST2$N_Cost_NOx_ter_e = 1000*COST2$NOx_MTN * 1.24 # $/kgN Ozone damages to forests
# 
# COST2$N_Cost_NOx_atm_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 32.20 # $/kgN Human respiratory health
# COST2$N_Cost_NH3_atm_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * 6.87 # $/kgN Human respiratory health
# COST2$N_Cost_NOx_atm_e[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 0.43 # $/kgN visibility damages
# COST2$N_Cost_NH3_atm_e[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * 0.43 # $/kgN visibility damages
# COST2$N_Cost_N2O_atm_c[COST2$Sub_category == 'Fertilizer' ] = N_Fert_N2O_p * 15.07 # $/kgN Greenhouse damages
# COST2$N_Cost_NOx_atm_c[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * (-5.02) # $/kgN Climate Cooling Benefits
# COST2$N_Cost_NH3_atm_c[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * (-5.02) # $/kgN Climate Cooling Benefits
# COST2$N_Cost_NOx_ter_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 0.12 # $/kgN Damages to structures
# COST2$N_Cost_NH3_ter_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * 0.12 # $/kgN Damages to structures
# COST2$N_Cost_NOx_ter_a[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 2.11 # $/kgN Ozone damages to crops
# COST2$N_Cost_N2O_ter_a[COST2$Sub_category == 'Fertilizer' ] = N_Fert_N2O_p * 1.48 # $/kgN UV damages to crops
# COST2$N_Cost_NOx_ter_e[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 1.24 # $/kgN Ozone damages to forests
# 
# COST = rbind(COST1,COST2)
# 
# COST$N_SW_kg = 0.21 * 1000*(rowSums(COST[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # all N sources (not N2O), # proportion that goes to SW (Houlton et al. 2013)
# COST$N_GW_kg = 0.79 * .33 * 1000*(rowSums(COST[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # proportion that goes to GW (Sabota et al. 2015)
# COST$N_coast_kg = .40 * COST$N_SW_kg # proportion of SW that goes to coast (Sabota et al. 2015)
# 
# COST1 = COST[COST$Timeframe == 'Baseline',]
# COST2 = COST[COST$Timeframe == 'Projected',]
# 
# COST1$N_SW_kg[COST1$Sub_category == 'Fertilizer' ] = N_Fert_SW_c
# COST1$N_GW_kg[COST1$Sub_category == 'Fertilizer' ] = N_Fert_GW_c
# COST1$N_coast_kg[COST1$Sub_category == 'Fertilizer' ] = N_Fert_coast_c
# COST2$N_SW_kg[COST2$Sub_category == 'Fertilizer' ] = N_Fert_SW_p
# COST2$N_GW_kg[COST2$Sub_category == 'Fertilizer' ] = N_Fert_GW_p
# COST2$N_coast_kg[COST2$Sub_category == 'Fertilizer' ] = N_Fert_coast_p
# 
# COST = rbind(COST1,COST2)
# 
# # Update below
# COST$N_Cost_aquaFresh_e =
#   COST$N_SW_kg * 0.23 + # $/kgN Lake waterfront property values
#   COST$N_SW_kg * 0.19 + # $/kgN Recreational Freshwater use
#   COST$N_SW_kg * 0.01 # $/kgN Endangered species protection
# COST$N_Cost_aquaGround_h =
#   COST$N_GW_kg * 0.15 + # $/kgN Replacement with bottled water
#   COST$N_GW_kg * 0.60 # $/kgN Treatment of private well water
# COST$N_Cost_aquaCoast_e =
#   COST$N_coast_kg * 7.11 # $/kgN Recreational use of estuary
# 
# 
# # No NH3 emissions factor data for Commuting
# COMMUT$N_Cost_NOx_atm_h = 1000*COMMUT$NOx_MTN * 32.20 # $/kgN Human respiratory health
# COMMUT$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health
# COMMUT$N_Cost_NOx_atm_e = 1000*COMMUT$NOx_MTN * 0.43 # $/kgN visibility damages
# COMMUT$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages
# COMMUT$N_Cost_N2O_atm_c = 1000*COMMUT$N2O_MTN * 15.07 # $/kgN Greenhouse damages
# COMMUT$N_Cost_NOx_atm_c = 1000*COMMUT$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits
# COMMUT$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits
# COMMUT$N_Cost_NOx_ter_h = 1000*COMMUT$NOx_MTN * 0.12 # $/kgN Damages to structures
# COMMUT$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures
# COMMUT$N_Cost_NOx_ter_a = 1000*COMMUT$NOx_MTN * 2.11 # $/kgN Ozone damages to crops
# COMMUT$N_Cost_N2O_ter_a = 1000*COMMUT$N2O_MTN * 1.48 # $/kgN UV damages to crops
# COMMUT$N_Cost_NOx_ter_e = 1000*COMMUT$NOx_MTN * 1.24 # $/kgN Ozone damages to forests
# 
# # No NH3 emissions factor data for Energy sources
# ENERGY$N_Cost_NOx_atm_h = 1000*ENERGY$NOx_MTN * 32.20 # $/kgN Human respiratory health
# ENERGY$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health
# ENERGY$N_Cost_NOx_atm_e = 1000*ENERGY$NOx_MTN * 0.43 # $/kgN visibility damages
# ENERGY$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages
# ENERGY$N_Cost_N2O_atm_c = 1000*ENERGY$N2O_MTN * 15.07 # $/kgN Greenhouse damages
# ENERGY$N_Cost_NOx_atm_c = 1000*ENERGY$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits
# ENERGY$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits
# ENERGY$N_Cost_NOx_ter_h = 1000*ENERGY$NOx_MTN * 0.12 # $/kgN Damages to structures
# ENERGY$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures
# ENERGY$N_Cost_NOx_ter_a = 1000*ENERGY$NOx_MTN * 2.11 # $/kgN Ozone damages to crops
# ENERGY$N_Cost_N2O_ter_a = 1000*ENERGY$N2O_MTN * 1.48 # $/kgN UV damages to crops
# ENERGY$N_Cost_NOx_ter_e = 1000*ENERGY$NOx_MTN * 1.24 # $/kgN Ozone damages to forests
# 
# COMMUT$N_SW_kg = 0.21 * 1000*(rowSums(COMMUT[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # all N sources (not N2O), # proportion that goes to SW (Houlton et al. 2013)
# COMMUT$N_GW_kg = 0.79 * .33 *  1000*(rowSums(COMMUT[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # proportion that goes to GW (Sabota et al. 2015)
# COMMUT$N_coast_kg = 0.40 * COMMUT$N_SW_kg # proportion of SW that goes to coast (Sabota et al. 2015)
# 
# ENERGY$N_SW_kg = 0.21 * 1000*(rowSums(ENERGY[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # all N sources (not N2O),  # proportion that goes to SW (Houlton et al. 2013)
# ENERGY$N_GW_kg = 0.79 * .33 *  1000*(rowSums(ENERGY[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # proportion that goes to GW (Sabota et al. 2015)
# ENERGY$N_coast_kg = 0.40 * ENERGY$N_SW_kg # proportion of SW that goes to coast (Sabota et al. 2015)
# 
# COMMUT$N_Cost_aquaFresh_e =
#   COMMUT$N_SW_kg * 0.23 + # $/kgN Lake waterfront property values
#   COMMUT$N_SW_kg * 0.19 + # $/kgN Recreational Freshwater use
#   COMMUT$N_SW_kg * 0.01 # $/kgN Endangered species protection
# COMMUT$N_Cost_aquaGround_h =
#   COMMUT$N_GW_kg * 0.15 + # $/kgN Replacement with bottled water
#   COMMUT$N_GW_kg * 0.60 # $/kgN Treatment of private well water
# COMMUT$N_Cost_aquaCoast_e =
#   COMMUT$N_coast_kg * 7.11 # $/kgN Recreational use of estuary
# 
# ENERGY$N_Cost_aquaFresh_e =
#   ENERGY$N_SW_kg * 0.23 + # $/kgN Lake waterfront property values
#   ENERGY$N_SW_kg * 0.19 + # $/kgN Recreational Freshwater use
#   ENERGY$N_SW_kg * 0.01 # $/kgN Endangered species protection
# ENERGY$N_Cost_aquaGround_h =
#   ENERGY$N_GW_kg * 0.15 + # $/kgN Replacement with bottled water
#   ENERGY$N_GW_kg * 0.60 # $/kgN Treatment of private well water
# ENERGY$N_Cost_aquaCoast_e =
#   ENERGY$N_coast_kg * 7.11 # $/kgN Recreational use of estuary
# 
# COST$N_Cost_Total =
#   rowSums(COST[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h',
#                   'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
#                   'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c',
#                   'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h',
#                   'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
#                   'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e',
#                   'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h',
#                   'N_Cost_aquaCoast_e')], na.rm=T)
# 
# COMMUT$N_Cost_Total =
#   rowSums(COMMUT[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h',
#                     'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
#                     'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c',
#                     'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h',
#                     'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
#                     'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e',
#                     'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h',
#                     'N_Cost_aquaCoast_e')], na.rm=T)
# 
# ENERGY$N_Cost_Total =
#   rowSums(ENERGY[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h',
#                     'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
#                     'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c',
#                     'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h',
#                     'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
#                     'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e',
#                     'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h',
#                     'N_Cost_aquaCoast_e')], na.rm=T)
# 
# # Add back on COMMUTING AND ENERGY
# COST = rbind(COST,COMMUT,ENERGY)
# 
# COST_R = COST
# 
# #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# # FOOD COSTS
# #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# FOOD = FOOD_R
# 
# # C Costs
# # Jana Compton: For Carbon costs, we recommend using $2-$50 per ton of CO2 equivalent
# # That covers the range we are using in our paper.
# # Units of C_Footprint are MT for COST and kg for food data
# FOOD$C_Cost_min = 2*FOOD$C_Footprint/1000 # Initial Units are kg
# FOOD$C_Cost_max = 50*FOOD$C_Footprint/1000 # Initial Units are kg
# FOOD$C_Cost_mid = 30*FOOD$C_Footprint/1000 # Initial Units are kg
# 
# # N Costs
# #Food footprint is in kg N
# FOOD$N_NOx = FOOD$N_virtual* 0.20 # Virtual N Emission conribution
# FOOD$N_N2O = FOOD$N_virtual * 0.03 # Virtual N Emission conribution
# FOOD$N_NH3 = FOOD$N_virtual * 0.13 # Virtual N Emission conribution
# FOOD$N_SW = FOOD$N_virtual * 0.21 # Virtual N to water (Houlton et al. 2013)
# FOOD$N_GW = FOOD$N_virtual * .79 * .33 # N to groundwater (Sabota et al. 2015)
# FOOD$N_Coast = FOOD$N_SW * .40 # N to coast water (Sabota et al. 2015)
# 
# FOOD$N_Cost_NOx_atm_h = FOOD$N_NOx * 32.20 # $/kgN Human respiratory health
# FOOD$N_Cost_NH3_atm_h = FOOD$N_NH3 * 6.87 # $/kgN Human respiratory health
# FOOD$N_Cost_NOx_atm_e = FOOD$N_NOx * 0.43 # $/kgN visibility damages
# FOOD$N_Cost_NH3_atm_e = FOOD$N_NH3 * 0.43 # $/kgN visibility damages
# FOOD$N_Cost_N2O_atm_c = FOOD$N_N2O * 15.07 # $/kgN Greenhouse damages
# FOOD$N_Cost_NOx_atm_c = FOOD$N_NOx * (-5.02) # $/kgN Climate Cooling Benefits
# FOOD$N_Cost_NH3_atm_c = FOOD$N_NH3 * (-5.02) # $/kgN Climate Cooling Benefits
# FOOD$N_Cost_NOx_ter_h = FOOD$N_NOx * 0.12 # $/kgN Damages to structures
# FOOD$N_Cost_NH3_ter_h = FOOD$N_NH3 * 0.12 # $/kgN Damages to structures
# FOOD$N_Cost_NOx_ter_a = FOOD$N_NOx * 2.11 # $/kgN Ozone damages to crops
# FOOD$N_Cost_N2O_ter_a = FOOD$N_N2O * 1.48 # $/kgN UV damages to crops
# FOOD$N_Cost_NOx_ter_e = FOOD$N_NOx * 1.24 # $/kgN Ozone damages to forests
# 
# FOOD$N_Cost_aquaFresh_e =
#   FOOD$N_SW * 0.23 + # $/kgN Lake waterfront property values
#   FOOD$N_SW * 0.19 + # $/kgN Recreational Freshwater use
#   FOOD$N_SW * 0.01 # $/kgN Endangered species protection
# FOOD$N_Cost_aquaGround_h =
#   FOOD$N_GW * 0.15 + # $/kgN Replacement with bottled water
#   FOOD$N_GW * 0.60 # $/kgN Treatment of private well water
# FOOD$N_Cost_aquaCoast_e =
#   FOOD$N_Coast * 7.11 # $/kgN Recreational use of estuary
# 
# FOOD$N_Cost_water =  FOOD$N_Cost_aquaFresh_e + FOOD$N_Cost_aquaGround_h + FOOD$N_Cost_aquaCoast_e
# 
# FOOD$N_Cost_virtual =  # = Food Production Value, previously labeled as N_Cost_Total
#   rowSums(FOOD[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h',
#                   'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
#                   'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c',
#                   'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h',
#                   'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
#                   'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e',
#                   'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h',
#                   'N_Cost_aquaCoast_e')], na.rm=T)
# 
# 
# FOOD_COST_R = FOOD

#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# STEP_4 End >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

#test = TABLE_R[TABLE_R$Source == 'Purchased Electricity',]
#test = COMBO_R_[COMBO_R_$Source == 'Purchased Electricity',]
#test = COMBO_R[COMBO_R$Category == 'Purchased Electricity',]

#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# Business as Usual (BAU) HARDCODED VALUES 
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

uva_R = uva

# "Business as Usual Growth to 2025"

names(food)[which(colnames(food)=="UVA_inventory")] = "inventory"
names(food)[which(colnames(food)=="Food_category")] = "Category"

food$Color_codes = str_remove(food$Color_codes, '#')
food$Color_codes = as.character(paste0('#',food$Color_codes))

food1 = food
food2 = food

# Add Projected category
food1$Timeframe = 'Baseline'
food2$Timeframe = 'Projected'

# Get base value for reactive Projected
f1 = food2[food2$Category == 'Spices',]$inventory
f2 = food2[food2$Category == 'Sugars',]$inventory
f3 = food2[food2$Category == 'Oils',]$inventory
f4 = food2[food2$Category == 'Coffee and tea',]$inventory
f5 = food2[food2$Category == 'Liquids',]$inventory
f6 = food2[food2$Category == 'Nuts',]$inventory
f7 = food2[food2$Category == 'Beans',]$inventory
f8 = food2[food2$Category == 'Potatoes',]$inventory
f9 = food2[food2$Category == 'Fruits',]$inventory
f10 = food2[food2$Category == 'Vegetables',]$inventory
f11 = food2[food2$Category == 'Grains',]$inventory
f12 = food2[food2$Category == 'Eggs',]$inventory
f13 = food2[food2$Category == 'Cheese',]$inventory
f14 = food2[food2$Category == 'Milk',]$inventory
f15 = food2[food2$Category == 'Fish',]$inventory
f16 = food2[food2$Category == 'Chicken',]$inventory
f17 = food2[food2$Category == 'Pork',]$inventory
f18 = food2[food2$Category == 'Beef',]$inventory

# Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
food2[food2$Category == 'Spices',]$inventory = f1* 18*.01+f1
food2[food2$Category == 'Sugars',]$inventory = f2* 18*.01+f2
food2[food2$Category == 'Oils',]$inventory = f3* 18*.01+f3
food2[food2$Category == 'Coffee and tea',]$inventory = f4* 18*.01+f4
food2[food2$Category == 'Liquids',]$inventory = f5* 18*.01+f5
food2[food2$Category == 'Nuts',]$inventory = f6* 18*.01+f6
food2[food2$Category == 'Beans',]$inventory = f7* 18*.01+f7
food2[food2$Category == 'Potatoes',]$inventory = f8* 18*.01+f8
food2[food2$Category == 'Fruits',]$inventory = f9* 18*.01+f9
food2[food2$Category == 'Vegetables',]$inventory = f10* 18*.01+f10
food2[food2$Category == 'Grains',]$inventory = f11* 18*.01+f11
food2[food2$Category == 'Eggs',]$inventory = f12* 18*.01+f12
food2[food2$Category == 'Cheese',]$inventory = f13* 18*.01+f13
food2[food2$Category == 'Milk',]$inventory = f14* 18*.01+f14
food2[food2$Category == 'Fish',]$inventory = f15* 18*.01+f15
food2[food2$Category == 'Chicken',]$inventory = f16* 18*.01+f16
food2[food2$Category == 'Pork',]$inventory = f17* 18*.01+f17
food2[food2$Category == 'Beef',]$inventory = f18* 18*.01+f18

FOOD = rbind(food1,food2)

# Calculuations
# Result units = kg eCO2
# Carbon Footprint: (inventory unit e.g. kg) * (kg eCO2 / kg food)
FOOD$C_Footprint = FOOD$inventory * FOOD$C_footprint_food

# Result units = kg N
# N food supply: (inventory unit e.g. kg) * N Conent is unitless?
FOOD$N_food_supply = FOOD$inventory * FOOD$N_Content

# Result units = kg N
# Waste N:  Food_waste (Unitless - %) * (kg N)
FOOD$N_waste = FOOD$Food_waste * FOOD$N_food_supply

# Result units = kg N
# Inventory unit (kg N) * (kg N loss / kg N food)
FOOD$N_virtual = FOOD$N_food_supply * FOOD$Conventional_virtual_N_factor

# N Footprint
# Result units = kg N
FOOD$N_Footprint = FOOD$N_waste + FOOD$N_virtual

# P Footprint
# Result units = kg P
FOOD$P_Footprint = FOOD$inventory * FOOD$P_footprint_food

# W Footprint
# Result units = gallons water (264.172 gal/m3 * kg inventory * m3 water / MT food * 1 MT/1000 kg)
FOOD$Blue_W_Footprint = 264.172*FOOD$inventory * FOOD$Blue_W_Footprint_food / 1000
FOOD$Green_W_Footprint = 264.172*FOOD$inventory * FOOD$Green_W_Footprint_food / 1000
FOOD$Grey_W_Footprint = 264.172*FOOD$inventory * FOOD$Grey_W_Footprint_food / 1000

#food$Total_W_Footprint = food$Green_W_Footprint + food$Blue_W_Footprint + food$Grey_W_Footprint
FOOD$B_Footprint = FOOD$Blue_W_Footprint
FOOD$G_Footprint = FOOD$Green_W_Footprint
FOOD$BG_Footprint = FOOD$Green_W_Footprint + FOOD$Blue_W_Footprint

# Convert values with na to zero
FOOD[is.na(FOOD)] <- 0

FOOD_R_BAU = FOOD

#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# BAU Carbon
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

# Projected 1 (each variable changes differently)
sectr1 = 'Purchased Electricity'
sectr2 = 'Food'
sectr3 = 'On-Campus Stationary Sources'
sectr4 = 'Direct Transportation Sources'
sectr5 = 'Commuting'
sectr6 = 'Agriculture Sources'
sectr7 = 'Refrigerants & Chemicals'
sectr8 = 'Wastewater'
sectr9 = 'Direct Water Use'

uva1 = uva_R
uva2 = uva_R

# Add Projected category
uva1$Timeframe = 'Baseline'
uva2$Timeframe = 'Projected'

# This reactive part is for all categories except Energy, Commuting, and Food
# Gives the baseline value
b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
#b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory

# Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = b1 * 22*.01+b1
uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = b2 * 12*.01+b2
uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = b3 * 12*.01+b3
uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = b4 * 12*.01+b4
uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = b5 * 12*.01+b5
uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = b6 * 0*.01+b6
uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = b7 * 0*.01+b7
uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = b8 * 0*.01+b8
uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = b9 * 0*.01+b9
uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = b10 * 0*.01+b10
uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = b11 * 19*.01+b11
# uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory = b12 * 0*.01+b12


COMBO = rbind(uva1,uva2)

# sum(COMBO[COMBO$Category == 'Commuting' & COMBO$Timeframe == 'Baseline',]$inventory)

#CARBON_____________________________________________________________________
# Result units = kg CO2
# Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
COMBO$CO2_r = COMBO$inventory * COMBO$CO2.EF

# Result units = kg eCO2
# Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
COMBO$eCO2_r = COMBO$inventory * COMBO$eCO2.EF

# Result units = kg CH4
# Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
COMBO$CH4_r = COMBO$inventory * COMBO$CH4.EF

#NITROGEN_____________________________________________________________________
# Result units = kg N20
# Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
COMBO$N2O_r = COMBO$inventory * COMBO$N2O.EF

# Result units = kg NOx
# Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
COMBO$NOx_r = COMBO$inventory * COMBO$NOx.EF

# Result units = kg N20
# Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
COMBO$OtherN_r = COMBO$inventory * COMBO$Other.N.EF

#INTERMEDIATE C & N _______________________________________________________________

# calculate Footprints by category (divide by 1000 to convert from kg to MT)
# Units of GWP 
COMBO$CO2_MTCDE = COMBO$CO2_r/1000  # MT CO2e
COMBO$eCO2_MTCDE = COMBO$eCO2_r/1000 # MT CO2e
COMBO$CH4_MTCDE = COMBO$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
COMBO$N2O_MTCDE = COMBO$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e

# Calculations only for refrigerants and chemicals for Carbon
# inventory (kg) * GWP (Unitless??) / 1000 = MT CO2e
COMBO$Ref_Chem[COMBO$Source=='HCFC-22'] = COMBO[COMBO$Source=='HCFC-22',]$inventory * gwp[gwp$Pollutant=='HCFC-22',]$GWP/1000 # MT CO2e
COMBO$Ref_Chem[COMBO$Source=='HCFE-235da2'] = COMBO[COMBO$Source=='HCFE-235da2',]$inventory * gwp[gwp$Pollutant=='HCFE-235da2',]$GWP/1000 # MT CO2e
COMBO$Ref_Chem[COMBO$Source=='HFC-134a'] = COMBO[COMBO$Source=='HFC-134a',]$inventory * gwp[gwp$Pollutant=='HFC-134a',]$GWP/1000 # MT CO2e
COMBO$Ref_Chem[COMBO$Source=='HG-10'] = COMBO[COMBO$Source=='HG-10',]$inventory * gwp[gwp$Pollutant=='HG-10',]$GWP/1000 # MT CO2e
#COMBO$Ref_Chem[COMBO$Source=='Other'] = COMBO[COMBO$Source=='Other',]$inventory * gwp[gwp$Pollutant=='Other',]$GWP/1000 # MT CO2e
COMBO$Ref_Chem[COMBO$Source=='R-404a'] = COMBO[COMBO$Source=='R-404a',]$inventory * gwp[gwp$Pollutant=='R-404a',]$GWP/1000 # MT CO2e


#*****************************************************************************************************
# FOOTPRINT Calculations
#*****************************************************************************************************

# CALCULATING FOOTPRINT C_____________________________________________________________________
# Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
COMBO$C_Footprint = rowSums(COMBO[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE','Ref_Chem')],na.rm=T) 
# COMBO[COMBO$Source == 'Purchased Electricity' & COMBO$Timeframe == 'Baseline',]$C_Footprint
# COMBO[COMBO$Source == 'Purchased Electricity' & COMBO$Timeframe == 'Projected',]$C_Footprint

#*****************************************************************************************************
# FOOTPRINT DATA OUTPUT
#*****************************************************************************************************

# Summarize by Category___________________________________________________________________________
# Units are MT C, MT N, MT P, Gallons Water 

COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
  group_by(Category) %>% 
  summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T))
COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
  group_by(Category) %>% 
  summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T)) 

COMBO1$Timeframe = 'Baseline'
COMBO2$Timeframe = 'Projected'

#*****************************************************************************************************
# ADD FOOD ONTO FOOTPRINT Calculations
#*****************************************************************************************************

# Calculate total food footprints (original units = kg for C,N,P or gal for water)
# final units = MT (Metric Tons)

# food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
# food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
food1_ = FOOD_R_BAU[FOOD_R_BAU$Timeframe == 'Baseline',]
food2_ = FOOD_R_BAU[FOOD_R_BAU$Timeframe == 'Projected',]

C_food_footprint1 = sum(food1_$C_footprint,na.rm=T)/1000 # convert to MT from kg
C_food_footprint2 = sum(food2_$C_footprint,na.rm=T)/1000 # convert to MT from kg

#Make a new 1 row dataframe 
C_food_rw1 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint1)
C_food_rw2 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint2)

C_food_rw1$Timeframe = 'Baseline'
C_food_rw2$Timeframe = 'Projected'

# add on the food row
COMBO_foot1 = rbind(COMBO1,C_food_rw1)
COMBO_foot2 = rbind(COMBO2,C_food_rw2)

COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)

# Rearrange the rows to match the slider rows
Carbon_R_BAU = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                     COMBO_foot[COMBO_foot$Category=='Food',],
                     COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                     COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                     COMBO_foot[COMBO_foot$Category=='Commuting',],
                     #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                     COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                     COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                     COMBO_foot[COMBO_foot$Category=='Wastewater',],
                     COMBO_foot[COMBO_foot$Category=='Direct Water Use',])

#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# BAU Nitrogen
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

# Projected 1 (each variable changes differently)
sectr1 = 'Purchased Electricity'
sectr2 = 'Food'
sectr3 = 'On-Campus Stationary Sources'
sectr4 = 'Direct Transportation Sources'
sectr5 = 'Commuting'
sectr6 = 'Agriculture Sources'
sectr7 = 'Refrigerants & Chemicals'
sectr8 = 'Wastewater'
sectr9 = 'Direct Water Use'

uva1 = uva_R
uva2 = uva_R

# Add Projected category
uva1$Timeframe = 'Baseline'
uva2$Timeframe = 'Projected'

# This reactive part is for all categories except Energy, Commuting, and Food
# Gives the baseline/Baseline value
b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
#b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory

# Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = b1 * 22*.01+b1
uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = b2 * 12*.01+b2
uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = b3 * 12*.01+b3
uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = b4 * 12*.01+b4
uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = b5 * 12*.01+b5
uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = b6 * 0*.01+b6
uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = b7 * 0*.01+b7
uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = b8 * 0*.01+b8
uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = b9 * 0*.01+b9
uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = b10 * 0*.01+b10
uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = b11 * 19*.01+b11
# uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory = b12 * 0*.01+b12


COMBO = rbind(uva1,uva2)


#NITROGEN_____________________________________________________________________
# Result units = kg N20
# Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
COMBO$N2O_r = COMBO$inventory * COMBO$N2O.EF

# Result units = kg NOx
# Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
COMBO$NOx_r = COMBO$inventory * COMBO$NOx.EF

# Result units = kg N20
# Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
COMBO$OtherN_r = COMBO$inventory * COMBO$Other.N.EF

#INTERMEDIATE N _______________________________________________________________

# intermediate N
COMBO$N2O_MTN = COMBO$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
COMBO$NOx_MTN = COMBO$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
COMBO$OtherN_MTN = COMBO$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N

#*****************************************************************************************************
# FOOTPRINT Calculations
#*****************************************************************************************************

# CALCULATING FOOTPRINT C & N_____________________________________________________________________
# Units N_Footprint = Metric Tons
COMBO$N_Footprint = rowSums(COMBO[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 

#*****************************************************************************************************
# FOOTPRINT DATA OUTPUT
#*****************************************************************************************************

# Summarize by Category___________________________________________________________________________
# Units are MT C, MT N, MT P, Gallons Water 

COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
  group_by(Category) %>% 
  summarize(Total_N_Footprint = sum(N_Footprint,na.rm=T))
COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
  group_by(Category) %>% 
  summarize(Total_N_Footprint = sum(N_Footprint,na.rm=T)) 

COMBO1$Timeframe = 'Baseline'
COMBO2$Timeframe = 'Projected'


#*****************************************************************************************************
# ADD FOOD ONTO FOOTPRINT Calculations
#*****************************************************************************************************

# Calculate total food footprints (original units = kg for C,N,P or gal for water)
# final units = MT (Metric Tons)

# food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
# food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
food1_ = FOOD_R_BAU[FOOD_R_BAU$Timeframe == 'Baseline',]
food2_ = FOOD_R_BAU[FOOD_R_BAU$Timeframe == 'Projected',]


N_food_footprint1 = sum(food1_$N_footprint,na.rm=T)/1000
N_food_footprint2 = sum(food2_$N_footprint,na.rm=T)/1000

#Make a new 1 row dataframe 
N_food_rw1 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint1)
N_food_rw2 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint2)

N_food_rw1$Timeframe = 'Baseline'
N_food_rw2$Timeframe = 'Projected'

# add on the food row
COMBO_foot1 = rbind(COMBO1,N_food_rw1)
COMBO_foot2 = rbind(COMBO2,N_food_rw2)

COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)

# Rearrange the rows to match the slider rows
Nitrogen_R_BAU = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                       COMBO_foot[COMBO_foot$Category=='Food',],
                       COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                       COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                       COMBO_foot[COMBO_foot$Category=='Commuting',],
                       #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                       COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                       COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                       COMBO_foot[COMBO_foot$Category=='Wastewater',],
                       COMBO_foot[COMBO_foot$Category=='Direct Water Use',])

#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# BAU Phosphorus
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# Projected 1 (each variable changes differently)
sectr1 = 'Purchased Electricity'
sectr2 = 'Food'
sectr3 = 'On-Campus Stationary Sources'
sectr4 = 'Direct Transportation Sources'
sectr5 = 'Commuting'
sectr6 = 'Agriculture Sources'
sectr7 = 'Refrigerants & Chemicals'
sectr8 = 'Wastewater'
sectr9 = 'Direct Water Use'

uva1 = uva_R
uva2 = uva_R

# Add Projected category
uva1$Timeframe = 'Baseline'
uva2$Timeframe = 'Projected'

# This reactive part is for all categories except Energy, Commuting, and Food
# Gives the baseline value
b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
#b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory

# Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
  b1 * 22*.01+b1
uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
  b2 * 12*.01+b2
uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
  b3 * 12*.01+b3
uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
  b4 * 12*.01+b4
uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
  b5 * 12*.01+b5
uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
  b6 * 0*.01+b6
uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
  b7 * 0*.01+b7
uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
  b8 * 0*.01+b8
uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
  b9 * 0*.01+b9
uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
  b10 * 0*.01+b10
uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
  b11 * 19*.01+b11
# uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory = 
#   b12 * 0*.01+b12

COMBO = rbind(uva1,uva2)

#*****************************************************************************************************
# FOOTPRINT Calculations
#*****************************************************************************************************

#PHOSPHORUS FOOTPRINT_____________________________________________________________________

# Result units = MT of P
# Inventory unit (e.g. US gallon) * kg P / inventory unit
COMBO$P_Footprint = COMBO$inventory * COMBO$P.EF /1000  # Divide by 1000 to get metric tons

#*****************************************************************************************************
# FOOTPRINT DATA OUTPUT
#*****************************************************************************************************

# Summarize by Category___________________________________________________________________________
# Units are MT P

COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
  group_by(Category) %>% 
  summarize(Total_P_Footprint = sum(P_Footprint,na.rm=T))
COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
  group_by(Category) %>% 
  summarize(Total_P_Footprint = sum(P_Footprint,na.rm=T)) 

COMBO1$Timeframe = 'Baseline'
COMBO2$Timeframe = 'Projected'

#*****************************************************************************************************
# ADD FOOD ONTO FOOTPRINT Calculations
#*****************************************************************************************************

# Calculate total food footprints (original units = kg for C,N,P or gal for water)
# final units = MT (Metric Tons)

# food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
# food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
food1_ = FOOD_R_BAU[FOOD_R_BAU$Timeframe == 'Baseline',]
food2_ = FOOD_R_BAU[FOOD_R_BAU$Timeframe == 'Projected',]

P_food_footprint1 = sum(food1_$P_footprint,na.rm=T)/1000
P_food_footprint2 = sum(food2_$P_footprint,na.rm=T)/1000

#Make a new 1 row dataframe 
P_food_rw1 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint1)
P_food_rw2 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint2)

P_food_rw1$Timeframe = 'Baseline'
P_food_rw2$Timeframe = 'Projected'

# add on the food row
COMBO_foot1 = rbind(COMBO1,P_food_rw1)
COMBO_foot2 = rbind(COMBO2,P_food_rw2)

COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)

# Rearrange the rows to match the slider rows
Phosphorus_R_BAU = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                         COMBO_foot[COMBO_foot$Category=='Food',],
                         COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                         COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                         COMBO_foot[COMBO_foot$Category=='Commuting',],
                         #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                         COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                         COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                         COMBO_foot[COMBO_foot$Category=='Wastewater',],
                         COMBO_foot[COMBO_foot$Category=='Direct Water Use',])


#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# BAU Water
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# Projected 1 (each variable changes differently)
sectr1 = 'Purchased Electricity'
sectr2 = 'Food'
sectr3 = 'On-Campus Stationary Sources'
sectr4 = 'Direct Transportation Sources'
sectr5 = 'Commuting'
sectr6 = 'Agriculture Sources'
sectr7 = 'Refrigerants & Chemicals'
sectr8 = 'Wastewater'
sectr9 = 'Direct Water Use'

uva1 = uva_R
uva2 = uva_R

# Add Projected category
uva1$Timeframe = 'Baseline'
uva2$Timeframe = 'Projected'

# This reactive part is for all categories except Energy, Commuting, and Food
# Gives the baseline value
b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory

# Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
  b1 * 22*.01+b1
uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
  b2 * 12*.01+b2
uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
  b3 * 12*.01+b3
uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
  b4 * 12*.01+b4
uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
  b5 * 12*.01+b5
uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
  b6 * 0*.01+b6
uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
  b7 * 0*.01+b7
uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
  b8 * 0*.01+b8
uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
  b9 * 0*.01+b9
uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
  b10 * 0*.01+b10
uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
  b11 * 19*.01+b11
uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory =
  b12 * 0*.01+b12

COMBO = rbind(uva1,uva2)

#*****************************************************************************************************
# FOOTPRINT Calculations
#*****************************************************************************************************

#WATER FOOTPRINT ________________________________________________________________

# Result units = gallons
# Inventory unit (e.g. US gallon) * (gal water / inventory unit) 
COMBO$W_Footprint1 = COMBO$inventory * COMBO$Water.EF #* 0.00378541178 us this if convert to m3


for (i in 1:nrow(COMBO)){
  if(COMBO$Scope[i]=='Scope 1' &
     COMBO$Category[i]=='Direct Water Use' &
     COMBO$Sub_category[i]=='On-campus water consumption' &
     COMBO$Source[i]=='Direct Use') {
    COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * 1000000
  } else if(COMBO$Scope[i]=='Scope 2' &
            COMBO$Category[i]=='Purchased Electricity' &
            COMBO$Sub_category[i]=='Purchased Electricity' &
            COMBO$Source[i]=='Purchased Electricity'){
    COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * (10^(-12))*3600000/0.00378541178
  } else {
    COMBO$W_Footprint[i] = COMBO$W_Footprint1[i]
  }
}

#*****************************************************************************************************
# FOOTPRINT DATA OUTPUT
#*****************************************************************************************************

# Summarize by Category___________________________________________________________________________
# Units are MT C, MT N, MT P, Gallons Water 

COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
  group_by(Category) %>% 
  summarize(Total_W_Footprint = sum(W_Footprint,na.rm=T))
COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
  group_by(Category) %>% 
  summarize(Total_W_Footprint = sum(W_Footprint,na.rm=T)) 

COMBO1$Timeframe = 'Baseline'
COMBO2$Timeframe = 'Projected'

#*****************************************************************************************************
# ADD FOOD ONTO FOOTPRINT Calculations
#*****************************************************************************************************

# Calculate total food footprints (original units = kg for C,N,P or gal for water)
# final units = MT (Metric Tons)

# food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
# food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
food1_ = FOOD_R_BAU[FOOD_R_BAU$Timeframe == 'Baseline',]
food2_ = FOOD_R_BAU[FOOD_R_BAU$Timeframe == 'Projected',]

# Units for water = gallons
B_food_footprint1 = sum(food1_$B_footprint,na.rm=T)
B_food_footprint2 = sum(food2_$B_footprint,na.rm=T)
G_food_footprint1 = sum(food1_$G_footprint,na.rm=T)
G_food_footprint2 = sum(food2_$G_footprint,na.rm=T)
BG_food_footprint1 = sum(food1_$BG_footprint,na.rm=T)
BG_food_footprint2 = sum(food2_$BG_footprint,na.rm=T)

#Make a new 1 row dataframe 
B_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint1)
B_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint2)
G_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint1)
G_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint2)
BG_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint1)
BG_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint2)

W_food_rw1 = B_food_rw1
W_food_rw2 = B_food_rw2

W_food_rw1$Timeframe = 'Baseline'
W_food_rw2$Timeframe = 'Projected'

# add on the food row
COMBO_foot1 = rbind(COMBO1,W_food_rw1)
COMBO_foot2 = rbind(COMBO2,W_food_rw2)

COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)

# Rearrange the rows to match the slider rows
Water_R_BAU = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                    COMBO_foot[COMBO_foot$Category=='Food',],
                    COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                    COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                    COMBO_foot[COMBO_foot$Category=='Commuting',],
                    #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                    COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                    COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                    COMBO_foot[COMBO_foot$Category=='Wastewater',],
                    COMBO_foot[COMBO_foot$Category=='Direct Water Use',]) 

#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# BAU TABLE_R
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# Projected 1 (each variable changes differently)
sectr1 = 'Purchased Electricity'
sectr2 = 'Food'
sectr3 = 'On-Campus Stationary Sources'
sectr4 = 'Direct Transportation Sources'
sectr5 = 'Commuting'
sectr6 = 'Agriculture Sources'
sectr7 = 'Refrigerants & Chemicals'
sectr8 = 'Wastewater'
sectr9 = 'Direct Water Use'

uva1 = uva_R
uva2 = uva_R

# Add Projected category
uva1$Timeframe = 'Baseline'
uva2$Timeframe = 'Projected'
# Make sure they are same units before summarizing in next step

# This reactive part is for all categories except Energy, Commuting, and Food
# Gives the baseline value
b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory

# Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
  b1 * 22*.01+b1
uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
  b2 * 12*.01+b2
uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
  b3 * 12*.01+b3
uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
  b4 * 12*.01+b4
uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
  b5 * 12*.01+b5
uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
  b6 * 0*.01+b6
uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
  b7 * 0*.01+b7
uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
  b8 * 0*.01+b8
uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
  b9 * 0*.01+b9
uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
  b10 * 0*.01+b10
uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
  b11 * 19*.01+b11
uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory =
  b12 * 0*.01+b12

TABLE_R_BAU = rbind(uva1,uva2)  

#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# BAU COMBO_R_
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
COMBO = TABLE_R_BAU

#CARBON_____________________________________________________________________
# Result units = kg CO2
# Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
COMBO$CO2_r = COMBO$inventory * COMBO$CO2.EF

# Result units = kg eCO2
# Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
COMBO$eCO2_r = COMBO$inventory * COMBO$eCO2.EF

# Result units = kg CH4
# Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
COMBO$CH4_r = COMBO$inventory * COMBO$CH4.EF

#NITROGEN_____________________________________________________________________
# Result units = kg N20
# Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
COMBO$N2O_r = COMBO$inventory * COMBO$N2O.EF

# Result units = kg NOx
# Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
COMBO$NOx_r = COMBO$inventory * COMBO$NOx.EF

# Result units = kg N20
# Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
COMBO$OtherN_r = COMBO$inventory * COMBO$Other.N.EF

#INTERMEDIATE C & N _______________________________________________________________

# calculate Footprints by category (divide by 1000 to convert from kg to MT)
# Units of GWP 
COMBO$CO2_MTCDE = COMBO$CO2_r/1000  # MT CO2e
COMBO$eCO2_MTCDE = COMBO$eCO2_r/1000 # MT CO2e
COMBO$CH4_MTCDE = COMBO$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
COMBO$N2O_MTCDE = COMBO$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e

# Calculations only for refrigerants and chemicals for Carbon
# inventory (kg) * GWP (Unitless??) / 1000 = MT CO2e
COMBO$Ref_Chem[COMBO$Source=='HCFC-22'] = COMBO[COMBO$Source=='HCFC-22',]$inventory * gwp[gwp$Pollutant=='HCFC-22',]$GWP/1000 # MT CO2e
COMBO$Ref_Chem[COMBO$Source=='HCFE-235da2'] = COMBO[COMBO$Source=='HCFE-235da2',]$inventory * gwp[gwp$Pollutant=='HCFE-235da2',]$GWP/1000 # MT CO2e
COMBO$Ref_Chem[COMBO$Source=='HFC-134a'] = COMBO[COMBO$Source=='HFC-134a',]$inventory * gwp[gwp$Pollutant=='HFC-134a',]$GWP/1000 # MT CO2e
COMBO$Ref_Chem[COMBO$Source=='HG-10'] = COMBO[COMBO$Source=='HG-10',]$inventory * gwp[gwp$Pollutant=='HG-10',]$GWP/1000 # MT CO2e
#COMBO$Ref_Chem[COMBO$Source=='Other'] = COMBO[COMBO$Source=='Other',]$inventory * gwp[gwp$Pollutant=='Other',]$GWP/1000 # MT CO2e
COMBO$Ref_Chem[COMBO$Source=='R-404a'] = COMBO[COMBO$Source=='R-404a',]$inventory * gwp[gwp$Pollutant=='R-404a',]$GWP/1000 # MT CO2e

# intermediate N
COMBO$N2O_MTN = COMBO$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
COMBO$NOx_MTN = COMBO$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
COMBO$OtherN_MTN = COMBO$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N  

#*****************************************************************************************************
# FOOTPRINT Calculations
#*****************************************************************************************************

# CALCULATING FOOTPRINT C & N_____________________________________________________________________
# Units C_Footprint = Metric Tons, N_Footprint = Metric Tons

COMBO$C_Footprint = rowSums(COMBO[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE','Ref_Chem')],na.rm=T) 
COMBO$N_Footprint = rowSums(COMBO[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
#test = COMBO[COMBO$Source == 'Purchased Electricity',]

#PHOSPHORUS FOOTPRINT_____________________________________________________________________

# Result units = MT of P
# Inventory unit (e.g. US gallon) * kg P / inventory unit
COMBO$P_Footprint = COMBO$inventory * COMBO$P.EF /1000  # Divide by 1000 to get metric tons


#WATER FOOTPRINT ________________________________________________________________

# Result units = gallons
# Inventory unit (e.g. US gallon) * (gal water / inventory unit) 

COMBO$W_Footprint1 = COMBO$inventory * COMBO$Water.EF #* 0.00378541178 us this if convert to m3


for (i in 1:nrow(COMBO)){
  if(COMBO$Scope[i]=='Scope 1' & 
     COMBO$Category[i]=='Direct Water Use' & 
     COMBO$Sub_category[i]=='On-campus water consumption' & 
     COMBO$Source[i]=='Direct Use') {
    COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * 1000000
  } else if(COMBO$Scope[i]=='Scope 2' & 
            COMBO$Category[i]=='Purchased Electricity' &
            COMBO$Sub_category[i]=='Purchased Electricity' & 
            COMBO$Source[i]=='Purchased Electricity'){
    COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * (10^(-12))*3600000/0.00378541178
  } else {
    COMBO$W_Footprint[i] = COMBO$W_Footprint1[i]
  } 
}

COMBO_R_BAU_ = COMBO  # Units are MT for C, N, P, & gallons for Water  

#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# BAU COMBO_R
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
COMBO = COMBO_R_BAU_

# Summarize by Category___________________________________________________________________________
# Units are MT C, MT N, MT P, Gallons Water 

COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
  group_by(Category) %>% 
  summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
            Total_N_Footprint = sum(N_Footprint,na.rm=T),
            Total_P_Footprint = sum(P_Footprint,na.rm=T),
            Total_W_Footprint = sum(W_Footprint,na.rm=T))
COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
  group_by(Category) %>% 
  summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
            Total_N_Footprint = sum(N_Footprint,na.rm=T),
            Total_P_Footprint = sum(P_Footprint,na.rm=T),
            Total_W_Footprint = sum(W_Footprint,na.rm=T)) 

COMBO1$Timeframe = 'Baseline'
COMBO2$Timeframe = 'Projected'


#*****************************************************************************************************
# ADD FOOD ONTO FOOTPRINT Calculations
#*****************************************************************************************************

# Calculate total food footprints (original units = kg for C,N,P or gal for water)
# final units = MT (Metric Tons)

# food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
# food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
food1_ = FOOD_R_BAU[FOOD_R_BAU$Timeframe == 'Baseline',]
food2_ = FOOD_R_BAU[FOOD_R_BAU$Timeframe == 'Projected',]

C_food_footprint1 = sum(food1_$C_footprint,na.rm=T)/1000
N_food_footprint1 = sum(food1_$N_footprint,na.rm=T)/1000
P_food_footprint1 = sum(food1_$P_footprint,na.rm=T)/1000
C_food_footprint2 = sum(food2_$C_footprint,na.rm=T)/1000
N_food_footprint2 = sum(food2_$N_footprint,na.rm=T)/1000
P_food_footprint2 = sum(food2_$P_footprint,na.rm=T)/1000

# Units for water = gallons
B_food_footprint1 = sum(food1_$B_footprint,na.rm=T)
G_food_footprint1 = sum(food1_$G_footprint,na.rm=T)
BG_food_footprint1 = sum(food1_$BG_footprint,na.rm=T)
B_food_footprint2 = sum(food2_$B_footprint,na.rm=T)
G_food_footprint2 = sum(food2_$G_footprint,na.rm=T)
BG_food_footprint2 = sum(food2_$BG_footprint,na.rm=T)

#Make a new 1 row dataframe 
C_food_rw1 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint1)
N_food_rw1 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint1)
P_food_rw1 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint1)
B_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint1)
G_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint1)
BG_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint1)
C_food_rw2 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint2)
N_food_rw2 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint2)
P_food_rw2 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint2)
B_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint2)
G_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint2)
BG_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint2)

food_row1 = merge(C_food_rw1,N_food_rw1,by='Category')
food_row1 = merge(food_row1,P_food_rw1,by='Category')
food_row1 = merge(food_row1,B_food_rw1,by='Category')
food_row1$Timeframe = "Baseline"

food_row2 = merge(C_food_rw2,N_food_rw2,by='Category')
food_row2 = merge(food_row2,P_food_rw2,by='Category')
food_row2 = merge(food_row2,B_food_rw2,by='Category')
food_row2$Timeframe = "Projected"

# add on the food row
COMBO_foot1 = rbind(COMBO1,food_row1)
COMBO_foot2 = rbind(COMBO2,food_row2)

COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)

# Rearrange the rows to match the slider rows
COMBO_R_BAU = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                    COMBO_foot[COMBO_foot$Category=='Food',],
                    COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                    COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                    COMBO_foot[COMBO_foot$Category=='Commuting',],
                    #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                    COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                    COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                    COMBO_foot[COMBO_foot$Category=='Wastewater',],
                    COMBO_foot[COMBO_foot$Category=='Direct Water Use',])

#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# BAU COMMUTING_FAC_TABLE_R
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# Footprint Units are MT C and MT N

commut1 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Faculty Commuting',]
commut2 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Faculty Commuting',]

# Add Projected category
commut1$Timeframe = 'Baseline'
commut2$Timeframe = 'Projected'

# Gives the baseline value
c1 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Automobile',]$inventory
c2 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Bike',]$inventory
c3 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Carpool',]$inventory
c4 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Public Bus',]$inventory
c5 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Walk',]$inventory

commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Automobile',]$inventory = 
  c1 * 12*.01+c1
commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Bike',]$inventory = 
  c2 * 12*.01+c2
commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Carpool',]$inventory = 
  c3 * 12*.01+c3
commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Public Bus',]$inventory = 
  c4 * 12*.01+c4
commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Walk',]$inventory = 
  c5 * 12*.01+c5

COMMUTING_FAC_TABLE_R_BAU = rbind(commut1,commut2)  

#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# BAU Commut_Fac_R_
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
COMMUTING = COMMUTING_FAC_TABLE_R_BAU

#CARBON_____________________________________________________________________
# Result units = kg CO2
# Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
COMMUTING$CO2_r = COMMUTING$inventory * COMMUTING$CO2.EF

# Result units = kg eCO2
# Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
COMMUTING$eCO2_r = COMMUTING$inventory * COMMUTING$eCO2.EF

# Result units = kg CH4
# Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
COMMUTING$CH4_r = COMMUTING$inventory * COMMUTING$CH4.EF

#NITROGEN_____________________________________________________________________
# Result units = kg N20
# Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
COMMUTING$N2O_r = COMMUTING$inventory * COMMUTING$N2O.EF

# Result units = kg NOx
# Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
COMMUTING$NOx_r = COMMUTING$inventory * COMMUTING$NOx.EF

# Result units = kg N20
# Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
COMMUTING$OtherN_r = COMMUTING$inventory * COMMUTING$Other.N.EF

#INTERMEDIATE C & N _______________________________________________________________

# calculate Footprints by category (divide by 1000 to convert from kg to MT)
# Units of GWP 
COMMUTING$CO2_MTCDE = COMMUTING$CO2_r/1000  # MT CO2e
COMMUTING$eCO2_MTCDE = COMMUTING$eCO2_r/1000 # MT CO2e
COMMUTING$CH4_MTCDE = COMMUTING$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
COMMUTING$N2O_MTCDE = COMMUTING$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e

# intermediate N
COMMUTING$N2O_MTN = COMMUTING$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
COMMUTING$NOx_MTN = COMMUTING$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
COMMUTING$OtherN_MTN = COMMUTING$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N

#*****************************************************************************************************
# FOOTPRINT Calculations
#*****************************************************************************************************

# CALCULATING FOOTPRINT C & N_____________________________________________________________________
# Units C_Footprint = Metric Tons, N_Footprint = Metric Tons

COMMUTING$C_Footprint = rowSums(COMMUTING[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
COMMUTING$N_Footprint = rowSums(COMMUTING[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 

Commut_Fac_R_BAU_ = COMMUTING  

#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# BAU Commut_Fac_R
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
COMMUTING = Commut_Fac_R_BAU_
#*****************************************************************************************************
# FOOTPRINT DATA OUTPUT
#*****************************************************************************************************

# Summarize by Category___________________________________________________________________________
# Units are MT C, MT N, MT P, Gallons Water 

COMMUTING1_ = COMMUTING[COMMUTING$Timeframe == 'Baseline',] %>% 
  group_by(Category,Sub_category,Source) %>% 
  summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
            Total_N_Footprint = sum(N_Footprint,na.rm=T))
COMMUTING2_ = COMMUTING[COMMUTING$Timeframe == 'Projected',] %>%
  group_by(Category,Sub_category,Source) %>% 
  summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
            Total_N_Footprint = sum(N_Footprint,na.rm=T)) 

COMMUTING1_$Timeframe = 'Baseline'
COMMUTING2_$Timeframe = 'Projected'

Commut_Fac_R_BAU = rbind(COMMUTING1_,COMMUTING2_)  

#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# BAU COMMUTING_STAFF_TABLE_R
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# Footprint Units are MT C and MT N

commut1 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Staff Commuting',]
commut2 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Staff Commuting',]

# Add Projected category
commut1$Timeframe = 'Baseline'
commut2$Timeframe = 'Projected'

# Gives the baseline value

c6 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Automobile',]$inventory
c7 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Bike',]$inventory
c8 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Carpool',]$inventory
c9 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Public Bus',]$inventory
c10 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Walk',]$inventory

commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Automobile',]$inventory = 
  c6 * 12*.01+c6
commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Bike',]$inventory = 
  c7 * 12*.01+c7
commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Carpool',]$inventory = 
  c8 * 12*.01+c8
commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Public Bus',]$inventory = 
  c9 * 12*.01+c9
commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Walk',]$inventory = 
  c10 * 12*.01+c10

COMMUTING_STAFF_TABLE_R_BAU  = rbind(commut1,commut2)  

#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# BAU Commut_Staff_R_
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
COMMUTING = COMMUTING_STAFF_TABLE_R_BAU

#CARBON_____________________________________________________________________
# Result units = kg CO2
# Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
COMMUTING$CO2_r = COMMUTING$inventory * COMMUTING$CO2.EF

# Result units = kg eCO2
# Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
COMMUTING$eCO2_r = COMMUTING$inventory * COMMUTING$eCO2.EF

# Result units = kg CH4
# Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
COMMUTING$CH4_r = COMMUTING$inventory * COMMUTING$CH4.EF

#NITROGEN_____________________________________________________________________
# Result units = kg N20
# Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
COMMUTING$N2O_r = COMMUTING$inventory * COMMUTING$N2O.EF

# Result units = kg NOx
# Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
COMMUTING$NOx_r = COMMUTING$inventory * COMMUTING$NOx.EF

# Result units = kg N20
# Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
COMMUTING$OtherN_r = COMMUTING$inventory * COMMUTING$Other.N.EF

#INTERMEDIATE C & N _______________________________________________________________

# calculate Footprints by category (divide by 1000 to convert from kg to MT)
# Units of GWP 
COMMUTING$CO2_MTCDE = COMMUTING$CO2_r/1000  # MT CO2e
COMMUTING$eCO2_MTCDE = COMMUTING$eCO2_r/1000 # MT CO2e
COMMUTING$CH4_MTCDE = COMMUTING$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
COMMUTING$N2O_MTCDE = COMMUTING$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e

# intermediate N
COMMUTING$N2O_MTN = COMMUTING$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
COMMUTING$NOx_MTN = COMMUTING$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
COMMUTING$OtherN_MTN = COMMUTING$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N

#*****************************************************************************************************
# FOOTPRINT Calculations
#*****************************************************************************************************

# CALCULATING FOOTPRINT C & N_____________________________________________________________________
# Units C_Footprint = Metric Tons, N_Footprint = Metric Tons

COMMUTING$C_Footprint = rowSums(COMMUTING[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
COMMUTING$N_Footprint = rowSums(COMMUTING[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 

Commut_Staff_R_BAU_ = COMMUTING  


#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# BAU Commut_Staff_R
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
#*****************************************************************************************************
# FOOTPRINT DATA OUTPUT
#*****************************************************************************************************

COMMUTING = Commut_Staff_R_BAU_

# Summarize by Category___________________________________________________________________________
# Units are MT C, MT N, MT P, Gallons Water 

COMMUTING1_ = COMMUTING[COMMUTING$Timeframe == 'Baseline',] %>% 
  group_by(Category,Sub_category,Source) %>% 
  summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
            Total_N_Footprint = sum(N_Footprint,na.rm=T))
COMMUTING2_ = COMMUTING[COMMUTING$Timeframe == 'Projected',] %>%
  group_by(Category,Sub_category,Source) %>% 
  summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
            Total_N_Footprint = sum(N_Footprint,na.rm=T)) 

COMMUTING1_$Timeframe = 'Baseline'
COMMUTING2_$Timeframe = 'Projected'

Commut_Staff_R_BAU = rbind(COMMUTING1_,COMMUTING2_)  

#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# BAU COMMUTING_STUD_TABLE_R
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# Footprint Units are MT C and MT N

commut1 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Student Commuting',]
commut2 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Student Commuting',]

# Add Projected category
commut1$Timeframe = 'Baseline'
commut2$Timeframe = 'Projected'

# Gives the baseline value

c11 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Automobile',]$inventory
c12 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Bike',]$inventory
c13 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Carpool',]$inventory
c14 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Public Bus',]$inventory
c15 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Walk',]$inventory

commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Automobile',]$inventory = 
  c11 * 12*.01+c11
commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Bike',]$inventory = 
  c12 * 12*.01+c12
commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Carpool',]$inventory = 
  c13 * 12*.01+c13
commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Public Bus',]$inventory = 
  c14 * 12*.01+c14
commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Walk',]$inventory = 
  c15 * 12*.01+c15

COMMUTING_STUD_TABLE_R_BAU = rbind(commut1,commut2)  

#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# BAU Commut_Stud_R_
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
COMMUTING = COMMUTING_STUD_TABLE_R_BAU

#CARBON_____________________________________________________________________
# Result units = kg CO2
# Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
COMMUTING$CO2_r = COMMUTING$inventory * COMMUTING$CO2.EF

# Result units = kg eCO2
# Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
COMMUTING$eCO2_r = COMMUTING$inventory * COMMUTING$eCO2.EF

# Result units = kg CH4
# Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
COMMUTING$CH4_r = COMMUTING$inventory * COMMUTING$CH4.EF

#NITROGEN_____________________________________________________________________
# Result units = kg N20
# Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
COMMUTING$N2O_r = COMMUTING$inventory * COMMUTING$N2O.EF

# Result units = kg NOx
# Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
COMMUTING$NOx_r = COMMUTING$inventory * COMMUTING$NOx.EF

# Result units = kg N20
# Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
COMMUTING$OtherN_r = COMMUTING$inventory * COMMUTING$Other.N.EF

#INTERMEDIATE C & N _______________________________________________________________

# calculate Footprints by category (divide by 1000 to convert from kg to MT)
# Units of GWP 
COMMUTING$CO2_MTCDE = COMMUTING$CO2_r/1000  # MT CO2e
COMMUTING$eCO2_MTCDE = COMMUTING$eCO2_r/1000 # MT CO2e
COMMUTING$CH4_MTCDE = COMMUTING$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
COMMUTING$N2O_MTCDE = COMMUTING$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e

# intermediate N
COMMUTING$N2O_MTN = COMMUTING$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
COMMUTING$NOx_MTN = COMMUTING$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
COMMUTING$OtherN_MTN = COMMUTING$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N

#*****************************************************************************************************
# FOOTPRINT Calculations
#*****************************************************************************************************

# CALCULATING FOOTPRINT C & N_____________________________________________________________________
# Units C_Footprint = Metric Tons, N_Footprint = Metric Tons

COMMUTING$C_Footprint = rowSums(COMMUTING[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
COMMUTING$N_Footprint = rowSums(COMMUTING[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 

Commut_Stud_R_BAU_ = COMMUTING  

#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# BAU Commut_Stud_R
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
COMMUTING = Commut_Stud_R_BAU_
#*****************************************************************************************************
# FOOTPRINT DATA OUTPUT
#*****************************************************************************************************

# Summarize by Category___________________________________________________________________________
# Units are MT C, MT N, MT P, Gallons Water 

COMMUTING1_ = COMMUTING[COMMUTING$Timeframe == 'Baseline',] %>% 
  group_by(Category,Sub_category,Source) %>% 
  summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
            Total_N_Footprint = sum(N_Footprint,na.rm=T))
COMMUTING2_ = COMMUTING[COMMUTING$Timeframe == 'Projected',] %>%
  group_by(Category,Sub_category,Source) %>% 
  summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
            Total_N_Footprint = sum(N_Footprint,na.rm=T)) 

COMMUTING1_$Timeframe = 'Baseline'
COMMUTING2_$Timeframe = 'Projected'

Commut_Stud_R_BAU = rbind(COMMUTING1_,COMMUTING2_)  


#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# BAU ENERGY_TABLE_R
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# ENGERGY
Energy1 = uva[uva$Category == 'On-Campus Stationary Sources',]
Energy2 = Energy1

# Add Projected category
Energy1$Timeframe = 'Baseline'
Energy2$Timeframe = 'Projected'

sectr3 ='On-Campus Stationary Sources'

e1 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory
e2 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory
e3 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory
e4 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory
e5 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory
e6 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory
e7 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory
e8 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory

# Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory = 
  e1* 19*.01+e1
Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory = 
  e2* 19*.01+e2
Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory = 
  e3* 19*.01+e3
Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory = 
  e4* 19*.01+e4
Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory = 
  e5* 19*.01+e5
Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory = 
  e6* 19*.01+e6
Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory = 
  e7* 19*.01+e7
Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory = 
  e8* 19*.01+e8

ENERGY_TABLE_R_BAU = rbind(Energy1,Energy2)  

#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# BAU Energy_R_
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
ENERGY = ENERGY_TABLE_R_BAU
# FOOTPRINT CALCULATIONS
#CARBON_____________________________________________________________________
# Result units = kg CO2
# Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
ENERGY$CO2_r = ENERGY$inventory * ENERGY$CO2.EF

# Result units = kg eCO2
# Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
ENERGY$eCO2_r = ENERGY$inventory * ENERGY$eCO2.EF

# Result units = kg CH4
# Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
ENERGY$CH4_r = ENERGY$inventory * ENERGY$CH4.EF

#NITROGEN_____________________________________________________________________
# Result units = kg N20
# Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
ENERGY$N2O_r = ENERGY$inventory * ENERGY$N2O.EF

# Result units = kg NOx
# Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
ENERGY$NOx_r = ENERGY$inventory * ENERGY$NOx.EF

# Result units = kg N20
# Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
ENERGY$OtherN_r = ENERGY$inventory * ENERGY$Other.N.EF

#INTERMEDIATE C & N _______________________________________________________________

# calculate Footprints by category (divide by 1000 to convert from kg to MT)
# Units of GWP 
ENERGY$CO2_MTCDE = ENERGY$CO2_r/1000  # MT CO2e
ENERGY$eCO2_MTCDE = ENERGY$eCO2_r/1000 # MT CO2e
ENERGY$CH4_MTCDE = ENERGY$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
ENERGY$N2O_MTCDE = ENERGY$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e

# intermediate N
ENERGY$N2O_MTN = ENERGY$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
ENERGY$NOx_MTN = ENERGY$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
ENERGY$OtherN_MTN = ENERGY$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N

#*****************************************************************************************************
# FOOTPRINT Calculations
#*****************************************************************************************************

# CALCULATING FOOTPRINT C & N_____________________________________________________________________
# Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
ENERGY$C_Footprint = rowSums(ENERGY[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
ENERGY$N_Footprint = rowSums(ENERGY[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 

Energy_R_BAU_ = ENERGY  

#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# BAU Energy_R
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
ENERGY = Energy_R_BAU_
#*****************************************************************************************************
# FOOTPRINT DATA OUTPUT
#*****************************************************************************************************

# Summarize by Category___________________________________________________________________________
# Units are MT C, MT N, MT P, Gallons Water 

ENERGY1 = ENERGY[ENERGY$Timeframe == 'Baseline',] %>% 
  group_by(Category,Sub_category,Source) %>% 
  summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
            Total_N_Footprint = sum(N_Footprint,na.rm=T))
ENERGY2 = ENERGY[ENERGY$Timeframe == 'Projected',] %>%
  group_by(Category,Sub_category,Source) %>% 
  summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
            Total_N_Footprint = sum(N_Footprint,na.rm=T)) 

ENERGY1$Timeframe = 'Baseline'
ENERGY2$Timeframe = 'Projected'

Energy_R_BAU = rbind(ENERGY1,ENERGY2)  

#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# BAU COST_R
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# COST = COMBO_R_
# COMMUT = rbind(Commut_Fac_R_,Commut_Staff_R_,Commut_Stud_R_)
# ENERGY = Energy_R_

COST = COMBO_R_BAU_
COMMUT = rbind(Commut_Fac_R_BAU_,Commut_Staff_R_BAU_,Commut_Stud_R_BAU_)
ENERGY = Energy_R_BAU_

# Remove the COMMUTING and ENERGY from main dataframe
COST = COST[COST$Category != 'Commuting',]
COST = COST[COST$Category != 'On-Campus Stationary Sources',]


# Get the dataframes to have same fields
COST = COST[,c('Scope','Category','Sub_category','Source','Units',
               'inventory','NOx_MTN','N2O_MTN','OtherN_MTN',
               'C_Footprint','N_Footprint','Timeframe')]
COMMUT = COMMUT[,c('Scope','Category','Sub_category','Source','Units',
                   'inventory','NOx_MTN','N2O_MTN','OtherN_MTN',
                   'C_Footprint','N_Footprint','Timeframe')]
ENERGY = ENERGY[,c('Scope','Category','Sub_category','Source','Units',
                   'inventory','NOx_MTN','N2O_MTN','OtherN_MTN',
                   'C_Footprint','N_Footprint','Timeframe')]


#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# CARBON COSTS ********************************************************************
# Jana Compton: For Carbon costs, we recommend using $2-$50 per ton of CO2 equivalent 
# That covers the range we are using in our paper.  
# Units of C_Footprint are MT for COST and kg for food data
COST$C_Cost_min = 2*COST$C_Footprint # Initial Units are MT
COST$C_Cost_max = 50*COST$C_Footprint # Initial Units are MT
COST$C_Cost_mid = 30*COST$C_Footprint # Initial Units are MT

COMMUT$C_Cost_min = 2*COMMUT$C_Footprint # Initial Units are MT
COMMUT$C_Cost_max = 50*COMMUT$C_Footprint # Initial Units are MT
COMMUT$C_Cost_mid = 30*COMMUT$C_Footprint # Initial Units are MT

ENERGY$C_Cost_min = 2*ENERGY$C_Footprint # Initial Units are MT
ENERGY$C_Cost_max = 50*ENERGY$C_Footprint # Initial Units are MT
ENERGY$C_Cost_mid = 30*ENERGY$C_Footprint # Initial Units are MT

# NITROGEN COSTS ******************************************************************
# Other N  contributs to fertilizer and wastewater inventories, 
# The fertilizer component can be split into NOx, N2O, NH3, and N to Water 
# Using the following percentages 20%, 3%, 13%, 21%, respectively
# Wastewater component contributes to the N to water

# Baseline
N_Fert_c = 1000*COST[COST$Sub_category == 'Fertilizer' & COST$Timeframe == 'Baseline',]$OtherN_MTN 
N_Fert_NOx_c = N_Fert_c * 0.2
N_Fert_N2O_c = N_Fert_c * 0.03
N_Fert_NH3_c = N_Fert_c * 0.13
N_Fert_SW_c = N_Fert_c * 0.21 # proportion that goes to SW (Houlton et al. 2013)
N_Fert_GW_c = N_Fert_c * .79 * .33 # proportion that goes to GW (Sabota et al. 2015)
N_Fert_coast_c = N_Fert_SW_c * .40 # proportion of SW that goes to coast (Sabota et al. 2015)

# Projected
N_Fert_p = 1000*COST[COST$Sub_category == 'Fertilizer' & COST$Timeframe == 'Projected',]$OtherN_MTN 
N_Fert_NOx_p = N_Fert_p * 0.2
N_Fert_N2O_p = N_Fert_p * 0.03
N_Fert_NH3_p = N_Fert_p * 0.13
N_Fert_SW_p = N_Fert_p * 0.21 # proportion that goes to SW (Houlton et al. 2013)
N_Fert_GW_p = N_Fert_p * .79 * .33 # proportion that goes to GW (Sabota et al. 2015)
N_Fert_coast_p = N_Fert_SW_p * .40 # proportion of SW that goes to coast (Sabota et al. 2015)

#********************************************************************************

COST1 = COST[COST$Timeframe == 'Baseline',]
COST2 = COST[COST$Timeframe == 'Projected',]

# Units are MT N2O or NOx - so multiplying by 1000 to convert to kg
# h = health/social; a = agriculure; e = Ecosystems; c = climate
COST1$N_Cost_NOx_atm_h = 1000*COST1$NOx_MTN * 32.20 # $/kgN Human respiratory health 
COST1$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health (zero unless fertilzer - see below)
COST1$N_Cost_NOx_atm_e = 1000*COST1$NOx_MTN * 0.43 # $/kgN visibility damages 
COST1$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages (zero unless fertilzer - see below)
COST1$N_Cost_N2O_atm_c = 1000*COST1$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
COST1$N_Cost_NOx_atm_c = 1000*COST1$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
COST1$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits (zero unless fertilzer - see below)
COST1$N_Cost_NOx_ter_h = 1000*COST1$NOx_MTN * 0.12 # $/kgN Damages to structures  
COST1$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures (zero unless fertilzer - see below)
COST1$N_Cost_NOx_ter_a = 1000*COST1$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
COST1$N_Cost_N2O_ter_a = 1000*COST1$N2O_MTN * 1.48 # $/kgN UV damages to crops 
COST1$N_Cost_NOx_ter_e = 1000*COST1$NOx_MTN * 1.24 # $/kgN Ozone damages to forests  

COST1$N_Cost_NOx_atm_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 32.20 # $/kgN Human respiratory health
COST1$N_Cost_NH3_atm_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * 6.87 # $/kgN Human respiratory health 
COST1$N_Cost_NOx_atm_e[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 0.43 # $/kgN visibility damages 
COST1$N_Cost_NH3_atm_e[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * 0.43 # $/kgN visibility damages 
COST1$N_Cost_N2O_atm_c[COST1$Sub_category == 'Fertilizer' ] = N_Fert_N2O_c * 15.07 # $/kgN Greenhouse damages 
COST1$N_Cost_NOx_atm_c[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * (-5.02) # $/kgN Climate Cooling Benefits
COST1$N_Cost_NH3_atm_c[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * (-5.02) # $/kgN Climate Cooling Benefits 
COST1$N_Cost_NOx_ter_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 0.12 # $/kgN Damages to structures
COST1$N_Cost_NH3_ter_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * 0.12 # $/kgN Damages to structures
COST1$N_Cost_NOx_ter_a[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 2.11 # $/kgN Ozone damages to crops  
COST1$N_Cost_N2O_ter_a[COST1$Sub_category == 'Fertilizer' ] = N_Fert_N2O_c * 1.48 # $/kgN UV damages to crops 
COST1$N_Cost_NOx_ter_e[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 1.24 # $/kgN Ozone damages to forests  

COST2$N_Cost_NOx_atm_h = 1000*COST2$NOx_MTN * 32.20 # $/kgN Human respiratory health 
COST2$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health (zero unless fertilzer - see below)
COST2$N_Cost_NOx_atm_e = 1000*COST2$NOx_MTN * 0.43 # $/kgN visibility damages 
COST2$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages (zero unless fertilzer - see below)
COST2$N_Cost_N2O_atm_c = 1000*COST2$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
COST2$N_Cost_NOx_atm_c = 1000*COST2$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
COST2$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits (zero unless fertilzer - see below)
COST2$N_Cost_NOx_ter_h = 1000*COST2$NOx_MTN * 0.12 # $/kgN Damages to structures  
COST2$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures (zero unless fertilzer - see below)
COST2$N_Cost_NOx_ter_a = 1000*COST2$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
COST2$N_Cost_N2O_ter_a = 1000*COST2$N2O_MTN * 1.48 # $/kgN UV damages to crops 
COST2$N_Cost_NOx_ter_e = 1000*COST2$NOx_MTN * 1.24 # $/kgN Ozone damages to forests  

COST2$N_Cost_NOx_atm_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 32.20 # $/kgN Human respiratory health
COST2$N_Cost_NH3_atm_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * 6.87 # $/kgN Human respiratory health 
COST2$N_Cost_NOx_atm_e[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 0.43 # $/kgN visibility damages 
COST2$N_Cost_NH3_atm_e[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * 0.43 # $/kgN visibility damages 
COST2$N_Cost_N2O_atm_c[COST2$Sub_category == 'Fertilizer' ] = N_Fert_N2O_p * 15.07 # $/kgN Greenhouse damages 
COST2$N_Cost_NOx_atm_c[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * (-5.02) # $/kgN Climate Cooling Benefits
COST2$N_Cost_NH3_atm_c[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * (-5.02) # $/kgN Climate Cooling Benefits 
COST2$N_Cost_NOx_ter_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 0.12 # $/kgN Damages to structures
COST2$N_Cost_NH3_ter_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * 0.12 # $/kgN Damages to structures
COST2$N_Cost_NOx_ter_a[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 2.11 # $/kgN Ozone damages to crops  
COST2$N_Cost_N2O_ter_a[COST2$Sub_category == 'Fertilizer' ] = N_Fert_N2O_p * 1.48 # $/kgN UV damages to crops 
COST2$N_Cost_NOx_ter_e[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 1.24 # $/kgN Ozone damages to forests  

COST = rbind(COST1,COST2)

COST$N_SW_kg = 0.21 * 1000*(rowSums(COST[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # all N sources (not N2O), # proportion that goes to SW (Houlton et al. 2013)
COST$N_GW_kg = 0.79 * .33 * 1000*(rowSums(COST[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # proportion that goes to GW (Sabota et al. 2015) 
COST$N_coast_kg = .40 * COST$N_SW_kg # proportion of SW that goes to coast (Sabota et al. 2015)

COST1 = COST[COST$Timeframe == 'Baseline',]
COST2 = COST[COST$Timeframe == 'Projected',]

COST1$N_SW_kg[COST1$Sub_category == 'Fertilizer' ] = N_Fert_SW_c
COST1$N_GW_kg[COST1$Sub_category == 'Fertilizer' ] = N_Fert_GW_c 
COST1$N_coast_kg[COST1$Sub_category == 'Fertilizer' ] = N_Fert_coast_c 
COST2$N_SW_kg[COST2$Sub_category == 'Fertilizer' ] = N_Fert_SW_p
COST2$N_GW_kg[COST2$Sub_category == 'Fertilizer' ] = N_Fert_GW_p 
COST2$N_coast_kg[COST2$Sub_category == 'Fertilizer' ] = N_Fert_coast_p 

COST = rbind(COST1,COST2)

# Update below 
COST$N_Cost_aquaFresh_e = 
  COST$N_SW_kg * 0.23 + # $/kgN Lake waterfront property values
  COST$N_SW_kg * 0.19 + # $/kgN Recreational Freshwater use
  COST$N_SW_kg * 0.01 # $/kgN Endangered species protection
COST$N_Cost_aquaGround_h = 
  COST$N_GW_kg * 0.15 + # $/kgN Replacement with bottled water
  COST$N_GW_kg * 0.60 # $/kgN Treatment of private well water 
COST$N_Cost_aquaCoast_e = 
  COST$N_coast_kg * 7.11 # $/kgN Recreational use of estuary


# No NH3 emissions factor data for Commuting
COMMUT$N_Cost_NOx_atm_h = 1000*COMMUT$NOx_MTN * 32.20 # $/kgN Human respiratory health 
COMMUT$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health 
COMMUT$N_Cost_NOx_atm_e = 1000*COMMUT$NOx_MTN * 0.43 # $/kgN visibility damages 
COMMUT$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages 
COMMUT$N_Cost_N2O_atm_c = 1000*COMMUT$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
COMMUT$N_Cost_NOx_atm_c = 1000*COMMUT$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
COMMUT$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits 
COMMUT$N_Cost_NOx_ter_h = 1000*COMMUT$NOx_MTN * 0.12 # $/kgN Damages to structures  
COMMUT$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures  
COMMUT$N_Cost_NOx_ter_a = 1000*COMMUT$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
COMMUT$N_Cost_N2O_ter_a = 1000*COMMUT$N2O_MTN * 1.48 # $/kgN UV damages to crops 
COMMUT$N_Cost_NOx_ter_e = 1000*COMMUT$NOx_MTN * 1.24 # $/kgN Ozone damages to forests

# No NH3 emissions factor data for Energy sources
ENERGY$N_Cost_NOx_atm_h = 1000*ENERGY$NOx_MTN * 32.20 # $/kgN Human respiratory health 
ENERGY$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health 
ENERGY$N_Cost_NOx_atm_e = 1000*ENERGY$NOx_MTN * 0.43 # $/kgN visibility damages 
ENERGY$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages 
ENERGY$N_Cost_N2O_atm_c = 1000*ENERGY$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
ENERGY$N_Cost_NOx_atm_c = 1000*ENERGY$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
ENERGY$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits 
ENERGY$N_Cost_NOx_ter_h = 1000*ENERGY$NOx_MTN * 0.12 # $/kgN Damages to structures  
ENERGY$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures  
ENERGY$N_Cost_NOx_ter_a = 1000*ENERGY$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
ENERGY$N_Cost_N2O_ter_a = 1000*ENERGY$N2O_MTN * 1.48 # $/kgN UV damages to crops 
ENERGY$N_Cost_NOx_ter_e = 1000*ENERGY$NOx_MTN * 1.24 # $/kgN Ozone damages to forests

COMMUT$N_SW_kg = 0.21 * 1000*(rowSums(COMMUT[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # all N sources (not N2O), # proportion that goes to SW (Houlton et al. 2013)
COMMUT$N_GW_kg = 0.79 * .33 *  1000*(rowSums(COMMUT[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # proportion that goes to GW (Sabota et al. 2015) 
COMMUT$N_coast_kg = 0.40 * COMMUT$N_SW_kg # proportion of SW that goes to coast (Sabota et al. 2015)

ENERGY$N_SW_kg = 0.21 * 1000*(rowSums(ENERGY[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # all N sources (not N2O),  # proportion that goes to SW (Houlton et al. 2013)
ENERGY$N_GW_kg = 0.79 * .33 *  1000*(rowSums(ENERGY[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # proportion that goes to GW (Sabota et al. 2015) 
ENERGY$N_coast_kg = 0.40 * ENERGY$N_SW_kg # proportion of SW that goes to coast (Sabota et al. 2015)

COMMUT$N_Cost_aquaFresh_e = 
  COMMUT$N_SW_kg * 0.23 + # $/kgN Lake waterfront property values
  COMMUT$N_SW_kg * 0.19 + # $/kgN Recreational Freshwater use
  COMMUT$N_SW_kg * 0.01 # $/kgN Endangered species protection
COMMUT$N_Cost_aquaGround_h = 
  COMMUT$N_GW_kg * 0.15 + # $/kgN Replacement with bottled water
  COMMUT$N_GW_kg * 0.60 # $/kgN Treatment of private well water 
COMMUT$N_Cost_aquaCoast_e = 
  COMMUT$N_coast_kg * 7.11 # $/kgN Recreational use of estuary

ENERGY$N_Cost_aquaFresh_e = 
  ENERGY$N_SW_kg * 0.23 + # $/kgN Lake waterfront property values
  ENERGY$N_SW_kg * 0.19 + # $/kgN Recreational Freshwater use
  ENERGY$N_SW_kg * 0.01 # $/kgN Endangered species protection
ENERGY$N_Cost_aquaGround_h = 
  ENERGY$N_GW_kg * 0.15 + # $/kgN Replacement with bottled water
  ENERGY$N_GW_kg * 0.60 # $/kgN Treatment of private well water 
ENERGY$N_Cost_aquaCoast_e = 
  ENERGY$N_coast_kg * 7.11 # $/kgN Recreational use of estuary

COST$N_Cost_Total = 
  rowSums(COST[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                  'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                  'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                  'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                  'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                  'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                  'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                  'N_Cost_aquaCoast_e')], na.rm=T)

COMMUT$N_Cost_Total = 
  rowSums(COMMUT[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                    'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                    'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                    'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                    'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                    'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                    'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                    'N_Cost_aquaCoast_e')], na.rm=T)

ENERGY$N_Cost_Total = 
  rowSums(ENERGY[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                    'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                    'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                    'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                    'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                    'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                    'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                    'N_Cost_aquaCoast_e')], na.rm=T)

# Add back on COMMUTING AND ENERGY
COST = rbind(COST,COMMUT,ENERGY)

COST_R_BAU = COST  

#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
# BAU FOOD_COST_R
#>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

FOOD = FOOD_R_BAU

# C Costs
# Jana Compton: For Carbon costs, we recommend using $2-$50 per ton of CO2 equivalent 
# That covers the range we are using in our paper.  
# Units of C_Footprint are MT for COST and kg for food data
FOOD$C_Cost_min = 2*FOOD$C_Footprint/1000 # Initial Units are kg
FOOD$C_Cost_max = 50*FOOD$C_Footprint/1000 # Initial Units are kg
FOOD$C_Cost_mid = 30*FOOD$C_Footprint/1000 # Initial Units are kg

# N Costs
#Food footprint is in kg N
FOOD$N_NOx = FOOD$N_virtual* 0.20 # Virtual N Emission conribution
FOOD$N_N2O = FOOD$N_virtual * 0.03 # Virtual N Emission conribution
FOOD$N_NH3 = FOOD$N_virtual * 0.13 # Virtual N Emission conribution
FOOD$N_SW = FOOD$N_virtual * 0.21 # Virtual N to water (Houlton et al. 2013)
FOOD$N_GW = FOOD$N_virtual * .79 * .33 # N to groundwater (Sabota et al. 2015)
FOOD$N_Coast = FOOD$N_SW * .40 # N to coast water (Sabota et al. 2015)

FOOD$N_Cost_NOx_atm_h = FOOD$N_NOx * 32.20 # $/kgN Human respiratory health 
FOOD$N_Cost_NH3_atm_h = FOOD$N_NH3 * 6.87 # $/kgN Human respiratory health 
FOOD$N_Cost_NOx_atm_e = FOOD$N_NOx * 0.43 # $/kgN visibility damages 
FOOD$N_Cost_NH3_atm_e = FOOD$N_NH3 * 0.43 # $/kgN visibility damages 
FOOD$N_Cost_N2O_atm_c = FOOD$N_N2O * 15.07 # $/kgN Greenhouse damages 
FOOD$N_Cost_NOx_atm_c = FOOD$N_NOx * (-5.02) # $/kgN Climate Cooling Benefits 
FOOD$N_Cost_NH3_atm_c = FOOD$N_NH3 * (-5.02) # $/kgN Climate Cooling Benefits 
FOOD$N_Cost_NOx_ter_h = FOOD$N_NOx * 0.12 # $/kgN Damages to structures  
FOOD$N_Cost_NH3_ter_h = FOOD$N_NH3 * 0.12 # $/kgN Damages to structures  
FOOD$N_Cost_NOx_ter_a = FOOD$N_NOx * 2.11 # $/kgN Ozone damages to crops  
FOOD$N_Cost_N2O_ter_a = FOOD$N_N2O * 1.48 # $/kgN UV damages to crops 
FOOD$N_Cost_NOx_ter_e = FOOD$N_NOx * 1.24 # $/kgN Ozone damages to forests  

FOOD$N_Cost_aquaFresh_e = 
  FOOD$N_SW * 0.23 + # $/kgN Lake waterfront property values
  FOOD$N_SW * 0.19 + # $/kgN Recreational Freshwater use
  FOOD$N_SW * 0.01 # $/kgN Endangered species protection
FOOD$N_Cost_aquaGround_h = 
  FOOD$N_GW * 0.15 + # $/kgN Replacement with bottled water
  FOOD$N_GW * 0.60 # $/kgN Treatment of private well water 
FOOD$N_Cost_aquaCoast_e = 
  FOOD$N_Coast * 7.11 # $/kgN Recreational use of estuary

FOOD$N_Cost_water =  FOOD$N_Cost_aquaFresh_e + FOOD$N_Cost_aquaGround_h + FOOD$N_Cost_aquaCoast_e

FOOD$N_Cost_virtual =  # = Food Production Value, previously labeled as N_Cost_Total
  rowSums(FOOD[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                  'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                  'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                  'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                  'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                  'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                  'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                  'N_Cost_aquaCoast_e')], na.rm=T)

# DOn't need to calculate  food waste, don't have the right data
#costs = 39.07+0.43+10.05+0.12+3.59+1.24+0.43+0.75+7.11
#FOOD$N_Cost_waste = FOOD$N_waste * costs  # for Food Waste Calculation
#FOOD$N_Cost_virtual = FOOD$N_virtual * costs # for Food production calculation

FOOD_COST_R_BAU = FOOD 

#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
# Define server logic required to draw a histogram ----
server <- function(input, output) {
  
  # This is the reactive part
  
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  # STEP_5 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  
  observe({
    input$ResetEFs
    # Purchased Electricity EFs
    updateSelectInput(inputId="Elect.CO2.EF_change", selected=0.3885392)
    updateSelectInput(inputId="Elect.CH4.EF_change", selected=0.0000434)
    updateSelectInput(inputId="Elect.N2O.EF_change", selected=0.00000625)
    updateSelectInput(inputId="Elect.NOx.EF_change", selected=0.000264228)
    
    # On-campus Stationary EFs
    updateSelectInput(inputId="Coal.CO2.EF_change", selected=2508.843651)
    updateSelectInput(inputId="Coal.CH4.EF_change", selected=0.249049501)
    updateSelectInput(inputId="Coal.N2O.EF_change", selected=0.037357425)
    updateSelectInput(inputId="Coal.NOx.EF_change", selected=9.458129032)
    
    updateSelectInput(inputId="Oil.CO2.EF_change", selected=10.09767348)
    updateSelectInput(inputId="Oil.CH4.EF_change", selected=0.001294102)
    updateSelectInput(inputId="Oil.N2O.EF_change", selected=0.0000776)
    updateSelectInput(inputId="Oil.NOx.EF_change", selected=0.005154464)
    
    updateSelectInput(inputId="Propane.CO2.EF_change", selected=5.22770094)
    updateSelectInput(inputId="Propane.CH4.EF_change", selected=0.000893733)
    updateSelectInput(inputId="Propane.N2O.EF_change", selected=0.00005362)
    updateSelectInput(inputId="Propane.NOx.EF_change", selected=0.003151786)
    
    updateSelectInput(inputId="NaturalGas.CO2.EF_change", selected=53.02)
    updateSelectInput(inputId="NaturalGas.CH4.EF_change", selected=0.004739)
    updateSelectInput(inputId="NaturalGas.N2O.EF_change", selected=0.000095)
    updateSelectInput(inputId="NaturalGas.NOx.EF_change", selected=0.03414929)
    
  })

  
  
  # observeEvent(input$NewEFs{ })
  # observe({
  #   input$NewEFs
  #   updateSelectInput(inputId="CO2.EF_change", selected=NULL)
  #   updateSelectInput(inputId="CH4.EF_change", selected=NULL)
  #   updateSelectInput(inputId="N2O.EF_change", selected=NULL)
  #   updateSelectInput(inputId="NOx.EF_change", selected=NULL)
  # })
  
  # Emission Factor Choices (Just for Purchased Electricity: CO2, CH4, N2O, and NOx EFs)
  uva_R <- reactive({

    # Purchased Electricity EFs
    uva_ef$CO2.EF[uva_ef$Source == 'Purchased Electricity'] = as.numeric(input$Elect.CO2.EF_change)
    uva_ef$CH4.EF[uva_ef$Source == 'Purchased Electricity'] = as.numeric(input$Elect.CH4.EF_change)
    uva_ef$N2O.EF[uva_ef$Source == 'Purchased Electricity'] = as.numeric(input$Elect.N2O.EF_change)
    uva_ef$NOx.EF[uva_ef$Source == 'Purchased Electricity'] = as.numeric(input$Elect.NOx.EF_change)
    
    # On-campus Stationary EFs
    uva_ef$CO2.EF[uva_ef$Sub_category == 'Non-Cogeneration' & uva_ef$Source == 'Coal (Steam Coal)'] = as.numeric(input$Coal.CO2.EF_change)
    uva_ef$CH4.EF[uva_ef$Sub_category == 'Non-Cogeneration' & uva_ef$Source == 'Coal (Steam Coal)'] = as.numeric(input$Coal.CH4.EF_change)
    uva_ef$N2O.EF[uva_ef$Sub_category == 'Non-Cogeneration' & uva_ef$Source == 'Coal (Steam Coal)'] = as.numeric(input$Coal.N2O.EF_change)
    uva_ef$NOx.EF[uva_ef$Sub_category == 'Non-Cogeneration' & uva_ef$Source == 'Coal (Steam Coal)'] = as.numeric(input$Coal.NOx.EF_change)
    
    uva_ef$CO2.EF[uva_ef$Sub_category == 'Non-Cogeneration' & uva_ef$Source == 'Distillate Oil (#1-4)'] = as.numeric(input$Oil.CO2.EF_change)
    uva_ef$CH4.EF[uva_ef$Sub_category == 'Non-Cogeneration' & uva_ef$Source == 'Distillate Oil (#1-4)'] = as.numeric(input$Oil.CH4.EF_change)
    uva_ef$N2O.EF[uva_ef$Sub_category == 'Non-Cogeneration' & uva_ef$Source == 'Distillate Oil (#1-4)'] = as.numeric(input$Oil.N2O.EF_change)
    uva_ef$NOx.EF[uva_ef$Sub_category == 'Non-Cogeneration' & uva_ef$Source == 'Distillate Oil (#1-4)'] = as.numeric(input$Oil.NOx.EF_change)
    
    uva_ef$CO2.EF[uva_ef$Sub_category == 'Non-Cogeneration' & uva_ef$Source == 'LPG (Propane)'] = as.numeric(input$Propane.CO2.EF_change)
    uva_ef$CH4.EF[uva_ef$Sub_category == 'Non-Cogeneration' & uva_ef$Source == 'LPG (Propane)'] = as.numeric(input$Propane.CH4.EF_change)
    uva_ef$N2O.EF[uva_ef$Sub_category == 'Non-Cogeneration' & uva_ef$Source == 'LPG (Propane)'] = as.numeric(input$Propane.N2O.EF_change)
    uva_ef$NOx.EF[uva_ef$Sub_category == 'Non-Cogeneration' & uva_ef$Source == 'LPG (Propane)'] = as.numeric(input$Propane.NOx.EF_change)
    
    uva_ef$CO2.EF[uva_ef$Sub_category == 'Non-Cogeneration' & uva_ef$Source == 'Natural Gas'] = as.numeric(input$NaturalGas.CO2.EF_change)
    uva_ef$CH4.EF[uva_ef$Sub_category == 'Non-Cogeneration' & uva_ef$Source == 'Natural Gas'] = as.numeric(input$NaturalGas.CH4.EF_change)
    uva_ef$N2O.EF[uva_ef$Sub_category == 'Non-Cogeneration' & uva_ef$Source == 'Natural Gas'] = as.numeric(input$NaturalGas.N2O.EF_change)
    uva_ef$NOx.EF[uva_ef$Sub_category == 'Non-Cogeneration' & uva_ef$Source == 'Natural Gas'] = as.numeric(input$NaturalGas.NOx.EF_change)

    uva_R = uva_ef

  })
  
  
  
  #*****************************************************************************************************
  # FOOD REACTIVE
  #*****************************************************************************************************
  
  FOOD_R <- reactive({
    
    # # Campus Vs. Individual
    # if(input$campusVindividual == "Campus"){
    #   uva = uva_R()
    #   food = food
    # }
    # 
    # else if(input$campusVindividual == "Individual"){
    #   uva = uva_individual
    #   food = food_individual
    # }
      
    # Units for Inventory (kg)
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 0
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    if(input$scenario == "Manual Scenario"){
    names(food)[which(colnames(food)=="UVA_inventory")] = "inventory"
    names(food)[which(colnames(food)=="Food_category")] = "Category"
    
    food$Color_codes = str_remove(food$Color_codes, '#')
    food$Color_codes = as.character(paste0('#',food$Color_codes))
    
    food1 = food
    food2 = food
    
    # Add Projected category
    food1$Timeframe = 'Baseline'
    food2$Timeframe = 'Projected'
    
    # Get base value for reactive Projected
    f1 = food2[food2$Category == 'Spices',]$inventory
    f2 = food2[food2$Category == 'Sugars',]$inventory
    f3 = food2[food2$Category == 'Oils',]$inventory
    f4 = food2[food2$Category == 'Coffee and tea',]$inventory
    f5 = food2[food2$Category == 'Liquids',]$inventory
    f6 = food2[food2$Category == 'Nuts',]$inventory
    f7 = food2[food2$Category == 'Beans',]$inventory
    f8 = food2[food2$Category == 'Potatoes',]$inventory
    f9 = food2[food2$Category == 'Fruits',]$inventory
    f10 = food2[food2$Category == 'Vegetables',]$inventory
    f11 = food2[food2$Category == 'Grains',]$inventory
    f12 = food2[food2$Category == 'Eggs',]$inventory
    f13 = food2[food2$Category == 'Cheese',]$inventory
    f14 = food2[food2$Category == 'Milk',]$inventory
    f15 = food2[food2$Category == 'Fish',]$inventory
    f16 = food2[food2$Category == 'Chicken',]$inventory
    f17 = food2[food2$Category == 'Pork',]$inventory
    f18 = food2[food2$Category == 'Beef',]$inventory
    
    # Projected changes - multiplying each Category by the SLIDER Value e.g. "cat1a_proj"
    food2[food2$Category == 'Spices',]$inventory = f1* input$cat1a_proj*.01+f1
    food2[food2$Category == 'Sugars',]$inventory = f2* input$cat2a_proj*.01+f2
    food2[food2$Category == 'Oils',]$inventory = f3* input$cat3a_proj*.01+f3
    food2[food2$Category == 'Coffee and tea',]$inventory = f4* input$cat4a_proj*.01+f4
    food2[food2$Category == 'Liquids',]$inventory = f5* input$cat5a_proj*.01+f5
    food2[food2$Category == 'Nuts',]$inventory = f6* input$cat6a_proj*.01+f6
    food2[food2$Category == 'Beans',]$inventory = f7* input$cat7a_proj*.01+f7
    food2[food2$Category == 'Potatoes',]$inventory = f8* input$cat8a_proj*.01+f8
    food2[food2$Category == 'Fruits',]$inventory = f9* input$cat9a_proj*.01+f9
    food2[food2$Category == 'Vegetables',]$inventory = f10* input$cat10a_proj*.01+f10
    food2[food2$Category == 'Grains',]$inventory = f11* input$cat11a_proj*.01+f11
    food2[food2$Category == 'Eggs',]$inventory = f12* input$cat12a_proj*.01+f12
    food2[food2$Category == 'Cheese',]$inventory = f13* input$cat13a_proj*.01+f13
    food2[food2$Category == 'Milk',]$inventory = f14* input$cat14a_proj*.01+f14
    food2[food2$Category == 'Fish',]$inventory = f15* input$cat15a_proj*.01+f15
    food2[food2$Category == 'Chicken',]$inventory = f16* input$cat16a_proj*.01+f16
    food2[food2$Category == 'Pork',]$inventory = f17* input$cat17a_proj*.01+f17
    food2[food2$Category == 'Beef',]$inventory = f18* input$cat18a_proj*.01+f18
    
    FOOD = rbind(food1,food2)
    
    # Calculuations
    # Result units = kg eCO2
    # Carbon Footprint: (inventory unit e.g. kg) * (kg eCO2 / kg food)
    FOOD$C_Footprint = FOOD$inventory * FOOD$C_footprint_food
    
    # Result units = kg N
    # N food supply: (inventory unit e.g. kg) * N Conent is unitless?
    FOOD$N_food_supply = FOOD$inventory * FOOD$N_Content
    
    # Result units = kg N
    # Waste N:  Food_waste (Unitless - %) * (kg N)
    FOOD$N_waste = FOOD$Food_waste * FOOD$N_food_supply
    
    # Result units = kg N
    # Inventory unit (kg N) * (kg N loss / kg N food)
    FOOD$N_virtual = FOOD$N_food_supply * FOOD$Conventional_virtual_N_factor
    
    # N Footprint
    # Result units = kg N
    FOOD$N_Footprint = FOOD$N_waste + FOOD$N_virtual
    
    # P Footprint
    # Result units = kg P
    FOOD$P_Footprint = FOOD$inventory * FOOD$P_footprint_food
    
    # W Footprint
    # Result units = gallons water (264.172 gal/m3 * kg inventory * m3 water / MT food * 1 MT/1000 kg)
    FOOD$Blue_W_Footprint = 264.172*FOOD$inventory * FOOD$Blue_W_Footprint_food / 1000
    FOOD$Green_W_Footprint = 264.172*FOOD$inventory * FOOD$Green_W_Footprint_food / 1000
    FOOD$Grey_W_Footprint = 264.172*FOOD$inventory * FOOD$Grey_W_Footprint_food / 1000
    
    #food$Total_W_Footprint = food$Green_W_Footprint + food$Blue_W_Footprint + food$Grey_W_Footprint
    FOOD$B_Footprint = FOOD$Blue_W_Footprint
    FOOD$G_Footprint = FOOD$Green_W_Footprint
    FOOD$BG_Footprint = FOOD$Green_W_Footprint + FOOD$Blue_W_Footprint
    
    # Convert values with na to zero
    FOOD[is.na(FOOD)] <- 0
    
    FOOD_R = FOOD
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 1 Food 
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
 
    else if(input$scenario == "Business as Usual Growth to 2025"){
    names(food)[which(colnames(food)=="UVA_inventory")] = "inventory"
    names(food)[which(colnames(food)=="Food_category")] = "Category"
    
    food$Color_codes = str_remove(food$Color_codes, '#')
    food$Color_codes = as.character(paste0('#',food$Color_codes))
    
    food1 = food
    food2 = food
    
    # Add Projected category
    food1$Timeframe = 'Baseline'
    food2$Timeframe = 'Projected'
    
    # Get base value for reactive Projected
    f1 = food2[food2$Category == 'Spices',]$inventory
    f2 = food2[food2$Category == 'Sugars',]$inventory
    f3 = food2[food2$Category == 'Oils',]$inventory
    f4 = food2[food2$Category == 'Coffee and tea',]$inventory
    f5 = food2[food2$Category == 'Liquids',]$inventory
    f6 = food2[food2$Category == 'Nuts',]$inventory
    f7 = food2[food2$Category == 'Beans',]$inventory
    f8 = food2[food2$Category == 'Potatoes',]$inventory
    f9 = food2[food2$Category == 'Fruits',]$inventory
    f10 = food2[food2$Category == 'Vegetables',]$inventory
    f11 = food2[food2$Category == 'Grains',]$inventory
    f12 = food2[food2$Category == 'Eggs',]$inventory
    f13 = food2[food2$Category == 'Cheese',]$inventory
    f14 = food2[food2$Category == 'Milk',]$inventory
    f15 = food2[food2$Category == 'Fish',]$inventory
    f16 = food2[food2$Category == 'Chicken',]$inventory
    f17 = food2[food2$Category == 'Pork',]$inventory
    f18 = food2[food2$Category == 'Beef',]$inventory
    
    # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
    food2[food2$Category == 'Spices',]$inventory = f1* input$cat1b_proj*.01+f1
    food2[food2$Category == 'Sugars',]$inventory = f2* input$cat2b_proj*.01+f2
    food2[food2$Category == 'Oils',]$inventory = f3* input$cat3b_proj*.01+f3
    food2[food2$Category == 'Coffee and tea',]$inventory = f4* input$cat4b_proj*.01+f4
    food2[food2$Category == 'Liquids',]$inventory = f5* input$cat5b_proj*.01+f5
    food2[food2$Category == 'Nuts',]$inventory = f6* input$cat6b_proj*.01+f6
    food2[food2$Category == 'Beans',]$inventory = f7* input$cat7b_proj*.01+f7
    food2[food2$Category == 'Potatoes',]$inventory = f8* input$cat8b_proj*.01+f8
    food2[food2$Category == 'Fruits',]$inventory = f9* input$cat9b_proj*.01+f9
    food2[food2$Category == 'Vegetables',]$inventory = f10* input$cat10b_proj*.01+f10
    food2[food2$Category == 'Grains',]$inventory = f11* input$cat11b_proj*.01+f11
    food2[food2$Category == 'Eggs',]$inventory = f12* input$cat12b_proj*.01+f12
    food2[food2$Category == 'Cheese',]$inventory = f13* input$cat13b_proj*.01+f13
    food2[food2$Category == 'Milk',]$inventory = f14* input$cat14b_proj*.01+f14
    food2[food2$Category == 'Fish',]$inventory = f15* input$cat15b_proj*.01+f15
    food2[food2$Category == 'Chicken',]$inventory = f16* input$cat16b_proj*.01+f16
    food2[food2$Category == 'Pork',]$inventory = f17* input$cat17b_proj*.01+f17
    food2[food2$Category == 'Beef',]$inventory = f18* input$cat18b_proj*.01+f18
    
    FOOD = rbind(food1,food2)
    
    # Calculuations
    # Result units = kg eCO2
    # Carbon Footprint: (inventory unit e.g. kg) * (kg eCO2 / kg food)
    FOOD$C_Footprint = FOOD$inventory * FOOD$C_footprint_food
    
    # Result units = kg N
    # N food supply: (inventory unit e.g. kg) * N Conent is unitless?
    FOOD$N_food_supply = FOOD$inventory * FOOD$N_Content
    
    # Result units = kg N
    # Waste N:  Food_waste (Unitless - %) * (kg N)
    FOOD$N_waste = FOOD$Food_waste * FOOD$N_food_supply
    
    # Result units = kg N
    # Inventory unit (kg N) * (kg N loss / kg N food)
    FOOD$N_virtual = FOOD$N_food_supply * FOOD$Conventional_virtual_N_factor
    
    # N Footprint
    # Result units = kg N
    FOOD$N_Footprint = FOOD$N_waste + FOOD$N_virtual
    
    # P Footprint
    # Result units = kg P
    FOOD$P_Footprint = FOOD$inventory * FOOD$P_footprint_food
    
    # W Footprint
    # Result units = gallons water (264.172 gal/m3 * kg inventory * m3 water / MT food * 1 MT/1000 kg)
    FOOD$Blue_W_Footprint = 264.172*FOOD$inventory * FOOD$Blue_W_Footprint_food / 1000
    FOOD$Green_W_Footprint = 264.172*FOOD$inventory * FOOD$Green_W_Footprint_food / 1000
    FOOD$Grey_W_Footprint = 264.172*FOOD$inventory * FOOD$Grey_W_Footprint_food / 1000
    
    #food$Total_W_Footprint = food$Green_W_Footprint + food$Blue_W_Footprint + food$Grey_W_Footprint
    FOOD$B_Footprint = FOOD$Blue_W_Footprint
    FOOD$G_Footprint = FOOD$Green_W_Footprint
    FOOD$BG_Footprint = FOOD$Green_W_Footprint + FOOD$Blue_W_Footprint
    
    # Convert values with na to zero
    FOOD[is.na(FOOD)] <- 0
    
    FOOD_R = FOOD
    } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 2 Food 
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    
    else if(input$scenario == "15% Vegetarian Meals"){
      names(food)[which(colnames(food)=="UVA_inventory")] = "inventory"
      names(food)[which(colnames(food)=="Food_category")] = "Category"
      
      food$Color_codes = str_remove(food$Color_codes, '#')
      food$Color_codes = as.character(paste0('#',food$Color_codes))
      
      food1 = food
      food2 = food
      
      # Add Projected category
      food1$Timeframe = 'Baseline'
      food2$Timeframe = 'Projected'
      
      # Get base value for reactive Projected
      f1 = food2[food2$Category == 'Spices',]$inventory
      f2 = food2[food2$Category == 'Sugars',]$inventory
      f3 = food2[food2$Category == 'Oils',]$inventory
      f4 = food2[food2$Category == 'Coffee and tea',]$inventory
      f5 = food2[food2$Category == 'Liquids',]$inventory
      f6 = food2[food2$Category == 'Nuts',]$inventory
      f7 = food2[food2$Category == 'Beans',]$inventory
      f8 = food2[food2$Category == 'Potatoes',]$inventory
      f9 = food2[food2$Category == 'Fruits',]$inventory
      f10 = food2[food2$Category == 'Vegetables',]$inventory
      f11 = food2[food2$Category == 'Grains',]$inventory
      f12 = food2[food2$Category == 'Eggs',]$inventory
      f13 = food2[food2$Category == 'Cheese',]$inventory
      f14 = food2[food2$Category == 'Milk',]$inventory
      f15 = food2[food2$Category == 'Fish',]$inventory
      f16 = food2[food2$Category == 'Chicken',]$inventory
      f17 = food2[food2$Category == 'Pork',]$inventory
      f18 = food2[food2$Category == 'Beef',]$inventory
      
      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      food2[food2$Category == 'Spices',]$inventory = f1* input$cat1c_proj*.01+f1
      food2[food2$Category == 'Sugars',]$inventory = f2* input$cat2c_proj*.01+f2
      food2[food2$Category == 'Oils',]$inventory = f3* input$cat3c_proj*.01+f3
      food2[food2$Category == 'Coffee and tea',]$inventory = f4* input$cat4c_proj*.01+f4
      food2[food2$Category == 'Liquids',]$inventory = f5* input$cat5c_proj*.01+f5
      food2[food2$Category == 'Nuts',]$inventory = f6* input$cat6c_proj*.01+f6
      food2[food2$Category == 'Beans',]$inventory = f7* input$cat7c_proj*.01+f7
      food2[food2$Category == 'Potatoes',]$inventory = f8* input$cat8c_proj*.01+f8
      food2[food2$Category == 'Fruits',]$inventory = f9* input$cat9c_proj*.01+f9
      food2[food2$Category == 'Vegetables',]$inventory = f10* input$cat10c_proj*.01+f10
      food2[food2$Category == 'Grains',]$inventory = f11* input$cat11c_proj*.01+f11
      food2[food2$Category == 'Eggs',]$inventory = f12* input$cat12c_proj*.01+f12
      food2[food2$Category == 'Cheese',]$inventory = f13* input$cat13c_proj*.01+f13
      food2[food2$Category == 'Milk',]$inventory = f14* input$cat14c_proj*.01+f14
      food2[food2$Category == 'Fish',]$inventory = f15* input$cat15c_proj*.01+f15
      food2[food2$Category == 'Chicken',]$inventory = f16* input$cat16c_proj*.01+f16
      food2[food2$Category == 'Pork',]$inventory = f17* input$cat17c_proj*.01+f17
      food2[food2$Category == 'Beef',]$inventory = f18* input$cat18c_proj*.01+f18
      
      FOOD = rbind(food1,food2)
      
      # Calculuations
      # Result units = kg eCO2
      # Carbon Footprint: (inventory unit e.g. kg) * (kg eCO2 / kg food)
      FOOD$C_Footprint = FOOD$inventory * FOOD$C_footprint_food
      
      # Result units = kg N
      # N food supply: (inventory unit e.g. kg) * N Conent is unitless?
      FOOD$N_food_supply = FOOD$inventory * FOOD$N_Content
      
      # Result units = kg N
      # Waste N:  Food_waste (Unitless - %) * (kg N)
      FOOD$N_waste = FOOD$Food_waste * FOOD$N_food_supply
      
      # Result units = kg N
      # Inventory unit (kg N) * (kg N loss / kg N food)
      FOOD$N_virtual = FOOD$N_food_supply * FOOD$Conventional_virtual_N_factor
      
      # N Footprint
      # Result units = kg N
      FOOD$N_Footprint = FOOD$N_waste + FOOD$N_virtual
      
      # P Footprint
      # Result units = kg P
      FOOD$P_Footprint = FOOD$inventory * FOOD$P_footprint_food
      
      # W Footprint
      # Result units = gallons water (264.172 gal/m3 * kg inventory * m3 water / MT food * 1 MT/1000 kg)
      FOOD$Blue_W_Footprint = 264.172*FOOD$inventory * FOOD$Blue_W_Footprint_food / 1000
      FOOD$Green_W_Footprint = 264.172*FOOD$inventory * FOOD$Green_W_Footprint_food / 1000
      FOOD$Grey_W_Footprint = 264.172*FOOD$inventory * FOOD$Grey_W_Footprint_food / 1000
      
      #food$Total_W_Footprint = food$Green_W_Footprint + food$Blue_W_Footprint + food$Grey_W_Footprint
      FOOD$B_Footprint = FOOD$Blue_W_Footprint
      FOOD$G_Footprint = FOOD$Green_W_Footprint
      FOOD$BG_Footprint = FOOD$Green_W_Footprint + FOOD$Blue_W_Footprint
      
      # Convert values with na to zero
      FOOD[is.na(FOOD)] <- 0
      
      FOOD_R = FOOD
    } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 3 Food
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    
    else if(input$scenario == "Replacement of 20% beef with Chicken"){
      names(food)[which(colnames(food)=="UVA_inventory")] = "inventory"
      names(food)[which(colnames(food)=="Food_category")] = "Category"
      
      food$Color_codes = str_remove(food$Color_codes, '#')
      food$Color_codes = as.character(paste0('#',food$Color_codes))
      
      food1 = food
      food2 = food
      
      # Add Projected category
      food1$Timeframe = 'Baseline'
      food2$Timeframe = 'Projected'
      
      # Get base value for reactive Projected
      f1 = food2[food2$Category == 'Spices',]$inventory
      f2 = food2[food2$Category == 'Sugars',]$inventory
      f3 = food2[food2$Category == 'Oils',]$inventory
      f4 = food2[food2$Category == 'Coffee and tea',]$inventory
      f5 = food2[food2$Category == 'Liquids',]$inventory
      f6 = food2[food2$Category == 'Nuts',]$inventory
      f7 = food2[food2$Category == 'Beans',]$inventory
      f8 = food2[food2$Category == 'Potatoes',]$inventory
      f9 = food2[food2$Category == 'Fruits',]$inventory
      f10 = food2[food2$Category == 'Vegetables',]$inventory
      f11 = food2[food2$Category == 'Grains',]$inventory
      f12 = food2[food2$Category == 'Eggs',]$inventory
      f13 = food2[food2$Category == 'Cheese',]$inventory
      f14 = food2[food2$Category == 'Milk',]$inventory
      f15 = food2[food2$Category == 'Fish',]$inventory
      f16 = food2[food2$Category == 'Chicken',]$inventory
      f17 = food2[food2$Category == 'Pork',]$inventory
      f18 = food2[food2$Category == 'Beef',]$inventory
      
      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      food2[food2$Category == 'Spices',]$inventory = f1* input$cat1d_proj*.01+f1
      food2[food2$Category == 'Sugars',]$inventory = f2* input$cat2d_proj*.01+f2
      food2[food2$Category == 'Oils',]$inventory = f3* input$cat3d_proj*.01+f3
      food2[food2$Category == 'Coffee and tea',]$inventory = f4* input$cat4d_proj*.01+f4
      food2[food2$Category == 'Liquids',]$inventory = f5* input$cat5d_proj*.01+f5
      food2[food2$Category == 'Nuts',]$inventory = f6* input$cat6d_proj*.01+f6
      food2[food2$Category == 'Beans',]$inventory = f7* input$cat7d_proj*.01+f7
      food2[food2$Category == 'Potatoes',]$inventory = f8* input$cat8d_proj*.01+f8
      food2[food2$Category == 'Fruits',]$inventory = f9* input$cat9d_proj*.01+f9
      food2[food2$Category == 'Vegetables',]$inventory = f10* input$cat10d_proj*.01+f10
      food2[food2$Category == 'Grains',]$inventory = f11* input$cat11d_proj*.01+f11
      food2[food2$Category == 'Eggs',]$inventory = f12* input$cat12d_proj*.01+f12
      food2[food2$Category == 'Cheese',]$inventory = f13* input$cat13d_proj*.01+f13
      food2[food2$Category == 'Milk',]$inventory = f14* input$cat14d_proj*.01+f14
      food2[food2$Category == 'Fish',]$inventory = f15* input$cat15d_proj*.01+f15
      food2[food2$Category == 'Chicken',]$inventory = f16* input$cat16d_proj*.01+f16
      food2[food2$Category == 'Pork',]$inventory = f17* input$cat17d_proj*.01+f17
      food2[food2$Category == 'Beef',]$inventory = f18* input$cat18d_proj*.01+f18
      
      FOOD = rbind(food1,food2)
      
      # Calculuations
      # Result units = kg eCO2
      # Carbon Footprint: (inventory unit e.g. kg) * (kg eCO2 / kg food)
      FOOD$C_Footprint = FOOD$inventory * FOOD$C_footprint_food
      
      # Result units = kg N
      # N food supply: (inventory unit e.g. kg) * N Conent is unitless?
      FOOD$N_food_supply = FOOD$inventory * FOOD$N_Content
      
      # Result units = kg N
      # Waste N:  Food_waste (Unitless - %) * (kg N)
      FOOD$N_waste = FOOD$Food_waste * FOOD$N_food_supply
      
      # Result units = kg N
      # Inventory unit (kg N) * (kg N loss / kg N food)
      FOOD$N_virtual = FOOD$N_food_supply * FOOD$Conventional_virtual_N_factor
      
      # N Footprint
      # Result units = kg N
      FOOD$N_Footprint = FOOD$N_waste + FOOD$N_virtual
      
      # P Footprint
      # Result units = kg P
      FOOD$P_Footprint = FOOD$inventory * FOOD$P_footprint_food
      
      # W Footprint
      # Result units = gallons water (264.172 gal/m3 * kg inventory * m3 water / MT food * 1 MT/1000 kg)
      FOOD$Blue_W_Footprint = 264.172*FOOD$inventory * FOOD$Blue_W_Footprint_food / 1000
      FOOD$Green_W_Footprint = 264.172*FOOD$inventory * FOOD$Green_W_Footprint_food / 1000
      FOOD$Grey_W_Footprint = 264.172*FOOD$inventory * FOOD$Grey_W_Footprint_food / 1000
      
      #food$Total_W_Footprint = food$Green_W_Footprint + food$Blue_W_Footprint + food$Grey_W_Footprint
      FOOD$B_Footprint = FOOD$Blue_W_Footprint
      FOOD$G_Footprint = FOOD$Green_W_Footprint
      FOOD$BG_Footprint = FOOD$Green_W_Footprint + FOOD$Blue_W_Footprint
      
      # Convert values with na to zero
      FOOD[is.na(FOOD)] <- 0
      
      FOOD_R = FOOD
    } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 4 Food
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    
    else if(input$scenario == "Fuel Optimization"){
      names(food)[which(colnames(food)=="UVA_inventory")] = "inventory"
      names(food)[which(colnames(food)=="Food_category")] = "Category"
      
      food$Color_codes = str_remove(food$Color_codes, '#')
      food$Color_codes = as.character(paste0('#',food$Color_codes))
      
      food1 = food
      food2 = food
      
      # Add Projected category
      food1$Timeframe = 'Baseline'
      food2$Timeframe = 'Projected'
      
      # Get base value for reactive Projected
      f1 = food2[food2$Category == 'Spices',]$inventory
      f2 = food2[food2$Category == 'Sugars',]$inventory
      f3 = food2[food2$Category == 'Oils',]$inventory
      f4 = food2[food2$Category == 'Coffee and tea',]$inventory
      f5 = food2[food2$Category == 'Liquids',]$inventory
      f6 = food2[food2$Category == 'Nuts',]$inventory
      f7 = food2[food2$Category == 'Beans',]$inventory
      f8 = food2[food2$Category == 'Potatoes',]$inventory
      f9 = food2[food2$Category == 'Fruits',]$inventory
      f10 = food2[food2$Category == 'Vegetables',]$inventory
      f11 = food2[food2$Category == 'Grains',]$inventory
      f12 = food2[food2$Category == 'Eggs',]$inventory
      f13 = food2[food2$Category == 'Cheese',]$inventory
      f14 = food2[food2$Category == 'Milk',]$inventory
      f15 = food2[food2$Category == 'Fish',]$inventory
      f16 = food2[food2$Category == 'Chicken',]$inventory
      f17 = food2[food2$Category == 'Pork',]$inventory
      f18 = food2[food2$Category == 'Beef',]$inventory
      
      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      food2[food2$Category == 'Spices',]$inventory = f1* input$cat1e_proj*.01+f1
      food2[food2$Category == 'Sugars',]$inventory = f2* input$cat2e_proj*.01+f2
      food2[food2$Category == 'Oils',]$inventory = f3* input$cat3e_proj*.01+f3
      food2[food2$Category == 'Coffee and tea',]$inventory = f4* input$cat4e_proj*.01+f4
      food2[food2$Category == 'Liquids',]$inventory = f5* input$cat5e_proj*.01+f5
      food2[food2$Category == 'Nuts',]$inventory = f6* input$cat6e_proj*.01+f6
      food2[food2$Category == 'Beans',]$inventory = f7* input$cat7e_proj*.01+f7
      food2[food2$Category == 'Potatoes',]$inventory = f8* input$cat8e_proj*.01+f8
      food2[food2$Category == 'Fruits',]$inventory = f9* input$cat9e_proj*.01+f9
      food2[food2$Category == 'Vegetables',]$inventory = f10* input$cat10e_proj*.01+f10
      food2[food2$Category == 'Grains',]$inventory = f11* input$cat11e_proj*.01+f11
      food2[food2$Category == 'Eggs',]$inventory = f12* input$cat12e_proj*.01+f12
      food2[food2$Category == 'Cheese',]$inventory = f13* input$cat13e_proj*.01+f13
      food2[food2$Category == 'Milk',]$inventory = f14* input$cat14e_proj*.01+f14
      food2[food2$Category == 'Fish',]$inventory = f15* input$cat15e_proj*.01+f15
      food2[food2$Category == 'Chicken',]$inventory = f16* input$cat16e_proj*.01+f16
      food2[food2$Category == 'Pork',]$inventory = f17* input$cat17e_proj*.01+f17
      food2[food2$Category == 'Beef',]$inventory = f18* input$cat18e_proj*.01+f18
      
      FOOD = rbind(food1,food2)
      
      # Calculuations
      # Result units = kg eCO2
      # Carbon Footprint: (inventory unit e.g. kg) * (kg eCO2 / kg food)
      FOOD$C_Footprint = FOOD$inventory * FOOD$C_footprint_food
      
      # Result units = kg N
      # N food supply: (inventory unit e.g. kg) * N Conent is unitless?
      FOOD$N_food_supply = FOOD$inventory * FOOD$N_Content
      
      # Result units = kg N
      # Waste N:  Food_waste (Unitless - %) * (kg N)
      FOOD$N_waste = FOOD$Food_waste * FOOD$N_food_supply
      
      # Result units = kg N
      # Inventory unit (kg N) * (kg N loss / kg N food)
      FOOD$N_virtual = FOOD$N_food_supply * FOOD$Conventional_virtual_N_factor
      
      # N Footprint
      # Result units = kg N
      FOOD$N_Footprint = FOOD$N_waste + FOOD$N_virtual
      
      # P Footprint
      # Result units = kg P
      FOOD$P_Footprint = FOOD$inventory * FOOD$P_footprint_food
      
      # W Footprint
      # Result units = gallons water (264.172 gal/m3 * kg inventory * m3 water / MT food * 1 MT/1000 kg)
      FOOD$Blue_W_Footprint = 264.172*FOOD$inventory * FOOD$Blue_W_Footprint_food / 1000
      FOOD$Green_W_Footprint = 264.172*FOOD$inventory * FOOD$Green_W_Footprint_food / 1000
      FOOD$Grey_W_Footprint = 264.172*FOOD$inventory * FOOD$Grey_W_Footprint_food / 1000
      
      #food$Total_W_Footprint = food$Green_W_Footprint + food$Blue_W_Footprint + food$Grey_W_Footprint
      FOOD$B_Footprint = FOOD$Blue_W_Footprint
      FOOD$G_Footprint = FOOD$Green_W_Footprint
      FOOD$BG_Footprint = FOOD$Green_W_Footprint + FOOD$Blue_W_Footprint
      
      # Convert values with na to zero
      FOOD[is.na(FOOD)] <- 0
      
      FOOD_R = FOOD
    } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 5 Food
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    
    else if(input$scenario == "Implementing All Scenarios"){
      names(food)[which(colnames(food)=="UVA_inventory")] = "inventory"
      names(food)[which(colnames(food)=="Food_category")] = "Category"
      
      food$Color_codes = str_remove(food$Color_codes, '#')
      food$Color_codes = as.character(paste0('#',food$Color_codes))
      
      food1 = food
      food2 = food
      
      # Add Projected category
      food1$Timeframe = 'Baseline'
      food2$Timeframe = 'Projected'
      
      # Get base value for reactive Projected
      f1 = food2[food2$Category == 'Spices',]$inventory
      f2 = food2[food2$Category == 'Sugars',]$inventory
      f3 = food2[food2$Category == 'Oils',]$inventory
      f4 = food2[food2$Category == 'Coffee and tea',]$inventory
      f5 = food2[food2$Category == 'Liquids',]$inventory
      f6 = food2[food2$Category == 'Nuts',]$inventory
      f7 = food2[food2$Category == 'Beans',]$inventory
      f8 = food2[food2$Category == 'Potatoes',]$inventory
      f9 = food2[food2$Category == 'Fruits',]$inventory
      f10 = food2[food2$Category == 'Vegetables',]$inventory
      f11 = food2[food2$Category == 'Grains',]$inventory
      f12 = food2[food2$Category == 'Eggs',]$inventory
      f13 = food2[food2$Category == 'Cheese',]$inventory
      f14 = food2[food2$Category == 'Milk',]$inventory
      f15 = food2[food2$Category == 'Fish',]$inventory
      f16 = food2[food2$Category == 'Chicken',]$inventory
      f17 = food2[food2$Category == 'Pork',]$inventory
      f18 = food2[food2$Category == 'Beef',]$inventory
      
      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      food2[food2$Category == 'Spices',]$inventory = f1* input$cat1f_proj*.01+f1
      food2[food2$Category == 'Sugars',]$inventory = f2* input$cat2f_proj*.01+f2
      food2[food2$Category == 'Oils',]$inventory = f3* input$cat3f_proj*.01+f3
      food2[food2$Category == 'Coffee and tea',]$inventory = f4* input$cat4f_proj*.01+f4
      food2[food2$Category == 'Liquids',]$inventory = f5* input$cat5f_proj*.01+f5
      food2[food2$Category == 'Nuts',]$inventory = f6* input$cat6f_proj*.01+f6
      food2[food2$Category == 'Beans',]$inventory = f7* input$cat7f_proj*.01+f7
      food2[food2$Category == 'Potatoes',]$inventory = f8* input$cat8f_proj*.01+f8
      food2[food2$Category == 'Fruits',]$inventory = f9* input$cat9f_proj*.01+f9
      food2[food2$Category == 'Vegetables',]$inventory = f10* input$cat10f_proj*.01+f10
      food2[food2$Category == 'Grains',]$inventory = f11* input$cat11f_proj*.01+f11
      food2[food2$Category == 'Eggs',]$inventory = f12* input$cat12f_proj*.01+f12
      food2[food2$Category == 'Cheese',]$inventory = f13* input$cat13f_proj*.01+f13
      food2[food2$Category == 'Milk',]$inventory = f14* input$cat14f_proj*.01+f14
      food2[food2$Category == 'Fish',]$inventory = f15* input$cat15f_proj*.01+f15
      food2[food2$Category == 'Chicken',]$inventory = f16* input$cat16f_proj*.01+f16
      food2[food2$Category == 'Pork',]$inventory = f17* input$cat17f_proj*.01+f17
      food2[food2$Category == 'Beef',]$inventory = f18* input$cat18f_proj*.01+f18
      
      FOOD = rbind(food1,food2)
      
      # Calculuations
      # Result units = kg eCO2
      # Carbon Footprint: (inventory unit e.g. kg) * (kg eCO2 / kg food)
      FOOD$C_Footprint = FOOD$inventory * FOOD$C_footprint_food
      
      # Result units = kg N
      # N food supply: (inventory unit e.g. kg) * N Conent is unitless?
      FOOD$N_food_supply = FOOD$inventory * FOOD$N_Content
      
      # Result units = kg N
      # Waste N:  Food_waste (Unitless - %) * (kg N)
      FOOD$N_waste = FOOD$Food_waste * FOOD$N_food_supply
      
      # Result units = kg N
      # Inventory unit (kg N) * (kg N loss / kg N food)
      FOOD$N_virtual = FOOD$N_food_supply * FOOD$Conventional_virtual_N_factor
      
      # N Footprint
      # Result units = kg N
      FOOD$N_Footprint = FOOD$N_waste + FOOD$N_virtual
      
      # P Footprint
      # Result units = kg P
      FOOD$P_Footprint = FOOD$inventory * FOOD$P_footprint_food
      
      # W Footprint
      # Result units = gallons water (264.172 gal/m3 * kg inventory * m3 water / MT food * 1 MT/1000 kg)
      FOOD$Blue_W_Footprint = 264.172*FOOD$inventory * FOOD$Blue_W_Footprint_food / 1000
      FOOD$Green_W_Footprint = 264.172*FOOD$inventory * FOOD$Green_W_Footprint_food / 1000
      FOOD$Grey_W_Footprint = 264.172*FOOD$inventory * FOOD$Grey_W_Footprint_food / 1000
      
      #food$Total_W_Footprint = food$Green_W_Footprint + food$Blue_W_Footprint + food$Grey_W_Footprint
      FOOD$B_Footprint = FOOD$Blue_W_Footprint
      FOOD$G_Footprint = FOOD$Green_W_Footprint
      FOOD$BG_Footprint = FOOD$Green_W_Footprint + FOOD$Blue_W_Footprint
      
      # Convert values with na to zero
      FOOD[is.na(FOOD)] <- 0
      
      FOOD_R = FOOD
    } # Scenario
    
    
  }) # reactive
  
  
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  # STEP_5 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  #*****************************************************************************************************
  # Carbon Reactive
  #*****************************************************************************************************
  
  Carbon_R <- reactive({
    
    # # Campus Vs. Individual
    # if(input$campusVindividual == "Campus"){
    #   uva = uva_R()
    #   food = food
    # }
    # 
    # else if(input$campusVindividual == "Individual"){
    #   uva = uva_individual
    #   food = food_individual
    # }
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 0 Carbon
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    if(input$scenario == "Manual Scenario"){
    # Projected 1 (each variable changes differently)
    sectr1 = 'Purchased Electricity'
    sectr2 = 'Food'
    sectr3 = 'On-Campus Stationary Sources'
    sectr4 = 'Direct Transportation Sources'
    sectr5 = 'Commuting'
    sectr6 = 'Agriculture Sources'
    sectr7 = 'Refrigerants & Chemicals'
    sectr8 = 'Wastewater'
    sectr9 = 'Direct Water Use'
    
    uva1 = uva_R()
    uva2 = uva_R()
    
    # Add Projected category
    uva1$Timeframe = 'Baseline'
    uva2$Timeframe = 'Projected'
    
    # This reactive part is for all categories except Energy, Commuting, and Food
    # Gives the baseline/Baseline value
    b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
    b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
    b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
    b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
    b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
    b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
    b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
    b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
    b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
    b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
    b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
    #b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory
    
    # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
    uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
      b1 * input$sctr1a_proj*.01+b1
    uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
      b2 * input$sctr4a_proj*.01+b2
    uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
      b3 * input$sctr4a_proj*.01+b3
    uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
      b4 * input$sctr4a_proj*.01+b4
    uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
      b5 * input$sctr4a_proj*.01+b5
    uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
      b6 * input$sctr6a_proj*.01+b6
    uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
      b7 * input$sctr7a_proj*.01+b7
    uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
      b8 * input$sctr7a_proj*.01+b8
    uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
      b9 * input$sctr7a_proj*.01+b9
    uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
      b10 * input$sctr7a_proj*.01+b10
    uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
      b11 * input$sctr8a_proj*.01+b11
    # uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory = 
    #   b12 * input$sctr9a_proj*.01+b12
    
    
    COMBO = rbind(uva1,uva2)
    
    # sum(COMBO[COMBO$Category == 'Commuting' & COMBO$Timeframe == 'Baseline',]$inventory)
    
    #CARBON_____________________________________________________________________
    # Result units = kg CO2
    # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
    COMBO$CO2_r = COMBO$inventory * COMBO$CO2.EF
    
    # Result units = kg eCO2
    # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
    COMBO$eCO2_r = COMBO$inventory * COMBO$eCO2.EF
    
    # Result units = kg CH4
    # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
    COMBO$CH4_r = COMBO$inventory * COMBO$CH4.EF
    
    #NITROGEN_____________________________________________________________________
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMBO$N2O_r = COMBO$inventory * COMBO$N2O.EF
    
    # Result units = kg NOx
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMBO$NOx_r = COMBO$inventory * COMBO$NOx.EF
    
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMBO$OtherN_r = COMBO$inventory * COMBO$Other.N.EF
    
    #INTERMEDIATE C & N _______________________________________________________________
    
    # calculate Footprints by category (divide by 1000 to convert from kg to MT)
    # Units of GWP 
    COMBO$CO2_MTCDE = COMBO$CO2_r/1000  # MT CO2e
    COMBO$eCO2_MTCDE = COMBO$eCO2_r/1000 # MT CO2e
    COMBO$CH4_MTCDE = COMBO$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
    COMBO$N2O_MTCDE = COMBO$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
    
    # Calculations only for refrigerants and chemicals for Carbon
    # inventory (kg) * GWP (Unitless??) / 1000 = MT CO2e
    COMBO$Ref_Chem[COMBO$Source=='HCFC-22'] = COMBO[COMBO$Source=='HCFC-22',]$inventory * gwp[gwp$Pollutant=='HCFC-22',]$GWP/1000 # MT CO2e
    COMBO$Ref_Chem[COMBO$Source=='HCFE-235da2'] = COMBO[COMBO$Source=='HCFE-235da2',]$inventory * gwp[gwp$Pollutant=='HCFE-235da2',]$GWP/1000 # MT CO2e
    COMBO$Ref_Chem[COMBO$Source=='HFC-134a'] = COMBO[COMBO$Source=='HFC-134a',]$inventory * gwp[gwp$Pollutant=='HFC-134a',]$GWP/1000 # MT CO2e
    COMBO$Ref_Chem[COMBO$Source=='HG-10'] = COMBO[COMBO$Source=='HG-10',]$inventory * gwp[gwp$Pollutant=='HG-10',]$GWP/1000 # MT CO2e
    #COMBO$Ref_Chem[COMBO$Source=='Other'] = COMBO[COMBO$Source=='Other',]$inventory * gwp[gwp$Pollutant=='Other',]$GWP/1000 # MT CO2e
    COMBO$Ref_Chem[COMBO$Source=='R-404a'] = COMBO[COMBO$Source=='R-404a',]$inventory * gwp[gwp$Pollutant=='R-404a',]$GWP/1000 # MT CO2e
    
    
    #*****************************************************************************************************
    # FOOTPRINT Calculations
    #*****************************************************************************************************
    
    # CALCULATING FOOTPRINT C_____________________________________________________________________
    # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
    COMBO$C_Footprint = rowSums(COMBO[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE','Ref_Chem')],na.rm=T) 
    
    
    #*****************************************************************************************************
    # FOOTPRINT DATA OUTPUT
    #*****************************************************************************************************
    
    # Summarize by Category___________________________________________________________________________
    # Units are MT C, MT N, MT P, Gallons Water 
    
    COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
      group_by(Category) %>% 
      summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T))
    COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
      group_by(Category) %>% 
      summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T)) 
    
    COMBO1$Timeframe = 'Baseline'
    COMBO2$Timeframe = 'Projected'
    
    
    #*****************************************************************************************************
    # ADD FOOD ONTO FOOTPRINT Calculations
    #*****************************************************************************************************
    
    # Calculate total food footprints (original units = kg for C,N,P or gal for water)
    # final units = MT (Metric Tons)
    
    # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
    # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
    food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    
    C_food_footprint1 = sum(food1_$C_footprint,na.rm=T)/1000 # convert to MT from kg
    C_food_footprint2 = sum(food2_$C_footprint,na.rm=T)/1000 # convert to MT from kg
    
    #Make a new 1 row dataframe 
    C_food_rw1 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint1)
    C_food_rw2 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint2)
    
    C_food_rw1$Timeframe = 'Baseline'
    C_food_rw2$Timeframe = 'Projected'
    
    # add on the food row
    COMBO_foot1 = rbind(COMBO1,C_food_rw1)
    COMBO_foot2 = rbind(COMBO2,C_food_rw2)
    
    COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
    
    # Rearrange the rows to match the slider rows
    Carbon_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                     COMBO_foot[COMBO_foot$Category=='Food',],
                     COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                     COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                     COMBO_foot[COMBO_foot$Category=='Commuting',],
                     #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                     COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                     COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                     COMBO_foot[COMBO_foot$Category=='Wastewater',],
                     COMBO_foot[COMBO_foot$Category=='Direct Water Use',])
  
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 1 Carbon
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    
    else if(input$scenario == "Business as Usual Growth to 2025"){  
      # Projected 1 (each variable changes differently)
      sectr1 = 'Purchased Electricity'
    sectr2 = 'Food'
    sectr3 = 'On-Campus Stationary Sources'
    sectr4 = 'Direct Transportation Sources'
    sectr5 = 'Commuting'
    sectr6 = 'Agriculture Sources'
    sectr7 = 'Refrigerants & Chemicals'
    sectr8 = 'Wastewater'
    sectr9 = 'Direct Water Use'
    
    uva1 = uva_R
    uva2 = uva_R
    
    # Add Projected category
    uva1$Timeframe = 'Baseline'
    uva2$Timeframe = 'Projected'
    
    # This reactive part is for all categories except Energy, Commuting, and Food
    # Gives the baseline value
    b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
    b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
    b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
    b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
    b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
    b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
    b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
    b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
    b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
    b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
    b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
    #b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory
    
    # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
    uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
      b1 * input$sctr1b_proj*.01+b1
    uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
      b2 * input$sctr4b_proj*.01+b2
    uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
      b3 * input$sctr4b_proj*.01+b3
    uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
      b4 * input$sctr4b_proj*.01+b4
    uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
      b5 * input$sctr4b_proj*.01+b5
    uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
      b6 * input$sctr6b_proj*.01+b6
    uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
      b7 * input$sctr7b_proj*.01+b7
    uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
      b8 * input$sctr7b_proj*.01+b8
    uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
      b9 * input$sctr7b_proj*.01+b9
    uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
      b10 * input$sctr7b_proj*.01+b10
    uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
      b11 * input$sctr8b_proj*.01+b11
    # uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory = 
    #   b12 * input$sctr9b_proj*.01+b12
    
    
    COMBO = rbind(uva1,uva2)
    
    # sum(COMBO[COMBO$Category == 'Commuting' & COMBO$Timeframe == 'Baseline',]$inventory)
    
    #CARBON_____________________________________________________________________
    # Result units = kg CO2
    # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
    COMBO$CO2_r = COMBO$inventory * COMBO$CO2.EF
    
    # Result units = kg eCO2
    # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
    COMBO$eCO2_r = COMBO$inventory * COMBO$eCO2.EF
    
    # Result units = kg CH4
    # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
    COMBO$CH4_r = COMBO$inventory * COMBO$CH4.EF
    
    #NITROGEN_____________________________________________________________________
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMBO$N2O_r = COMBO$inventory * COMBO$N2O.EF
    
    # Result units = kg NOx
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMBO$NOx_r = COMBO$inventory * COMBO$NOx.EF
    
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMBO$OtherN_r = COMBO$inventory * COMBO$Other.N.EF
    
    #INTERMEDIATE C & N _______________________________________________________________
    
    # calculate Footprints by category (divide by 1000 to convert from kg to MT)
    # Units of GWP 
    COMBO$CO2_MTCDE = COMBO$CO2_r/1000  # MT CO2e
    COMBO$eCO2_MTCDE = COMBO$eCO2_r/1000 # MT CO2e
    COMBO$CH4_MTCDE = COMBO$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
    COMBO$N2O_MTCDE = COMBO$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
    
    # Calculations only for refrigerants and chemicals for Carbon
    # inventory (kg) * GWP (Unitless??) / 1000 = MT CO2e
    COMBO$Ref_Chem[COMBO$Source=='HCFC-22'] = COMBO[COMBO$Source=='HCFC-22',]$inventory * gwp[gwp$Pollutant=='HCFC-22',]$GWP/1000 # MT CO2e
    COMBO$Ref_Chem[COMBO$Source=='HCFE-235da2'] = COMBO[COMBO$Source=='HCFE-235da2',]$inventory * gwp[gwp$Pollutant=='HCFE-235da2',]$GWP/1000 # MT CO2e
    COMBO$Ref_Chem[COMBO$Source=='HFC-134a'] = COMBO[COMBO$Source=='HFC-134a',]$inventory * gwp[gwp$Pollutant=='HFC-134a',]$GWP/1000 # MT CO2e
    COMBO$Ref_Chem[COMBO$Source=='HG-10'] = COMBO[COMBO$Source=='HG-10',]$inventory * gwp[gwp$Pollutant=='HG-10',]$GWP/1000 # MT CO2e
    #COMBO$Ref_Chem[COMBO$Source=='Other'] = COMBO[COMBO$Source=='Other',]$inventory * gwp[gwp$Pollutant=='Other',]$GWP/1000 # MT CO2e
    COMBO$Ref_Chem[COMBO$Source=='R-404a'] = COMBO[COMBO$Source=='R-404a',]$inventory * gwp[gwp$Pollutant=='R-404a',]$GWP/1000 # MT CO2e
    
    
    #*****************************************************************************************************
    # FOOTPRINT Calculations
    #*****************************************************************************************************
    
    # CALCULATING FOOTPRINT C_____________________________________________________________________
    # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
    COMBO$C_Footprint = rowSums(COMBO[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE','Ref_Chem')],na.rm=T) 
    
    #*****************************************************************************************************
    # FOOTPRINT DATA OUTPUT
    #*****************************************************************************************************
    
    # Summarize by Category___________________________________________________________________________
    # Units are MT C, MT N, MT P, Gallons Water 
    
    COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
      group_by(Category) %>% 
      summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T))
    COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
      group_by(Category) %>% 
      summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T)) 
    
    COMBO1$Timeframe = 'Baseline'
    COMBO2$Timeframe = 'Projected'
    
    #*****************************************************************************************************
    # ADD FOOD ONTO FOOTPRINT Calculations
    #*****************************************************************************************************
    
    # Calculate total food footprints (original units = kg for C,N,P or gal for water)
    # final units = MT (Metric Tons)
    
    # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
    # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
    food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    
    C_food_footprint1 = sum(food1_$C_footprint,na.rm=T)/1000 # convert to MT from kg
    C_food_footprint2 = sum(food2_$C_footprint,na.rm=T)/1000 # convert to MT from kg
    
    #Make a new 1 row dataframe 
    C_food_rw1 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint1)
    C_food_rw2 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint2)
    
    C_food_rw1$Timeframe = 'Baseline'
    C_food_rw2$Timeframe = 'Projected'
    
    # add on the food row
    COMBO_foot1 = rbind(COMBO1,C_food_rw1)
    COMBO_foot2 = rbind(COMBO2,C_food_rw2)
    
    COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
    
    # Rearrange the rows to match the slider rows
    Carbon_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                     COMBO_foot[COMBO_foot$Category=='Food',],
                     COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                     COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                     COMBO_foot[COMBO_foot$Category=='Commuting',],
                     #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                     COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                     COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                     COMBO_foot[COMBO_foot$Category=='Wastewater',],
                     COMBO_foot[COMBO_foot$Category=='Direct Water Use',])
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 2 Carbon 
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    
    else if(input$scenario == "15% Vegetarian Meals"){  
      # Projected 1 (each variable changes differently)
      sectr1 = 'Purchased Electricity'
      sectr2 = 'Food'
      sectr3 = 'On-Campus Stationary Sources'
      sectr4 = 'Direct Transportation Sources'
      sectr5 = 'Commuting'
      sectr6 = 'Agriculture Sources'
      sectr7 = 'Refrigerants & Chemicals'
      sectr8 = 'Wastewater'
      sectr9 = 'Direct Water Use'
      
      uva1 = uva_R
      uva2 = uva_R
      
      # Add Projected category
      uva1$Timeframe = 'Baseline'
      uva2$Timeframe = 'Projected'
      
      # This reactive part is for all categories except Energy, Commuting, and Food
      # Gives the baseline value
      b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
      b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
      b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
      b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
      b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
      b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
      b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
      b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
      b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
      b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
      b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
      #b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory
      
      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
        b1 * input$sctr1c_proj*.01+b1
      uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
        b2 * input$sctr4c_proj*.01+b2
      uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
        b3 * input$sctr4c_proj*.01+b3
      uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
        b4 * input$sctr4c_proj*.01+b4
      uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
        b5 * input$sctr4c_proj*.01+b5
      uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
        b6 * input$sctr6c_proj*.01+b6
      uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
        b7 * input$sctr7c_proj*.01+b7
      uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
        b8 * input$sctr7c_proj*.01+b8
      uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
        b9 * input$sctr7c_proj*.01+b9
      uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
        b10 * input$sctr7c_proj*.01+b10
      uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
        b11 * input$sctr8c_proj*.01+b11
      # uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory = 
      #   b12 * input$sctr9c_proj*.01+b12
      
      
      COMBO = rbind(uva1,uva2)
      
      # sum(COMBO[COMBO$Category == 'Commuting' & COMBO$Timeframe == 'Baseline',]$inventory)
      
      #CARBON_____________________________________________________________________
      # Result units = kg CO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
      COMBO$CO2_r = COMBO$inventory * COMBO$CO2.EF
      
      # Result units = kg eCO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
      COMBO$eCO2_r = COMBO$inventory * COMBO$eCO2.EF
      
      # Result units = kg CH4
      # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
      COMBO$CH4_r = COMBO$inventory * COMBO$CH4.EF
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$N2O_r = COMBO$inventory * COMBO$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$NOx_r = COMBO$inventory * COMBO$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$OtherN_r = COMBO$inventory * COMBO$Other.N.EF
      
      #INTERMEDIATE C & N _______________________________________________________________
      
      # calculate Footprints by category (divide by 1000 to convert from kg to MT)
      # Units of GWP 
      COMBO$CO2_MTCDE = COMBO$CO2_r/1000  # MT CO2e
      COMBO$eCO2_MTCDE = COMBO$eCO2_r/1000 # MT CO2e
      COMBO$CH4_MTCDE = COMBO$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
      COMBO$N2O_MTCDE = COMBO$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
      
      # Calculations only for refrigerants and chemicals for Carbon
      # inventory (kg) * GWP (Unitless??) / 1000 = MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HCFC-22'] = COMBO[COMBO$Source=='HCFC-22',]$inventory * gwp[gwp$Pollutant=='HCFC-22',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HCFE-235da2'] = COMBO[COMBO$Source=='HCFE-235da2',]$inventory * gwp[gwp$Pollutant=='HCFE-235da2',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HFC-134a'] = COMBO[COMBO$Source=='HFC-134a',]$inventory * gwp[gwp$Pollutant=='HFC-134a',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HG-10'] = COMBO[COMBO$Source=='HG-10',]$inventory * gwp[gwp$Pollutant=='HG-10',]$GWP/1000 # MT CO2e
      #COMBO$Ref_Chem[COMBO$Source=='Other'] = COMBO[COMBO$Source=='Other',]$inventory * gwp[gwp$Pollutant=='Other',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='R-404a'] = COMBO[COMBO$Source=='R-404a',]$inventory * gwp[gwp$Pollutant=='R-404a',]$GWP/1000 # MT CO2e
      
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C_____________________________________________________________________
      # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
      COMBO$C_Footprint = rowSums(COMBO[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE','Ref_Chem')],na.rm=T) 
      
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
        group_by(Category) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T))
      COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
        group_by(Category) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T)) 
      
      COMBO1$Timeframe = 'Baseline'
      COMBO2$Timeframe = 'Projected'
      
      #*****************************************************************************************************
      # ADD FOOD ONTO FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # Calculate total food footprints (original units = kg for C,N,P or gal for water)
      # final units = MT (Metric Tons)
      
      # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
      # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
      food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
      food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
      
      C_food_footprint1 = sum(food1_$C_footprint,na.rm=T)/1000 # convert to MT from kg
      C_food_footprint2 = sum(food2_$C_footprint,na.rm=T)/1000 # convert to MT from kg
      
      #Make a new 1 row dataframe 
      C_food_rw1 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint1)
      C_food_rw2 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint2)
      
      C_food_rw1$Timeframe = 'Baseline'
      C_food_rw2$Timeframe = 'Projected'
      
      # add on the food row
      COMBO_foot1 = rbind(COMBO1,C_food_rw1)
      COMBO_foot2 = rbind(COMBO2,C_food_rw2)
      
      COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
      
      # Rearrange the rows to match the slider rows
      Carbon_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                       COMBO_foot[COMBO_foot$Category=='Food',],
                       COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                       COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                       COMBO_foot[COMBO_foot$Category=='Commuting',],
                       #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                       COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                       COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                       COMBO_foot[COMBO_foot$Category=='Wastewater',],
                       COMBO_foot[COMBO_foot$Category=='Direct Water Use',])
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 3 Carbon
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    
    else if(input$scenario == "Replacement of 20% beef with Chicken"){  
      # Projected 1 (each variable changes differently)
      sectr1 = 'Purchased Electricity'
      sectr2 = 'Food'
      sectr3 = 'On-Campus Stationary Sources'
      sectr4 = 'Direct Transportation Sources'
      sectr5 = 'Commuting'
      sectr6 = 'Agriculture Sources'
      sectr7 = 'Refrigerants & Chemicals'
      sectr8 = 'Wastewater'
      sectr9 = 'Direct Water Use'
      
      uva1 = uva_R
      uva2 = uva_R
      
      # Add Projected category
      uva1$Timeframe = 'Baseline'
      uva2$Timeframe = 'Projected'
      
      # This reactive part is for all categories except Energy, Commuting, and Food
      # Gives the baseline value
      b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
      b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
      b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
      b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
      b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
      b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
      b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
      b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
      b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
      b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
      b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
      #b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory
      
      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
        b1 * input$sctr1d_proj*.01+b1
      uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
        b2 * input$sctr4d_proj*.01+b2
      uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
        b3 * input$sctr4d_proj*.01+b3
      uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
        b4 * input$sctr4d_proj*.01+b4
      uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
        b5 * input$sctr4d_proj*.01+b5
      uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
        b6 * input$sctr6d_proj*.01+b6
      uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
        b7 * input$sctr7d_proj*.01+b7
      uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
        b8 * input$sctr7d_proj*.01+b8
      uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
        b9 * input$sctr7d_proj*.01+b9
      uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
        b10 * input$sctr7d_proj*.01+b10
      uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
        b11 * input$sctr8d_proj*.01+b11
      # uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory = 
      #   b12 * input$sctr9d_proj*.01+b12
      
      
      COMBO = rbind(uva1,uva2)
      
      # sum(COMBO[COMBO$Category == 'Commuting' & COMBO$Timeframe == 'Baseline',]$inventory)
      
      #CARBON_____________________________________________________________________
      # Result units = kg CO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
      COMBO$CO2_r = COMBO$inventory * COMBO$CO2.EF
      
      # Result units = kg eCO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
      COMBO$eCO2_r = COMBO$inventory * COMBO$eCO2.EF
      
      # Result units = kg CH4
      # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
      COMBO$CH4_r = COMBO$inventory * COMBO$CH4.EF
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$N2O_r = COMBO$inventory * COMBO$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$NOx_r = COMBO$inventory * COMBO$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$OtherN_r = COMBO$inventory * COMBO$Other.N.EF
      
      #INTERMEDIATE C & N _______________________________________________________________
      
      # calculate Footprints by category (divide by 1000 to convert from kg to MT)
      # Units of GWP 
      COMBO$CO2_MTCDE = COMBO$CO2_r/1000  # MT CO2e
      COMBO$eCO2_MTCDE = COMBO$eCO2_r/1000 # MT CO2e
      COMBO$CH4_MTCDE = COMBO$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
      COMBO$N2O_MTCDE = COMBO$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
      
      # Calculations only for refrigerants and chemicals for Carbon
      # inventory (kg) * GWP (Unitless??) / 1000 = MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HCFC-22'] = COMBO[COMBO$Source=='HCFC-22',]$inventory * gwp[gwp$Pollutant=='HCFC-22',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HCFE-235da2'] = COMBO[COMBO$Source=='HCFE-235da2',]$inventory * gwp[gwp$Pollutant=='HCFE-235da2',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HFC-134a'] = COMBO[COMBO$Source=='HFC-134a',]$inventory * gwp[gwp$Pollutant=='HFC-134a',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HG-10'] = COMBO[COMBO$Source=='HG-10',]$inventory * gwp[gwp$Pollutant=='HG-10',]$GWP/1000 # MT CO2e
      #COMBO$Ref_Chem[COMBO$Source=='Other'] = COMBO[COMBO$Source=='Other',]$inventory * gwp[gwp$Pollutant=='Other',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='R-404a'] = COMBO[COMBO$Source=='R-404a',]$inventory * gwp[gwp$Pollutant=='R-404a',]$GWP/1000 # MT CO2e
      
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C_____________________________________________________________________
      # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
      COMBO$C_Footprint = rowSums(COMBO[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE','Ref_Chem')],na.rm=T) 
      
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
        group_by(Category) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T))
      COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
        group_by(Category) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T)) 
      
      COMBO1$Timeframe = 'Baseline'
      COMBO2$Timeframe = 'Projected'
      
      #*****************************************************************************************************
      # ADD FOOD ONTO FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # Calculate total food footprints (original units = kg for C,N,P or gal for water)
      # final units = MT (Metric Tons)
      
      # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
      # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
      food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
      food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
      
      C_food_footprint1 = sum(food1_$C_footprint,na.rm=T)/1000 # convert to MT from kg
      C_food_footprint2 = sum(food2_$C_footprint,na.rm=T)/1000 # convert to MT from kg
      
      #Make a new 1 row dataframe 
      C_food_rw1 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint1)
      C_food_rw2 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint2)
      
      C_food_rw1$Timeframe = 'Baseline'
      C_food_rw2$Timeframe = 'Projected'
      
      # add on the food row
      COMBO_foot1 = rbind(COMBO1,C_food_rw1)
      COMBO_foot2 = rbind(COMBO2,C_food_rw2)
      
      COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
      
      # Rearrange the rows to match the slider rows
      Carbon_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                       COMBO_foot[COMBO_foot$Category=='Food',],
                       COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                       COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                       COMBO_foot[COMBO_foot$Category=='Commuting',],
                       #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                       COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                       COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                       COMBO_foot[COMBO_foot$Category=='Wastewater',],
                       COMBO_foot[COMBO_foot$Category=='Direct Water Use',])
    } # Scenario  
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 4 Carbon
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    
    else if(input$scenario == "Fuel Optimization"){  
      # Projected 1 (each variable changes differently)
      sectr1 = 'Purchased Electricity'
      sectr2 = 'Food'
      sectr3 = 'On-Campus Stationary Sources'
      sectr4 = 'Direct Transportation Sources'
      sectr5 = 'Commuting'
      sectr6 = 'Agriculture Sources'
      sectr7 = 'Refrigerants & Chemicals'
      sectr8 = 'Wastewater'
      sectr9 = 'Direct Water Use'
      
      uva1 = uva_R
      uva2 = uva_R
      
      # Add Projected category
      uva1$Timeframe = 'Baseline'
      uva2$Timeframe = 'Projected'
      
      # This reactive part is for all categories except Energy, Commuting, and Food
      # Gives the baseline value
      b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
      b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
      b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
      b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
      b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
      b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
      b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
      b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
      b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
      b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
      b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
      #b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory
      
      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
        b1 * input$sctr1e_proj*.01+b1
      uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
        b2 * input$sctr4e_proj*.01+b2
      uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
        b3 * input$sctr4e_proj*.01+b3
      uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
        b4 * input$sctr4e_proj*.01+b4
      uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
        b5 * input$sctr4e_proj*.01+b5
      uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
        b6 * input$sctr6e_proj*.01+b6
      uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
        b7 * input$sctr7e_proj*.01+b7
      uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
        b8 * input$sctr7e_proj*.01+b8
      uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
        b9 * input$sctr7e_proj*.01+b9
      uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
        b10 * input$sctr7e_proj*.01+b10
      uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
        b11 * input$sctr8e_proj*.01+b11
      # uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory = 
      #   b12 * input$sctr9e_proj*.01+b12
      
      
      COMBO = rbind(uva1,uva2)
      
      # sum(COMBO[COMBO$Category == 'Commuting' & COMBO$Timeframe == 'Baseline',]$inventory)
      
      #CARBON_____________________________________________________________________
      # Result units = kg CO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
      COMBO$CO2_r = COMBO$inventory * COMBO$CO2.EF
      
      # Result units = kg eCO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
      COMBO$eCO2_r = COMBO$inventory * COMBO$eCO2.EF
      
      # Result units = kg CH4
      # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
      COMBO$CH4_r = COMBO$inventory * COMBO$CH4.EF
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$N2O_r = COMBO$inventory * COMBO$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$NOx_r = COMBO$inventory * COMBO$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$OtherN_r = COMBO$inventory * COMBO$Other.N.EF
      
      #INTERMEDIATE C & N _______________________________________________________________
      
      # calculate Footprints by category (divide by 1000 to convert from kg to MT)
      # Units of GWP 
      COMBO$CO2_MTCDE = COMBO$CO2_r/1000  # MT CO2e
      COMBO$eCO2_MTCDE = COMBO$eCO2_r/1000 # MT CO2e
      COMBO$CH4_MTCDE = COMBO$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
      COMBO$N2O_MTCDE = COMBO$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
      
      # Calculations only for refrigerants and chemicals for Carbon
      # inventory (kg) * GWP (Unitless??) / 1000 = MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HCFC-22'] = COMBO[COMBO$Source=='HCFC-22',]$inventory * gwp[gwp$Pollutant=='HCFC-22',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HCFE-235da2'] = COMBO[COMBO$Source=='HCFE-235da2',]$inventory * gwp[gwp$Pollutant=='HCFE-235da2',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HFC-134a'] = COMBO[COMBO$Source=='HFC-134a',]$inventory * gwp[gwp$Pollutant=='HFC-134a',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HG-10'] = COMBO[COMBO$Source=='HG-10',]$inventory * gwp[gwp$Pollutant=='HG-10',]$GWP/1000 # MT CO2e
      #COMBO$Ref_Chem[COMBO$Source=='Other'] = COMBO[COMBO$Source=='Other',]$inventory * gwp[gwp$Pollutant=='Other',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='R-404a'] = COMBO[COMBO$Source=='R-404a',]$inventory * gwp[gwp$Pollutant=='R-404a',]$GWP/1000 # MT CO2e
      
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C_____________________________________________________________________
      # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
      COMBO$C_Footprint = rowSums(COMBO[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE','Ref_Chem')],na.rm=T) 
      
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
        group_by(Category) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T))
      COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
        group_by(Category) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T)) 
      
      COMBO1$Timeframe = 'Baseline'
      COMBO2$Timeframe = 'Projected'
      
      #*****************************************************************************************************
      # ADD FOOD ONTO FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # Calculate total food footprints (original units = kg for C,N,P or gal for water)
      # final units = MT (Metric Tons)
      
      # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
      # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
      food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
      food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
      
      C_food_footprint1 = sum(food1_$C_footprint,na.rm=T)/1000 # convert to MT from kg
      C_food_footprint2 = sum(food2_$C_footprint,na.rm=T)/1000 # convert to MT from kg
      
      #Make a new 1 row dataframe 
      C_food_rw1 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint1)
      C_food_rw2 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint2)
      
      C_food_rw1$Timeframe = 'Baseline'
      C_food_rw2$Timeframe = 'Projected'
      
      # add on the food row
      COMBO_foot1 = rbind(COMBO1,C_food_rw1)
      COMBO_foot2 = rbind(COMBO2,C_food_rw2)
      
      COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
      
      # Rearrange the rows to match the slider rows
      Carbon_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                       COMBO_foot[COMBO_foot$Category=='Food',],
                       COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                       COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                       COMBO_foot[COMBO_foot$Category=='Commuting',],
                       #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                       COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                       COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                       COMBO_foot[COMBO_foot$Category=='Wastewater',],
                       COMBO_foot[COMBO_foot$Category=='Direct Water Use',])
    } # Scenario  
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 5 Carbon
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    
    else if(input$scenario == "Implementing All Scenarios"){  
      # Projected 1 (each variable changes differently)
      sectr1 = 'Purchased Electricity'
      sectr2 = 'Food'
      sectr3 = 'On-Campus Stationary Sources'
      sectr4 = 'Direct Transportation Sources'
      sectr5 = 'Commuting'
      sectr6 = 'Agriculture Sources'
      sectr7 = 'Refrigerants & Chemicals'
      sectr8 = 'Wastewater'
      sectr9 = 'Direct Water Use'
      
      uva1 = uva_R
      uva2 = uva_R
      
      # Add Projected category
      uva1$Timeframe = 'Baseline'
      uva2$Timeframe = 'Projected'
      
      # This reactive part is for all categories except Energy, Commuting, and Food
      # Gives the baseline value
      b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
      b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
      b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
      b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
      b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
      b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
      b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
      b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
      b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
      b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
      b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
      #b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory
      
      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
        b1 * input$sctr1f_proj*.01+b1
      uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
        b2 * input$sctr4f_proj*.01+b2
      uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
        b3 * input$sctr4f_proj*.01+b3
      uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
        b4 * input$sctr4f_proj*.01+b4
      uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
        b5 * input$sctr4f_proj*.01+b5
      uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
        b6 * input$sctr6f_proj*.01+b6
      uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
        b7 * input$sctr7f_proj*.01+b7
      uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
        b8 * input$sctr7f_proj*.01+b8
      uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
        b9 * input$sctr7f_proj*.01+b9
      uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
        b10 * input$sctr7f_proj*.01+b10
      uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
        b11 * input$sctr8f_proj*.01+b11
      # uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory = 
      #   b12 * input$sctr9f_proj*.01+b12
      
      
      COMBO = rbind(uva1,uva2)
      
      # sum(COMBO[COMBO$Category == 'Commuting' & COMBO$Timeframe == 'Baseline',]$inventory)
      
      #CARBON_____________________________________________________________________
      # Result units = kg CO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
      COMBO$CO2_r = COMBO$inventory * COMBO$CO2.EF
      
      # Result units = kg eCO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
      COMBO$eCO2_r = COMBO$inventory * COMBO$eCO2.EF
      
      # Result units = kg CH4
      # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
      COMBO$CH4_r = COMBO$inventory * COMBO$CH4.EF
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$N2O_r = COMBO$inventory * COMBO$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$NOx_r = COMBO$inventory * COMBO$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$OtherN_r = COMBO$inventory * COMBO$Other.N.EF
      
      #INTERMEDIATE C & N _______________________________________________________________
      
      # calculate Footprints by category (divide by 1000 to convert from kg to MT)
      # Units of GWP 
      COMBO$CO2_MTCDE = COMBO$CO2_r/1000  # MT CO2e
      COMBO$eCO2_MTCDE = COMBO$eCO2_r/1000 # MT CO2e
      COMBO$CH4_MTCDE = COMBO$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
      COMBO$N2O_MTCDE = COMBO$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
      
      # Calculations only for refrigerants and chemicals for Carbon
      # inventory (kg) * GWP (Unitless??) / 1000 = MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HCFC-22'] = COMBO[COMBO$Source=='HCFC-22',]$inventory * gwp[gwp$Pollutant=='HCFC-22',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HCFE-235da2'] = COMBO[COMBO$Source=='HCFE-235da2',]$inventory * gwp[gwp$Pollutant=='HCFE-235da2',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HFC-134a'] = COMBO[COMBO$Source=='HFC-134a',]$inventory * gwp[gwp$Pollutant=='HFC-134a',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HG-10'] = COMBO[COMBO$Source=='HG-10',]$inventory * gwp[gwp$Pollutant=='HG-10',]$GWP/1000 # MT CO2e
      #COMBO$Ref_Chem[COMBO$Source=='Other'] = COMBO[COMBO$Source=='Other',]$inventory * gwp[gwp$Pollutant=='Other',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='R-404a'] = COMBO[COMBO$Source=='R-404a',]$inventory * gwp[gwp$Pollutant=='R-404a',]$GWP/1000 # MT CO2e
      
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C_____________________________________________________________________
      # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
      COMBO$C_Footprint = rowSums(COMBO[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE','Ref_Chem')],na.rm=T) 
      
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
        group_by(Category) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T))
      COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
        group_by(Category) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T)) 
      
      COMBO1$Timeframe = 'Baseline'
      COMBO2$Timeframe = 'Projected'
      
      #*****************************************************************************************************
      # ADD FOOD ONTO FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # Calculate total food footprints (original units = kg for C,N,P or gal for water)
      # final units = MT (Metric Tons)
      
      # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
      # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
      food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
      food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
      
      C_food_footprint1 = sum(food1_$C_footprint,na.rm=T)/1000 # convert to MT from kg
      C_food_footprint2 = sum(food2_$C_footprint,na.rm=T)/1000 # convert to MT from kg
      
      #Make a new 1 row dataframe 
      C_food_rw1 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint1)
      C_food_rw2 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint2)
      
      C_food_rw1$Timeframe = 'Baseline'
      C_food_rw2$Timeframe = 'Projected'
      
      # add on the food row
      COMBO_foot1 = rbind(COMBO1,C_food_rw1)
      COMBO_foot2 = rbind(COMBO2,C_food_rw2)
      
      COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
      
      # Rearrange the rows to match the slider rows
      Carbon_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                       COMBO_foot[COMBO_foot$Category=='Food',],
                       COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                       COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                       COMBO_foot[COMBO_foot$Category=='Commuting',],
                       #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                       COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                       COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                       COMBO_foot[COMBO_foot$Category=='Wastewater',],
                       COMBO_foot[COMBO_foot$Category=='Direct Water Use',])
    } # Scenario  
    
  }) # reactive
  
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  # STEP_6 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  #*****************************************************************************************************
  # Nitrogen Reactive
  #*****************************************************************************************************
  
  Nitrogen_R <- reactive({
    
    # # Campus Vs. Individual
    # if(input$campusVindividual == "Campus"){
    #   uva = uva_R()
    #   food = food
    # }
    # 
    # else if(input$campusVindividual == "Individual"){
    #   uva = uva_individual
    #   food = food_individual
    # }
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 0
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    if(input$scenario == "Manual Scenario"){
    # Projected 1 (each variable changes differently)
    sectr1 = 'Purchased Electricity'
    sectr2 = 'Food'
    sectr3 = 'On-Campus Stationary Sources'
    sectr4 = 'Direct Transportation Sources'
    sectr5 = 'Commuting'
    sectr6 = 'Agriculture Sources'
    sectr7 = 'Refrigerants & Chemicals'
    sectr8 = 'Wastewater'
    sectr9 = 'Direct Water Use'
    
    uva1 = uva_R()
    uva2 = uva_R()
    
    # Add Projected category
    uva1$Timeframe = 'Baseline'
    uva2$Timeframe = 'Projected'
    
    # This reactive part is for all categories except Energy, Commuting, and Food
    # Gives the baseline value
    b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
    b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
    b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
    b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
    b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
    b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
    b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
    b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
    b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
    b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
    b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
    #b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory
    
    # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
    uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
      b1 * input$sctr1a_proj*.01+b1
    uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
      b2 * input$sctr4a_proj*.01+b2
    uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
      b3 * input$sctr4a_proj*.01+b3
    uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
      b4 * input$sctr4a_proj*.01+b4
    uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
      b5 * input$sctr4a_proj*.01+b5
    uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
      b6 * input$sctr6a_proj*.01+b6
    uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
      b7 * input$sctr7a_proj*.01+b7
    uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
      b8 * input$sctr7a_proj*.01+b8
    uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
      b9 * input$sctr7a_proj*.01+b9
    uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
      b10 * input$sctr7a_proj*.01+b10
    uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
      b11 * input$sctr8a_proj*.01+b11
    # uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory = 
    #   b12 * input$sctr9a_proj*.01+b12
    
    
    COMBO = rbind(uva1,uva2)
    
    
    #NITROGEN_____________________________________________________________________
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMBO$N2O_r = COMBO$inventory * COMBO$N2O.EF
    
    # Result units = kg NOx
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMBO$NOx_r = COMBO$inventory * COMBO$NOx.EF
    
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMBO$OtherN_r = COMBO$inventory * COMBO$Other.N.EF
    
    #INTERMEDIATE N _______________________________________________________________
    
    # intermediate N
    COMBO$N2O_MTN = COMBO$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
    COMBO$NOx_MTN = COMBO$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
    COMBO$OtherN_MTN = COMBO$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
    
    #*****************************************************************************************************
    # FOOTPRINT Calculations
    #*****************************************************************************************************
    
    # CALCULATING FOOTPRINT C & N_____________________________________________________________________
    # Units N_Footprint = Metric Tons
    COMBO$N_Footprint = rowSums(COMBO[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
    
    #*****************************************************************************************************
    # FOOTPRINT DATA OUTPUT
    #*****************************************************************************************************
    
    # Summarize by Category___________________________________________________________________________
    # Units are MT C, MT N, MT P, Gallons Water 
    
    COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
      group_by(Category) %>% 
      summarize(Total_N_Footprint = sum(N_Footprint,na.rm=T))
    COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
      group_by(Category) %>% 
      summarize(Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
    
    COMBO1$Timeframe = 'Baseline'
    COMBO2$Timeframe = 'Projected'
    
    
    #*****************************************************************************************************
    # ADD FOOD ONTO FOOTPRINT Calculations
    #*****************************************************************************************************
    
    # Calculate total food footprints (original units = kg for C,N,P or gal for water)
    # final units = MT (Metric Tons)
    
    # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
    # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
    food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    
    
    N_food_footprint1 = sum(food1_$N_footprint,na.rm=T)/1000
    N_food_footprint2 = sum(food2_$N_footprint,na.rm=T)/1000
    
    #Make a new 1 row dataframe 
    N_food_rw1 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint1)
    N_food_rw2 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint2)
    
    N_food_rw1$Timeframe = 'Baseline'
    N_food_rw2$Timeframe = 'Projected'
    
    # add on the food row
    COMBO_foot1 = rbind(COMBO1,N_food_rw1)
    COMBO_foot2 = rbind(COMBO2,N_food_rw2)
    
    COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
    
    # Rearrange the rows to match the slider rows
    Nitrogen_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                       COMBO_foot[COMBO_foot$Category=='Food',],
                       COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                       COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                       COMBO_foot[COMBO_foot$Category=='Commuting',],
                       #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                       COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                       COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                       COMBO_foot[COMBO_foot$Category=='Wastewater',],
                       COMBO_foot[COMBO_foot$Category=='Direct Water Use',])
   
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 1 Nitrogen
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    
    else if(input$scenario == "Business as Usual Growth to 2025"){
      # Projected 1 (each variable changes differently)
      sectr1 = 'Purchased Electricity'
      sectr2 = 'Food'
      sectr3 = 'On-Campus Stationary Sources'
      sectr4 = 'Direct Transportation Sources'
      sectr5 = 'Commuting'
      sectr6 = 'Agriculture Sources'
      sectr7 = 'Refrigerants & Chemicals'
      sectr8 = 'Wastewater'
      sectr9 = 'Direct Water Use'
      
      uva1 = uva_R()
      uva2 = uva_R()
      
      # Add Projected category
      uva1$Timeframe = 'Baseline'
      uva2$Timeframe = 'Projected'
      
      # This reactive part is for all categories except Energy, Commuting, and Food
      # Gives the baseline/Baseline value
      b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
      b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
      b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
      b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
      b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
      b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
      b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
      b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
      b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
      b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
      b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
      #b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory
      
      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
        b1 * input$sctr1b_proj*.01+b1
      uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
        b2 * input$sctr4b_proj*.01+b2
      uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
        b3 * input$sctr4b_proj*.01+b3
      uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
        b4 * input$sctr4b_proj*.01+b4
      uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
        b5 * input$sctr4b_proj*.01+b5
      uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
        b6 * input$sctr6b_proj*.01+b6
      uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
        b7 * input$sctr7b_proj*.01+b7
      uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
        b8 * input$sctr7b_proj*.01+b8
      uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
        b9 * input$sctr7b_proj*.01+b9
      uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
        b10 * input$sctr7b_proj*.01+b10
      uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
        b11 * input$sctr8b_proj*.01+b11
      # uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory = 
      #   b12 * input$sctr9b_proj*.01+b12
      
      
      COMBO = rbind(uva1,uva2)
      
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$N2O_r = COMBO$inventory * COMBO$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$NOx_r = COMBO$inventory * COMBO$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$OtherN_r = COMBO$inventory * COMBO$Other.N.EF
      
      #INTERMEDIATE N _______________________________________________________________
      
      # intermediate N
      COMBO$N2O_MTN = COMBO$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
      COMBO$NOx_MTN = COMBO$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
      COMBO$OtherN_MTN = COMBO$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C & N_____________________________________________________________________
      # Units N_Footprint = Metric Tons
      COMBO$N_Footprint = rowSums(COMBO[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
      
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
        group_by(Category) %>% 
        summarize(Total_N_Footprint = sum(N_Footprint,na.rm=T))
      COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
        group_by(Category) %>% 
        summarize(Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
      
      COMBO1$Timeframe = 'Baseline'
      COMBO2$Timeframe = 'Projected'
      
      
      #*****************************************************************************************************
      # ADD FOOD ONTO FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # Calculate total food footprints (original units = kg for C,N,P or gal for water)
      # final units = MT (Metric Tons)
      
      # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
      # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
      food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
      food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
      
      
      N_food_footprint1 = sum(food1_$N_footprint,na.rm=T)/1000
      N_food_footprint2 = sum(food2_$N_footprint,na.rm=T)/1000
      
      #Make a new 1 row dataframe 
      N_food_rw1 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint1)
      N_food_rw2 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint2)
      
      N_food_rw1$Timeframe = 'Baseline'
      N_food_rw2$Timeframe = 'Projected'
      
      # add on the food row
      COMBO_foot1 = rbind(COMBO1,N_food_rw1)
      COMBO_foot2 = rbind(COMBO2,N_food_rw2)
      
      COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
      
      # Rearrange the rows to match the slider rows
      Nitrogen_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                         COMBO_foot[COMBO_foot$Category=='Food',],
                         COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                         COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                         COMBO_foot[COMBO_foot$Category=='Commuting',],
                         #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                         COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                         COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                         COMBO_foot[COMBO_foot$Category=='Wastewater',],
                         COMBO_foot[COMBO_foot$Category=='Direct Water Use',])
    } # Scenario
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 2 Nitrogen
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
     
    else if(input$scenario == "15% Vegetarian Meals"){
      # Projected 1 (each variable changes differently)
      sectr1 = 'Purchased Electricity'
    sectr2 = 'Food'
    sectr3 = 'On-Campus Stationary Sources'
    sectr4 = 'Direct Transportation Sources'
    sectr5 = 'Commuting'
    sectr6 = 'Agriculture Sources'
    sectr7 = 'Refrigerants & Chemicals'
    sectr8 = 'Wastewater'
    sectr9 = 'Direct Water Use'
    
    uva1 = uva_R()
    uva2 = uva_R()
    
    # Add Projected category
    uva1$Timeframe = 'Baseline'
    uva2$Timeframe = 'Projected'
    
    # This reactive part is for all categories except Energy, Commuting, and Food
    # Gives the baseline/Baseline value
    b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
    b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
    b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
    b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
    b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
    b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
    b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
    b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
    b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
    b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
    b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
    #b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory
    
    # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
    uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
      b1 * input$sctr1c_proj*.01+b1
    uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
      b2 * input$sctr4c_proj*.01+b2
    uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
      b3 * input$sctr4c_proj*.01+b3
    uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
      b4 * input$sctr4c_proj*.01+b4
    uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
      b5 * input$sctr4c_proj*.01+b5
    uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
      b6 * input$sctr6c_proj*.01+b6
    uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
      b7 * input$sctr7c_proj*.01+b7
    uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
      b8 * input$sctr7c_proj*.01+b8
    uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
      b9 * input$sctr7c_proj*.01+b9
    uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
      b10 * input$sctr7c_proj*.01+b10
    uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
      b11 * input$sctr8c_proj*.01+b11
    # uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory = 
    #   b12 * input$sctr9c_proj*.01+b12
    
    
    COMBO = rbind(uva1,uva2)
    
    
    #NITROGEN_____________________________________________________________________
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMBO$N2O_r = COMBO$inventory * COMBO$N2O.EF
    
    # Result units = kg NOx
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMBO$NOx_r = COMBO$inventory * COMBO$NOx.EF
    
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMBO$OtherN_r = COMBO$inventory * COMBO$Other.N.EF
    
    #INTERMEDIATE N _______________________________________________________________
    
    # intermediate N
    COMBO$N2O_MTN = COMBO$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
    COMBO$NOx_MTN = COMBO$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
    COMBO$OtherN_MTN = COMBO$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
    
    #*****************************************************************************************************
    # FOOTPRINT Calculations
    #*****************************************************************************************************
    
    # CALCULATING FOOTPRINT C & N_____________________________________________________________________
    # Units N_Footprint = Metric Tons
    COMBO$N_Footprint = rowSums(COMBO[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
    
    #*****************************************************************************************************
    # FOOTPRINT DATA OUTPUT
    #*****************************************************************************************************
    
    # Summarize by Category___________________________________________________________________________
    # Units are MT C, MT N, MT P, Gallons Water 
    
    COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
      group_by(Category) %>% 
      summarize(Total_N_Footprint = sum(N_Footprint,na.rm=T))
    COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
      group_by(Category) %>% 
      summarize(Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
    
    COMBO1$Timeframe = 'Baseline'
    COMBO2$Timeframe = 'Projected'
    
    
    #*****************************************************************************************************
    # ADD FOOD ONTO FOOTPRINT Calculations
    #*****************************************************************************************************
    
    # Calculate total food footprints (original units = kg for C,N,P or gal for water)
    # final units = MT (Metric Tons)
    
    # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
    # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
    food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    
    
    N_food_footprint1 = sum(food1_$N_footprint,na.rm=T)/1000
    N_food_footprint2 = sum(food2_$N_footprint,na.rm=T)/1000
    
    #Make a new 1 row dataframe 
    N_food_rw1 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint1)
    N_food_rw2 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint2)
    
    N_food_rw1$Timeframe = 'Baseline'
    N_food_rw2$Timeframe = 'Projected'
    
    # add on the food row
    COMBO_foot1 = rbind(COMBO1,N_food_rw1)
    COMBO_foot2 = rbind(COMBO2,N_food_rw2)
    
    COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
    
    # Rearrange the rows to match the slider rows
    Nitrogen_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                       COMBO_foot[COMBO_foot$Category=='Food',],
                       COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                       COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                       COMBO_foot[COMBO_foot$Category=='Commuting',],
                       #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                       COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                       COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                       COMBO_foot[COMBO_foot$Category=='Wastewater',],
                       COMBO_foot[COMBO_foot$Category=='Direct Water Use',])
    } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 3 Nitrogen
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    
    else if(input$scenario == "Replacement of 20% beef with Chicken"){
      # Projected 1 (each variable changes differently)
      sectr1 = 'Purchased Electricity'
      sectr2 = 'Food'
      sectr3 = 'On-Campus Stationary Sources'
      sectr4 = 'Direct Transportation Sources'
      sectr5 = 'Commuting'
      sectr6 = 'Agriculture Sources'
      sectr7 = 'Refrigerants & Chemicals'
      sectr8 = 'Wastewater'
      sectr9 = 'Direct Water Use'
      
      uva1 = uva_R()
      uva2 = uva_R()
      
      # Add Projected category
      uva1$Timeframe = 'Baseline'
      uva2$Timeframe = 'Projected'
      
      # This reactive part is for all categories except Energy, Commuting, and Food
      # Gives the baseline value
      b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
      b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
      b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
      b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
      b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
      b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
      b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
      b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
      b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
      b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
      b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
      #b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory
      
      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
        b1 * input$sctr1d_proj*.01+b1
      uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
        b2 * input$sctr4d_proj*.01+b2
      uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
        b3 * input$sctr4d_proj*.01+b3
      uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
        b4 * input$sctr4d_proj*.01+b4
      uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
        b5 * input$sctr4d_proj*.01+b5
      uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
        b6 * input$sctr6d_proj*.01+b6
      uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
        b7 * input$sctr7d_proj*.01+b7
      uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
        b8 * input$sctr7d_proj*.01+b8
      uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
        b9 * input$sctr7d_proj*.01+b9
      uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
        b10 * input$sctr7d_proj*.01+b10
      uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
        b11 * input$sctr8d_proj*.01+b11
      # uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory = 
      #   b12 * input$sctr9d_proj*.01+b12
      
      
      COMBO = rbind(uva1,uva2)
      
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$N2O_r = COMBO$inventory * COMBO$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$NOx_r = COMBO$inventory * COMBO$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$OtherN_r = COMBO$inventory * COMBO$Other.N.EF
      
      #INTERMEDIATE N _______________________________________________________________
      
      # intermediate N
      COMBO$N2O_MTN = COMBO$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
      COMBO$NOx_MTN = COMBO$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
      COMBO$OtherN_MTN = COMBO$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C & N_____________________________________________________________________
      # Units N_Footprint = Metric Tons
      COMBO$N_Footprint = rowSums(COMBO[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
      
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
        group_by(Category) %>% 
        summarize(Total_N_Footprint = sum(N_Footprint,na.rm=T))
      COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
        group_by(Category) %>% 
        summarize(Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
      
      COMBO1$Timeframe = 'Baseline'
      COMBO2$Timeframe = 'Projected'
      
      
      #*****************************************************************************************************
      # ADD FOOD ONTO FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # Calculate total food footprints (original units = kg for C,N,P or gal for water)
      # final units = MT (Metric Tons)
      
      # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
      # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
      food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
      food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
      
      
      N_food_footprint1 = sum(food1_$N_footprint,na.rm=T)/1000
      N_food_footprint2 = sum(food2_$N_footprint,na.rm=T)/1000
      
      #Make a new 1 row dataframe 
      N_food_rw1 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint1)
      N_food_rw2 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint2)
      
      N_food_rw1$Timeframe = 'Baseline'
      N_food_rw2$Timeframe = 'Projected'
      
      # add on the food row
      COMBO_foot1 = rbind(COMBO1,N_food_rw1)
      COMBO_foot2 = rbind(COMBO2,N_food_rw2)
      
      COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
      
      # Rearrange the rows to match the slider rows
      Nitrogen_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                         COMBO_foot[COMBO_foot$Category=='Food',],
                         COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                         COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                         COMBO_foot[COMBO_foot$Category=='Commuting',],
                         #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                         COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                         COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                         COMBO_foot[COMBO_foot$Category=='Wastewater',],
                         COMBO_foot[COMBO_foot$Category=='Direct Water Use',])
    } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 4 Nitrogen
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    
    else if(input$scenario == "Fuel Optimization"){
      # Projected 1 (each variable changes differently)
      sectr1 = 'Purchased Electricity'
      sectr2 = 'Food'
      sectr3 = 'On-Campus Stationary Sources'
      sectr4 = 'Direct Transportation Sources'
      sectr5 = 'Commuting'
      sectr6 = 'Agriculture Sources'
      sectr7 = 'Refrigerants & Chemicals'
      sectr8 = 'Wastewater'
      sectr9 = 'Direct Water Use'
      
      uva1 = uva_R()
      uva2 = uva_R()
      
      # Add Projected category
      uva1$Timeframe = 'Baseline'
      uva2$Timeframe = 'Projected'
      
      # This reactive part is for all categories except Energy, Commuting, and Food
      # Gives the baseline value
      b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
      b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
      b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
      b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
      b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
      b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
      b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
      b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
      b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
      b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
      b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
      #b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory
      
      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
        b1 * input$sctr1e_proj*.01+b1
      uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
        b2 * input$sctr4e_proj*.01+b2
      uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
        b3 * input$sctr4e_proj*.01+b3
      uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
        b4 * input$sctr4e_proj*.01+b4
      uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
        b5 * input$sctr4e_proj*.01+b5
      uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
        b6 * input$sctr6e_proj*.01+b6
      uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
        b7 * input$sctr7e_proj*.01+b7
      uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
        b8 * input$sctr7e_proj*.01+b8
      uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
        b9 * input$sctr7e_proj*.01+b9
      uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
        b10 * input$sctr7e_proj*.01+b10
      uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
        b11 * input$sctr8e_proj*.01+b11
      # uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory = 
      #   b12 * input$sctr9e_proj*.01+b12
      
      
      COMBO = rbind(uva1,uva2)
      
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$N2O_r = COMBO$inventory * COMBO$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$NOx_r = COMBO$inventory * COMBO$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$OtherN_r = COMBO$inventory * COMBO$Other.N.EF
      
      #INTERMEDIATE N _______________________________________________________________
      
      # intermediate N
      COMBO$N2O_MTN = COMBO$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
      COMBO$NOx_MTN = COMBO$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
      COMBO$OtherN_MTN = COMBO$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C & N_____________________________________________________________________
      # Units N_Footprint = Metric Tons
      COMBO$N_Footprint = rowSums(COMBO[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
      
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
        group_by(Category) %>% 
        summarize(Total_N_Footprint = sum(N_Footprint,na.rm=T))
      COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
        group_by(Category) %>% 
        summarize(Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
      
      COMBO1$Timeframe = 'Baseline'
      COMBO2$Timeframe = 'Projected'
      
      
      #*****************************************************************************************************
      # ADD FOOD ONTO FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # Calculate total food footprints (original units = kg for C,N,P or gal for water)
      # final units = MT (Metric Tons)
      
      # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
      # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
      food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
      food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
      
      
      N_food_footprint1 = sum(food1_$N_footprint,na.rm=T)/1000
      N_food_footprint2 = sum(food2_$N_footprint,na.rm=T)/1000
      
      #Make a new 1 row dataframe 
      N_food_rw1 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint1)
      N_food_rw2 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint2)
      
      N_food_rw1$Timeframe = 'Baseline'
      N_food_rw2$Timeframe = 'Projected'
      
      # add on the food row
      COMBO_foot1 = rbind(COMBO1,N_food_rw1)
      COMBO_foot2 = rbind(COMBO2,N_food_rw2)
      
      COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
      
      # Rearrange the rows to match the slider rows
      Nitrogen_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                         COMBO_foot[COMBO_foot$Category=='Food',],
                         COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                         COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                         COMBO_foot[COMBO_foot$Category=='Commuting',],
                         #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                         COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                         COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                         COMBO_foot[COMBO_foot$Category=='Wastewater',],
                         COMBO_foot[COMBO_foot$Category=='Direct Water Use',])
    } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 5 Nitrogen
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    
    else if(input$scenario == "Implementing All Scenarios"){
      # Projected 1 (each variable changes differently)
      sectr1 = 'Purchased Electricity'
      sectr2 = 'Food'
      sectr3 = 'On-Campus Stationary Sources'
      sectr4 = 'Direct Transportation Sources'
      sectr5 = 'Commuting'
      sectr6 = 'Agriculture Sources'
      sectr7 = 'Refrigerants & Chemicals'
      sectr8 = 'Wastewater'
      sectr9 = 'Direct Water Use'
      
      uva1 = uva_R()
      uva2 = uva_R()
      
      # Add Projected category
      uva1$Timeframe = 'Baseline'
      uva2$Timeframe = 'Projected'
      
      # This reactive part is for all categories except Energy, Commuting, and Food
      # Gives the baseline value
      b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
      b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
      b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
      b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
      b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
      b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
      b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
      b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
      b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
      b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
      b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
      #b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory
      
      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
        b1 * input$sctr1f_proj*.01+b1
      uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
        b2 * input$sctr4f_proj*.01+b2
      uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
        b3 * input$sctr4f_proj*.01+b3
      uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
        b4 * input$sctr4f_proj*.01+b4
      uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
        b5 * input$sctr4f_proj*.01+b5
      uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
        b6 * input$sctr6f_proj*.01+b6
      uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
        b7 * input$sctr7f_proj*.01+b7
      uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
        b8 * input$sctr7f_proj*.01+b8
      uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
        b9 * input$sctr7f_proj*.01+b9
      uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
        b10 * input$sctr7f_proj*.01+b10
      uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
        b11 * input$sctr8f_proj*.01+b11
      # uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory = 
      #   b12 * input$sctr9f_proj*.01+b12
      
      
      COMBO = rbind(uva1,uva2)
      
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$N2O_r = COMBO$inventory * COMBO$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$NOx_r = COMBO$inventory * COMBO$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$OtherN_r = COMBO$inventory * COMBO$Other.N.EF
      
      #INTERMEDIATE N _______________________________________________________________
      
      # intermediate N
      COMBO$N2O_MTN = COMBO$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
      COMBO$NOx_MTN = COMBO$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
      COMBO$OtherN_MTN = COMBO$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C & N_____________________________________________________________________
      # Units N_Footprint = Metric Tons
      COMBO$N_Footprint = rowSums(COMBO[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
      
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
        group_by(Category) %>% 
        summarize(Total_N_Footprint = sum(N_Footprint,na.rm=T))
      COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
        group_by(Category) %>% 
        summarize(Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
      
      COMBO1$Timeframe = 'Baseline'
      COMBO2$Timeframe = 'Projected'
      
      
      #*****************************************************************************************************
      # ADD FOOD ONTO FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # Calculate total food footprints (original units = kg for C,N,P or gal for water)
      # final units = MT (Metric Tons)
      
      # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
      # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
      food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
      food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
      
      
      N_food_footprint1 = sum(food1_$N_footprint,na.rm=T)/1000
      N_food_footprint2 = sum(food2_$N_footprint,na.rm=T)/1000
      
      #Make a new 1 row dataframe 
      N_food_rw1 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint1)
      N_food_rw2 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint2)
      
      N_food_rw1$Timeframe = 'Baseline'
      N_food_rw2$Timeframe = 'Projected'
      
      # add on the food row
      COMBO_foot1 = rbind(COMBO1,N_food_rw1)
      COMBO_foot2 = rbind(COMBO2,N_food_rw2)
      
      COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
      
      # Rearrange the rows to match the slider rows
      Nitrogen_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                         COMBO_foot[COMBO_foot$Category=='Food',],
                         COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                         COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                         COMBO_foot[COMBO_foot$Category=='Commuting',],
                         #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                         COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                         COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                         COMBO_foot[COMBO_foot$Category=='Wastewater',],
                         COMBO_foot[COMBO_foot$Category=='Direct Water Use',])
    } # Scenario
    
    
    }) # reactive
  
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  # STEP_7 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  #*****************************************************************************************************
  # Phosphorus Reactive
  #*****************************************************************************************************
  
  Phosphorus_R <- reactive({
    
    # # Campus Vs. Individual
    # if(input$campusVindividual == "Campus"){
    #   uva = uva_R()
    #   food = food
    # }
    # 
    # else if(input$campusVindividual == "Individual"){
    #   uva = uva_individual
    #   food = food_individual
    # }
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 0
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    if(input$scenario == "Manual Scenario"){
    # Projected 1 (each variable changes differently)
    sectr1 = 'Purchased Electricity'
    sectr2 = 'Food'
    sectr3 = 'On-Campus Stationary Sources'
    sectr4 = 'Direct Transportation Sources'
    sectr5 = 'Commuting'
    sectr6 = 'Agriculture Sources'
    sectr7 = 'Refrigerants & Chemicals'
    sectr8 = 'Wastewater'
    sectr9 = 'Direct Water Use'
    
    uva1 = uva_R()
    uva2 = uva_R()
    
    # Add Projected category
    uva1$Timeframe = 'Baseline'
    uva2$Timeframe = 'Projected'
    
    # This reactive part is for all categories except Energy, Commuting, and Food
    # Gives the baseline/Baseline value
    b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
    b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
    b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
    b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
    b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
    b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
    b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
    b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
    b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
    b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
    b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
    #b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory
    
    # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
    uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
      b1 * input$sctr1a_proj*.01+b1
    uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
      b2 * input$sctr4a_proj*.01+b2
    uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
      b3 * input$sctr4a_proj*.01+b3
    uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
      b4 * input$sctr4a_proj*.01+b4
    uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
      b5 * input$sctr4a_proj*.01+b5
    uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
      b6 * input$sctr6a_proj*.01+b6
    uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
      b7 * input$sctr7a_proj*.01+b7
    uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
      b8 * input$sctr7a_proj*.01+b8
    uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
      b9 * input$sctr7a_proj*.01+b9
    uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
      b10 * input$sctr7a_proj*.01+b10
    uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
      b11 * input$sctr8a_proj*.01+b11
    # uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory = 
    #   b12 * input$sctr9a_proj*.01+b12
    
    COMBO = rbind(uva1,uva2)
    
    #*****************************************************************************************************
    # FOOTPRINT Calculations
    #*****************************************************************************************************
    
    #PHOSPHORUS FOOTPRINT_____________________________________________________________________
    
    # Result units = MT of P
    # Inventory unit (e.g. US gallon) * kg P / inventory unit
    COMBO$P_Footprint = COMBO$inventory * COMBO$P.EF /1000  # Divide by 1000 to get metric tons
    
    #*****************************************************************************************************
    # FOOTPRINT DATA OUTPUT
    #*****************************************************************************************************
    
    # Summarize by Category___________________________________________________________________________
    # Units are MT P
    
    COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
      group_by(Category) %>% 
      summarize(Total_P_Footprint = sum(P_Footprint,na.rm=T))
    COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
      group_by(Category) %>% 
      summarize(Total_P_Footprint = sum(P_Footprint,na.rm=T)) 
    
    COMBO1$Timeframe = 'Baseline'
    COMBO2$Timeframe = 'Projected'
    
    #*****************************************************************************************************
    # ADD FOOD ONTO FOOTPRINT Calculations
    #*****************************************************************************************************
    
    # Calculate total food footprints (original units = kg for C,N,P or gal for water)
    # final units = MT (Metric Tons)
    
    # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
    # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
    food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    
    P_food_footprint1 = sum(food1_$P_footprint,na.rm=T)/1000
    P_food_footprint2 = sum(food2_$P_footprint,na.rm=T)/1000
    
    #Make a new 1 row dataframe 
    P_food_rw1 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint1)
    P_food_rw2 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint2)
    
    P_food_rw1$Timeframe = 'Baseline'
    P_food_rw2$Timeframe = 'Projected'
    
    # add on the food row
    COMBO_foot1 = rbind(COMBO1,P_food_rw1)
    COMBO_foot2 = rbind(COMBO2,P_food_rw2)
    
    COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
    
    # Rearrange the rows to match the slider rows
    Phosphorus_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                         COMBO_foot[COMBO_foot$Category=='Food',],
                         COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                         COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                         COMBO_foot[COMBO_foot$Category=='Commuting',],
                         #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                         COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                         COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                         COMBO_foot[COMBO_foot$Category=='Wastewater',],
                         COMBO_foot[COMBO_foot$Category=='Direct Water Use',])
    
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 1 Phosphorus
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Business as Usual Growth to 2025"){
      # Projected 1 (each variable changes differently)
      sectr1 = 'Purchased Electricity'
      sectr2 = 'Food'
      sectr3 = 'On-Campus Stationary Sources'
      sectr4 = 'Direct Transportation Sources'
      sectr5 = 'Commuting'
      sectr6 = 'Agriculture Sources'
      sectr7 = 'Refrigerants & Chemicals'
      sectr8 = 'Wastewater'
      sectr9 = 'Direct Water Use'
      
      uva1 = uva_R()
      uva2 = uva_R()
      
      # Add Projected category
      uva1$Timeframe = 'Baseline'
      uva2$Timeframe = 'Projected'
      
      # This reactive part is for all categories except Energy, Commuting, and Food
      # Gives the baseline value
      b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
      b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
      b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
      b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
      b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
      b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
      b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
      b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
      b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
      b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
      b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
      #b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory
      
      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
        b1 * input$sctr1b_proj*.01+b1
      uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
        b2 * input$sctr4b_proj*.01+b2
      uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
        b3 * input$sctr4b_proj*.01+b3
      uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
        b4 * input$sctr4b_proj*.01+b4
      uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
        b5 * input$sctr4b_proj*.01+b5
      uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
        b6 * input$sctr6b_proj*.01+b6
      uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
        b7 * input$sctr7b_proj*.01+b7
      uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
        b8 * input$sctr7b_proj*.01+b8
      uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
        b9 * input$sctr7b_proj*.01+b9
      uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
        b10 * input$sctr7b_proj*.01+b10
      uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
        b11 * input$sctr8b_proj*.01+b11
      # uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory = 
      #   b12 * input$sctr9b_proj*.01+b12
      
      COMBO = rbind(uva1,uva2)
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      #PHOSPHORUS FOOTPRINT_____________________________________________________________________
      
      # Result units = MT of P
      # Inventory unit (e.g. US gallon) * kg P / inventory unit
      COMBO$P_Footprint = COMBO$inventory * COMBO$P.EF /1000  # Divide by 1000 to get metric tons
      
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT P
      
      COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
        group_by(Category) %>% 
        summarize(Total_P_Footprint = sum(P_Footprint,na.rm=T))
      COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
        group_by(Category) %>% 
        summarize(Total_P_Footprint = sum(P_Footprint,na.rm=T)) 
      
      COMBO1$Timeframe = 'Baseline'
      COMBO2$Timeframe = 'Projected'
      
      #*****************************************************************************************************
      # ADD FOOD ONTO FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # Calculate total food footprints (original units = kg for C,N,P or gal for water)
      # final units = MT (Metric Tons)
      
      # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
      # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
      food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
      food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
      
      P_food_footprint1 = sum(food1_$P_footprint,na.rm=T)/1000
      P_food_footprint2 = sum(food2_$P_footprint,na.rm=T)/1000
      
      #Make a new 1 row dataframe 
      P_food_rw1 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint1)
      P_food_rw2 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint2)
      
      P_food_rw1$Timeframe = 'Baseline'
      P_food_rw2$Timeframe = 'Projected'
      
      # add on the food row
      COMBO_foot1 = rbind(COMBO1,P_food_rw1)
      COMBO_foot2 = rbind(COMBO2,P_food_rw2)
      
      COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
      
      # Rearrange the rows to match the slider rows
      Phosphorus_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                           COMBO_foot[COMBO_foot$Category=='Food',],
                           COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                           COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                           COMBO_foot[COMBO_foot$Category=='Commuting',],
                           #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                           COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                           COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                           COMBO_foot[COMBO_foot$Category=='Wastewater',],
                           COMBO_foot[COMBO_foot$Category=='Direct Water Use',])
      
    } # Scenario 
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 2 Phosphorus
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "15% Vegetarian Meals"){
      # Projected 1 (each variable changes differently)
      sectr1 = 'Purchased Electricity'
    sectr2 = 'Food'
    sectr3 = 'On-Campus Stationary Sources'
    sectr4 = 'Direct Transportation Sources'
    sectr5 = 'Commuting'
    sectr6 = 'Agriculture Sources'
    sectr7 = 'Refrigerants & Chemicals'
    sectr8 = 'Wastewater'
    sectr9 = 'Direct Water Use'
    
    uva1 = uva_R()
    uva2 = uva_R()
    
    # Add Projected category
    uva1$Timeframe = 'Baseline'
    uva2$Timeframe = 'Projected'
    
    # This reactive part is for all categories except Energy, Commuting, and Food
    # Gives the baseline value
    b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
    b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
    b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
    b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
    b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
    b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
    b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
    b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
    b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
    b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
    b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
    #b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory
    
    # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
    uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
      b1 * input$sctr1c_proj*.01+b1
    uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
      b2 * input$sctr4c_proj*.01+b2
    uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
      b3 * input$sctr4c_proj*.01+b3
    uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
      b4 * input$sctr4c_proj*.01+b4
    uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
      b5 * input$sctr4c_proj*.01+b5
    uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
      b6 * input$sctr6c_proj*.01+b6
    uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
      b7 * input$sctr7c_proj*.01+b7
    uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
      b8 * input$sctr7c_proj*.01+b8
    uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
      b9 * input$sctr7c_proj*.01+b9
    uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
      b10 * input$sctr7c_proj*.01+b10
    uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
      b11 * input$sctr8c_proj*.01+b11
    # uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory = 
    #   b12 * input$sctr9c_proj*.01+b12
    
    COMBO = rbind(uva1,uva2)
    
    #*****************************************************************************************************
    # FOOTPRINT Calculations
    #*****************************************************************************************************
    
    #PHOSPHORUS FOOTPRINT_____________________________________________________________________
    
    # Result units = MT of P
    # Inventory unit (e.g. US gallon) * kg P / inventory unit
    COMBO$P_Footprint = COMBO$inventory * COMBO$P.EF /1000  # Divide by 1000 to get metric tons
    
    #*****************************************************************************************************
    # FOOTPRINT DATA OUTPUT
    #*****************************************************************************************************
    
    # Summarize by Category___________________________________________________________________________
    # Units are MT P
    
    COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
      group_by(Category) %>% 
      summarize(Total_P_Footprint = sum(P_Footprint,na.rm=T))
    COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
      group_by(Category) %>% 
      summarize(Total_P_Footprint = sum(P_Footprint,na.rm=T)) 
    
    COMBO1$Timeframe = 'Baseline'
    COMBO2$Timeframe = 'Projected'
    
    #*****************************************************************************************************
    # ADD FOOD ONTO FOOTPRINT Calculations
    #*****************************************************************************************************
    
    # Calculate total food footprints (original units = kg for C,N,P or gal for water)
    # final units = MT (Metric Tons)
    
    # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
    # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
    food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    
    P_food_footprint1 = sum(food1_$P_footprint,na.rm=T)/1000
    P_food_footprint2 = sum(food2_$P_footprint,na.rm=T)/1000
    
    #Make a new 1 row dataframe 
    P_food_rw1 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint1)
    P_food_rw2 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint2)
    
    P_food_rw1$Timeframe = 'Baseline'
    P_food_rw2$Timeframe = 'Projected'
    
    # add on the food row
    COMBO_foot1 = rbind(COMBO1,P_food_rw1)
    COMBO_foot2 = rbind(COMBO2,P_food_rw2)
    
    COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
    
    # Rearrange the rows to match the slider rows
    Phosphorus_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                         COMBO_foot[COMBO_foot$Category=='Food',],
                         COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                         COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                         COMBO_foot[COMBO_foot$Category=='Commuting',],
                         #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                         COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                         COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                         COMBO_foot[COMBO_foot$Category=='Wastewater',],
                         COMBO_foot[COMBO_foot$Category=='Direct Water Use',])
    
  } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 3 Phosphorus
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Replacement of 20% beef with Chicken"){
      # Projected 1 (each variable changes differently)
      sectr1 = 'Purchased Electricity'
      sectr2 = 'Food'
      sectr3 = 'On-Campus Stationary Sources'
      sectr4 = 'Direct Transportation Sources'
      sectr5 = 'Commuting'
      sectr6 = 'Agriculture Sources'
      sectr7 = 'Refrigerants & Chemicals'
      sectr8 = 'Wastewater'
      sectr9 = 'Direct Water Use'
      
      uva1 = uva_R()
      uva2 = uva_R()
      
      # Add Projected category
      uva1$Timeframe = 'Baseline'
      uva2$Timeframe = 'Projected'
      
      # This reactive part is for all categories except Energy, Commuting, and Food
      # Gives the baseline/Baseline value
      b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
      b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
      b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
      b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
      b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
      b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
      b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
      b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
      b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
      b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
      b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
      #b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory
      
      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
        b1 * input$sctr1d_proj*.01+b1
      uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
        b2 * input$sctr4d_proj*.01+b2
      uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
        b3 * input$sctr4d_proj*.01+b3
      uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
        b4 * input$sctr4d_proj*.01+b4
      uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
        b5 * input$sctr4d_proj*.01+b5
      uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
        b6 * input$sctr6d_proj*.01+b6
      uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
        b7 * input$sctr7d_proj*.01+b7
      uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
        b8 * input$sctr7d_proj*.01+b8
      uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
        b9 * input$sctr7d_proj*.01+b9
      uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
        b10 * input$sctr7d_proj*.01+b10
      uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
        b11 * input$sctr8d_proj*.01+b11
      # uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory = 
      #   b12 * input$sctr9d_proj*.01+b12
      
      COMBO = rbind(uva1,uva2)
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      #PHOSPHORUS FOOTPRINT_____________________________________________________________________
      
      # Result units = MT of P
      # Inventory unit (e.g. US gallon) * kg P / inventory unit
      COMBO$P_Footprint = COMBO$inventory * COMBO$P.EF /1000  # Divide by 1000 to get metric tons
      
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT P
      
      COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
        group_by(Category) %>% 
        summarize(Total_P_Footprint = sum(P_Footprint,na.rm=T))
      COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
        group_by(Category) %>% 
        summarize(Total_P_Footprint = sum(P_Footprint,na.rm=T)) 
      
      COMBO1$Timeframe = 'Baseline'
      COMBO2$Timeframe = 'Projected'
      
      #*****************************************************************************************************
      # ADD FOOD ONTO FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # Calculate total food footprints (original units = kg for C,N,P or gal for water)
      # final units = MT (Metric Tons)
      
      # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
      # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
      food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
      food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
      
      P_food_footprint1 = sum(food1_$P_footprint,na.rm=T)/1000
      P_food_footprint2 = sum(food2_$P_footprint,na.rm=T)/1000
      
      #Make a new 1 row dataframe 
      P_food_rw1 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint1)
      P_food_rw2 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint2)
      
      P_food_rw1$Timeframe = 'Baseline'
      P_food_rw2$Timeframe = 'Projected'
      
      # add on the food row
      COMBO_foot1 = rbind(COMBO1,P_food_rw1)
      COMBO_foot2 = rbind(COMBO2,P_food_rw2)
      
      COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
      
      # Rearrange the rows to match the slider rows
      Phosphorus_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                           COMBO_foot[COMBO_foot$Category=='Food',],
                           COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                           COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                           COMBO_foot[COMBO_foot$Category=='Commuting',],
                           #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                           COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                           COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                           COMBO_foot[COMBO_foot$Category=='Wastewater',],
                           COMBO_foot[COMBO_foot$Category=='Direct Water Use',])
      
    } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 4 Phosphorus
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Fuel Optimization"){
      # Projected 1 (each variable changes differently)
      sectr1 = 'Purchased Electricity'
      sectr2 = 'Food'
      sectr3 = 'On-Campus Stationary Sources'
      sectr4 = 'Direct Transportation Sources'
      sectr5 = 'Commuting'
      sectr6 = 'Agriculture Sources'
      sectr7 = 'Refrigerants & Chemicals'
      sectr8 = 'Wastewater'
      sectr9 = 'Direct Water Use'
      
      uva1 = uva_R()
      uva2 = uva_R()
      
      # Add Projected category
      uva1$Timeframe = 'Baseline'
      uva2$Timeframe = 'Projected'
      
      # This reactive part is for all categories except Energy, Commuting, and Food
      # Gives the baseline/Baseline value
      b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
      b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
      b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
      b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
      b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
      b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
      b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
      b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
      b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
      b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
      b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
      #b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory
      
      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
        b1 * input$sctr1e_proj*.01+b1
      uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
        b2 * input$sctr4e_proj*.01+b2
      uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
        b3 * input$sctr4e_proj*.01+b3
      uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
        b4 * input$sctr4e_proj*.01+b4
      uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
        b5 * input$sctr4e_proj*.01+b5
      uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
        b6 * input$sctr6e_proj*.01+b6
      uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
        b7 * input$sctr7e_proj*.01+b7
      uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
        b8 * input$sctr7e_proj*.01+b8
      uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
        b9 * input$sctr7e_proj*.01+b9
      uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
        b10 * input$sctr7e_proj*.01+b10
      uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
        b11 * input$sctr8e_proj*.01+b11
      # uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory = 
      #   b12 * input$sctr9e_proj*.01+b12
      
      COMBO = rbind(uva1,uva2)
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      #PHOSPHORUS FOOTPRINT_____________________________________________________________________
      
      # Result units = MT of P
      # Inventory unit (e.g. US gallon) * kg P / inventory unit
      COMBO$P_Footprint = COMBO$inventory * COMBO$P.EF /1000  # Divide by 1000 to get metric tons
      
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT P
      
      COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
        group_by(Category) %>% 
        summarize(Total_P_Footprint = sum(P_Footprint,na.rm=T))
      COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
        group_by(Category) %>% 
        summarize(Total_P_Footprint = sum(P_Footprint,na.rm=T)) 
      
      COMBO1$Timeframe = 'Baseline'
      COMBO2$Timeframe = 'Projected'
      
      #*****************************************************************************************************
      # ADD FOOD ONTO FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # Calculate total food footprints (original units = kg for C,N,P or gal for water)
      # final units = MT (Metric Tons)
      
      # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
      # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
      food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
      food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
      
      P_food_footprint1 = sum(food1_$P_footprint,na.rm=T)/1000
      P_food_footprint2 = sum(food2_$P_footprint,na.rm=T)/1000
      
      #Make a new 1 row dataframe 
      P_food_rw1 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint1)
      P_food_rw2 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint2)
      
      P_food_rw1$Timeframe = 'Baseline'
      P_food_rw2$Timeframe = 'Projected'
      
      # add on the food row
      COMBO_foot1 = rbind(COMBO1,P_food_rw1)
      COMBO_foot2 = rbind(COMBO2,P_food_rw2)
      
      COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
      
      # Rearrange the rows to match the slider rows
      Phosphorus_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                           COMBO_foot[COMBO_foot$Category=='Food',],
                           COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                           COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                           COMBO_foot[COMBO_foot$Category=='Commuting',],
                           #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                           COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                           COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                           COMBO_foot[COMBO_foot$Category=='Wastewater',],
                           COMBO_foot[COMBO_foot$Category=='Direct Water Use',])
      
    } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 5 Phosphorus
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Implementing All Scenarios"){
      # Projected 1 (each variable changes differently)
      sectr1 = 'Purchased Electricity'
      sectr2 = 'Food'
      sectr3 = 'On-Campus Stationary Sources'
      sectr4 = 'Direct Transportation Sources'
      sectr5 = 'Commuting'
      sectr6 = 'Agriculture Sources'
      sectr7 = 'Refrigerants & Chemicals'
      sectr8 = 'Wastewater'
      sectr9 = 'Direct Water Use'
      
      uva1 = uva_R()
      uva2 = uva_R()
      
      # Add Projected category
      uva1$Timeframe = 'Baseline'
      uva2$Timeframe = 'Projected'
      
      # This reactive part is for all categories except Energy, Commuting, and Food
      # Gives the baseline/Baseline value
      b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
      b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
      b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
      b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
      b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
      b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
      b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
      b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
      b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
      b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
      b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
      #b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory
      
      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
        b1 * input$sctr1f_proj*.01+b1
      uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
        b2 * input$sctr4f_proj*.01+b2
      uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
        b3 * input$sctr4f_proj*.01+b3
      uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
        b4 * input$sctr4f_proj*.01+b4
      uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
        b5 * input$sctr4f_proj*.01+b5
      uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
        b6 * input$sctr6f_proj*.01+b6
      uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
        b7 * input$sctr7f_proj*.01+b7
      uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
        b8 * input$sctr7f_proj*.01+b8
      uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
        b9 * input$sctr7f_proj*.01+b9
      uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
        b10 * input$sctr7f_proj*.01+b10
      uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
        b11 * input$sctr8f_proj*.01+b11
      # uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory = 
      #   b12 * input$sctr9f_proj*.01+b12
      
      COMBO = rbind(uva1,uva2)
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      #PHOSPHORUS FOOTPRINT_____________________________________________________________________
      
      # Result units = MT of P
      # Inventory unit (e.g. US gallon) * kg P / inventory unit
      COMBO$P_Footprint = COMBO$inventory * COMBO$P.EF /1000  # Divide by 1000 to get metric tons
      
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT P
      
      COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
        group_by(Category) %>% 
        summarize(Total_P_Footprint = sum(P_Footprint,na.rm=T))
      COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
        group_by(Category) %>% 
        summarize(Total_P_Footprint = sum(P_Footprint,na.rm=T)) 
      
      COMBO1$Timeframe = 'Baseline'
      COMBO2$Timeframe = 'Projected'
      
      #*****************************************************************************************************
      # ADD FOOD ONTO FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # Calculate total food footprints (original units = kg for C,N,P or gal for water)
      # final units = MT (Metric Tons)
      
      # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
      # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
      food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
      food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
      
      P_food_footprint1 = sum(food1_$P_footprint,na.rm=T)/1000
      P_food_footprint2 = sum(food2_$P_footprint,na.rm=T)/1000
      
      #Make a new 1 row dataframe 
      P_food_rw1 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint1)
      P_food_rw2 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint2)
      
      P_food_rw1$Timeframe = 'Baseline'
      P_food_rw2$Timeframe = 'Projected'
      
      # add on the food row
      COMBO_foot1 = rbind(COMBO1,P_food_rw1)
      COMBO_foot2 = rbind(COMBO2,P_food_rw2)
      
      COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
      
      # Rearrange the rows to match the slider rows
      Phosphorus_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                           COMBO_foot[COMBO_foot$Category=='Food',],
                           COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                           COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                           COMBO_foot[COMBO_foot$Category=='Commuting',],
                           #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                           COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                           COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                           COMBO_foot[COMBO_foot$Category=='Wastewater',],
                           COMBO_foot[COMBO_foot$Category=='Direct Water Use',])
      
    } # Scenario
    
    
  }) # reactive
  
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  # STEP_8 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  #*****************************************************************************************************
  # Water Reactive
  #*****************************************************************************************************
  
  Water_R <- reactive({
    
    # # Campus Vs. Individual
    # if(input$campusVindividual == "Campus"){
    #   uva = uva_R()
    #   food = food
    # }
    # 
    # else if(input$campusVindividual == "Individual"){
    #   uva = uva_individual
    #   food = food_individual
    # }
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 0
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    if(input$scenario == "Manual Scenario"){
    # Projected 1 (each variable changes differently)
    sectr1 = 'Purchased Electricity'
    sectr2 = 'Food'
    sectr3 = 'On-Campus Stationary Sources'
    sectr4 = 'Direct Transportation Sources'
    sectr5 = 'Commuting'
    sectr6 = 'Agriculture Sources'
    sectr7 = 'Refrigerants & Chemicals'
    sectr8 = 'Wastewater'
    sectr9 = 'Direct Water Use'
    
    uva1 = uva_R()
    uva2 = uva_R()
    
    # Add Projected category
    uva1$Timeframe = 'Baseline'
    uva2$Timeframe = 'Projected'
    
    # This reactive part is for all categories except Energy, Commuting, and Food
    # Gives the baseline value
    b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
    b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
    b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
    b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
    b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
    b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
    b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
    b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
    b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
    b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
    b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
    b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory
    
    # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
    uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
      b1 * input$sctr1a_proj*.01+b1
    uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
      b2 * input$sctr4a_proj*.01+b2
    uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
      b3 * input$sctr4a_proj*.01+b3
    uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
      b4 * input$sctr4a_proj*.01+b4
    uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
      b5 * input$sctr4a_proj*.01+b5
    uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
      b6 * input$sctr6a_proj*.01+b6
    uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
      b7 * input$sctr7a_proj*.01+b7
    uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
      b8 * input$sctr7a_proj*.01+b8
    uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
      b9 * input$sctr7a_proj*.01+b9
    uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
      b10 * input$sctr7a_proj*.01+b10
    uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
      b11 * input$sctr8a_proj*.01+b11
    uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory =
      b12 * input$sctr9a_proj*.01+b12
    
    COMBO = rbind(uva1,uva2)
    
    #*****************************************************************************************************
    # FOOTPRINT Calculations
    #*****************************************************************************************************
    
    #WATER FOOTPRINT ________________________________________________________________
    
    # Result units = gallons
    # Inventory unit (e.g. US gallon) * (gal water / inventory unit) 
    COMBO$W_Footprint1 = COMBO$inventory * COMBO$Water.EF #* 0.00378541178 us this if convert to m3
    
    
    for (i in 1:nrow(COMBO)){
      if(COMBO$Scope[i]=='Scope 1' &
         COMBO$Category[i]=='Direct Water Use' &
         COMBO$Sub_category[i]=='On-campus water consumption' &
         COMBO$Source[i]=='Direct Use') {
        COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * 1000000
      } else if(COMBO$Scope[i]=='Scope 2' &
                COMBO$Category[i]=='Purchased Electricity' &
                COMBO$Sub_category[i]=='Purchased Electricity' &
                COMBO$Source[i]=='Purchased Electricity'){
        COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * (10^(-12))*3600000/0.00378541178
      } else {
        COMBO$W_Footprint[i] = COMBO$W_Footprint1[i]
      }
    }
    
    #*****************************************************************************************************
    # FOOTPRINT DATA OUTPUT
    #*****************************************************************************************************
    
    # Summarize by Category___________________________________________________________________________
    # Units are MT C, MT N, MT P, Gallons Water 
    
    COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
      group_by(Category) %>% 
      summarize(Total_W_Footprint = sum(W_Footprint,na.rm=T))
    COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
      group_by(Category) %>% 
      summarize(Total_W_Footprint = sum(W_Footprint,na.rm=T)) 
    
    COMBO1$Timeframe = 'Baseline'
    COMBO2$Timeframe = 'Projected'
    
    #*****************************************************************************************************
    # ADD FOOD ONTO FOOTPRINT Calculations
    #*****************************************************************************************************
    
    # Calculate total food footprints (original units = kg for C,N,P or gal for water)
    # final units = MT (Metric Tons)
    
    # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
    # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
    food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    
    # Units for water = gallons
    B_food_footprint1 = sum(food1_$B_footprint,na.rm=T)
    B_food_footprint2 = sum(food2_$B_footprint,na.rm=T)
    G_food_footprint1 = sum(food1_$G_footprint,na.rm=T)
    G_food_footprint2 = sum(food2_$G_footprint,na.rm=T)
    BG_food_footprint1 = sum(food1_$BG_footprint,na.rm=T)
    BG_food_footprint2 = sum(food2_$BG_footprint,na.rm=T)
    
    #Make a new 1 row dataframe 
    B_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint1)
    B_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint2)
    G_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint1)
    G_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint2)
    BG_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint1)
    BG_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint2)
    
    W_food_rw1 = B_food_rw1
    W_food_rw2 = B_food_rw2
    
    W_food_rw1$Timeframe = 'Baseline'
    W_food_rw2$Timeframe = 'Projected'
    
    # add on the food row
    COMBO_foot1 = rbind(COMBO1,W_food_rw1)
    COMBO_foot2 = rbind(COMBO2,W_food_rw2)
    
    COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
    
    # Rearrange the rows to match the slider rows
    Water_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                    COMBO_foot[COMBO_foot$Category=='Food',],
                    COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                    COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                    COMBO_foot[COMBO_foot$Category=='Commuting',],
                    #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                    COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                    COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                    COMBO_foot[COMBO_foot$Category=='Wastewater',],
                    COMBO_foot[COMBO_foot$Category=='Direct Water Use',])
    
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 1 Water
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Business as Usual Growth to 2025"){
      # Projected 1 (each variable changes differently)
      sectr1 = 'Purchased Electricity'
      sectr2 = 'Food'
      sectr3 = 'On-Campus Stationary Sources'
      sectr4 = 'Direct Transportation Sources'
      sectr5 = 'Commuting'
      sectr6 = 'Agriculture Sources'
      sectr7 = 'Refrigerants & Chemicals'
      sectr8 = 'Wastewater'
      sectr9 = 'Direct Water Use'
      
      uva1 = uva_R()
      uva2 = uva_R()
      
      # Add Projected category
      uva1$Timeframe = 'Baseline'
      uva2$Timeframe = 'Projected'
      
      # This reactive part is for all categories except Energy, Commuting, and Food
      # Gives the baseline value
      b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
      b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
      b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
      b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
      b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
      b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
      b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
      b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
      b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
      b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
      b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
      b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory
      
      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
        b1 * input$sctr1b_proj*.01+b1
      uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
        b2 * input$sctr4b_proj*.01+b2
      uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
        b3 * input$sctr4b_proj*.01+b3
      uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
        b4 * input$sctr4b_proj*.01+b4
      uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
        b5 * input$sctr4b_proj*.01+b5
      uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
        b6 * input$sctr6b_proj*.01+b6
      uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
        b7 * input$sctr7b_proj*.01+b7
      uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
        b8 * input$sctr7b_proj*.01+b8
      uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
        b9 * input$sctr7b_proj*.01+b9
      uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
        b10 * input$sctr7b_proj*.01+b10
      uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
        b11 * input$sctr8b_proj*.01+b11
      uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory =
        b12 * input$sctr9b_proj*.01+b12
      
      COMBO = rbind(uva1,uva2)
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      #WATER FOOTPRINT ________________________________________________________________
      
      # Result units = gallons
      # Inventory unit (e.g. US gallon) * (gal water / inventory unit) 
      COMBO$W_Footprint1 = COMBO$inventory * COMBO$Water.EF #* 0.00378541178 us this if convert to m3
      
      
      for (i in 1:nrow(COMBO)){
        if(COMBO$Scope[i]=='Scope 1' &
           COMBO$Category[i]=='Direct Water Use' &
           COMBO$Sub_category[i]=='On-campus water consumption' &
           COMBO$Source[i]=='Direct Use') {
          COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * 1000000
        } else if(COMBO$Scope[i]=='Scope 2' &
                  COMBO$Category[i]=='Purchased Electricity' &
                  COMBO$Sub_category[i]=='Purchased Electricity' &
                  COMBO$Source[i]=='Purchased Electricity'){
          COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * (10^(-12))*3600000/0.00378541178
        } else {
          COMBO$W_Footprint[i] = COMBO$W_Footprint1[i]
        }
      }
      
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
        group_by(Category) %>% 
        summarize(Total_W_Footprint = sum(W_Footprint,na.rm=T))
      COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
        group_by(Category) %>% 
        summarize(Total_W_Footprint = sum(W_Footprint,na.rm=T)) 
      
      COMBO1$Timeframe = 'Baseline'
      COMBO2$Timeframe = 'Projected'
      
      #*****************************************************************************************************
      # ADD FOOD ONTO FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # Calculate total food footprints (original units = kg for C,N,P or gal for water)
      # final units = MT (Metric Tons)
      
      # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
      # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
      food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
      food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
      
      # Units for water = gallons
      B_food_footprint1 = sum(food1_$B_footprint,na.rm=T)
      B_food_footprint2 = sum(food2_$B_footprint,na.rm=T)
      G_food_footprint1 = sum(food1_$G_footprint,na.rm=T)
      G_food_footprint2 = sum(food2_$G_footprint,na.rm=T)
      BG_food_footprint1 = sum(food1_$BG_footprint,na.rm=T)
      BG_food_footprint2 = sum(food2_$BG_footprint,na.rm=T)
      
      #Make a new 1 row dataframe 
      B_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint1)
      B_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint2)
      G_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint1)
      G_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint2)
      BG_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint1)
      BG_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint2)
      
      W_food_rw1 = B_food_rw1
      W_food_rw2 = B_food_rw2
      
      W_food_rw1$Timeframe = 'Baseline'
      W_food_rw2$Timeframe = 'Projected'
      
      # add on the food row
      COMBO_foot1 = rbind(COMBO1,W_food_rw1)
      COMBO_foot2 = rbind(COMBO2,W_food_rw2)
      
      COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
      
      # Rearrange the rows to match the slider rows
      Water_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                      COMBO_foot[COMBO_foot$Category=='Food',],
                      COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                      COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                      COMBO_foot[COMBO_foot$Category=='Commuting',],
                      #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                      COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                      COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                      COMBO_foot[COMBO_foot$Category=='Wastewater',],
                      COMBO_foot[COMBO_foot$Category=='Direct Water Use',]) 
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 2 Water
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "15% Vegetarian Meals"){
      # Projected 1 (each variable changes differently)
      sectr1 = 'Purchased Electricity'
    sectr2 = 'Food'
    sectr3 = 'On-Campus Stationary Sources'
    sectr4 = 'Direct Transportation Sources'
    sectr5 = 'Commuting'
    sectr6 = 'Agriculture Sources'
    sectr7 = 'Refrigerants & Chemicals'
    sectr8 = 'Wastewater'
    sectr9 = 'Direct Water Use'
    
    uva1 = uva_R()
    uva2 = uva_R()
    
    # Add Projected category
    uva1$Timeframe = 'Baseline'
    uva2$Timeframe = 'Projected'
    
    # This reactive part is for all categories except Energy, Commuting, and Food
    # Gives the baseline value
    b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
    b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
    b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
    b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
    b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
    b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
    b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
    b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
    b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
    b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
    b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
    b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory
    
    # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
    uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
      b1 * input$sctr1c_proj*.01+b1
    uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
      b2 * input$sctr4c_proj*.01+b2
    uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
      b3 * input$sctr4c_proj*.01+b3
    uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
      b4 * input$sctr4c_proj*.01+b4
    uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
      b5 * input$sctr4c_proj*.01+b5
    uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
      b6 * input$sctr6c_proj*.01+b6
    uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
      b7 * input$sctr7c_proj*.01+b7
    uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
      b8 * input$sctr7c_proj*.01+b8
    uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
      b9 * input$sctr7c_proj*.01+b9
    uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
      b10 * input$sctr7c_proj*.01+b10
    uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
      b11 * input$sctr8c_proj*.01+b11
    uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory =
      b12 * input$sctr9c_proj*.01+b12
    
    COMBO = rbind(uva1,uva2)
    
    #*****************************************************************************************************
    # FOOTPRINT Calculations
    #*****************************************************************************************************
    
    #WATER FOOTPRINT ________________________________________________________________
    
    # Result units = gallons
    # Inventory unit (e.g. US gallon) * (gal water / inventory unit) 
    COMBO$W_Footprint1 = COMBO$inventory * COMBO$Water.EF #* 0.00378541178 us this if convert to m3
    
    
    for (i in 1:nrow(COMBO)){
      if(COMBO$Scope[i]=='Scope 1' &
         COMBO$Category[i]=='Direct Water Use' &
         COMBO$Sub_category[i]=='On-campus water consumption' &
         COMBO$Source[i]=='Direct Use') {
        COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * 1000000
      } else if(COMBO$Scope[i]=='Scope 2' &
                COMBO$Category[i]=='Purchased Electricity' &
                COMBO$Sub_category[i]=='Purchased Electricity' &
                COMBO$Source[i]=='Purchased Electricity'){
        COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * (10^(-12))*3600000/0.00378541178
      } else {
        COMBO$W_Footprint[i] = COMBO$W_Footprint1[i]
      }
    }
    
    #*****************************************************************************************************
    # FOOTPRINT DATA OUTPUT
    #*****************************************************************************************************
    
    # Summarize by Category___________________________________________________________________________
    # Units are MT C, MT N, MT P, Gallons Water 
    
    COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
      group_by(Category) %>% 
      summarize(Total_W_Footprint = sum(W_Footprint,na.rm=T))
    COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
      group_by(Category) %>% 
      summarize(Total_W_Footprint = sum(W_Footprint,na.rm=T)) 
    
    COMBO1$Timeframe = 'Baseline'
    COMBO2$Timeframe = 'Projected'
    
    #*****************************************************************************************************
    # ADD FOOD ONTO FOOTPRINT Calculations
    #*****************************************************************************************************
    
    # Calculate total food footprints (original units = kg for C,N,P or gal for water)
    # final units = MT (Metric Tons)
    
    # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
    # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
    food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    
    # Units for water = gallons
    B_food_footprint1 = sum(food1_$B_footprint,na.rm=T)
    B_food_footprint2 = sum(food2_$B_footprint,na.rm=T)
    G_food_footprint1 = sum(food1_$G_footprint,na.rm=T)
    G_food_footprint2 = sum(food2_$G_footprint,na.rm=T)
    BG_food_footprint1 = sum(food1_$BG_footprint,na.rm=T)
    BG_food_footprint2 = sum(food2_$BG_footprint,na.rm=T)
    
    #Make a new 1 row dataframe 
    B_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint1)
    B_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint2)
    G_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint1)
    G_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint2)
    BG_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint1)
    BG_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint2)
    
    W_food_rw1 = B_food_rw1
    W_food_rw2 = B_food_rw2
    
    W_food_rw1$Timeframe = 'Baseline'
    W_food_rw2$Timeframe = 'Projected'
    
    # add on the food row
    COMBO_foot1 = rbind(COMBO1,W_food_rw1)
    COMBO_foot2 = rbind(COMBO2,W_food_rw2)
    
    COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
    
    # Rearrange the rows to match the slider rows
    Water_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                    COMBO_foot[COMBO_foot$Category=='Food',],
                    COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                    COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                    COMBO_foot[COMBO_foot$Category=='Commuting',],
                    #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                    COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                    COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                    COMBO_foot[COMBO_foot$Category=='Wastewater',],
                    COMBO_foot[COMBO_foot$Category=='Direct Water Use',]) 
  } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 3 Water
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Replacement of 20% beef with Chicken"){
      # Projected 1 (each variable changes differently)
      sectr1 = 'Purchased Electricity'
      sectr2 = 'Food'
      sectr3 = 'On-Campus Stationary Sources'
      sectr4 = 'Direct Transportation Sources'
      sectr5 = 'Commuting'
      sectr6 = 'Agriculture Sources'
      sectr7 = 'Refrigerants & Chemicals'
      sectr8 = 'Wastewater'
      sectr9 = 'Direct Water Use'
      
      uva1 = uva_R()
      uva2 = uva_R()
      
      # Add Projected category
      uva1$Timeframe = 'Baseline'
      uva2$Timeframe = 'Projected'
      
      # This reactive part is for all categories except Energy, Commuting, and Food
      # Gives the baseline value
      b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
      b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
      b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
      b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
      b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
      b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
      b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
      b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
      b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
      b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
      b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
      b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory
      
      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
        b1 * input$sctr1d_proj*.01+b1
      uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
        b2 * input$sctr4d_proj*.01+b2
      uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
        b3 * input$sctr4d_proj*.01+b3
      uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
        b4 * input$sctr4d_proj*.01+b4
      uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
        b5 * input$sctr4d_proj*.01+b5
      uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
        b6 * input$sctr6d_proj*.01+b6
      uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
        b7 * input$sctr7d_proj*.01+b7
      uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
        b8 * input$sctr7d_proj*.01+b8
      uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
        b9 * input$sctr7d_proj*.01+b9
      uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
        b10 * input$sctr7d_proj*.01+b10
      uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
        b11 * input$sctr8d_proj*.01+b11
      uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory =
        b12 * input$sctr9d_proj*.01+b12
      
      COMBO = rbind(uva1,uva2)
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      #WATER FOOTPRINT ________________________________________________________________
      
      # Result units = gallons
      # Inventory unit (e.g. US gallon) * (gal water / inventory unit) 
      COMBO$W_Footprint1 = COMBO$inventory * COMBO$Water.EF #* 0.00378541178 us this if convert to m3
      
      
      for (i in 1:nrow(COMBO)){
        if(COMBO$Scope[i]=='Scope 1' &
           COMBO$Category[i]=='Direct Water Use' &
           COMBO$Sub_category[i]=='On-campus water consumption' &
           COMBO$Source[i]=='Direct Use') {
          COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * 1000000
        } else if(COMBO$Scope[i]=='Scope 2' &
                  COMBO$Category[i]=='Purchased Electricity' &
                  COMBO$Sub_category[i]=='Purchased Electricity' &
                  COMBO$Source[i]=='Purchased Electricity'){
          COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * (10^(-12))*3600000/0.00378541178
        } else {
          COMBO$W_Footprint[i] = COMBO$W_Footprint1[i]
        }
      }
      
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
        group_by(Category) %>% 
        summarize(Total_W_Footprint = sum(W_Footprint,na.rm=T))
      COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
        group_by(Category) %>% 
        summarize(Total_W_Footprint = sum(W_Footprint,na.rm=T)) 
      
      COMBO1$Timeframe = 'Baseline'
      COMBO2$Timeframe = 'Projected'
      
      #*****************************************************************************************************
      # ADD FOOD ONTO FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # Calculate total food footprints (original units = kg for C,N,P or gal for water)
      # final units = MT (Metric Tons)
      
      # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
      # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
      food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
      food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
      
      # Units for water = gallons
      B_food_footprint1 = sum(food1_$B_footprint,na.rm=T)
      B_food_footprint2 = sum(food2_$B_footprint,na.rm=T)
      G_food_footprint1 = sum(food1_$G_footprint,na.rm=T)
      G_food_footprint2 = sum(food2_$G_footprint,na.rm=T)
      BG_food_footprint1 = sum(food1_$BG_footprint,na.rm=T)
      BG_food_footprint2 = sum(food2_$BG_footprint,na.rm=T)
      
      #Make a new 1 row dataframe 
      B_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint1)
      B_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint2)
      G_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint1)
      G_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint2)
      BG_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint1)
      BG_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint2)
      
      W_food_rw1 = B_food_rw1
      W_food_rw2 = B_food_rw2
      
      W_food_rw1$Timeframe = 'Baseline'
      W_food_rw2$Timeframe = 'Projected'
      
      # add on the food row
      COMBO_foot1 = rbind(COMBO1,W_food_rw1)
      COMBO_foot2 = rbind(COMBO2,W_food_rw2)
      
      COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
      
      # Rearrange the rows to match the slider rows
      Water_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                      COMBO_foot[COMBO_foot$Category=='Food',],
                      COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                      COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                      COMBO_foot[COMBO_foot$Category=='Commuting',],
                      #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                      COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                      COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                      COMBO_foot[COMBO_foot$Category=='Wastewater',],
                      COMBO_foot[COMBO_foot$Category=='Direct Water Use',]) 
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 4 Water
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Fuel Optimization"){
      # Projected 1 (each variable changes differently)
      sectr1 = 'Purchased Electricity'
      sectr2 = 'Food'
      sectr3 = 'On-Campus Stationary Sources'
      sectr4 = 'Direct Transportation Sources'
      sectr5 = 'Commuting'
      sectr6 = 'Agriculture Sources'
      sectr7 = 'Refrigerants & Chemicals'
      sectr8 = 'Wastewater'
      sectr9 = 'Direct Water Use'
      
      uva1 = uva_R()
      uva2 = uva_R()
      
      # Add Projected category
      uva1$Timeframe = 'Baseline'
      uva2$Timeframe = 'Projected'
      
      # This reactive part is for all categories except Energy, Commuting, and Food
      # Gives the baseline value
      b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
      b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
      b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
      b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
      b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
      b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
      b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
      b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
      b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
      b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
      b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
      b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory
      
      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
        b1 * input$sctr1e_proj*.01+b1
      uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
        b2 * input$sctr4e_proj*.01+b2
      uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
        b3 * input$sctr4e_proj*.01+b3
      uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
        b4 * input$sctr4e_proj*.01+b4
      uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
        b5 * input$sctr4e_proj*.01+b5
      uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
        b6 * input$sctr6e_proj*.01+b6
      uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
        b7 * input$sctr7e_proj*.01+b7
      uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
        b8 * input$sctr7e_proj*.01+b8
      uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
        b9 * input$sctr7e_proj*.01+b9
      uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
        b10 * input$sctr7e_proj*.01+b10
      uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
        b11 * input$sctr8e_proj*.01+b11
      uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory =
        b12 * input$sctr9e_proj*.01+b12
      
      COMBO = rbind(uva1,uva2)
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      #WATER FOOTPRINT ________________________________________________________________
      
      # Result units = gallons
      # Inventory unit (e.g. US gallon) * (gal water / inventory unit) 
      COMBO$W_Footprint1 = COMBO$inventory * COMBO$Water.EF #* 0.00378541178 us this if convert to m3
      
      
      for (i in 1:nrow(COMBO)){
        if(COMBO$Scope[i]=='Scope 1' &
           COMBO$Category[i]=='Direct Water Use' &
           COMBO$Sub_category[i]=='On-campus water consumption' &
           COMBO$Source[i]=='Direct Use') {
          COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * 1000000
        } else if(COMBO$Scope[i]=='Scope 2' &
                  COMBO$Category[i]=='Purchased Electricity' &
                  COMBO$Sub_category[i]=='Purchased Electricity' &
                  COMBO$Source[i]=='Purchased Electricity'){
          COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * (10^(-12))*3600000/0.00378541178
        } else {
          COMBO$W_Footprint[i] = COMBO$W_Footprint1[i]
        }
      }
      
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
        group_by(Category) %>% 
        summarize(Total_W_Footprint = sum(W_Footprint,na.rm=T))
      COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
        group_by(Category) %>% 
        summarize(Total_W_Footprint = sum(W_Footprint,na.rm=T)) 
      
      COMBO1$Timeframe = 'Baseline'
      COMBO2$Timeframe = 'Projected'
      
      #*****************************************************************************************************
      # ADD FOOD ONTO FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # Calculate total food footprints (original units = kg for C,N,P or gal for water)
      # final units = MT (Metric Tons)
      
      # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
      # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
      food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
      food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
      
      # Units for water = gallons
      B_food_footprint1 = sum(food1_$B_footprint,na.rm=T)
      B_food_footprint2 = sum(food2_$B_footprint,na.rm=T)
      G_food_footprint1 = sum(food1_$G_footprint,na.rm=T)
      G_food_footprint2 = sum(food2_$G_footprint,na.rm=T)
      BG_food_footprint1 = sum(food1_$BG_footprint,na.rm=T)
      BG_food_footprint2 = sum(food2_$BG_footprint,na.rm=T)
      
      #Make a new 1 row dataframe 
      B_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint1)
      B_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint2)
      G_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint1)
      G_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint2)
      BG_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint1)
      BG_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint2)
      
      W_food_rw1 = B_food_rw1
      W_food_rw2 = B_food_rw2
      
      W_food_rw1$Timeframe = 'Baseline'
      W_food_rw2$Timeframe = 'Projected'
      
      # add on the food row
      COMBO_foot1 = rbind(COMBO1,W_food_rw1)
      COMBO_foot2 = rbind(COMBO2,W_food_rw2)
      
      COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
      
      # Rearrange the rows to match the slider rows
      Water_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                      COMBO_foot[COMBO_foot$Category=='Food',],
                      COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                      COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                      COMBO_foot[COMBO_foot$Category=='Commuting',],
                      #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                      COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                      COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                      COMBO_foot[COMBO_foot$Category=='Wastewater',],
                      COMBO_foot[COMBO_foot$Category=='Direct Water Use',]) 
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 5 Water
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Implementing All Scenarios"){
      # Projected 1 (each variable changes differently)
      sectr1 = 'Purchased Electricity'
      sectr2 = 'Food'
      sectr3 = 'On-Campus Stationary Sources'
      sectr4 = 'Direct Transportation Sources'
      sectr5 = 'Commuting'
      sectr6 = 'Agriculture Sources'
      sectr7 = 'Refrigerants & Chemicals'
      sectr8 = 'Wastewater'
      sectr9 = 'Direct Water Use'
      
      uva1 = uva_R()
      uva2 = uva_R()
      
      # Add Projected category
      uva1$Timeframe = 'Baseline'
      uva2$Timeframe = 'Projected'
      
      # This reactive part is for all categories except Energy, Commuting, and Food
      # Gives the baseline value
      b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
      b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
      b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
      b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
      b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
      b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
      b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
      b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
      b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
      b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
      b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
      b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory
      
      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory = 
        b1 * input$sctr1f_proj*.01+b1
      uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory = 
        b2 * input$sctr4f_proj*.01+b2
      uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory = 
        b3 * input$sctr4f_proj*.01+b3
      uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory = 
        b4 * input$sctr4f_proj*.01+b4
      uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory = 
        b5 * input$sctr4f_proj*.01+b5
      uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory = 
        b6 * input$sctr6f_proj*.01+b6
      uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory = 
        b7 * input$sctr7f_proj*.01+b7
      uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory = 
        b8 * input$sctr7f_proj*.01+b8
      uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory = 
        b9 * input$sctr7f_proj*.01+b9
      uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory = 
        b10 * input$sctr7f_proj*.01+b10
      uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory = 
        b11 * input$sctr8f_proj*.01+b11
      uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory =
        b12 * input$sctr9f_proj*.01+b12
      
      COMBO = rbind(uva1,uva2)
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      #WATER FOOTPRINT ________________________________________________________________
      
      # Result units = gallons
      # Inventory unit (e.g. US gallon) * (gal water / inventory unit) 
      COMBO$W_Footprint1 = COMBO$inventory * COMBO$Water.EF #* 0.00378541178 us this if convert to m3
      
      
      for (i in 1:nrow(COMBO)){
        if(COMBO$Scope[i]=='Scope 1' &
           COMBO$Category[i]=='Direct Water Use' &
           COMBO$Sub_category[i]=='On-campus water consumption' &
           COMBO$Source[i]=='Direct Use') {
          COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * 1000000
        } else if(COMBO$Scope[i]=='Scope 2' &
                  COMBO$Category[i]=='Purchased Electricity' &
                  COMBO$Sub_category[i]=='Purchased Electricity' &
                  COMBO$Source[i]=='Purchased Electricity'){
          COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * (10^(-12))*3600000/0.00378541178
        } else {
          COMBO$W_Footprint[i] = COMBO$W_Footprint1[i]
        }
      }
      
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
        group_by(Category) %>% 
        summarize(Total_W_Footprint = sum(W_Footprint,na.rm=T))
      COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
        group_by(Category) %>% 
        summarize(Total_W_Footprint = sum(W_Footprint,na.rm=T)) 
      
      COMBO1$Timeframe = 'Baseline'
      COMBO2$Timeframe = 'Projected'
      
      #*****************************************************************************************************
      # ADD FOOD ONTO FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # Calculate total food footprints (original units = kg for C,N,P or gal for water)
      # final units = MT (Metric Tons)
      
      # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
      # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
      food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
      food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
      
      # Units for water = gallons
      B_food_footprint1 = sum(food1_$B_footprint,na.rm=T)
      B_food_footprint2 = sum(food2_$B_footprint,na.rm=T)
      G_food_footprint1 = sum(food1_$G_footprint,na.rm=T)
      G_food_footprint2 = sum(food2_$G_footprint,na.rm=T)
      BG_food_footprint1 = sum(food1_$BG_footprint,na.rm=T)
      BG_food_footprint2 = sum(food2_$BG_footprint,na.rm=T)
      
      #Make a new 1 row dataframe 
      B_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint1)
      B_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint2)
      G_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint1)
      G_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint2)
      BG_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint1)
      BG_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint2)
      
      W_food_rw1 = B_food_rw1
      W_food_rw2 = B_food_rw2
      
      W_food_rw1$Timeframe = 'Baseline'
      W_food_rw2$Timeframe = 'Projected'
      
      # add on the food row
      COMBO_foot1 = rbind(COMBO1,W_food_rw1)
      COMBO_foot2 = rbind(COMBO2,W_food_rw2)
      
      COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
      
      # Rearrange the rows to match the slider rows
      Water_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                      COMBO_foot[COMBO_foot$Category=='Food',],
                      COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                      COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                      COMBO_foot[COMBO_foot$Category=='Commuting',],
                      #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                      COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                      COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                      COMBO_foot[COMBO_foot$Category=='Wastewater',],
                      COMBO_foot[COMBO_foot$Category=='Direct Water Use',]) 
    } # Scenario 
    
  }) # reactive
  
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  # STEP_9 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  #*****************************************************************************************************
  # C,N,P,W Reactive
  #*****************************************************************************************************
  
  TABLE_R <- reactive({

    # # Campus Vs. Individual
    # if(input$campusVindividual == "Campus"){
    #   uva = uva_R()
    #   food = food
    # }
    # 
    # else if(input$campusVindividual == "Individual"){
    #   uva = uva_individual
    #   food = food_individual
    # }

    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 0
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    if(input$scenario == "Manual Scenario"){
    # Projected 1 (each variable changes differently)
    sectr1 = 'Purchased Electricity'
    sectr2 = 'Food'
    sectr3 = 'On-Campus Stationary Sources'
    sectr4 = 'Direct Transportation Sources'
    sectr5 = 'Commuting'
    sectr6 = 'Agriculture Sources'
    sectr7 = 'Refrigerants & Chemicals'
    sectr8 = 'Wastewater'
    sectr9 = 'Direct Water Use'

    uva1 = uva_R()
    uva2 = uva_R()

    # Add Projected category
    uva1$Timeframe = 'Baseline'
    uva2$Timeframe = 'Projected'
    # Make sure they are same units before summarizing in next step

    # This reactive part is for all categories except Energy, Commuting, and Food
    # Gives the baseline value
    b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
    b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
    b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
    b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
    b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
    b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
    b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
    b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
    b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
    b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
    b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
    b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory

    # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
    uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory =
      b1 * input$sctr1a_proj*.01+b1
    uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory =
      b2 * input$sctr4a_proj*.01+b2
    uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory =
      b3 * input$sctr4a_proj*.01+b3
    uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory =
      b4 * input$sctr4a_proj*.01+b4
    uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory =
      b5 * input$sctr4a_proj*.01+b5
    uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory =
      b6 * input$sctr6a_proj*.01+b6
    uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory =
      b7 * input$sctr7a_proj*.01+b7
    uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory =
      b8 * input$sctr7a_proj*.01+b8
    uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory =
      b9 * input$sctr7a_proj*.01+b9
    uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory =
      b10 * input$sctr7a_proj*.01+b10
    uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory =
      b11 * input$sctr8a_proj*.01+b11
    uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory =
      b12 * input$sctr9a_proj*.01+b12

    TABLE_R = rbind(uva1,uva2)

    } # Scenario

    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 1 TABLE_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Business as Usual Growth to 2025"){
      # Projected 1 (each variable changes differently)
    sectr1 = 'Purchased Electricity'
    sectr2 = 'Food'
    sectr3 = 'On-Campus Stationary Sources'
    sectr4 = 'Direct Transportation Sources'
    sectr5 = 'Commuting'
    sectr6 = 'Agriculture Sources'
    sectr7 = 'Refrigerants & Chemicals'
    sectr8 = 'Wastewater'
    sectr9 = 'Direct Water Use'

    uva1 = uva_R()
    uva2 = uva_R()

    # Add Projected category
    uva1$Timeframe = 'Baseline'
    uva2$Timeframe = 'Projected'
    # Make sure they are same units before summarizing in next step

    # This reactive part is for all categories except Energy, Commuting, and Food
    # Gives the baseline value
    b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
    b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
    b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
    b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
    b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
    b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
    b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
    b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
    b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
    b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
    b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
    b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory

    # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
    uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory =
      b1 * input$sctr1b_proj*.01+b1
    uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory =
      b2 * input$sctr4b_proj*.01+b2
    uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory =
      b3 * input$sctr4b_proj*.01+b3
    uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory =
      b4 * input$sctr4b_proj*.01+b4
    uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory =
      b5 * input$sctr4b_proj*.01+b5
    uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory =
      b6 * input$sctr6b_proj*.01+b6
    uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory =
      b7 * input$sctr7b_proj*.01+b7
    uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory =
      b8 * input$sctr7b_proj*.01+b8
    uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory =
      b9 * input$sctr7b_proj*.01+b9
    uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory =
      b10 * input$sctr7b_proj*.01+b10
    uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory =
      b11 * input$sctr8b_proj*.01+b11
    uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory =
      b12 * input$sctr9b_proj*.01+b12

    TABLE_R = rbind(uva1,uva2)
    #test = TABLE_R[TABLE_R$Source == 'Purchased Electricity',]

  } # Scenario

    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 2 TABLE_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "15% Vegetarian Meals"){
      # Projected 1 (each variable changes differently)
      sectr1 = 'Purchased Electricity'
      sectr2 = 'Food'
      sectr3 = 'On-Campus Stationary Sources'
      sectr4 = 'Direct Transportation Sources'
      sectr5 = 'Commuting'
      sectr6 = 'Agriculture Sources'
      sectr7 = 'Refrigerants & Chemicals'
      sectr8 = 'Wastewater'
      sectr9 = 'Direct Water Use'

      uva1 = uva_R()
      uva2 = uva_R()

      # Add Projected category
      uva1$Timeframe = 'Baseline'
      uva2$Timeframe = 'Projected'
      # Make sure they are same units before summarizing in next step

      # This reactive part is for all categories except Energy, Commuting, and Food
      # Gives the baseline value
      b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
      b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
      b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
      b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
      b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
      b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
      b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
      b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
      b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
      b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
      b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
      b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory

      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory =
        b1 * input$sctr1c_proj*.01+b1
      uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory =
        b2 * input$sctr4c_proj*.01+b2
      uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory =
        b3 * input$sctr4c_proj*.01+b3
      uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory =
        b4 * input$sctr4c_proj*.01+b4
      uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory =
        b5 * input$sctr4c_proj*.01+b5
      uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory =
        b6 * input$sctr6c_proj*.01+b6
      uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory =
        b7 * input$sctr7c_proj*.01+b7
      uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory =
        b8 * input$sctr7c_proj*.01+b8
      uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory =
        b9 * input$sctr7c_proj*.01+b9
      uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory =
        b10 * input$sctr7c_proj*.01+b10
      uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory =
        b11 * input$sctr8c_proj*.01+b11
      uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory =
        b12 * input$sctr9c_proj*.01+b12

      TABLE_R = rbind(uva1,uva2)
    } # Scenario

    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 3 TABLE_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Replacement of 20% beef with Chicken"){
      # Projected 1 (each variable changes differently)
      sectr1 = 'Purchased Electricity'
      sectr2 = 'Food'
      sectr3 = 'On-Campus Stationary Sources'
      sectr4 = 'Direct Transportation Sources'
      sectr5 = 'Commuting'
      sectr6 = 'Agriculture Sources'
      sectr7 = 'Refrigerants & Chemicals'
      sectr8 = 'Wastewater'
      sectr9 = 'Direct Water Use'

      uva1 = uva_R()
      uva2 = uva_R()

      # Add Projected category
      uva1$Timeframe = 'Baseline'
      uva2$Timeframe = 'Projected'
      # Make sure they are same units before summarizing in next step

      # This reactive part is for all categories except Energy, Commuting, and Food
      # Gives the baseline value
      b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
      b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
      b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
      b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
      b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
      b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
      b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
      b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
      b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
      b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
      b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
      b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory

      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory =
        b1 * input$sctr1d_proj*.01+b1
      uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory =
        b2 * input$sctr4d_proj*.01+b2
      uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory =
        b3 * input$sctr4d_proj*.01+b3
      uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory =
        b4 * input$sctr4d_proj*.01+b4
      uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory =
        b5 * input$sctr4d_proj*.01+b5
      uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory =
        b6 * input$sctr6d_proj*.01+b6
      uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory =
        b7 * input$sctr7d_proj*.01+b7
      uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory =
        b8 * input$sctr7d_proj*.01+b8
      uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory =
        b9 * input$sctr7d_proj*.01+b9
      uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory =
        b10 * input$sctr7d_proj*.01+b10
      uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory =
        b11 * input$sctr8d_proj*.01+b11
      uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory =
        b12 * input$sctr9d_proj*.01+b12

      TABLE_R = rbind(uva1,uva2)
    } # Scenario

    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 4 TABLE_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Fuel Optimization"){
      # Projected 1 (each variable changes differently)
      sectr1 = 'Purchased Electricity'
      sectr2 = 'Food'
      sectr3 = 'On-Campus Stationary Sources'
      sectr4 = 'Direct Transportation Sources'
      sectr5 = 'Commuting'
      sectr6 = 'Agriculture Sources'
      sectr7 = 'Refrigerants & Chemicals'
      sectr8 = 'Wastewater'
      sectr9 = 'Direct Water Use'

      uva1 = uva_R()
      uva2 = uva_R()

      # Add Projected category
      uva1$Timeframe = 'Baseline'
      uva2$Timeframe = 'Projected'
      # Make sure they are same units before summarizing in next step

      # This reactive part is for all categories except Energy, Commuting, and Food
      # Gives the baseline value
      b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
      b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
      b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
      b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
      b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
      b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
      b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
      b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
      b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
      b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
      b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
      b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory

      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory =
        b1 * input$sctr1e_proj*.01+b1
      uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory =
        b2 * input$sctr4e_proj*.01+b2
      uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory =
        b3 * input$sctr4e_proj*.01+b3
      uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory =
        b4 * input$sctr4e_proj*.01+b4
      uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory =
        b5 * input$sctr4e_proj*.01+b5
      uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory =
        b6 * input$sctr6e_proj*.01+b6
      uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory =
        b7 * input$sctr7e_proj*.01+b7
      uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory =
        b8 * input$sctr7e_proj*.01+b8
      uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory =
        b9 * input$sctr7e_proj*.01+b9
      uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory =
        b10 * input$sctr7e_proj*.01+b10
      uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory =
        b11 * input$sctr8e_proj*.01+b11
      uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory =
        b12 * input$sctr9e_proj*.01+b12

      TABLE_R = rbind(uva1,uva2)
    } # Scenario

    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 5 TABLE_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Implementing All Scenarios"){
      # Projected 1 (each variable changes differently)
      sectr1 = 'Purchased Electricity'
      sectr2 = 'Food'
      sectr3 = 'On-Campus Stationary Sources'
      sectr4 = 'Direct Transportation Sources'
      sectr5 = 'Commuting'
      sectr6 = 'Agriculture Sources'
      sectr7 = 'Refrigerants & Chemicals'
      sectr8 = 'Wastewater'
      sectr9 = 'Direct Water Use'

      uva1 = uva_R()
      uva2 = uva_R()

      # Add Projected category
      uva1$Timeframe = 'Baseline'
      uva2$Timeframe = 'Projected'
      # Make sure they are same units before summarizing in next step

      # This reactive part is for all categories except Energy, Commuting, and Food
      # Gives the baseline value
      b1 = uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory
      b2 = uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory
      b3 = uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory
      b4 = uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory
      b5 = uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory
      b6 = uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory
      b7 = uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory
      b8 = uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory
      b9 = uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory
      b10 = uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory
      b11 = uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory
      b12 = uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory

      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      uva2[uva2$Category == sectr1 & uva2$Source == 'Purchased Electricity',]$inventory =
        b1 * input$sctr1f_proj*.01+b1
      uva2[uva2$Category == sectr4 & uva2$Source == 'B100',]$inventory =
        b2 * input$sctr4f_proj*.01+b2
      uva2[uva2$Category == sectr4 & uva2$Source == 'Diesel Fleet',]$inventory =
        b3 * input$sctr4f_proj*.01+b3
      uva2[uva2$Category == sectr4 & uva2$Source == 'Gasoline Fleet',]$inventory =
        b4 * input$sctr4f_proj*.01+b4
      uva2[uva2$Category == sectr4 & uva2$Source == 'Other (Liquid fuels)',]$inventory =
        b5 * input$sctr4f_proj*.01+b5
      uva2[uva2$Category == sectr6 & uva2$Source == 'Synthetic',]$inventory =
        b6 * input$sctr6f_proj*.01+b6
      uva2[uva2$Category == sectr7 & uva2$Source == 'HCFC-22',]$inventory =
        b7 * input$sctr7f_proj*.01+b7
      uva2[uva2$Category == sectr7 & uva2$Source == 'HFC-134a',]$inventory =
        b8 * input$sctr7f_proj*.01+b8
      uva2[uva2$Category == sectr7 & uva2$Source == 'Other',]$inventory =
        b9 * input$sctr7f_proj*.01+b9
      uva2[uva2$Category == sectr7 & uva2$Source == 'R-404a',]$inventory =
        b10 * input$sctr7f_proj*.01+b10
      uva2[uva2$Category == sectr8 & uva2$Source == 'Anaerobic Digestion',]$inventory =
        b11 * input$sctr8f_proj*.01+b11
      uva2[uva2$Category == sectr9 & uva2$Source == 'Direct Use',]$inventory =
        b12 * input$sctr9f_proj*.01+b12

      TABLE_R = rbind(uva1,uva2)
    } # Scenario

  }) # reactive
  
  COMBO_R_ <- reactive({
    
    # # Campus Vs. Individual
    # if(input$campusVindividual == "Campus"){
    #   uva = uva_R()
    #   food = food
    # }
    # 
    # else if(input$campusVindividual == "Individual"){
    #   uva = uva_individual
    #   food = food_individual
    # }
    
    # Units for inventory varies (gal )
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 0
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    if(input$scenario == "Manual Scenario"){
    COMBO = TABLE_R()
    
    #CARBON_____________________________________________________________________
    # Result units = kg CO2
    # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
    COMBO$CO2_r = COMBO$inventory * COMBO$CO2.EF
    
    # Result units = kg eCO2
    # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
    COMBO$eCO2_r = COMBO$inventory * COMBO$eCO2.EF
    
    # Result units = kg CH4
    # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
    COMBO$CH4_r = COMBO$inventory * COMBO$CH4.EF
    
    #NITROGEN_____________________________________________________________________
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMBO$N2O_r = COMBO$inventory * COMBO$N2O.EF
    
    # Result units = kg NOx
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMBO$NOx_r = COMBO$inventory * COMBO$NOx.EF
    
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMBO$OtherN_r = COMBO$inventory * COMBO$Other.N.EF
    
    #INTERMEDIATE C & N _______________________________________________________________
    
    # calculate Footprints by category (divide by 1000 to convert from kg to MT)
    # Units of GWP 
    COMBO$CO2_MTCDE = COMBO$CO2_r/1000  # MT CO2e
    COMBO$eCO2_MTCDE = COMBO$eCO2_r/1000 # MT CO2e
    COMBO$CH4_MTCDE = COMBO$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
    COMBO$N2O_MTCDE = COMBO$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
    
    # Calculations only for refrigerants and chemicals for Carbon
    # inventory (kg) * GWP (Unitless??) / 1000 = MT CO2e
    COMBO$Ref_Chem[COMBO$Source=='HCFC-22'] = COMBO[COMBO$Source=='HCFC-22',]$inventory * gwp[gwp$Pollutant=='HCFC-22',]$GWP/1000 # MT CO2e
    COMBO$Ref_Chem[COMBO$Source=='HCFE-235da2'] = COMBO[COMBO$Source=='HCFE-235da2',]$inventory * gwp[gwp$Pollutant=='HCFE-235da2',]$GWP/1000 # MT CO2e
    COMBO$Ref_Chem[COMBO$Source=='HFC-134a'] = COMBO[COMBO$Source=='HFC-134a',]$inventory * gwp[gwp$Pollutant=='HFC-134a',]$GWP/1000 # MT CO2e
    COMBO$Ref_Chem[COMBO$Source=='HG-10'] = COMBO[COMBO$Source=='HG-10',]$inventory * gwp[gwp$Pollutant=='HG-10',]$GWP/1000 # MT CO2e
    #COMBO$Ref_Chem[COMBO$Source=='Other'] = COMBO[COMBO$Source=='Other',]$inventory * gwp[gwp$Pollutant=='Other',]$GWP/1000 # MT CO2e
    COMBO$Ref_Chem[COMBO$Source=='R-404a'] = COMBO[COMBO$Source=='R-404a',]$inventory * gwp[gwp$Pollutant=='R-404a',]$GWP/1000 # MT CO2e
    
    # intermediate N
    COMBO$N2O_MTN = COMBO$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
    COMBO$NOx_MTN = COMBO$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
    COMBO$OtherN_MTN = COMBO$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N  
    
    #*****************************************************************************************************
    # FOOTPRINT Calculations
    #*****************************************************************************************************
    
    # CALCULATING FOOTPRINT C & N_____________________________________________________________________
    # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
    
    COMBO$C_Footprint = rowSums(COMBO[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE','Ref_Chem')],na.rm=T) 
    COMBO$N_Footprint = rowSums(COMBO[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
    
    
    #PHOSPHORUS FOOTPRINT_____________________________________________________________________
    
    # Result units = MT of P
    # Inventory unit (e.g. US gallon) * kg P / inventory unit
    COMBO$P_Footprint = COMBO$inventory * COMBO$P.EF /1000  # Divide by 1000 to get metric tons
    
    
    #WATER FOOTPRINT ________________________________________________________________
    
    # Result units = gallons
    # Inventory unit (e.g. US gallon) * (gal water / inventory unit) 
    
    COMBO$W_Footprint1 = COMBO$inventory * COMBO$Water.EF #* 0.00378541178 us this if convert to m3
    
    
    for (i in 1:nrow(COMBO)){
      if(COMBO$Scope[i]=='Scope 1' & 
         COMBO$Category[i]=='Direct Water Use' & 
         COMBO$Sub_category[i]=='On-campus water consumption' & 
         COMBO$Source[i]=='Direct Use') {
        COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * 1000000
      } else if(COMBO$Scope[i]=='Scope 2' & 
                COMBO$Category[i]=='Purchased Electricity' &
                COMBO$Sub_category[i]=='Purchased Electricity' & 
                COMBO$Source[i]=='Purchased Electricity'){
        COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * (10^(-12))*3600000/0.00378541178
      } else {
        COMBO$W_Footprint[i] = COMBO$W_Footprint1[i]
      } 
    }
    
    COMBO_R_ = COMBO  # Units are MT for C, N, P, & gallons for Water
    
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 1 COMBO_R_
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Business as Usual Growth to 2025"){
    COMBO = TABLE_R()
      
    #CARBON_____________________________________________________________________
    # Result units = kg CO2
    # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
    COMBO$CO2_r = COMBO$inventory * COMBO$CO2.EF
    
    # Result units = kg eCO2
    # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
    COMBO$eCO2_r = COMBO$inventory * COMBO$eCO2.EF
    
    # Result units = kg CH4
    # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
    COMBO$CH4_r = COMBO$inventory * COMBO$CH4.EF
    
    #NITROGEN_____________________________________________________________________
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMBO$N2O_r = COMBO$inventory * COMBO$N2O.EF
    
    # Result units = kg NOx
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMBO$NOx_r = COMBO$inventory * COMBO$NOx.EF
    
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMBO$OtherN_r = COMBO$inventory * COMBO$Other.N.EF
    
    #INTERMEDIATE C & N _______________________________________________________________
    
    # calculate Footprints by category (divide by 1000 to convert from kg to MT)
    # Units of GWP 
    COMBO$CO2_MTCDE = COMBO$CO2_r/1000  # MT CO2e
    COMBO$eCO2_MTCDE = COMBO$eCO2_r/1000 # MT CO2e
    COMBO$CH4_MTCDE = COMBO$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
    COMBO$N2O_MTCDE = COMBO$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
    
    # Calculations only for refrigerants and chemicals for Carbon
    # inventory (kg) * GWP (Unitless??) / 1000 = MT CO2e
    COMBO$Ref_Chem[COMBO$Source=='HCFC-22'] = COMBO[COMBO$Source=='HCFC-22',]$inventory * gwp[gwp$Pollutant=='HCFC-22',]$GWP/1000 # MT CO2e
    COMBO$Ref_Chem[COMBO$Source=='HCFE-235da2'] = COMBO[COMBO$Source=='HCFE-235da2',]$inventory * gwp[gwp$Pollutant=='HCFE-235da2',]$GWP/1000 # MT CO2e
    COMBO$Ref_Chem[COMBO$Source=='HFC-134a'] = COMBO[COMBO$Source=='HFC-134a',]$inventory * gwp[gwp$Pollutant=='HFC-134a',]$GWP/1000 # MT CO2e
    COMBO$Ref_Chem[COMBO$Source=='HG-10'] = COMBO[COMBO$Source=='HG-10',]$inventory * gwp[gwp$Pollutant=='HG-10',]$GWP/1000 # MT CO2e
    #COMBO$Ref_Chem[COMBO$Source=='Other'] = COMBO[COMBO$Source=='Other',]$inventory * gwp[gwp$Pollutant=='Other',]$GWP/1000 # MT CO2e
    COMBO$Ref_Chem[COMBO$Source=='R-404a'] = COMBO[COMBO$Source=='R-404a',]$inventory * gwp[gwp$Pollutant=='R-404a',]$GWP/1000 # MT CO2e
    
    # intermediate N
    COMBO$N2O_MTN = COMBO$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
    COMBO$NOx_MTN = COMBO$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
    COMBO$OtherN_MTN = COMBO$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N  
    
    #*****************************************************************************************************
    # FOOTPRINT Calculations
    #*****************************************************************************************************
    
    # CALCULATING FOOTPRINT C & N_____________________________________________________________________
    # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
    
    COMBO$C_Footprint = rowSums(COMBO[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE','Ref_Chem')],na.rm=T) 
    COMBO$N_Footprint = rowSums(COMBO[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
    
    
    #PHOSPHORUS FOOTPRINT_____________________________________________________________________
    
    # Result units = MT of P
    # Inventory unit (e.g. US gallon) * kg P / inventory unit
    COMBO$P_Footprint = COMBO$inventory * COMBO$P.EF /1000  # Divide by 1000 to get metric tons
    
    
    #WATER FOOTPRINT ________________________________________________________________
    
    # Result units = gallons
    # Inventory unit (e.g. US gallon) * (gal water / inventory unit) 
    
    COMBO$W_Footprint1 = COMBO$inventory * COMBO$Water.EF #* 0.00378541178 us this if convert to m3
    
    
    for (i in 1:nrow(COMBO)){
      if(COMBO$Scope[i]=='Scope 1' & 
         COMBO$Category[i]=='Direct Water Use' & 
         COMBO$Sub_category[i]=='On-campus water consumption' & 
         COMBO$Source[i]=='Direct Use') {
        COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * 1000000
      } else if(COMBO$Scope[i]=='Scope 2' & 
                COMBO$Category[i]=='Purchased Electricity' &
                COMBO$Sub_category[i]=='Purchased Electricity' & 
                COMBO$Source[i]=='Purchased Electricity'){
        COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * (10^(-12))*3600000/0.00378541178
      } else {
        COMBO$W_Footprint[i] = COMBO$W_Footprint1[i]
      } 
    }
    
    COMBO_R_ = COMBO  # Units are MT for C, N, P, & gallons for Water  
    #test = COMBO_R_[COMBO_R_$Source == 'Purchased Electricity',]
    
  } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 2 COMBO_R_
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "15% Vegetarian Meals"){
      COMBO = TABLE_R()
      
      #CARBON_____________________________________________________________________
      # Result units = kg CO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
      COMBO$CO2_r = COMBO$inventory * COMBO$CO2.EF
      
      # Result units = kg eCO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
      COMBO$eCO2_r = COMBO$inventory * COMBO$eCO2.EF
      
      # Result units = kg CH4
      # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
      COMBO$CH4_r = COMBO$inventory * COMBO$CH4.EF
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$N2O_r = COMBO$inventory * COMBO$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$NOx_r = COMBO$inventory * COMBO$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$OtherN_r = COMBO$inventory * COMBO$Other.N.EF
      
      #INTERMEDIATE C & N _______________________________________________________________
      
      # calculate Footprints by category (divide by 1000 to convert from kg to MT)
      # Units of GWP 
      COMBO$CO2_MTCDE = COMBO$CO2_r/1000  # MT CO2e
      COMBO$eCO2_MTCDE = COMBO$eCO2_r/1000 # MT CO2e
      COMBO$CH4_MTCDE = COMBO$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
      COMBO$N2O_MTCDE = COMBO$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
      
      # Calculations only for refrigerants and chemicals for Carbon
      # inventory (kg) * GWP (Unitless??) / 1000 = MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HCFC-22'] = COMBO[COMBO$Source=='HCFC-22',]$inventory * gwp[gwp$Pollutant=='HCFC-22',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HCFE-235da2'] = COMBO[COMBO$Source=='HCFE-235da2',]$inventory * gwp[gwp$Pollutant=='HCFE-235da2',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HFC-134a'] = COMBO[COMBO$Source=='HFC-134a',]$inventory * gwp[gwp$Pollutant=='HFC-134a',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HG-10'] = COMBO[COMBO$Source=='HG-10',]$inventory * gwp[gwp$Pollutant=='HG-10',]$GWP/1000 # MT CO2e
      #COMBO$Ref_Chem[COMBO$Source=='Other'] = COMBO[COMBO$Source=='Other',]$inventory * gwp[gwp$Pollutant=='Other',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='R-404a'] = COMBO[COMBO$Source=='R-404a',]$inventory * gwp[gwp$Pollutant=='R-404a',]$GWP/1000 # MT CO2e
      
      # intermediate N
      COMBO$N2O_MTN = COMBO$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
      COMBO$NOx_MTN = COMBO$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
      COMBO$OtherN_MTN = COMBO$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N  
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C & N_____________________________________________________________________
      # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
      
      COMBO$C_Footprint = rowSums(COMBO[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE','Ref_Chem')],na.rm=T) 
      COMBO$N_Footprint = rowSums(COMBO[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
      
      
      #PHOSPHORUS FOOTPRINT_____________________________________________________________________
      
      # Result units = MT of P
      # Inventory unit (e.g. US gallon) * kg P / inventory unit
      COMBO$P_Footprint = COMBO$inventory * COMBO$P.EF /1000  # Divide by 1000 to get metric tons
      
      
      #WATER FOOTPRINT ________________________________________________________________
      
      # Result units = gallons
      # Inventory unit (e.g. US gallon) * (gal water / inventory unit) 
      
      COMBO$W_Footprint1 = COMBO$inventory * COMBO$Water.EF #* 0.00378541178 us this if convert to m3
      
      
      for (i in 1:nrow(COMBO)){
        if(COMBO$Scope[i]=='Scope 1' & 
           COMBO$Category[i]=='Direct Water Use' & 
           COMBO$Sub_category[i]=='On-campus water consumption' & 
           COMBO$Source[i]=='Direct Use') {
          COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * 1000000
        } else if(COMBO$Scope[i]=='Scope 2' & 
                  COMBO$Category[i]=='Purchased Electricity' &
                  COMBO$Sub_category[i]=='Purchased Electricity' & 
                  COMBO$Source[i]=='Purchased Electricity'){
          COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * (10^(-12))*3600000/0.00378541178
        } else {
          COMBO$W_Footprint[i] = COMBO$W_Footprint1[i]
        } 
      }
      
      COMBO_R_ = COMBO  # Units are MT for C, N, P, & gallons for Water  
    } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 3 COMBO_R_
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Replacement of 20% beef with Chicken"){
      COMBO = TABLE_R()
      
      #CARBON_____________________________________________________________________
      # Result units = kg CO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
      COMBO$CO2_r = COMBO$inventory * COMBO$CO2.EF
      
      # Result units = kg eCO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
      COMBO$eCO2_r = COMBO$inventory * COMBO$eCO2.EF
      
      # Result units = kg CH4
      # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
      COMBO$CH4_r = COMBO$inventory * COMBO$CH4.EF
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$N2O_r = COMBO$inventory * COMBO$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$NOx_r = COMBO$inventory * COMBO$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$OtherN_r = COMBO$inventory * COMBO$Other.N.EF
      
      #INTERMEDIATE C & N _______________________________________________________________
      
      # calculate Footprints by category (divide by 1000 to convert from kg to MT)
      # Units of GWP 
      COMBO$CO2_MTCDE = COMBO$CO2_r/1000  # MT CO2e
      COMBO$eCO2_MTCDE = COMBO$eCO2_r/1000 # MT CO2e
      COMBO$CH4_MTCDE = COMBO$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
      COMBO$N2O_MTCDE = COMBO$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
      
      # Calculations only for refrigerants and chemicals for Carbon
      # inventory (kg) * GWP (Unitless??) / 1000 = MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HCFC-22'] = COMBO[COMBO$Source=='HCFC-22',]$inventory * gwp[gwp$Pollutant=='HCFC-22',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HCFE-235da2'] = COMBO[COMBO$Source=='HCFE-235da2',]$inventory * gwp[gwp$Pollutant=='HCFE-235da2',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HFC-134a'] = COMBO[COMBO$Source=='HFC-134a',]$inventory * gwp[gwp$Pollutant=='HFC-134a',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HG-10'] = COMBO[COMBO$Source=='HG-10',]$inventory * gwp[gwp$Pollutant=='HG-10',]$GWP/1000 # MT CO2e
      #COMBO$Ref_Chem[COMBO$Source=='Other'] = COMBO[COMBO$Source=='Other',]$inventory * gwp[gwp$Pollutant=='Other',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='R-404a'] = COMBO[COMBO$Source=='R-404a',]$inventory * gwp[gwp$Pollutant=='R-404a',]$GWP/1000 # MT CO2e
      
      # intermediate N
      COMBO$N2O_MTN = COMBO$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
      COMBO$NOx_MTN = COMBO$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
      COMBO$OtherN_MTN = COMBO$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N  
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C & N_____________________________________________________________________
      # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
      
      COMBO$C_Footprint = rowSums(COMBO[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE','Ref_Chem')],na.rm=T) 
      COMBO$N_Footprint = rowSums(COMBO[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
      
      
      #PHOSPHORUS FOOTPRINT_____________________________________________________________________
      
      # Result units = MT of P
      # Inventory unit (e.g. US gallon) * kg P / inventory unit
      COMBO$P_Footprint = COMBO$inventory * COMBO$P.EF /1000  # Divide by 1000 to get metric tons
      
      
      #WATER FOOTPRINT ________________________________________________________________
      
      # Result units = gallons
      # Inventory unit (e.g. US gallon) * (gal water / inventory unit) 
      
      COMBO$W_Footprint1 = COMBO$inventory * COMBO$Water.EF #* 0.00378541178 us this if convert to m3
      
      
      for (i in 1:nrow(COMBO)){
        if(COMBO$Scope[i]=='Scope 1' & 
           COMBO$Category[i]=='Direct Water Use' & 
           COMBO$Sub_category[i]=='On-campus water consumption' & 
           COMBO$Source[i]=='Direct Use') {
          COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * 1000000
        } else if(COMBO$Scope[i]=='Scope 2' & 
                  COMBO$Category[i]=='Purchased Electricity' &
                  COMBO$Sub_category[i]=='Purchased Electricity' & 
                  COMBO$Source[i]=='Purchased Electricity'){
          COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * (10^(-12))*3600000/0.00378541178
        } else {
          COMBO$W_Footprint[i] = COMBO$W_Footprint1[i]
        } 
      }
      
      COMBO_R_ = COMBO  # Units are MT for C, N, P, & gallons for Water  
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 4 COMBO_R_
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Fuel Optimization"){
      COMBO = TABLE_R()
      
      #CARBON_____________________________________________________________________
      # Result units = kg CO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
      COMBO$CO2_r = COMBO$inventory * COMBO$CO2.EF
      
      # Result units = kg eCO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
      COMBO$eCO2_r = COMBO$inventory * COMBO$eCO2.EF
      
      # Result units = kg CH4
      # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
      COMBO$CH4_r = COMBO$inventory * COMBO$CH4.EF
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$N2O_r = COMBO$inventory * COMBO$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$NOx_r = COMBO$inventory * COMBO$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$OtherN_r = COMBO$inventory * COMBO$Other.N.EF
      
      #INTERMEDIATE C & N _______________________________________________________________
      
      # calculate Footprints by category (divide by 1000 to convert from kg to MT)
      # Units of GWP 
      COMBO$CO2_MTCDE = COMBO$CO2_r/1000  # MT CO2e
      COMBO$eCO2_MTCDE = COMBO$eCO2_r/1000 # MT CO2e
      COMBO$CH4_MTCDE = COMBO$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
      COMBO$N2O_MTCDE = COMBO$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
      
      # Calculations only for refrigerants and chemicals for Carbon
      # inventory (kg) * GWP (Unitless??) / 1000 = MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HCFC-22'] = COMBO[COMBO$Source=='HCFC-22',]$inventory * gwp[gwp$Pollutant=='HCFC-22',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HCFE-235da2'] = COMBO[COMBO$Source=='HCFE-235da2',]$inventory * gwp[gwp$Pollutant=='HCFE-235da2',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HFC-134a'] = COMBO[COMBO$Source=='HFC-134a',]$inventory * gwp[gwp$Pollutant=='HFC-134a',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HG-10'] = COMBO[COMBO$Source=='HG-10',]$inventory * gwp[gwp$Pollutant=='HG-10',]$GWP/1000 # MT CO2e
      #COMBO$Ref_Chem[COMBO$Source=='Other'] = COMBO[COMBO$Source=='Other',]$inventory * gwp[gwp$Pollutant=='Other',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='R-404a'] = COMBO[COMBO$Source=='R-404a',]$inventory * gwp[gwp$Pollutant=='R-404a',]$GWP/1000 # MT CO2e
      
      # intermediate N
      COMBO$N2O_MTN = COMBO$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
      COMBO$NOx_MTN = COMBO$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
      COMBO$OtherN_MTN = COMBO$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N  
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C & N_____________________________________________________________________
      # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
      
      COMBO$C_Footprint = rowSums(COMBO[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE','Ref_Chem')],na.rm=T) 
      COMBO$N_Footprint = rowSums(COMBO[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
      
      
      #PHOSPHORUS FOOTPRINT_____________________________________________________________________
      
      # Result units = MT of P
      # Inventory unit (e.g. US gallon) * kg P / inventory unit
      COMBO$P_Footprint = COMBO$inventory * COMBO$P.EF /1000  # Divide by 1000 to get metric tons
      
      
      #WATER FOOTPRINT ________________________________________________________________
      
      # Result units = gallons
      # Inventory unit (e.g. US gallon) * (gal water / inventory unit) 
      
      COMBO$W_Footprint1 = COMBO$inventory * COMBO$Water.EF #* 0.00378541178 us this if convert to m3
      
      
      for (i in 1:nrow(COMBO)){
        if(COMBO$Scope[i]=='Scope 1' & 
           COMBO$Category[i]=='Direct Water Use' & 
           COMBO$Sub_category[i]=='On-campus water consumption' & 
           COMBO$Source[i]=='Direct Use') {
          COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * 1000000
        } else if(COMBO$Scope[i]=='Scope 2' & 
                  COMBO$Category[i]=='Purchased Electricity' &
                  COMBO$Sub_category[i]=='Purchased Electricity' & 
                  COMBO$Source[i]=='Purchased Electricity'){
          COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * (10^(-12))*3600000/0.00378541178
        } else {
          COMBO$W_Footprint[i] = COMBO$W_Footprint1[i]
        } 
      }
      
      COMBO_R_ = COMBO  # Units are MT for C, N, P, & gallons for Water  
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 5 COMBO_R_
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Implementing All Scenarios"){
      COMBO = TABLE_R()
      
      #CARBON_____________________________________________________________________
      # Result units = kg CO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
      COMBO$CO2_r = COMBO$inventory * COMBO$CO2.EF
      
      # Result units = kg eCO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
      COMBO$eCO2_r = COMBO$inventory * COMBO$eCO2.EF
      
      # Result units = kg CH4
      # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
      COMBO$CH4_r = COMBO$inventory * COMBO$CH4.EF
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$N2O_r = COMBO$inventory * COMBO$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$NOx_r = COMBO$inventory * COMBO$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMBO$OtherN_r = COMBO$inventory * COMBO$Other.N.EF
      
      #INTERMEDIATE C & N _______________________________________________________________
      
      # calculate Footprints by category (divide by 1000 to convert from kg to MT)
      # Units of GWP 
      COMBO$CO2_MTCDE = COMBO$CO2_r/1000  # MT CO2e
      COMBO$eCO2_MTCDE = COMBO$eCO2_r/1000 # MT CO2e
      COMBO$CH4_MTCDE = COMBO$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
      COMBO$N2O_MTCDE = COMBO$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
      
      # Calculations only for refrigerants and chemicals for Carbon
      # inventory (kg) * GWP (Unitless??) / 1000 = MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HCFC-22'] = COMBO[COMBO$Source=='HCFC-22',]$inventory * gwp[gwp$Pollutant=='HCFC-22',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HCFE-235da2'] = COMBO[COMBO$Source=='HCFE-235da2',]$inventory * gwp[gwp$Pollutant=='HCFE-235da2',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HFC-134a'] = COMBO[COMBO$Source=='HFC-134a',]$inventory * gwp[gwp$Pollutant=='HFC-134a',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='HG-10'] = COMBO[COMBO$Source=='HG-10',]$inventory * gwp[gwp$Pollutant=='HG-10',]$GWP/1000 # MT CO2e
      #COMBO$Ref_Chem[COMBO$Source=='Other'] = COMBO[COMBO$Source=='Other',]$inventory * gwp[gwp$Pollutant=='Other',]$GWP/1000 # MT CO2e
      COMBO$Ref_Chem[COMBO$Source=='R-404a'] = COMBO[COMBO$Source=='R-404a',]$inventory * gwp[gwp$Pollutant=='R-404a',]$GWP/1000 # MT CO2e
      
      # intermediate N
      COMBO$N2O_MTN = COMBO$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
      COMBO$NOx_MTN = COMBO$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
      COMBO$OtherN_MTN = COMBO$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N  
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C & N_____________________________________________________________________
      # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
      
      COMBO$C_Footprint = rowSums(COMBO[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE','Ref_Chem')],na.rm=T) 
      COMBO$N_Footprint = rowSums(COMBO[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
      
      
      #PHOSPHORUS FOOTPRINT_____________________________________________________________________
      
      # Result units = MT of P
      # Inventory unit (e.g. US gallon) * kg P / inventory unit
      COMBO$P_Footprint = COMBO$inventory * COMBO$P.EF /1000  # Divide by 1000 to get metric tons
      
      
      #WATER FOOTPRINT ________________________________________________________________
      
      # Result units = gallons
      # Inventory unit (e.g. US gallon) * (gal water / inventory unit) 
      
      COMBO$W_Footprint1 = COMBO$inventory * COMBO$Water.EF #* 0.00378541178 us this if convert to m3
      
      
      for (i in 1:nrow(COMBO)){
        if(COMBO$Scope[i]=='Scope 1' & 
           COMBO$Category[i]=='Direct Water Use' & 
           COMBO$Sub_category[i]=='On-campus water consumption' & 
           COMBO$Source[i]=='Direct Use') {
          COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * 1000000
        } else if(COMBO$Scope[i]=='Scope 2' & 
                  COMBO$Category[i]=='Purchased Electricity' &
                  COMBO$Sub_category[i]=='Purchased Electricity' & 
                  COMBO$Source[i]=='Purchased Electricity'){
          COMBO$W_Footprint[i] = COMBO$W_Footprint1[i] * (10^(-12))*3600000/0.00378541178
        } else {
          COMBO$W_Footprint[i] = COMBO$W_Footprint1[i]
        } 
      }
      
      COMBO_R_ = COMBO  # Units are MT for C, N, P, & gallons for Water  
    } # Scenario 
    
  }) # reactive
  
  #*****************************************************************************************************
  # FOOTPRINT DATA OUTPUT
  #*****************************************************************************************************
  
  COMBO_R <- reactive({
    
    # # Campus Vs. Individual
    # if(input$campusVindividual == "Campus"){
    #   uva = uva_R()
    #   food = food
    # }
    # 
    # else if(input$campusVindividual == "Individual"){
    #   uva = uva_individual
    #   food = food_individual
    # }
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 0
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    if(input$scenario == "Manual Scenario"){
    COMBO = COMBO_R_()
    
    # Summarize by Category___________________________________________________________________________
    # Units are MT C, MT N, MT P, Gallons Water 
    
    COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
      group_by(Category) %>% 
      summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                Total_N_Footprint = sum(N_Footprint,na.rm=T),
                Total_P_Footprint = sum(P_Footprint,na.rm=T),
                Total_W_Footprint = sum(W_Footprint,na.rm=T))
    COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
      group_by(Category) %>% 
      summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                Total_N_Footprint = sum(N_Footprint,na.rm=T),
                Total_P_Footprint = sum(P_Footprint,na.rm=T),
                Total_W_Footprint = sum(W_Footprint,na.rm=T)) 
    
    COMBO1$Timeframe = 'Baseline'
    COMBO2$Timeframe = 'Projected'
    
    
    #*****************************************************************************************************
    # ADD FOOD ONTO FOOTPRINT Calculations
    #*****************************************************************************************************
    
    # Calculate total food footprints (original units = kg for C,N,P or gal for water)
    # final units = MT (Metric Tons)
    
    # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
    # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
    food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    
    C_food_footprint1 = sum(food1_$C_footprint,na.rm=T)/1000
    N_food_footprint1 = sum(food1_$N_footprint,na.rm=T)/1000
    P_food_footprint1 = sum(food1_$P_footprint,na.rm=T)/1000
    C_food_footprint2 = sum(food2_$C_footprint,na.rm=T)/1000
    N_food_footprint2 = sum(food2_$N_footprint,na.rm=T)/1000
    P_food_footprint2 = sum(food2_$P_footprint,na.rm=T)/1000
    
    # Units for water = gallons
    B_food_footprint1 = sum(food1_$B_footprint,na.rm=T)
    G_food_footprint1 = sum(food1_$G_footprint,na.rm=T)
    BG_food_footprint1 = sum(food1_$BG_footprint,na.rm=T)
    B_food_footprint2 = sum(food2_$B_footprint,na.rm=T)
    G_food_footprint2 = sum(food2_$G_footprint,na.rm=T)
    BG_food_footprint2 = sum(food2_$BG_footprint,na.rm=T)
    
    #Make a new 1 row dataframe 
    C_food_rw1 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint1)
    N_food_rw1 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint1)
    P_food_rw1 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint1)
    B_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint1)
    G_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint1)
    BG_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint1)
    C_food_rw2 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint2)
    N_food_rw2 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint2)
    P_food_rw2 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint2)
    B_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint2)
    G_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint2)
    BG_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint2)
    
    food_row1 = merge(C_food_rw1,N_food_rw1,by='Category')
    food_row1 = merge(food_row1,P_food_rw1,by='Category')
    food_row1 = merge(food_row1,B_food_rw1,by='Category')
    food_row1$Timeframe = "Baseline"
    
    food_row2 = merge(C_food_rw2,N_food_rw2,by='Category')
    food_row2 = merge(food_row2,P_food_rw2,by='Category')
    food_row2 = merge(food_row2,B_food_rw2,by='Category')
    food_row2$Timeframe = "Projected"
    
    # add on the food row
    COMBO_foot1 = rbind(COMBO1,food_row1)
    COMBO_foot2 = rbind(COMBO2,food_row2)
    
    COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
    
    # Rearrange the rows to match the slider rows
    COMBO_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                    COMBO_foot[COMBO_foot$Category=='Food',],
                    COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                    COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                    COMBO_foot[COMBO_foot$Category=='Commuting',],
                    #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                    COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                    COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                    COMBO_foot[COMBO_foot$Category=='Wastewater',],
                    COMBO_foot[COMBO_foot$Category=='Direct Water Use',])
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 1 COMBO_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Business as Usual Growth to 2025"){
    COMBO = COMBO_R_()
    
    # Summarize by Category___________________________________________________________________________
    # Units are MT C, MT N, MT P, Gallons Water 
    
    COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
      group_by(Category) %>% 
      summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                Total_N_Footprint = sum(N_Footprint,na.rm=T),
                Total_P_Footprint = sum(P_Footprint,na.rm=T),
                Total_W_Footprint = sum(W_Footprint,na.rm=T))
    COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
      group_by(Category) %>% 
      summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                Total_N_Footprint = sum(N_Footprint,na.rm=T),
                Total_P_Footprint = sum(P_Footprint,na.rm=T),
                Total_W_Footprint = sum(W_Footprint,na.rm=T)) 
    
    COMBO1$Timeframe = 'Baseline'
    COMBO2$Timeframe = 'Projected'
    
    
    #*****************************************************************************************************
    # ADD FOOD ONTO FOOTPRINT Calculations
    #*****************************************************************************************************
    
    # Calculate total food footprints (original units = kg for C,N,P or gal for water)
    # final units = MT (Metric Tons)
    
    # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
    # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
    food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    
    C_food_footprint1 = sum(food1_$C_footprint,na.rm=T)/1000
    N_food_footprint1 = sum(food1_$N_footprint,na.rm=T)/1000
    P_food_footprint1 = sum(food1_$P_footprint,na.rm=T)/1000
    C_food_footprint2 = sum(food2_$C_footprint,na.rm=T)/1000
    N_food_footprint2 = sum(food2_$N_footprint,na.rm=T)/1000
    P_food_footprint2 = sum(food2_$P_footprint,na.rm=T)/1000
    
    # Units for water = gallons
    B_food_footprint1 = sum(food1_$B_footprint,na.rm=T)
    G_food_footprint1 = sum(food1_$G_footprint,na.rm=T)
    BG_food_footprint1 = sum(food1_$BG_footprint,na.rm=T)
    B_food_footprint2 = sum(food2_$B_footprint,na.rm=T)
    G_food_footprint2 = sum(food2_$G_footprint,na.rm=T)
    BG_food_footprint2 = sum(food2_$BG_footprint,na.rm=T)
    
    #Make a new 1 row dataframe 
    C_food_rw1 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint1)
    N_food_rw1 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint1)
    P_food_rw1 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint1)
    B_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint1)
    G_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint1)
    BG_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint1)
    C_food_rw2 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint2)
    N_food_rw2 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint2)
    P_food_rw2 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint2)
    B_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint2)
    G_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint2)
    BG_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint2)
    
    food_row1 = merge(C_food_rw1,N_food_rw1,by='Category')
    food_row1 = merge(food_row1,P_food_rw1,by='Category')
    food_row1 = merge(food_row1,B_food_rw1,by='Category')
    food_row1$Timeframe = "Baseline"
    
    food_row2 = merge(C_food_rw2,N_food_rw2,by='Category')
    food_row2 = merge(food_row2,P_food_rw2,by='Category')
    food_row2 = merge(food_row2,B_food_rw2,by='Category')
    food_row2$Timeframe = "Projected"
    
    # add on the food row
    COMBO_foot1 = rbind(COMBO1,food_row1)
    COMBO_foot2 = rbind(COMBO2,food_row2)
    
    COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
    
    # Rearrange the rows to match the slider rows
    COMBO_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                    COMBO_foot[COMBO_foot$Category=='Food',],
                    COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                    COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                    COMBO_foot[COMBO_foot$Category=='Commuting',],
                    #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                    COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                    COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                    COMBO_foot[COMBO_foot$Category=='Wastewater',],
                    COMBO_foot[COMBO_foot$Category=='Direct Water Use',])
    } # Scenario
   
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 2 COMBO_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "15% Vegetarian Meals"){
      COMBO = COMBO_R_()
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
        group_by(Category) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T),
                  Total_P_Footprint = sum(P_Footprint,na.rm=T),
                  Total_W_Footprint = sum(W_Footprint,na.rm=T))
      COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
        group_by(Category) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T),
                  Total_P_Footprint = sum(P_Footprint,na.rm=T),
                  Total_W_Footprint = sum(W_Footprint,na.rm=T)) 
      
      COMBO1$Timeframe = 'Baseline'
      COMBO2$Timeframe = 'Projected'
      
      
      #*****************************************************************************************************
      # ADD FOOD ONTO FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # Calculate total food footprints (original units = kg for C,N,P or gal for water)
      # final units = MT (Metric Tons)
      
      # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
      # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
      food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
      food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
      
      C_food_footprint1 = sum(food1_$C_footprint,na.rm=T)/1000
      N_food_footprint1 = sum(food1_$N_footprint,na.rm=T)/1000
      P_food_footprint1 = sum(food1_$P_footprint,na.rm=T)/1000
      C_food_footprint2 = sum(food2_$C_footprint,na.rm=T)/1000
      N_food_footprint2 = sum(food2_$N_footprint,na.rm=T)/1000
      P_food_footprint2 = sum(food2_$P_footprint,na.rm=T)/1000
      
      # Units for water = gallons
      B_food_footprint1 = sum(food1_$B_footprint,na.rm=T)
      G_food_footprint1 = sum(food1_$G_footprint,na.rm=T)
      BG_food_footprint1 = sum(food1_$BG_footprint,na.rm=T)
      B_food_footprint2 = sum(food2_$B_footprint,na.rm=T)
      G_food_footprint2 = sum(food2_$G_footprint,na.rm=T)
      BG_food_footprint2 = sum(food2_$BG_footprint,na.rm=T)
      
      #Make a new 1 row dataframe 
      C_food_rw1 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint1)
      N_food_rw1 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint1)
      P_food_rw1 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint1)
      B_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint1)
      G_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint1)
      BG_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint1)
      C_food_rw2 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint2)
      N_food_rw2 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint2)
      P_food_rw2 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint2)
      B_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint2)
      G_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint2)
      BG_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint2)
      
      food_row1 = merge(C_food_rw1,N_food_rw1,by='Category')
      food_row1 = merge(food_row1,P_food_rw1,by='Category')
      food_row1 = merge(food_row1,B_food_rw1,by='Category')
      food_row1$Timeframe = "Baseline"
      
      food_row2 = merge(C_food_rw2,N_food_rw2,by='Category')
      food_row2 = merge(food_row2,P_food_rw2,by='Category')
      food_row2 = merge(food_row2,B_food_rw2,by='Category')
      food_row2$Timeframe = "Projected"
      
      # add on the food row
      COMBO_foot1 = rbind(COMBO1,food_row1)
      COMBO_foot2 = rbind(COMBO2,food_row2)
      
      COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
      
      # Rearrange the rows to match the slider rows
      COMBO_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                      COMBO_foot[COMBO_foot$Category=='Food',],
                      COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                      COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                      COMBO_foot[COMBO_foot$Category=='Commuting',],
                      #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                      COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                      COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                      COMBO_foot[COMBO_foot$Category=='Wastewater',],
                      COMBO_foot[COMBO_foot$Category=='Direct Water Use',])
    } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 3 COMBO_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Replacement of 20% beef with Chicken"){
      COMBO = COMBO_R_()
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
        group_by(Category) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T),
                  Total_P_Footprint = sum(P_Footprint,na.rm=T),
                  Total_W_Footprint = sum(W_Footprint,na.rm=T))
      COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
        group_by(Category) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T),
                  Total_P_Footprint = sum(P_Footprint,na.rm=T),
                  Total_W_Footprint = sum(W_Footprint,na.rm=T)) 
      
      COMBO1$Timeframe = 'Baseline'
      COMBO2$Timeframe = 'Projected'
      
      
      #*****************************************************************************************************
      # ADD FOOD ONTO FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # Calculate total food footprints (original units = kg for C,N,P or gal for water)
      # final units = MT (Metric Tons)
      
      # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
      # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
      food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
      food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
      
      C_food_footprint1 = sum(food1_$C_footprint,na.rm=T)/1000
      N_food_footprint1 = sum(food1_$N_footprint,na.rm=T)/1000
      P_food_footprint1 = sum(food1_$P_footprint,na.rm=T)/1000
      C_food_footprint2 = sum(food2_$C_footprint,na.rm=T)/1000
      N_food_footprint2 = sum(food2_$N_footprint,na.rm=T)/1000
      P_food_footprint2 = sum(food2_$P_footprint,na.rm=T)/1000
      
      # Units for water = gallons
      B_food_footprint1 = sum(food1_$B_footprint,na.rm=T)
      G_food_footprint1 = sum(food1_$G_footprint,na.rm=T)
      BG_food_footprint1 = sum(food1_$BG_footprint,na.rm=T)
      B_food_footprint2 = sum(food2_$B_footprint,na.rm=T)
      G_food_footprint2 = sum(food2_$G_footprint,na.rm=T)
      BG_food_footprint2 = sum(food2_$BG_footprint,na.rm=T)
      
      #Make a new 1 row dataframe 
      C_food_rw1 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint1)
      N_food_rw1 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint1)
      P_food_rw1 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint1)
      B_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint1)
      G_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint1)
      BG_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint1)
      C_food_rw2 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint2)
      N_food_rw2 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint2)
      P_food_rw2 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint2)
      B_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint2)
      G_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint2)
      BG_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint2)
      
      food_row1 = merge(C_food_rw1,N_food_rw1,by='Category')
      food_row1 = merge(food_row1,P_food_rw1,by='Category')
      food_row1 = merge(food_row1,B_food_rw1,by='Category')
      food_row1$Timeframe = "Baseline"
      
      food_row2 = merge(C_food_rw2,N_food_rw2,by='Category')
      food_row2 = merge(food_row2,P_food_rw2,by='Category')
      food_row2 = merge(food_row2,B_food_rw2,by='Category')
      food_row2$Timeframe = "Projected"
      
      # add on the food row
      COMBO_foot1 = rbind(COMBO1,food_row1)
      COMBO_foot2 = rbind(COMBO2,food_row2)
      
      COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
      
      # Rearrange the rows to match the slider rows
      COMBO_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                      COMBO_foot[COMBO_foot$Category=='Food',],
                      COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                      COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                      COMBO_foot[COMBO_foot$Category=='Commuting',],
                      #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                      COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                      COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                      COMBO_foot[COMBO_foot$Category=='Wastewater',],
                      COMBO_foot[COMBO_foot$Category=='Direct Water Use',])
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 4 COMBO_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Fuel Optimization"){
      COMBO = COMBO_R_()
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
        group_by(Category) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T),
                  Total_P_Footprint = sum(P_Footprint,na.rm=T),
                  Total_W_Footprint = sum(W_Footprint,na.rm=T))
      COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
        group_by(Category) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T),
                  Total_P_Footprint = sum(P_Footprint,na.rm=T),
                  Total_W_Footprint = sum(W_Footprint,na.rm=T)) 
      
      COMBO1$Timeframe = 'Baseline'
      COMBO2$Timeframe = 'Projected'
      
      
      #*****************************************************************************************************
      # ADD FOOD ONTO FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # Calculate total food footprints (original units = kg for C,N,P or gal for water)
      # final units = MT (Metric Tons)
      
      # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
      # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
      food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
      food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
      
      C_food_footprint1 = sum(food1_$C_footprint,na.rm=T)/1000
      N_food_footprint1 = sum(food1_$N_footprint,na.rm=T)/1000
      P_food_footprint1 = sum(food1_$P_footprint,na.rm=T)/1000
      C_food_footprint2 = sum(food2_$C_footprint,na.rm=T)/1000
      N_food_footprint2 = sum(food2_$N_footprint,na.rm=T)/1000
      P_food_footprint2 = sum(food2_$P_footprint,na.rm=T)/1000
      
      # Units for water = gallons
      B_food_footprint1 = sum(food1_$B_footprint,na.rm=T)
      G_food_footprint1 = sum(food1_$G_footprint,na.rm=T)
      BG_food_footprint1 = sum(food1_$BG_footprint,na.rm=T)
      B_food_footprint2 = sum(food2_$B_footprint,na.rm=T)
      G_food_footprint2 = sum(food2_$G_footprint,na.rm=T)
      BG_food_footprint2 = sum(food2_$BG_footprint,na.rm=T)
      
      #Make a new 1 row dataframe 
      C_food_rw1 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint1)
      N_food_rw1 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint1)
      P_food_rw1 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint1)
      B_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint1)
      G_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint1)
      BG_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint1)
      C_food_rw2 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint2)
      N_food_rw2 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint2)
      P_food_rw2 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint2)
      B_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint2)
      G_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint2)
      BG_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint2)
      
      food_row1 = merge(C_food_rw1,N_food_rw1,by='Category')
      food_row1 = merge(food_row1,P_food_rw1,by='Category')
      food_row1 = merge(food_row1,B_food_rw1,by='Category')
      food_row1$Timeframe = "Baseline"
      
      food_row2 = merge(C_food_rw2,N_food_rw2,by='Category')
      food_row2 = merge(food_row2,P_food_rw2,by='Category')
      food_row2 = merge(food_row2,B_food_rw2,by='Category')
      food_row2$Timeframe = "Projected"
      
      # add on the food row
      COMBO_foot1 = rbind(COMBO1,food_row1)
      COMBO_foot2 = rbind(COMBO2,food_row2)
      
      COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
      
      # Rearrange the rows to match the slider rows
      COMBO_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                      COMBO_foot[COMBO_foot$Category=='Food',],
                      COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                      COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                      COMBO_foot[COMBO_foot$Category=='Commuting',],
                      #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                      COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                      COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                      COMBO_foot[COMBO_foot$Category=='Wastewater',],
                      COMBO_foot[COMBO_foot$Category=='Direct Water Use',])
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 5 COMBO_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Implementing All Scenarios"){
      COMBO = COMBO_R_()
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMBO1 = COMBO[COMBO$Timeframe == 'Baseline',] %>% 
        group_by(Category) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T),
                  Total_P_Footprint = sum(P_Footprint,na.rm=T),
                  Total_W_Footprint = sum(W_Footprint,na.rm=T))
      COMBO2 = COMBO[COMBO$Timeframe == 'Projected',] %>%
        group_by(Category) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T),
                  Total_P_Footprint = sum(P_Footprint,na.rm=T),
                  Total_W_Footprint = sum(W_Footprint,na.rm=T)) 
      
      COMBO1$Timeframe = 'Baseline'
      COMBO2$Timeframe = 'Projected'
      
      
      #*****************************************************************************************************
      # ADD FOOD ONTO FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # Calculate total food footprints (original units = kg for C,N,P or gal for water)
      # final units = MT (Metric Tons)
      
      # food1_ = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
      # food2_ = FOOD_R[FOOD_R$Timeframe == 'Projected',]
      food1_ = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
      food2_ = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
      
      C_food_footprint1 = sum(food1_$C_footprint,na.rm=T)/1000
      N_food_footprint1 = sum(food1_$N_footprint,na.rm=T)/1000
      P_food_footprint1 = sum(food1_$P_footprint,na.rm=T)/1000
      C_food_footprint2 = sum(food2_$C_footprint,na.rm=T)/1000
      N_food_footprint2 = sum(food2_$N_footprint,na.rm=T)/1000
      P_food_footprint2 = sum(food2_$P_footprint,na.rm=T)/1000
      
      # Units for water = gallons
      B_food_footprint1 = sum(food1_$B_footprint,na.rm=T)
      G_food_footprint1 = sum(food1_$G_footprint,na.rm=T)
      BG_food_footprint1 = sum(food1_$BG_footprint,na.rm=T)
      B_food_footprint2 = sum(food2_$B_footprint,na.rm=T)
      G_food_footprint2 = sum(food2_$G_footprint,na.rm=T)
      BG_food_footprint2 = sum(food2_$BG_footprint,na.rm=T)
      
      #Make a new 1 row dataframe 
      C_food_rw1 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint1)
      N_food_rw1 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint1)
      P_food_rw1 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint1)
      B_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint1)
      G_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint1)
      BG_food_rw1 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint1)
      C_food_rw2 = data.frame(Category = 'Food',Total_C_Footprint = C_food_footprint2)
      N_food_rw2 = data.frame(Category = 'Food',Total_N_Footprint = N_food_footprint2)
      P_food_rw2 = data.frame(Category = 'Food',Total_P_Footprint = P_food_footprint2)
      B_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = B_food_footprint2)
      G_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = G_food_footprint2)
      BG_food_rw2 = data.frame(Category = 'Food',Total_W_Footprint = BG_food_footprint2)
      
      food_row1 = merge(C_food_rw1,N_food_rw1,by='Category')
      food_row1 = merge(food_row1,P_food_rw1,by='Category')
      food_row1 = merge(food_row1,B_food_rw1,by='Category')
      food_row1$Timeframe = "Baseline"
      
      food_row2 = merge(C_food_rw2,N_food_rw2,by='Category')
      food_row2 = merge(food_row2,P_food_rw2,by='Category')
      food_row2 = merge(food_row2,B_food_rw2,by='Category')
      food_row2$Timeframe = "Projected"
      
      # add on the food row
      COMBO_foot1 = rbind(COMBO1,food_row1)
      COMBO_foot2 = rbind(COMBO2,food_row2)
      
      COMBO_foot = rbind(COMBO_foot1,COMBO_foot2)
      
      # Rearrange the rows to match the slider rows
      COMBO_R = rbind(COMBO_foot[COMBO_foot$Category=='Purchased Electricity',],
                      COMBO_foot[COMBO_foot$Category=='Food',],
                      COMBO_foot[COMBO_foot$Category=='On-Campus Stationary Sources',],
                      COMBO_foot[COMBO_foot$Category=='Direct Transportation Sources',],
                      COMBO_foot[COMBO_foot$Category=='Commuting',],
                      #COMBO_foot[COMBO_foot$Category=='Directly Financed Outsourced Travel',],
                      COMBO_foot[COMBO_foot$Category=='Agriculture Sources',],
                      COMBO_foot[COMBO_foot$Category=='Refrigerants & Chemicals',],
                      COMBO_foot[COMBO_foot$Category=='Wastewater',],
                      COMBO_foot[COMBO_foot$Category=='Direct Water Use',])
    } # Scenario
    
    }) # reactive
  
  
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  # STEP_11 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  #*****************************************************************************************************
  # Commuting Ractive Faculty Calculations
  #*****************************************************************************************************
  
  # Commuting all sub-categories and sources
  COMMUTING_FAC_TABLE_R <- reactive({
    
    # # Campus Vs. Individual
    # if(input$campusVindividual == "Campus"){
    #   uva = uva_R()
    #   food = food
    # }
    # 
    # else if(input$campusVindividual == "Individual"){
    #   uva = uva_individual
    #   food = food_individual
    # }
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 0
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    if(input$scenario == "Manual Scenario"){
    # Footprint Units are MT C and MT N
    
    commut1 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Faculty Commuting',]
    commut2 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Faculty Commuting',]
    
    # Add Projected category
    commut1$Timeframe = 'Baseline'
    commut2$Timeframe = 'Projected'
    
    # Gives the baseline value
    c1 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Automobile',]$inventory
    c2 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Bike',]$inventory
    c3 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Carpool',]$inventory
    c4 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Public Bus',]$inventory
    c5 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Walk',]$inventory
    
    commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Automobile',]$inventory = 
      c1 * input$fac1a_proj*.01+c1
    commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Bike',]$inventory = 
      c2 * input$fac2a_proj*.01+c2
    commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Carpool',]$inventory = 
      c3 * input$fac3a_proj*.01+c3
    commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Public Bus',]$inventory = 
      c4 * input$fac6a_proj*.01+c4
    commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Walk',]$inventory = 
      c5 * input$fac7a_proj*.01+c5
    
    COMMUTING_FAC_TABLE_R = rbind(commut1,commut2)
    
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 1 COMMUTING_FAC_TABLE_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Business as Usual Growth to 2025"){
      # Footprint Units are MT C and MT N
      
    commut1 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Faculty Commuting',]
    commut2 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Faculty Commuting',]
    
    # Add Projected category
    commut1$Timeframe = 'Baseline'
    commut2$Timeframe = 'Projected'
    
    # Gives the baseline value
    c1 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Automobile',]$inventory
    c2 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Bike',]$inventory
    c3 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Carpool',]$inventory
    c4 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Public Bus',]$inventory
    c5 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Walk',]$inventory
    
    commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Automobile',]$inventory = 
      c1 * input$fac1b_proj*.01+c1
    commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Bike',]$inventory = 
      c2 * input$fac2b_proj*.01+c2
    commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Carpool',]$inventory = 
      c3 * input$fac3b_proj*.01+c3
    commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Public Bus',]$inventory = 
      c4 * input$fac6b_proj*.01+c4
    commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Walk',]$inventory = 
      c5 * input$fac7b_proj*.01+c5
    
    COMMUTING_FAC_TABLE_R = rbind(commut1,commut2)  
  } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 2 COMMUTING_FAC_TABLE_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "15% Vegetarian Meals"){
      # Footprint Units are MT C and MT N
      
      commut1 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Faculty Commuting',]
      commut2 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Faculty Commuting',]
      
      # Add Projected category
      commut1$Timeframe = 'Baseline'
      commut2$Timeframe = 'Projected'
      
      # Gives the baseline value
      c1 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Automobile',]$inventory
      c2 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Bike',]$inventory
      c3 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Carpool',]$inventory
      c4 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Public Bus',]$inventory
      c5 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Walk',]$inventory
      
      commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Automobile',]$inventory = 
        c1 * input$fac1c_proj*.01+c1
      commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Bike',]$inventory = 
        c2 * input$fac2c_proj*.01+c2
      commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Carpool',]$inventory = 
        c3 * input$fac3c_proj*.01+c3
      commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Public Bus',]$inventory = 
        c4 * input$fac6c_proj*.01+c4
      commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Walk',]$inventory = 
        c5 * input$fac7c_proj*.01+c5
      
      COMMUTING_FAC_TABLE_R = rbind(commut1,commut2)  
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 3 COMMUTING_FAC_TABLE_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Replacement of 20% beef with Chicken"){
      # Footprint Units are MT C and MT N
      
      commut1 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Faculty Commuting',]
      commut2 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Faculty Commuting',]
      
      # Add Projected category
      commut1$Timeframe = 'Baseline'
      commut2$Timeframe = 'Projected'
      
      # Gives the baseline value
      c1 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Automobile',]$inventory
      c2 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Bike',]$inventory
      c3 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Carpool',]$inventory
      c4 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Public Bus',]$inventory
      c5 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Walk',]$inventory
      
      commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Automobile',]$inventory = 
        c1 * input$fac1d_proj*.01+c1
      commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Bike',]$inventory = 
        c2 * input$fac2d_proj*.01+c2
      commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Carpool',]$inventory = 
        c3 * input$fac3d_proj*.01+c3
      commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Public Bus',]$inventory = 
        c4 * input$fac6d_proj*.01+c4
      commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Walk',]$inventory = 
        c5 * input$fac7d_proj*.01+c5
      
      COMMUTING_FAC_TABLE_R = rbind(commut1,commut2)  
    } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 4 COMMUTING_FAC_TABLE_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Fuel Optimization"){
      # Footprint Units are MT C and MT N
      
      commut1 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Faculty Commuting',]
      commut2 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Faculty Commuting',]
      
      # Add Projected category
      commut1$Timeframe = 'Baseline'
      commut2$Timeframe = 'Projected'
      
      # Gives the baseline value
      c1 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Automobile',]$inventory
      c2 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Bike',]$inventory
      c3 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Carpool',]$inventory
      c4 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Public Bus',]$inventory
      c5 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Walk',]$inventory
      
      commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Automobile',]$inventory = 
        c1 * input$fac1e_proj*.01+c1
      commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Bike',]$inventory = 
        c2 * input$fac2e_proj*.01+c2
      commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Carpool',]$inventory = 
        c3 * input$fac3e_proj*.01+c3
      commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Public Bus',]$inventory = 
        c4 * input$fac6e_proj*.01+c4
      commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Walk',]$inventory = 
        c5 * input$fac7e_proj*.01+c5
      
      COMMUTING_FAC_TABLE_R = rbind(commut1,commut2)  
    } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 5 COMMUTING_FAC_TABLE_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Implementing All Scenarios"){
      # Footprint Units are MT C and MT N
      
      commut1 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Faculty Commuting',]
      commut2 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Faculty Commuting',]
      
      # Add Projected category
      commut1$Timeframe = 'Baseline'
      commut2$Timeframe = 'Projected'
      
      # Gives the baseline value
      c1 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Automobile',]$inventory
      c2 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Bike',]$inventory
      c3 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Carpool',]$inventory
      c4 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Public Bus',]$inventory
      c5 = commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Walk',]$inventory
      
      commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Automobile',]$inventory = 
        c1 * input$fac1f_proj*.01+c1
      commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Bike',]$inventory = 
        c2 * input$fac2f_proj*.01+c2
      commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Carpool',]$inventory = 
        c3 * input$fac3f_proj*.01+c3
      commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Public Bus',]$inventory = 
        c4 * input$fac6f_proj*.01+c4
      commut2[commut2$Sub_category=='Faculty Commuting' & commut2$Source == 'Walk',]$inventory = 
        c5 * input$fac7f_proj*.01+c5
      
      COMMUTING_FAC_TABLE_R = rbind(commut1,commut2)  
    } # Scenario
    
  }) # reactive
  
  Commut_Fac_R_ <- reactive({
    
    # # Campus Vs. Individual
    # if(input$campusVindividual == "Campus"){
    #   uva = uva_R()
    #   food = food
    # }
    # 
    # else if(input$campusVindividual == "Individual"){
    #   uva = uva_individual
    #   food = food_individual
    # }
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 0
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    if(input$scenario == "Manual Scenario"){
    
      COMMUTING = COMMUTING_FAC_TABLE_R()
    
    #CARBON_____________________________________________________________________
    # Result units = kg CO2
    # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
    COMMUTING$CO2_r = COMMUTING$inventory * COMMUTING$CO2.EF
    
    # Result units = kg eCO2
    # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
    COMMUTING$eCO2_r = COMMUTING$inventory * COMMUTING$eCO2.EF
    
    # Result units = kg CH4
    # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
    COMMUTING$CH4_r = COMMUTING$inventory * COMMUTING$CH4.EF
    
    #NITROGEN_____________________________________________________________________
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMMUTING$N2O_r = COMMUTING$inventory * COMMUTING$N2O.EF
    
    # Result units = kg NOx
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMMUTING$NOx_r = COMMUTING$inventory * COMMUTING$NOx.EF
    
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMMUTING$OtherN_r = COMMUTING$inventory * COMMUTING$Other.N.EF
    
    #INTERMEDIATE C & N _______________________________________________________________
    
    # calculate Footprints by category (divide by 1000 to convert from kg to MT)
    # Units of GWP 
    COMMUTING$CO2_MTCDE = COMMUTING$CO2_r/1000  # MT CO2e
    COMMUTING$eCO2_MTCDE = COMMUTING$eCO2_r/1000 # MT CO2e
    COMMUTING$CH4_MTCDE = COMMUTING$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
    COMMUTING$N2O_MTCDE = COMMUTING$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
    
    # intermediate N
    COMMUTING$N2O_MTN = COMMUTING$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
    COMMUTING$NOx_MTN = COMMUTING$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
    COMMUTING$OtherN_MTN = COMMUTING$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
    
    #*****************************************************************************************************
    # FOOTPRINT Calculations
    #*****************************************************************************************************
    
    # CALCULATING FOOTPRINT C & N_____________________________________________________________________
    # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
    
    COMMUTING$C_Footprint = rowSums(COMMUTING[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
    COMMUTING$N_Footprint = rowSums(COMMUTING[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
    
    Commut_Fac_R_ = COMMUTING
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 1 Commut_Fac_R_
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Business as Usual Growth to 2025"){
      COMMUTING = COMMUTING_FAC_TABLE_R()
    
    #CARBON_____________________________________________________________________
    # Result units = kg CO2
    # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
    COMMUTING$CO2_r = COMMUTING$inventory * COMMUTING$CO2.EF
    
    # Result units = kg eCO2
    # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
    COMMUTING$eCO2_r = COMMUTING$inventory * COMMUTING$eCO2.EF
    
    # Result units = kg CH4
    # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
    COMMUTING$CH4_r = COMMUTING$inventory * COMMUTING$CH4.EF
    
    #NITROGEN_____________________________________________________________________
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMMUTING$N2O_r = COMMUTING$inventory * COMMUTING$N2O.EF
    
    # Result units = kg NOx
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMMUTING$NOx_r = COMMUTING$inventory * COMMUTING$NOx.EF
    
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMMUTING$OtherN_r = COMMUTING$inventory * COMMUTING$Other.N.EF
    
    #INTERMEDIATE C & N _______________________________________________________________
    
    # calculate Footprints by category (divide by 1000 to convert from kg to MT)
    # Units of GWP 
    COMMUTING$CO2_MTCDE = COMMUTING$CO2_r/1000  # MT CO2e
    COMMUTING$eCO2_MTCDE = COMMUTING$eCO2_r/1000 # MT CO2e
    COMMUTING$CH4_MTCDE = COMMUTING$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
    COMMUTING$N2O_MTCDE = COMMUTING$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
    
    # intermediate N
    COMMUTING$N2O_MTN = COMMUTING$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
    COMMUTING$NOx_MTN = COMMUTING$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
    COMMUTING$OtherN_MTN = COMMUTING$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
    
    #*****************************************************************************************************
    # FOOTPRINT Calculations
    #*****************************************************************************************************
    
    # CALCULATING FOOTPRINT C & N_____________________________________________________________________
    # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
    
    COMMUTING$C_Footprint = rowSums(COMMUTING[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
    COMMUTING$N_Footprint = rowSums(COMMUTING[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
    
    Commut_Fac_R_ = COMMUTING  
  } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 2 Commut_Fac_R_
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "15% Vegetarian Meals"){
      COMMUTING = COMMUTING_FAC_TABLE_R()
      
      #CARBON_____________________________________________________________________
      # Result units = kg CO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
      COMMUTING$CO2_r = COMMUTING$inventory * COMMUTING$CO2.EF
      
      # Result units = kg eCO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
      COMMUTING$eCO2_r = COMMUTING$inventory * COMMUTING$eCO2.EF
      
      # Result units = kg CH4
      # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
      COMMUTING$CH4_r = COMMUTING$inventory * COMMUTING$CH4.EF
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$N2O_r = COMMUTING$inventory * COMMUTING$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$NOx_r = COMMUTING$inventory * COMMUTING$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$OtherN_r = COMMUTING$inventory * COMMUTING$Other.N.EF
      
      #INTERMEDIATE C & N _______________________________________________________________
      
      # calculate Footprints by category (divide by 1000 to convert from kg to MT)
      # Units of GWP 
      COMMUTING$CO2_MTCDE = COMMUTING$CO2_r/1000  # MT CO2e
      COMMUTING$eCO2_MTCDE = COMMUTING$eCO2_r/1000 # MT CO2e
      COMMUTING$CH4_MTCDE = COMMUTING$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
      COMMUTING$N2O_MTCDE = COMMUTING$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
      
      # intermediate N
      COMMUTING$N2O_MTN = COMMUTING$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
      COMMUTING$NOx_MTN = COMMUTING$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
      COMMUTING$OtherN_MTN = COMMUTING$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C & N_____________________________________________________________________
      # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
      
      COMMUTING$C_Footprint = rowSums(COMMUTING[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
      COMMUTING$N_Footprint = rowSums(COMMUTING[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
      
      Commut_Fac_R_ = COMMUTING  
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 3 Commut_Fac_R_
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Replacement of 20% beef with Chicken"){
      COMMUTING = COMMUTING_FAC_TABLE_R()
      
      #CARBON_____________________________________________________________________
      # Result units = kg CO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
      COMMUTING$CO2_r = COMMUTING$inventory * COMMUTING$CO2.EF
      
      # Result units = kg eCO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
      COMMUTING$eCO2_r = COMMUTING$inventory * COMMUTING$eCO2.EF
      
      # Result units = kg CH4
      # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
      COMMUTING$CH4_r = COMMUTING$inventory * COMMUTING$CH4.EF
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$N2O_r = COMMUTING$inventory * COMMUTING$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$NOx_r = COMMUTING$inventory * COMMUTING$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$OtherN_r = COMMUTING$inventory * COMMUTING$Other.N.EF
      
      #INTERMEDIATE C & N _______________________________________________________________
      
      # calculate Footprints by category (divide by 1000 to convert from kg to MT)
      # Units of GWP 
      COMMUTING$CO2_MTCDE = COMMUTING$CO2_r/1000  # MT CO2e
      COMMUTING$eCO2_MTCDE = COMMUTING$eCO2_r/1000 # MT CO2e
      COMMUTING$CH4_MTCDE = COMMUTING$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
      COMMUTING$N2O_MTCDE = COMMUTING$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
      
      # intermediate N
      COMMUTING$N2O_MTN = COMMUTING$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
      COMMUTING$NOx_MTN = COMMUTING$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
      COMMUTING$OtherN_MTN = COMMUTING$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C & N_____________________________________________________________________
      # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
      
      COMMUTING$C_Footprint = rowSums(COMMUTING[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
      COMMUTING$N_Footprint = rowSums(COMMUTING[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
      
      Commut_Fac_R_ = COMMUTING  
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 4 Commut_Fac_R_
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Fuel Optimization"){
      COMMUTING = COMMUTING_FAC_TABLE_R()
      
      #CARBON_____________________________________________________________________
      # Result units = kg CO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
      COMMUTING$CO2_r = COMMUTING$inventory * COMMUTING$CO2.EF
      
      # Result units = kg eCO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
      COMMUTING$eCO2_r = COMMUTING$inventory * COMMUTING$eCO2.EF
      
      # Result units = kg CH4
      # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
      COMMUTING$CH4_r = COMMUTING$inventory * COMMUTING$CH4.EF
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$N2O_r = COMMUTING$inventory * COMMUTING$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$NOx_r = COMMUTING$inventory * COMMUTING$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$OtherN_r = COMMUTING$inventory * COMMUTING$Other.N.EF
      
      #INTERMEDIATE C & N _______________________________________________________________
      
      # calculate Footprints by category (divide by 1000 to convert from kg to MT)
      # Units of GWP 
      COMMUTING$CO2_MTCDE = COMMUTING$CO2_r/1000  # MT CO2e
      COMMUTING$eCO2_MTCDE = COMMUTING$eCO2_r/1000 # MT CO2e
      COMMUTING$CH4_MTCDE = COMMUTING$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
      COMMUTING$N2O_MTCDE = COMMUTING$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
      
      # intermediate N
      COMMUTING$N2O_MTN = COMMUTING$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
      COMMUTING$NOx_MTN = COMMUTING$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
      COMMUTING$OtherN_MTN = COMMUTING$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C & N_____________________________________________________________________
      # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
      
      COMMUTING$C_Footprint = rowSums(COMMUTING[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
      COMMUTING$N_Footprint = rowSums(COMMUTING[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
      
      Commut_Fac_R_ = COMMUTING  
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 5 Commut_Fac_R_
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Implementing All Scenarios"){
      COMMUTING = COMMUTING_FAC_TABLE_R()
      
      #CARBON_____________________________________________________________________
      # Result units = kg CO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
      COMMUTING$CO2_r = COMMUTING$inventory * COMMUTING$CO2.EF
      
      # Result units = kg eCO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
      COMMUTING$eCO2_r = COMMUTING$inventory * COMMUTING$eCO2.EF
      
      # Result units = kg CH4
      # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
      COMMUTING$CH4_r = COMMUTING$inventory * COMMUTING$CH4.EF
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$N2O_r = COMMUTING$inventory * COMMUTING$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$NOx_r = COMMUTING$inventory * COMMUTING$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$OtherN_r = COMMUTING$inventory * COMMUTING$Other.N.EF
      
      #INTERMEDIATE C & N _______________________________________________________________
      
      # calculate Footprints by category (divide by 1000 to convert from kg to MT)
      # Units of GWP 
      COMMUTING$CO2_MTCDE = COMMUTING$CO2_r/1000  # MT CO2e
      COMMUTING$eCO2_MTCDE = COMMUTING$eCO2_r/1000 # MT CO2e
      COMMUTING$CH4_MTCDE = COMMUTING$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
      COMMUTING$N2O_MTCDE = COMMUTING$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
      
      # intermediate N
      COMMUTING$N2O_MTN = COMMUTING$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
      COMMUTING$NOx_MTN = COMMUTING$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
      COMMUTING$OtherN_MTN = COMMUTING$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C & N_____________________________________________________________________
      # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
      
      COMMUTING$C_Footprint = rowSums(COMMUTING[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
      COMMUTING$N_Footprint = rowSums(COMMUTING[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
      
      Commut_Fac_R_ = COMMUTING  
    } # Scenario
    
  }) # reactive
  
  Commut_Fac_R <- reactive({
    
    # # Campus Vs. Individual
    # if(input$campusVindividual == "Campus"){
    #   uva = uva_R()
    #   food = food
    # }
    # 
    # else if(input$campusVindividual == "Individual"){
    #   uva = uva_individual
    #   food = food_individual
    # }
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 0
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    if(input$scenario == "Manual Scenario"){
    COMMUTING = Commut_Fac_R_()
    #*****************************************************************************************************
    # FOOTPRINT DATA OUTPUT
    #*****************************************************************************************************
    
    # Summarize by Category___________________________________________________________________________
    # Units are MT C, MT N, MT P, Gallons Water 
    
    COMMUTING1_ = COMMUTING[COMMUTING$Timeframe == 'Baseline',] %>% 
      group_by(Category,Sub_category,Source) %>% 
      summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                Total_N_Footprint = sum(N_Footprint,na.rm=T))
    COMMUTING2_ = COMMUTING[COMMUTING$Timeframe == 'Projected',] %>%
      group_by(Category,Sub_category,Source) %>% 
      summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
    
    COMMUTING1_$Timeframe = 'Baseline'
    COMMUTING2_$Timeframe = 'Projected'
    
    Commut_Fac_R = rbind(COMMUTING1_,COMMUTING2_)
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 1 Commut_Fac_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Business as Usual Growth to 2025"){
      COMMUTING = Commut_Fac_R_()
    #*****************************************************************************************************
    # FOOTPRINT DATA OUTPUT
    #*****************************************************************************************************
    
    # Summarize by Category___________________________________________________________________________
    # Units are MT C, MT N, MT P, Gallons Water 
    
    COMMUTING1_ = COMMUTING[COMMUTING$Timeframe == 'Baseline',] %>% 
      group_by(Category,Sub_category,Source) %>% 
      summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                Total_N_Footprint = sum(N_Footprint,na.rm=T))
    COMMUTING2_ = COMMUTING[COMMUTING$Timeframe == 'Projected',] %>%
      group_by(Category,Sub_category,Source) %>% 
      summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
    
    COMMUTING1_$Timeframe = 'Baseline'
    COMMUTING2_$Timeframe = 'Projected'
    
    Commut_Fac_R = rbind(COMMUTING1_,COMMUTING2_)  
  } # Scenario   
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 2 Commut_Fac_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "15% Vegetarian Meals"){
      COMMUTING = Commut_Fac_R_()
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMMUTING1_ = COMMUTING[COMMUTING$Timeframe == 'Baseline',] %>% 
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T))
      COMMUTING2_ = COMMUTING[COMMUTING$Timeframe == 'Projected',] %>%
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
      
      COMMUTING1_$Timeframe = 'Baseline'
      COMMUTING2_$Timeframe = 'Projected'
      
      Commut_Fac_R = rbind(COMMUTING1_,COMMUTING2_)  
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 3 Commut_Fac_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Replacement of 20% beef with Chicken"){
      COMMUTING = Commut_Fac_R_()
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMMUTING1_ = COMMUTING[COMMUTING$Timeframe == 'Baseline',] %>% 
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T))
      COMMUTING2_ = COMMUTING[COMMUTING$Timeframe == 'Projected',] %>%
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
      
      COMMUTING1_$Timeframe = 'Baseline'
      COMMUTING2_$Timeframe = 'Projected'
      
      Commut_Fac_R = rbind(COMMUTING1_,COMMUTING2_)  
    } # Scenario   
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 4 Commut_Fac_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Fuel Optimization"){
      COMMUTING = Commut_Fac_R_()
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMMUTING1_ = COMMUTING[COMMUTING$Timeframe == 'Baseline',] %>% 
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T))
      COMMUTING2_ = COMMUTING[COMMUTING$Timeframe == 'Projected',] %>%
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
      
      COMMUTING1_$Timeframe = 'Baseline'
      COMMUTING2_$Timeframe = 'Projected'
      
      Commut_Fac_R = rbind(COMMUTING1_,COMMUTING2_)  
    } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 5 Commut_Fac_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Implementing All Scenarios"){
      COMMUTING = Commut_Fac_R_()
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMMUTING1_ = COMMUTING[COMMUTING$Timeframe == 'Baseline',] %>% 
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T))
      COMMUTING2_ = COMMUTING[COMMUTING$Timeframe == 'Projected',] %>%
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
      
      COMMUTING1_$Timeframe = 'Baseline'
      COMMUTING2_$Timeframe = 'Projected'
      
      Commut_Fac_R = rbind(COMMUTING1_,COMMUTING2_)  
    } # Scenario
    
  }) # reactive
  
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  # STEP_13 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  #*****************************************************************************************************
  # Commuting Reactive Staff Calculations
  #*****************************************************************************************************
  
  # Commuting all sub-categories and sources
  COMMUTING_STAFF_TABLE_R <- reactive({
    
    # # Campus Vs. Individual
    # if(input$campusVindividual == "Campus"){
    #   uva = uva_R()
    #   food = food
    # }
    # 
    # else if(input$campusVindividual == "Individual"){
    #   uva = uva_individual
    #   food = food_individual
    # }
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 0
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    if(input$scenario == "Manual Scenario"){
    # Footprint Units are MT C and MT N
    
    commut1 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Staff Commuting',]
    commut2 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Staff Commuting',]
    
    # Add Projected category
    commut1$Timeframe = 'Baseline'
    commut2$Timeframe = 'Projected'
    
    # Gives the baseline value
    
    c6 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Automobile',]$inventory
    c7 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Bike',]$inventory
    c8 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Carpool',]$inventory
    c9 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Public Bus',]$inventory
    c10 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Walk',]$inventory
    
    commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Automobile',]$inventory = 
      c6 * input$staf1a_proj*.01+c6
    commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Bike',]$inventory = 
      c7 * input$staf2a_proj*.01+c7
    commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Carpool',]$inventory = 
      c8 * input$staf3a_proj*.01+c8
    commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Public Bus',]$inventory = 
      c9 * input$staf6a_proj*.01+c9
    commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Walk',]$inventory = 
      c10 * input$staf7a_proj*.01+c10
    
    COMMUTING_STAFF_TABLE_R  = rbind(commut1,commut2)
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 1 COMMUTING_STAFF_TABLE_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Business as Usual Growth to 2025"){
      # Footprint Units are MT C and MT N
      
      commut1 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Staff Commuting',]
    commut2 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Staff Commuting',]
    
    # Add Projected category
    commut1$Timeframe = 'Baseline'
    commut2$Timeframe = 'Projected'
    
    # Gives the baseline value
    
    c6 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Automobile',]$inventory
    c7 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Bike',]$inventory
    c8 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Carpool',]$inventory
    c9 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Public Bus',]$inventory
    c10 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Walk',]$inventory
    
    commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Automobile',]$inventory = 
      c6 * input$staf1b_proj*.01+c6
    commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Bike',]$inventory = 
      c7 * input$staf2b_proj*.01+c7
    commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Carpool',]$inventory = 
      c8 * input$staf3b_proj*.01+c8
    commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Public Bus',]$inventory = 
      c9 * input$staf6b_proj*.01+c9
    commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Walk',]$inventory = 
      c10 * input$staf7b_proj*.01+c10
    
    COMMUTING_STAFF_TABLE_R  = rbind(commut1,commut2)  
  } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 2 COMMUTING_STAFF_TABLE_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "15% Vegetarian Meals"){
      # Footprint Units are MT C and MT N
      
      commut1 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Staff Commuting',]
      commut2 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Staff Commuting',]
      
      # Add Projected category
      commut1$Timeframe = 'Baseline'
      commut2$Timeframe = 'Projected'
      
      # Gives the baseline value
      
      c6 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Automobile',]$inventory
      c7 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Bike',]$inventory
      c8 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Carpool',]$inventory
      c9 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Public Bus',]$inventory
      c10 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Walk',]$inventory
      
      commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Automobile',]$inventory = 
        c6 * input$staf1c_proj*.01+c6
      commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Bike',]$inventory = 
        c7 * input$staf2c_proj*.01+c7
      commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Carpool',]$inventory = 
        c8 * input$staf3c_proj*.01+c8
      commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Public Bus',]$inventory = 
        c9 * input$staf6c_proj*.01+c9
      commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Walk',]$inventory = 
        c10 * input$staf7c_proj*.01+c10
      
      COMMUTING_STAFF_TABLE_R  = rbind(commut1,commut2)  
    } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 3 COMMUTING_STAFF_TABLE_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Replacement of 20% beef with Chicken"){
      # Footprint Units are MT C and MT N
      
      commut1 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Staff Commuting',]
      commut2 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Staff Commuting',]
      
      # Add Projected category
      commut1$Timeframe = 'Baseline'
      commut2$Timeframe = 'Projected'
      
      # Gives the baseline value
      
      c6 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Automobile',]$inventory
      c7 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Bike',]$inventory
      c8 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Carpool',]$inventory
      c9 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Public Bus',]$inventory
      c10 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Walk',]$inventory
      
      commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Automobile',]$inventory = 
        c6 * input$staf1d_proj*.01+c6
      commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Bike',]$inventory = 
        c7 * input$staf2d_proj*.01+c7
      commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Carpool',]$inventory = 
        c8 * input$staf3d_proj*.01+c8
      commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Public Bus',]$inventory = 
        c9 * input$staf6d_proj*.01+c9
      commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Walk',]$inventory = 
        c10 * input$staf7d_proj*.01+c10
      
      COMMUTING_STAFF_TABLE_R  = rbind(commut1,commut2)  
    } # Scenario  
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 4 COMMUTING_STAFF_TABLE_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Fuel Optimization"){
      # Footprint Units are MT C and MT N
      
      commut1 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Staff Commuting',]
      commut2 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Staff Commuting',]
      
      # Add Projected category
      commut1$Timeframe = 'Baseline'
      commut2$Timeframe = 'Projected'
      
      # Gives the baseline value
      
      c6 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Automobile',]$inventory
      c7 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Bike',]$inventory
      c8 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Carpool',]$inventory
      c9 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Public Bus',]$inventory
      c10 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Walk',]$inventory
      
      commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Automobile',]$inventory = 
        c6 * input$staf1e_proj*.01+c6
      commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Bike',]$inventory = 
        c7 * input$staf2e_proj*.01+c7
      commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Carpool',]$inventory = 
        c8 * input$staf3e_proj*.01+c8
      commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Public Bus',]$inventory = 
        c9 * input$staf6e_proj*.01+c9
      commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Walk',]$inventory = 
        c10 * input$staf7e_proj*.01+c10
      
      COMMUTING_STAFF_TABLE_R  = rbind(commut1,commut2)  
    } # Scenario  
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 5 COMMUTING_STAFF_TABLE_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Implementing All Scenarios"){
      # Footprint Units are MT C and MT N
      
      commut1 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Staff Commuting',]
      commut2 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Staff Commuting',]
      
      # Add Projected category
      commut1$Timeframe = 'Baseline'
      commut2$Timeframe = 'Projected'
      
      # Gives the baseline value
      
      c6 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Automobile',]$inventory
      c7 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Bike',]$inventory
      c8 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Carpool',]$inventory
      c9 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Public Bus',]$inventory
      c10 = commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Walk',]$inventory
      
      commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Automobile',]$inventory = 
        c6 * input$staf1f_proj*.01+c6
      commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Bike',]$inventory = 
        c7 * input$staf2f_proj*.01+c7
      commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Carpool',]$inventory = 
        c8 * input$staf3f_proj*.01+c8
      commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Public Bus',]$inventory = 
        c9 * input$staf6f_proj*.01+c9
      commut2[commut2$Sub_category=='Staff Commuting' & commut2$Source == 'Walk',]$inventory = 
        c10 * input$staf7f_proj*.01+c10
      
      COMMUTING_STAFF_TABLE_R  = rbind(commut1,commut2)  
    } # Scenario
    
  }) # reactive
  
  Commut_Staff_R_ <- reactive({
    
    # # Campus Vs. Individual
    # if(input$campusVindividual == "Campus"){
    #   uva = uva_R()
    #   food = food
    # }
    # 
    # else if(input$campusVindividual == "Individual"){
    #   uva = uva_individual
    #   food = food_individual
    # }
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 0
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    if(input$scenario == "Manual Scenario"){
    COMMUTING = COMMUTING_STAFF_TABLE_R()
    
    #CARBON_____________________________________________________________________
    # Result units = kg CO2
    # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
    COMMUTING$CO2_r = COMMUTING$inventory * COMMUTING$CO2.EF
    
    # Result units = kg eCO2
    # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
    COMMUTING$eCO2_r = COMMUTING$inventory * COMMUTING$eCO2.EF
    
    # Result units = kg CH4
    # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
    COMMUTING$CH4_r = COMMUTING$inventory * COMMUTING$CH4.EF
    
    #NITROGEN_____________________________________________________________________
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMMUTING$N2O_r = COMMUTING$inventory * COMMUTING$N2O.EF
    
    # Result units = kg NOx
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMMUTING$NOx_r = COMMUTING$inventory * COMMUTING$NOx.EF
    
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMMUTING$OtherN_r = COMMUTING$inventory * COMMUTING$Other.N.EF
    
    #INTERMEDIATE C & N _______________________________________________________________
    
    # calculate Footprints by category (divide by 1000 to convert from kg to MT)
    # Units of GWP 
    COMMUTING$CO2_MTCDE = COMMUTING$CO2_r/1000  # MT CO2e
    COMMUTING$eCO2_MTCDE = COMMUTING$eCO2_r/1000 # MT CO2e
    COMMUTING$CH4_MTCDE = COMMUTING$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
    COMMUTING$N2O_MTCDE = COMMUTING$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
    
    # intermediate N
    COMMUTING$N2O_MTN = COMMUTING$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
    COMMUTING$NOx_MTN = COMMUTING$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
    COMMUTING$OtherN_MTN = COMMUTING$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
    
    #*****************************************************************************************************
    # FOOTPRINT Calculations
    #*****************************************************************************************************
    
    # CALCULATING FOOTPRINT C & N_____________________________________________________________________
    # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
    
    COMMUTING$C_Footprint = rowSums(COMMUTING[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
    COMMUTING$N_Footprint = rowSums(COMMUTING[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
    
    Commut_Staff_R_ = COMMUTING
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 1 Commut_Staff_R_
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Business as Usual Growth to 2025"){
      COMMUTING = COMMUTING_STAFF_TABLE_R()
    
    #CARBON_____________________________________________________________________
    # Result units = kg CO2
    # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
    COMMUTING$CO2_r = COMMUTING$inventory * COMMUTING$CO2.EF
    
    # Result units = kg eCO2
    # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
    COMMUTING$eCO2_r = COMMUTING$inventory * COMMUTING$eCO2.EF
    
    # Result units = kg CH4
    # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
    COMMUTING$CH4_r = COMMUTING$inventory * COMMUTING$CH4.EF
    
    #NITROGEN_____________________________________________________________________
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMMUTING$N2O_r = COMMUTING$inventory * COMMUTING$N2O.EF
    
    # Result units = kg NOx
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMMUTING$NOx_r = COMMUTING$inventory * COMMUTING$NOx.EF
    
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMMUTING$OtherN_r = COMMUTING$inventory * COMMUTING$Other.N.EF
    
    #INTERMEDIATE C & N _______________________________________________________________
    
    # calculate Footprints by category (divide by 1000 to convert from kg to MT)
    # Units of GWP 
    COMMUTING$CO2_MTCDE = COMMUTING$CO2_r/1000  # MT CO2e
    COMMUTING$eCO2_MTCDE = COMMUTING$eCO2_r/1000 # MT CO2e
    COMMUTING$CH4_MTCDE = COMMUTING$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
    COMMUTING$N2O_MTCDE = COMMUTING$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
    
    # intermediate N
    COMMUTING$N2O_MTN = COMMUTING$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
    COMMUTING$NOx_MTN = COMMUTING$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
    COMMUTING$OtherN_MTN = COMMUTING$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
    
    #*****************************************************************************************************
    # FOOTPRINT Calculations
    #*****************************************************************************************************
    
    # CALCULATING FOOTPRINT C & N_____________________________________________________________________
    # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
    
    COMMUTING$C_Footprint = rowSums(COMMUTING[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
    COMMUTING$N_Footprint = rowSums(COMMUTING[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
    
    Commut_Staff_R_ = COMMUTING  
      
  } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 2 Commut_Staff_R_
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "15% Vegetarian Meals"){
      COMMUTING = COMMUTING_STAFF_TABLE_R()
      
      #CARBON_____________________________________________________________________
      # Result units = kg CO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
      COMMUTING$CO2_r = COMMUTING$inventory * COMMUTING$CO2.EF
      
      # Result units = kg eCO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
      COMMUTING$eCO2_r = COMMUTING$inventory * COMMUTING$eCO2.EF
      
      # Result units = kg CH4
      # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
      COMMUTING$CH4_r = COMMUTING$inventory * COMMUTING$CH4.EF
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$N2O_r = COMMUTING$inventory * COMMUTING$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$NOx_r = COMMUTING$inventory * COMMUTING$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$OtherN_r = COMMUTING$inventory * COMMUTING$Other.N.EF
      
      #INTERMEDIATE C & N _______________________________________________________________
      
      # calculate Footprints by category (divide by 1000 to convert from kg to MT)
      # Units of GWP 
      COMMUTING$CO2_MTCDE = COMMUTING$CO2_r/1000  # MT CO2e
      COMMUTING$eCO2_MTCDE = COMMUTING$eCO2_r/1000 # MT CO2e
      COMMUTING$CH4_MTCDE = COMMUTING$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
      COMMUTING$N2O_MTCDE = COMMUTING$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
      
      # intermediate N
      COMMUTING$N2O_MTN = COMMUTING$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
      COMMUTING$NOx_MTN = COMMUTING$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
      COMMUTING$OtherN_MTN = COMMUTING$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C & N_____________________________________________________________________
      # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
      
      COMMUTING$C_Footprint = rowSums(COMMUTING[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
      COMMUTING$N_Footprint = rowSums(COMMUTING[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
      
      Commut_Staff_R_ = COMMUTING  
      
    } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 3 Commut_Staff_R_
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Replacement of 20% beef with Chicken"){
      COMMUTING = COMMUTING_STAFF_TABLE_R()
      
      #CARBON_____________________________________________________________________
      # Result units = kg CO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
      COMMUTING$CO2_r = COMMUTING$inventory * COMMUTING$CO2.EF
      
      # Result units = kg eCO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
      COMMUTING$eCO2_r = COMMUTING$inventory * COMMUTING$eCO2.EF
      
      # Result units = kg CH4
      # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
      COMMUTING$CH4_r = COMMUTING$inventory * COMMUTING$CH4.EF
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$N2O_r = COMMUTING$inventory * COMMUTING$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$NOx_r = COMMUTING$inventory * COMMUTING$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$OtherN_r = COMMUTING$inventory * COMMUTING$Other.N.EF
      
      #INTERMEDIATE C & N _______________________________________________________________
      
      # calculate Footprints by category (divide by 1000 to convert from kg to MT)
      # Units of GWP 
      COMMUTING$CO2_MTCDE = COMMUTING$CO2_r/1000  # MT CO2e
      COMMUTING$eCO2_MTCDE = COMMUTING$eCO2_r/1000 # MT CO2e
      COMMUTING$CH4_MTCDE = COMMUTING$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
      COMMUTING$N2O_MTCDE = COMMUTING$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
      
      # intermediate N
      COMMUTING$N2O_MTN = COMMUTING$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
      COMMUTING$NOx_MTN = COMMUTING$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
      COMMUTING$OtherN_MTN = COMMUTING$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C & N_____________________________________________________________________
      # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
      
      COMMUTING$C_Footprint = rowSums(COMMUTING[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
      COMMUTING$N_Footprint = rowSums(COMMUTING[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
      
      Commut_Staff_R_ = COMMUTING  
      
    } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 4 Commut_Staff_R_
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Fuel Optimization"){
      COMMUTING = COMMUTING_STAFF_TABLE_R()
      
      #CARBON_____________________________________________________________________
      # Result units = kg CO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
      COMMUTING$CO2_r = COMMUTING$inventory * COMMUTING$CO2.EF
      
      # Result units = kg eCO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
      COMMUTING$eCO2_r = COMMUTING$inventory * COMMUTING$eCO2.EF
      
      # Result units = kg CH4
      # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
      COMMUTING$CH4_r = COMMUTING$inventory * COMMUTING$CH4.EF
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$N2O_r = COMMUTING$inventory * COMMUTING$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$NOx_r = COMMUTING$inventory * COMMUTING$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$OtherN_r = COMMUTING$inventory * COMMUTING$Other.N.EF
      
      #INTERMEDIATE C & N _______________________________________________________________
      
      # calculate Footprints by category (divide by 1000 to convert from kg to MT)
      # Units of GWP 
      COMMUTING$CO2_MTCDE = COMMUTING$CO2_r/1000  # MT CO2e
      COMMUTING$eCO2_MTCDE = COMMUTING$eCO2_r/1000 # MT CO2e
      COMMUTING$CH4_MTCDE = COMMUTING$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
      COMMUTING$N2O_MTCDE = COMMUTING$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
      
      # intermediate N
      COMMUTING$N2O_MTN = COMMUTING$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
      COMMUTING$NOx_MTN = COMMUTING$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
      COMMUTING$OtherN_MTN = COMMUTING$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C & N_____________________________________________________________________
      # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
      
      COMMUTING$C_Footprint = rowSums(COMMUTING[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
      COMMUTING$N_Footprint = rowSums(COMMUTING[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
      
      Commut_Staff_R_ = COMMUTING  
      
    } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 5 Commut_Staff_R_
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Implementing All Scenarios"){
      COMMUTING = COMMUTING_STAFF_TABLE_R()
      
      #CARBON_____________________________________________________________________
      # Result units = kg CO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
      COMMUTING$CO2_r = COMMUTING$inventory * COMMUTING$CO2.EF
      
      # Result units = kg eCO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
      COMMUTING$eCO2_r = COMMUTING$inventory * COMMUTING$eCO2.EF
      
      # Result units = kg CH4
      # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
      COMMUTING$CH4_r = COMMUTING$inventory * COMMUTING$CH4.EF
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$N2O_r = COMMUTING$inventory * COMMUTING$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$NOx_r = COMMUTING$inventory * COMMUTING$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$OtherN_r = COMMUTING$inventory * COMMUTING$Other.N.EF
      
      #INTERMEDIATE C & N _______________________________________________________________
      
      # calculate Footprints by category (divide by 1000 to convert from kg to MT)
      # Units of GWP 
      COMMUTING$CO2_MTCDE = COMMUTING$CO2_r/1000  # MT CO2e
      COMMUTING$eCO2_MTCDE = COMMUTING$eCO2_r/1000 # MT CO2e
      COMMUTING$CH4_MTCDE = COMMUTING$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
      COMMUTING$N2O_MTCDE = COMMUTING$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
      
      # intermediate N
      COMMUTING$N2O_MTN = COMMUTING$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
      COMMUTING$NOx_MTN = COMMUTING$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
      COMMUTING$OtherN_MTN = COMMUTING$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C & N_____________________________________________________________________
      # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
      
      COMMUTING$C_Footprint = rowSums(COMMUTING[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
      COMMUTING$N_Footprint = rowSums(COMMUTING[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
      
      Commut_Staff_R_ = COMMUTING  
      
    } # Scenario
    
  }) # reactive
  
  Commut_Staff_R <- reactive({
    
    # # Campus Vs. Individual
    # if(input$campusVindividual == "Campus"){
    #   uva = uva_R()
    #   food = food
    # }
    # 
    # else if(input$campusVindividual == "Individual"){
    #   uva = uva_individual
    #   food = food_individual
    # }
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 0
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    if(input$scenario == "Manual Scenario"){
    #*****************************************************************************************************
    # FOOTPRINT DATA OUTPUT
    #*****************************************************************************************************
    
    COMMUTING = Commut_Staff_R_()
    
    # Summarize by Category___________________________________________________________________________
    # Units are MT C, MT N, MT P, Gallons Water 
    
    COMMUTING1_ = COMMUTING[COMMUTING$Timeframe == 'Baseline',] %>% 
      group_by(Category,Sub_category,Source) %>% 
      summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                Total_N_Footprint = sum(N_Footprint,na.rm=T))
    COMMUTING2_ = COMMUTING[COMMUTING$Timeframe == 'Projected',] %>%
      group_by(Category,Sub_category,Source) %>% 
      summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
    
    COMMUTING1_$Timeframe = 'Baseline'
    COMMUTING2_$Timeframe = 'Projected'
    
    Commut_Staff_R = rbind(COMMUTING1_,COMMUTING2_)
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 1 Commut_Staff_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Business as Usual Growth to 2025"){
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      COMMUTING = Commut_Staff_R_()
    
    # Summarize by Category___________________________________________________________________________
    # Units are MT C, MT N, MT P, Gallons Water 
    
    COMMUTING1_ = COMMUTING[COMMUTING$Timeframe == 'Baseline',] %>% 
      group_by(Category,Sub_category,Source) %>% 
      summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                Total_N_Footprint = sum(N_Footprint,na.rm=T))
    COMMUTING2_ = COMMUTING[COMMUTING$Timeframe == 'Projected',] %>%
      group_by(Category,Sub_category,Source) %>% 
      summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
    
    COMMUTING1_$Timeframe = 'Baseline'
    COMMUTING2_$Timeframe = 'Projected'
    
    Commut_Staff_R = rbind(COMMUTING1_,COMMUTING2_)  
  } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 2 Commut_Staff_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "15% Vegetarian Meals"){
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      COMMUTING = Commut_Staff_R_()
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMMUTING1_ = COMMUTING[COMMUTING$Timeframe == 'Baseline',] %>% 
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T))
      COMMUTING2_ = COMMUTING[COMMUTING$Timeframe == 'Projected',] %>%
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
      
      COMMUTING1_$Timeframe = 'Baseline'
      COMMUTING2_$Timeframe = 'Projected'
      
      Commut_Staff_R = rbind(COMMUTING1_,COMMUTING2_)  
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 3 Commut_Staff_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Replacement of 20% beef with Chicken"){
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      COMMUTING = Commut_Staff_R_()
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMMUTING1_ = COMMUTING[COMMUTING$Timeframe == 'Baseline',] %>% 
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T))
      COMMUTING2_ = COMMUTING[COMMUTING$Timeframe == 'Projected',] %>%
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
      
      COMMUTING1_$Timeframe = 'Baseline'
      COMMUTING2_$Timeframe = 'Projected'
      
      Commut_Staff_R = rbind(COMMUTING1_,COMMUTING2_)  
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 4 Commut_Staff_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Fuel Optimization"){
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      COMMUTING = Commut_Staff_R_()
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMMUTING1_ = COMMUTING[COMMUTING$Timeframe == 'Baseline',] %>% 
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T))
      COMMUTING2_ = COMMUTING[COMMUTING$Timeframe == 'Projected',] %>%
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
      
      COMMUTING1_$Timeframe = 'Baseline'
      COMMUTING2_$Timeframe = 'Projected'
      
      Commut_Staff_R = rbind(COMMUTING1_,COMMUTING2_)  
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 5 Commut_Staff_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Implementing All Scenarios"){
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      COMMUTING = Commut_Staff_R_()
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMMUTING1_ = COMMUTING[COMMUTING$Timeframe == 'Baseline',] %>% 
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T))
      COMMUTING2_ = COMMUTING[COMMUTING$Timeframe == 'Projected',] %>%
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
      
      COMMUTING1_$Timeframe = 'Baseline'
      COMMUTING2_$Timeframe = 'Projected'
      
      Commut_Staff_R = rbind(COMMUTING1_,COMMUTING2_)  
    } # Scenario 
    
  }) # reactive
  
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  # STEP_14 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  #*****************************************************************************************************
  # Commuting Reactive Student Calculations
  #*****************************************************************************************************
  
  # Commuting all sub-categories and sources
  
  COMMUTING_STUD_TABLE_R <- reactive({
    
    # # Campus Vs. Individual
    # if(input$campusVindividual == "Campus"){
    #   uva = uva_R()
    #   food = food
    # }
    # 
    # else if(input$campusVindividual == "Individual"){
    #   uva = uva_individual
    #   food = food_individual
    # }
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 0
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    if(input$scenario == "Manual Scenario"){
    # Footprint Units are MT C and MT N
    
    commut1 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Student Commuting',]
    commut2 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Student Commuting',]
    
    # Add Projected category
    commut1$Timeframe = 'Baseline'
    commut2$Timeframe = 'Projected'
    
    # Gives the baseline value
    
    c11 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Automobile',]$inventory
    c12 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Bike',]$inventory
    c13 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Carpool',]$inventory
    c14 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Public Bus',]$inventory
    c15 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Walk',]$inventory
    
    commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Automobile',]$inventory = 
      c11 * input$stud1a_proj*.01+c11
    commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Bike',]$inventory = 
      c12 * input$stud2a_proj*.01+c12
    commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Carpool',]$inventory = 
      c13 * input$stud3a_proj*.01+c13
    commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Public Bus',]$inventory = 
      c14 * input$stud6a_proj*.01+c14
    commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Walk',]$inventory = 
      c15 * input$stud7a_proj*.01+c15
    
    COMMUTING_STUD_TABLE_R = rbind(commut1,commut2)
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 1 COMMUTING_STUD_TABLE_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Business as Usual Growth to 2025"){
      # Footprint Units are MT C and MT N
      
      commut1 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Student Commuting',]
    commut2 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Student Commuting',]
    
    # Add Projected category
    commut1$Timeframe = 'Baseline'
    commut2$Timeframe = 'Projected'
    
    # Gives the baseline value
    
    c11 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Automobile',]$inventory
    c12 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Bike',]$inventory
    c13 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Carpool',]$inventory
    c14 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Public Bus',]$inventory
    c15 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Walk',]$inventory
    
    commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Automobile',]$inventory = 
      c11 * input$stud1b_proj*.01+c11
    commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Bike',]$inventory = 
      c12 * input$stud2b_proj*.01+c12
    commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Carpool',]$inventory = 
      c13 * input$stud3b_proj*.01+c13
    commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Public Bus',]$inventory = 
      c14 * input$stud6b_proj*.01+c14
    commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Walk',]$inventory = 
      c15 * input$stud7b_proj*.01+c15
    
    COMMUTING_STUD_TABLE_R = rbind(commut1,commut2)  
  } # Scenario   
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 2 COMMUTING_STUD_TABLE_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "15% Vegetarian Meals"){
      # Footprint Units are MT C and MT N
      
      commut1 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Student Commuting',]
      commut2 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Student Commuting',]
      
      # Add Projected category
      commut1$Timeframe = 'Baseline'
      commut2$Timeframe = 'Projected'
      
      # Gives the baseline value
      
      c11 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Automobile',]$inventory
      c12 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Bike',]$inventory
      c13 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Carpool',]$inventory
      c14 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Public Bus',]$inventory
      c15 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Walk',]$inventory
      
      commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Automobile',]$inventory = 
        c11 * input$stud1c_proj*.01+c11
      commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Bike',]$inventory = 
        c12 * input$stud2c_proj*.01+c12
      commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Carpool',]$inventory = 
        c13 * input$stud3c_proj*.01+c13
      commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Public Bus',]$inventory = 
        c14 * input$stud6c_proj*.01+c14
      commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Walk',]$inventory = 
        c15 * input$stud7c_proj*.01+c15
      
      COMMUTING_STUD_TABLE_R = rbind(commut1,commut2)  
    } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 3 COMMUTING_STUD_TABLE_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Replacement of 20% beef with Chicken"){
      # Footprint Units are MT C and MT N
      
      commut1 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Student Commuting',]
      commut2 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Student Commuting',]
      
      # Add Projected category
      commut1$Timeframe = 'Baseline'
      commut2$Timeframe = 'Projected'
      
      # Gives the baseline value
      
      c11 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Automobile',]$inventory
      c12 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Bike',]$inventory
      c13 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Carpool',]$inventory
      c14 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Public Bus',]$inventory
      c15 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Walk',]$inventory
      
      commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Automobile',]$inventory = 
        c11 * input$stud1d_proj*.01+c11
      commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Bike',]$inventory = 
        c12 * input$stud2d_proj*.01+c12
      commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Carpool',]$inventory = 
        c13 * input$stud3d_proj*.01+c13
      commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Public Bus',]$inventory = 
        c14 * input$stud6d_proj*.01+c14
      commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Walk',]$inventory = 
        c15 * input$stud7d_proj*.01+c15
      
      COMMUTING_STUD_TABLE_R = rbind(commut1,commut2)  
    } # Scenario   
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 4 COMMUTING_STUD_TABLE_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Fuel Optimization"){
      # Footprint Units are MT C and MT N
      
      commut1 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Student Commuting',]
      commut2 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Student Commuting',]
      
      # Add Projected category
      commut1$Timeframe = 'Baseline'
      commut2$Timeframe = 'Projected'
      
      # Gives the baseline value
      
      c11 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Automobile',]$inventory
      c12 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Bike',]$inventory
      c13 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Carpool',]$inventory
      c14 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Public Bus',]$inventory
      c15 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Walk',]$inventory
      
      commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Automobile',]$inventory = 
        c11 * input$stud1e_proj*.01+c11
      commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Bike',]$inventory = 
        c12 * input$stud2e_proj*.01+c12
      commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Carpool',]$inventory = 
        c13 * input$stud3e_proj*.01+c13
      commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Public Bus',]$inventory = 
        c14 * input$stud6e_proj*.01+c14
      commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Walk',]$inventory = 
        c15 * input$stud7e_proj*.01+c15
      
      COMMUTING_STUD_TABLE_R = rbind(commut1,commut2)  
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 5 COMMUTING_STUD_TABLE_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Implementing All Scenarios"){
      # Footprint Units are MT C and MT N
      
      commut1 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Student Commuting',]
      commut2 = uva[uva$Category == 'Commuting' & uva$Sub_category == 'Student Commuting',]
      
      # Add Projected category
      commut1$Timeframe = 'Baseline'
      commut2$Timeframe = 'Projected'
      
      # Gives the baseline value
      
      c11 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Automobile',]$inventory
      c12 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Bike',]$inventory
      c13 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Carpool',]$inventory
      c14 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Public Bus',]$inventory
      c15 = commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Walk',]$inventory
      
      commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Automobile',]$inventory = 
        c11 * input$stud1f_proj*.01+c11
      commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Bike',]$inventory = 
        c12 * input$stud2f_proj*.01+c12
      commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Carpool',]$inventory = 
        c13 * input$stud3f_proj*.01+c13
      commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Public Bus',]$inventory = 
        c14 * input$stud6f_proj*.01+c14
      commut2[commut2$Sub_category=='Student Commuting' & commut2$Source == 'Walk',]$inventory = 
        c15 * input$stud7f_proj*.01+c15
      
      COMMUTING_STUD_TABLE_R = rbind(commut1,commut2)  
    } # Scenario 
    
  }) # reactive
  
  Commut_Stud_R_ <- reactive({
    
    # # Campus Vs. Individual
    # if(input$campusVindividual == "Campus"){
    #   uva = uva_R()
    #   food = food
    # }
    # 
    # else if(input$campusVindividual == "Individual"){
    #   uva = uva_individual
    #   food = food_individual
    # }
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 0
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    if(input$scenario == "Manual Scenario"){
    COMMUTING = COMMUTING_STUD_TABLE_R()
    
    #CARBON_____________________________________________________________________
    # Result units = kg CO2
    # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
    COMMUTING$CO2_r = COMMUTING$inventory * COMMUTING$CO2.EF
    
    # Result units = kg eCO2
    # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
    COMMUTING$eCO2_r = COMMUTING$inventory * COMMUTING$eCO2.EF
    
    # Result units = kg CH4
    # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
    COMMUTING$CH4_r = COMMUTING$inventory * COMMUTING$CH4.EF
    
    #NITROGEN_____________________________________________________________________
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMMUTING$N2O_r = COMMUTING$inventory * COMMUTING$N2O.EF
    
    # Result units = kg NOx
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMMUTING$NOx_r = COMMUTING$inventory * COMMUTING$NOx.EF
    
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMMUTING$OtherN_r = COMMUTING$inventory * COMMUTING$Other.N.EF
    
    #INTERMEDIATE C & N _______________________________________________________________
    
    # calculate Footprints by category (divide by 1000 to convert from kg to MT)
    # Units of GWP 
    COMMUTING$CO2_MTCDE = COMMUTING$CO2_r/1000  # MT CO2e
    COMMUTING$eCO2_MTCDE = COMMUTING$eCO2_r/1000 # MT CO2e
    COMMUTING$CH4_MTCDE = COMMUTING$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
    COMMUTING$N2O_MTCDE = COMMUTING$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
    
    # intermediate N
    COMMUTING$N2O_MTN = COMMUTING$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
    COMMUTING$NOx_MTN = COMMUTING$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
    COMMUTING$OtherN_MTN = COMMUTING$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
    
    #*****************************************************************************************************
    # FOOTPRINT Calculations
    #*****************************************************************************************************
    
    # CALCULATING FOOTPRINT C & N_____________________________________________________________________
    # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
    
    COMMUTING$C_Footprint = rowSums(COMMUTING[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
    COMMUTING$N_Footprint = rowSums(COMMUTING[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
    
    Commut_Stud_R_ = COMMUTING
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 1 Commut_Stud_R_
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Business as Usual Growth to 2025"){
      COMMUTING = COMMUTING_STUD_TABLE_R()
    
    #CARBON_____________________________________________________________________
    # Result units = kg CO2
    # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
    COMMUTING$CO2_r = COMMUTING$inventory * COMMUTING$CO2.EF
    
    # Result units = kg eCO2
    # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
    COMMUTING$eCO2_r = COMMUTING$inventory * COMMUTING$eCO2.EF
    
    # Result units = kg CH4
    # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
    COMMUTING$CH4_r = COMMUTING$inventory * COMMUTING$CH4.EF
    
    #NITROGEN_____________________________________________________________________
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMMUTING$N2O_r = COMMUTING$inventory * COMMUTING$N2O.EF
    
    # Result units = kg NOx
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMMUTING$NOx_r = COMMUTING$inventory * COMMUTING$NOx.EF
    
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    COMMUTING$OtherN_r = COMMUTING$inventory * COMMUTING$Other.N.EF
    
    #INTERMEDIATE C & N _______________________________________________________________
    
    # calculate Footprints by category (divide by 1000 to convert from kg to MT)
    # Units of GWP 
    COMMUTING$CO2_MTCDE = COMMUTING$CO2_r/1000  # MT CO2e
    COMMUTING$eCO2_MTCDE = COMMUTING$eCO2_r/1000 # MT CO2e
    COMMUTING$CH4_MTCDE = COMMUTING$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
    COMMUTING$N2O_MTCDE = COMMUTING$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
    
    # intermediate N
    COMMUTING$N2O_MTN = COMMUTING$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
    COMMUTING$NOx_MTN = COMMUTING$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
    COMMUTING$OtherN_MTN = COMMUTING$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
    
    #*****************************************************************************************************
    # FOOTPRINT Calculations
    #*****************************************************************************************************
    
    # CALCULATING FOOTPRINT C & N_____________________________________________________________________
    # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
    
    COMMUTING$C_Footprint = rowSums(COMMUTING[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
    COMMUTING$N_Footprint = rowSums(COMMUTING[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
    
    Commut_Stud_R_ = COMMUTING  
  } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 2 Commut_Stud_R_
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "15% Vegetarian Meals"){
      COMMUTING = COMMUTING_STUD_TABLE_R()
      
      #CARBON_____________________________________________________________________
      # Result units = kg CO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
      COMMUTING$CO2_r = COMMUTING$inventory * COMMUTING$CO2.EF
      
      # Result units = kg eCO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
      COMMUTING$eCO2_r = COMMUTING$inventory * COMMUTING$eCO2.EF
      
      # Result units = kg CH4
      # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
      COMMUTING$CH4_r = COMMUTING$inventory * COMMUTING$CH4.EF
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$N2O_r = COMMUTING$inventory * COMMUTING$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$NOx_r = COMMUTING$inventory * COMMUTING$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$OtherN_r = COMMUTING$inventory * COMMUTING$Other.N.EF
      
      #INTERMEDIATE C & N _______________________________________________________________
      
      # calculate Footprints by category (divide by 1000 to convert from kg to MT)
      # Units of GWP 
      COMMUTING$CO2_MTCDE = COMMUTING$CO2_r/1000  # MT CO2e
      COMMUTING$eCO2_MTCDE = COMMUTING$eCO2_r/1000 # MT CO2e
      COMMUTING$CH4_MTCDE = COMMUTING$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
      COMMUTING$N2O_MTCDE = COMMUTING$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
      
      # intermediate N
      COMMUTING$N2O_MTN = COMMUTING$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
      COMMUTING$NOx_MTN = COMMUTING$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
      COMMUTING$OtherN_MTN = COMMUTING$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C & N_____________________________________________________________________
      # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
      
      COMMUTING$C_Footprint = rowSums(COMMUTING[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
      COMMUTING$N_Footprint = rowSums(COMMUTING[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
      
      Commut_Stud_R_ = COMMUTING  
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 3 Commut_Stud_R_
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Replacement of 20% beef with Chicken"){
      COMMUTING = COMMUTING_STUD_TABLE_R()
      
      #CARBON_____________________________________________________________________
      # Result units = kg CO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
      COMMUTING$CO2_r = COMMUTING$inventory * COMMUTING$CO2.EF
      
      # Result units = kg eCO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
      COMMUTING$eCO2_r = COMMUTING$inventory * COMMUTING$eCO2.EF
      
      # Result units = kg CH4
      # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
      COMMUTING$CH4_r = COMMUTING$inventory * COMMUTING$CH4.EF
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$N2O_r = COMMUTING$inventory * COMMUTING$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$NOx_r = COMMUTING$inventory * COMMUTING$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$OtherN_r = COMMUTING$inventory * COMMUTING$Other.N.EF
      
      #INTERMEDIATE C & N _______________________________________________________________
      
      # calculate Footprints by category (divide by 1000 to convert from kg to MT)
      # Units of GWP 
      COMMUTING$CO2_MTCDE = COMMUTING$CO2_r/1000  # MT CO2e
      COMMUTING$eCO2_MTCDE = COMMUTING$eCO2_r/1000 # MT CO2e
      COMMUTING$CH4_MTCDE = COMMUTING$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
      COMMUTING$N2O_MTCDE = COMMUTING$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
      
      # intermediate N
      COMMUTING$N2O_MTN = COMMUTING$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
      COMMUTING$NOx_MTN = COMMUTING$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
      COMMUTING$OtherN_MTN = COMMUTING$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C & N_____________________________________________________________________
      # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
      
      COMMUTING$C_Footprint = rowSums(COMMUTING[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
      COMMUTING$N_Footprint = rowSums(COMMUTING[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
      
      Commut_Stud_R_ = COMMUTING  
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 4 Commut_Stud_R_
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Fuel Optimization"){
      COMMUTING = COMMUTING_STUD_TABLE_R()
      
      #CARBON_____________________________________________________________________
      # Result units = kg CO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
      COMMUTING$CO2_r = COMMUTING$inventory * COMMUTING$CO2.EF
      
      # Result units = kg eCO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
      COMMUTING$eCO2_r = COMMUTING$inventory * COMMUTING$eCO2.EF
      
      # Result units = kg CH4
      # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
      COMMUTING$CH4_r = COMMUTING$inventory * COMMUTING$CH4.EF
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$N2O_r = COMMUTING$inventory * COMMUTING$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$NOx_r = COMMUTING$inventory * COMMUTING$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$OtherN_r = COMMUTING$inventory * COMMUTING$Other.N.EF
      
      #INTERMEDIATE C & N _______________________________________________________________
      
      # calculate Footprints by category (divide by 1000 to convert from kg to MT)
      # Units of GWP 
      COMMUTING$CO2_MTCDE = COMMUTING$CO2_r/1000  # MT CO2e
      COMMUTING$eCO2_MTCDE = COMMUTING$eCO2_r/1000 # MT CO2e
      COMMUTING$CH4_MTCDE = COMMUTING$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
      COMMUTING$N2O_MTCDE = COMMUTING$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
      
      # intermediate N
      COMMUTING$N2O_MTN = COMMUTING$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
      COMMUTING$NOx_MTN = COMMUTING$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
      COMMUTING$OtherN_MTN = COMMUTING$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C & N_____________________________________________________________________
      # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
      
      COMMUTING$C_Footprint = rowSums(COMMUTING[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
      COMMUTING$N_Footprint = rowSums(COMMUTING[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
      
      Commut_Stud_R_ = COMMUTING  
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 5 Commut_Stud_R_
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Implementing All Scenarios"){
      COMMUTING = COMMUTING_STUD_TABLE_R()
      
      #CARBON_____________________________________________________________________
      # Result units = kg CO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
      COMMUTING$CO2_r = COMMUTING$inventory * COMMUTING$CO2.EF
      
      # Result units = kg eCO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
      COMMUTING$eCO2_r = COMMUTING$inventory * COMMUTING$eCO2.EF
      
      # Result units = kg CH4
      # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
      COMMUTING$CH4_r = COMMUTING$inventory * COMMUTING$CH4.EF
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$N2O_r = COMMUTING$inventory * COMMUTING$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$NOx_r = COMMUTING$inventory * COMMUTING$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      COMMUTING$OtherN_r = COMMUTING$inventory * COMMUTING$Other.N.EF
      
      #INTERMEDIATE C & N _______________________________________________________________
      
      # calculate Footprints by category (divide by 1000 to convert from kg to MT)
      # Units of GWP 
      COMMUTING$CO2_MTCDE = COMMUTING$CO2_r/1000  # MT CO2e
      COMMUTING$eCO2_MTCDE = COMMUTING$eCO2_r/1000 # MT CO2e
      COMMUTING$CH4_MTCDE = COMMUTING$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
      COMMUTING$N2O_MTCDE = COMMUTING$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
      
      # intermediate N
      COMMUTING$N2O_MTN = COMMUTING$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
      COMMUTING$NOx_MTN = COMMUTING$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
      COMMUTING$OtherN_MTN = COMMUTING$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C & N_____________________________________________________________________
      # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
      
      COMMUTING$C_Footprint = rowSums(COMMUTING[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
      COMMUTING$N_Footprint = rowSums(COMMUTING[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
      
      Commut_Stud_R_ = COMMUTING  
    } # Scenario 
    
    
  }) # reactive
  
  Commut_Stud_R <- reactive({
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 0
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    if(input$scenario == "Manual Scenario"){
      
    COMMUTING = Commut_Stud_R_()
    #*****************************************************************************************************
    # FOOTPRINT DATA OUTPUT
    #*****************************************************************************************************
    
    # Summarize by Category___________________________________________________________________________
    # Units are MT C, MT N, MT P, Gallons Water 
    
    COMMUTING1_ = COMMUTING[COMMUTING$Timeframe == 'Baseline',] %>% 
      group_by(Category,Sub_category,Source) %>% 
      summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                Total_N_Footprint = sum(N_Footprint,na.rm=T))
    COMMUTING2_ = COMMUTING[COMMUTING$Timeframe == 'Projected',] %>%
      group_by(Category,Sub_category,Source) %>% 
      summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
    
    COMMUTING1_$Timeframe = 'Baseline'
    COMMUTING2_$Timeframe = 'Projected'
    
    Commut_Stud_R = rbind(COMMUTING1_,COMMUTING2_)
    
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 1 Commut_Stud_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Business as Usual Growth to 2025"){
      COMMUTING = Commut_Stud_R_()
    #*****************************************************************************************************
    # FOOTPRINT DATA OUTPUT
    #*****************************************************************************************************
    
    # Summarize by Category___________________________________________________________________________
    # Units are MT C, MT N, MT P, Gallons Water 
    
    COMMUTING1_ = COMMUTING[COMMUTING$Timeframe == 'Baseline',] %>% 
      group_by(Category,Sub_category,Source) %>% 
      summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                Total_N_Footprint = sum(N_Footprint,na.rm=T))
    COMMUTING2_ = COMMUTING[COMMUTING$Timeframe == 'Projected',] %>%
      group_by(Category,Sub_category,Source) %>% 
      summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
    
    COMMUTING1_$Timeframe = 'Baseline'
    COMMUTING2_$Timeframe = 'Projected'
    
    Commut_Stud_R = rbind(COMMUTING1_,COMMUTING2_)  
      
  } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 2 Commut_Stud_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "15% Vegetarian Meals"){
      COMMUTING = Commut_Stud_R_()
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMMUTING1_ = COMMUTING[COMMUTING$Timeframe == 'Baseline',] %>% 
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T))
      COMMUTING2_ = COMMUTING[COMMUTING$Timeframe == 'Projected',] %>%
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
      
      COMMUTING1_$Timeframe = 'Baseline'
      COMMUTING2_$Timeframe = 'Projected'
      
      Commut_Stud_R = rbind(COMMUTING1_,COMMUTING2_)  
      
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 3 Commut_Stud_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Replacement of 20% beef with Chicken"){
      COMMUTING = Commut_Stud_R_()
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMMUTING1_ = COMMUTING[COMMUTING$Timeframe == 'Baseline',] %>% 
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T))
      COMMUTING2_ = COMMUTING[COMMUTING$Timeframe == 'Projected',] %>%
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
      
      COMMUTING1_$Timeframe = 'Baseline'
      COMMUTING2_$Timeframe = 'Projected'
      
      Commut_Stud_R = rbind(COMMUTING1_,COMMUTING2_)  
      
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 4 Commut_Stud_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Fuel Optimization"){
      COMMUTING = Commut_Stud_R_()
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMMUTING1_ = COMMUTING[COMMUTING$Timeframe == 'Baseline',] %>% 
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T))
      COMMUTING2_ = COMMUTING[COMMUTING$Timeframe == 'Projected',] %>%
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
      
      COMMUTING1_$Timeframe = 'Baseline'
      COMMUTING2_$Timeframe = 'Projected'
      
      Commut_Stud_R = rbind(COMMUTING1_,COMMUTING2_)  
      
    } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 5 Commut_Stud_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Implementing All Scenarios"){
      COMMUTING = Commut_Stud_R_()
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      COMMUTING1_ = COMMUTING[COMMUTING$Timeframe == 'Baseline',] %>% 
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T))
      COMMUTING2_ = COMMUTING[COMMUTING$Timeframe == 'Projected',] %>%
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
      
      COMMUTING1_$Timeframe = 'Baseline'
      COMMUTING2_$Timeframe = 'Projected'
      
      Commut_Stud_R = rbind(COMMUTING1_,COMMUTING2_)  
      
    } # Scenario
    
  }) # reactive
  
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  # STEP_15 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  #*****************************************************************************************************
  # Energy Reactive
  #*****************************************************************************************************
  
  ENERGY_TABLE_R <- reactive({
    
    # # Campus Vs. Individual
    # if(input$campusVindividual == "Campus"){
    #   uva = uva_R()
    #   food = food
    # }
    # 
    # else if(input$campusVindividual == "Individual"){
    #   uva = uva_individual
    #   food = food_individual
    # }
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 0
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    if(input$scenario == "Manual Scenario"){
    # ENGERGY
    Energy1 = uva[uva$Category == 'On-Campus Stationary Sources',]
    Energy2 = Energy1
    
    # Add Projected category
    Energy1$Timeframe = 'Baseline'
    Energy2$Timeframe = 'Projected'
    
    sectr3 ='On-Campus Stationary Sources'
    
    e1 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory
    e2 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory
    e3 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory
    e4 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory
    e5 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory
    e6 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory
    e7 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory
    e8 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory
    
    # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
    Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory = 
      e1* input$enrgy1a_proj*.01+e1
    Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory = 
      e2* input$enrgy3a_proj*.01+e2
    Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory = 
      e3* input$enrgy7a_proj*.01+e3
    Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory = 
      e4* input$enrgy8a_proj*.01+e4
    Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory = 
      e5* input$enrgy1a_proj*.01+e5
    Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory = 
      e6* input$enrgy3a_proj*.01+e6
    Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory = 
      e7* input$enrgy7a_proj*.01+e7
    Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory = 
      e8* input$enrgy8a_proj*.01+e8
    
    ENERGY_TABLE_R = rbind(Energy1,Energy2)
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 1 ENERGY_TABLE_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Business as Usual Growth to 2025"){
      # ENGERGY
      Energy1 = uva[uva$Category == 'On-Campus Stationary Sources',]
    Energy2 = Energy1
    
    # Add Projected category
    Energy1$Timeframe = 'Baseline'
    Energy2$Timeframe = 'Projected'
    
    sectr3 ='On-Campus Stationary Sources'
    
    e1 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory
    e2 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory
    e3 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory
    e4 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory
    e5 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory
    e6 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory
    e7 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory
    e8 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory
    
    # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
    Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory = 
      e1* input$enrgy1b_proj*.01+e1
    Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory = 
      e2* input$enrgy3b_proj*.01+e2
    Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory = 
      e3* input$enrgy7b_proj*.01+e3
    Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory = 
      e4* input$enrgy8b_proj*.01+e4
    Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory = 
      e5* input$enrgy1b_proj*.01+e5
    Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory = 
      e6* input$enrgy3b_proj*.01+e6
    Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory = 
      e7* input$enrgy7b_proj*.01+e7
    Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory = 
      e8* input$enrgy8b_proj*.01+e8
    
    ENERGY_TABLE_R = rbind(Energy1,Energy2)  
  } # Scenario  
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 2 ENERGY_TABLE_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "15% Vegetarian Meals"){
      # ENGERGY
      Energy1 = uva[uva$Category == 'On-Campus Stationary Sources',]
      Energy2 = Energy1
      
      # Add Projected category
      Energy1$Timeframe = 'Baseline'
      Energy2$Timeframe = 'Projected'
      
      sectr3 ='On-Campus Stationary Sources'
      
      e1 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory
      e2 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory
      e3 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory
      e4 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory
      e5 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory
      e6 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory
      e7 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory
      e8 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory
      
      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory = 
        e1* input$enrgy1c_proj*.01+e1
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory = 
        e2* input$enrgy3c_proj*.01+e2
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory = 
        e3* input$enrgy7c_proj*.01+e3
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory = 
        e4* input$enrgy8c_proj*.01+e4
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory = 
        e5* input$enrgy1c_proj*.01+e5
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory = 
        e6* input$enrgy3c_proj*.01+e6
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory = 
        e7* input$enrgy7c_proj*.01+e7
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory = 
        e8* input$enrgy8c_proj*.01+e8
      
      ENERGY_TABLE_R = rbind(Energy1,Energy2)  
    } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 3 ENERGY_TABLE_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Replacement of 20% beef with Chicken"){
      # ENGERGY
      Energy1 = uva[uva$Category == 'On-Campus Stationary Sources',]
      Energy2 = Energy1
      
      # Add Projected category
      Energy1$Timeframe = 'Baseline'
      Energy2$Timeframe = 'Projected'
      
      sectr3 ='On-Campus Stationary Sources'
      
      e1 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory
      e2 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory
      e3 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory
      e4 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory
      e5 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory
      e6 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory
      e7 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory
      e8 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory
      
      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory = 
        e1* input$enrgy1d_proj*.01+e1
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory = 
        e2* input$enrgy3d_proj*.01+e2
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory = 
        e3* input$enrgy7d_proj*.01+e3
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory = 
        e4* input$enrgy8d_proj*.01+e4
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory = 
        e5* input$enrgy1d_proj*.01+e5
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory = 
        e6* input$enrgy3d_proj*.01+e6
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory = 
        e7* input$enrgy7d_proj*.01+e7
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory = 
        e8* input$enrgy8d_proj*.01+e8
      
      ENERGY_TABLE_R = rbind(Energy1,Energy2)  
    } # Scenario  
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 4 ENERGY_TABLE_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Fuel Optimization"){
      # ENGERGY
      Energy1 = uva[uva$Category == 'On-Campus Stationary Sources',]
      Energy2 = Energy1
      
      # Add Projected category
      Energy1$Timeframe = 'Baseline'
      Energy2$Timeframe = 'Projected'
      
      sectr3 ='On-Campus Stationary Sources'
      
      e1 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory
      e2 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory
      e3 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory
      e4 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory
      e5 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory
      e6 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory
      e7 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory
      e8 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory
      
      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory = 
        e1* input$enrgy1e_proj*.01+e1
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory = 
        e2* input$enrgy3e_proj*.01+e2
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory = 
        e3* input$enrgy7e_proj*.01+e3
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory = 
        e4* input$enrgy8e_proj*.01+e4
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory = 
        e5* input$enrgy1e_proj*.01+e5
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory = 
        e6* input$enrgy3e_proj*.01+e6
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory = 
        e7* input$enrgy7e_proj*.01+e7
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory = 
        e8* input$enrgy8e_proj*.01+e8
      
      ENERGY_TABLE_R = rbind(Energy1,Energy2)  
    } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 5 ENERGY_TABLE_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Implementing All Scenarios"){
      # ENGERGY
      Energy1 = uva[uva$Category == 'On-Campus Stationary Sources',]
      Energy2 = Energy1
      
      # Add Projected category
      Energy1$Timeframe = 'Baseline'
      Energy2$Timeframe = 'Projected'
      
      sectr3 ='On-Campus Stationary Sources'
      
      e1 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory
      e2 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory
      e3 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory
      e4 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory
      e5 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory
      e6 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory
      e7 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory
      e8 = Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory
      
      # Projected changes - multiplying each Category by the SLIDER Value e.g. "sctr1_proj"
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory = 
        e1* input$enrgy1f_proj*.01+e1
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory = 
        e2* input$enrgy3f_proj*.01+e2
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory = 
        e3* input$enrgy7f_proj*.01+e3
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory = 
        e4* input$enrgy8f_proj*.01+e4
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Coal (Steam Coal)',]$inventory = 
        e5* input$enrgy1f_proj*.01+e5
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Distillate Oil (#1-4)',]$inventory = 
        e6* input$enrgy3f_proj*.01+e6
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'LPG (Propane)',]$inventory = 
        e7* input$enrgy7f_proj*.01+e7
      Energy2[Energy2$Category == sectr3 & Energy2$Sub_category == 'Non-Cogeneration' & Energy2$Source == 'Natural Gas',]$inventory = 
        e8* input$enrgy8f_proj*.01+e8
      
      ENERGY_TABLE_R = rbind(Energy1,Energy2)  
    } # Scenario
    
  }) # reactive
  
  Energy_R_ <- reactive({
    
    # # Campus Vs. Individual
    # if(input$campusVindividual == "Campus"){
    #   uva = uva_R()
    #   food = food
    # }
    # 
    # else if(input$campusVindividual == "Individual"){
    #   uva = uva_individual
    #   food = food_individual
    # }
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 0
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    if(input$scenario == "Manual Scenario"){
    ENERGY = ENERGY_TABLE_R()
    # FOOTPRINT CALCULATIONS
    #CARBON_____________________________________________________________________
    # Result units = kg CO2
    # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
    ENERGY$CO2_r = ENERGY$inventory * ENERGY$CO2.EF
    
    # Result units = kg eCO2
    # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
    ENERGY$eCO2_r = ENERGY$inventory * ENERGY$eCO2.EF
    
    # Result units = kg CH4
    # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
    ENERGY$CH4_r = ENERGY$inventory * ENERGY$CH4.EF
    
    #NITROGEN_____________________________________________________________________
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    ENERGY$N2O_r = ENERGY$inventory * ENERGY$N2O.EF
    
    # Result units = kg NOx
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    ENERGY$NOx_r = ENERGY$inventory * ENERGY$NOx.EF
    
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    ENERGY$OtherN_r = ENERGY$inventory * ENERGY$Other.N.EF
    
    #INTERMEDIATE C & N _______________________________________________________________
    
    # calculate Footprints by category (divide by 1000 to convert from kg to MT)
    # Units of GWP 
    ENERGY$CO2_MTCDE = ENERGY$CO2_r/1000  # MT CO2e
    ENERGY$eCO2_MTCDE = ENERGY$eCO2_r/1000 # MT CO2e
    ENERGY$CH4_MTCDE = ENERGY$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
    ENERGY$N2O_MTCDE = ENERGY$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
    
    # intermediate N
    ENERGY$N2O_MTN = ENERGY$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
    ENERGY$NOx_MTN = ENERGY$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
    ENERGY$OtherN_MTN = ENERGY$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
    
    #*****************************************************************************************************
    # FOOTPRINT Calculations
    #*****************************************************************************************************
    
    # CALCULATING FOOTPRINT C & N_____________________________________________________________________
    # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
    ENERGY$C_Footprint = rowSums(ENERGY[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
    ENERGY$N_Footprint = rowSums(ENERGY[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
    
    Energy_R_ = ENERGY
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 1 Energy_R_
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Business as Usual Growth to 2025"){
      ENERGY = ENERGY_TABLE_R()
    # FOOTPRINT CALCULATIONS
    #CARBON_____________________________________________________________________
    # Result units = kg CO2
    # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
    ENERGY$CO2_r = ENERGY$inventory * ENERGY$CO2.EF
    
    # Result units = kg eCO2
    # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
    ENERGY$eCO2_r = ENERGY$inventory * ENERGY$eCO2.EF
    
    # Result units = kg CH4
    # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
    ENERGY$CH4_r = ENERGY$inventory * ENERGY$CH4.EF
    
    #NITROGEN_____________________________________________________________________
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    ENERGY$N2O_r = ENERGY$inventory * ENERGY$N2O.EF
    
    # Result units = kg NOx
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    ENERGY$NOx_r = ENERGY$inventory * ENERGY$NOx.EF
    
    # Result units = kg N20
    # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
    ENERGY$OtherN_r = ENERGY$inventory * ENERGY$Other.N.EF
    
    #INTERMEDIATE C & N _______________________________________________________________
    
    # calculate Footprints by category (divide by 1000 to convert from kg to MT)
    # Units of GWP 
    ENERGY$CO2_MTCDE = ENERGY$CO2_r/1000  # MT CO2e
    ENERGY$eCO2_MTCDE = ENERGY$eCO2_r/1000 # MT CO2e
    ENERGY$CH4_MTCDE = ENERGY$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
    ENERGY$N2O_MTCDE = ENERGY$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
    
    # intermediate N
    ENERGY$N2O_MTN = ENERGY$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
    ENERGY$NOx_MTN = ENERGY$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
    ENERGY$OtherN_MTN = ENERGY$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
    
    #*****************************************************************************************************
    # FOOTPRINT Calculations
    #*****************************************************************************************************
    
    # CALCULATING FOOTPRINT C & N_____________________________________________________________________
    # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
    ENERGY$C_Footprint = rowSums(ENERGY[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
    ENERGY$N_Footprint = rowSums(ENERGY[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
    
    Energy_R_ = ENERGY  
  } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 2 Energy_R_
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "15% Vegetarian Meals"){
      ENERGY = ENERGY_TABLE_R()
      # FOOTPRINT CALCULATIONS
      #CARBON_____________________________________________________________________
      # Result units = kg CO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
      ENERGY$CO2_r = ENERGY$inventory * ENERGY$CO2.EF
      
      # Result units = kg eCO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
      ENERGY$eCO2_r = ENERGY$inventory * ENERGY$eCO2.EF
      
      # Result units = kg CH4
      # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
      ENERGY$CH4_r = ENERGY$inventory * ENERGY$CH4.EF
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      ENERGY$N2O_r = ENERGY$inventory * ENERGY$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      ENERGY$NOx_r = ENERGY$inventory * ENERGY$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      ENERGY$OtherN_r = ENERGY$inventory * ENERGY$Other.N.EF
      
      #INTERMEDIATE C & N _______________________________________________________________
      
      # calculate Footprints by category (divide by 1000 to convert from kg to MT)
      # Units of GWP 
      ENERGY$CO2_MTCDE = ENERGY$CO2_r/1000  # MT CO2e
      ENERGY$eCO2_MTCDE = ENERGY$eCO2_r/1000 # MT CO2e
      ENERGY$CH4_MTCDE = ENERGY$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
      ENERGY$N2O_MTCDE = ENERGY$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
      
      # intermediate N
      ENERGY$N2O_MTN = ENERGY$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
      ENERGY$NOx_MTN = ENERGY$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
      ENERGY$OtherN_MTN = ENERGY$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C & N_____________________________________________________________________
      # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
      ENERGY$C_Footprint = rowSums(ENERGY[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
      ENERGY$N_Footprint = rowSums(ENERGY[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
      
      Energy_R_ = ENERGY  
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 3 Energy_R_
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Replacement of 20% beef with Chicken"){
      ENERGY = ENERGY_TABLE_R()
      # FOOTPRINT CALCULATIONS
      #CARBON_____________________________________________________________________
      # Result units = kg CO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
      ENERGY$CO2_r = ENERGY$inventory * ENERGY$CO2.EF
      
      # Result units = kg eCO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
      ENERGY$eCO2_r = ENERGY$inventory * ENERGY$eCO2.EF
      
      # Result units = kg CH4
      # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
      ENERGY$CH4_r = ENERGY$inventory * ENERGY$CH4.EF
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      ENERGY$N2O_r = ENERGY$inventory * ENERGY$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      ENERGY$NOx_r = ENERGY$inventory * ENERGY$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      ENERGY$OtherN_r = ENERGY$inventory * ENERGY$Other.N.EF
      
      #INTERMEDIATE C & N _______________________________________________________________
      
      # calculate Footprints by category (divide by 1000 to convert from kg to MT)
      # Units of GWP 
      ENERGY$CO2_MTCDE = ENERGY$CO2_r/1000  # MT CO2e
      ENERGY$eCO2_MTCDE = ENERGY$eCO2_r/1000 # MT CO2e
      ENERGY$CH4_MTCDE = ENERGY$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
      ENERGY$N2O_MTCDE = ENERGY$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
      
      # intermediate N
      ENERGY$N2O_MTN = ENERGY$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
      ENERGY$NOx_MTN = ENERGY$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
      ENERGY$OtherN_MTN = ENERGY$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C & N_____________________________________________________________________
      # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
      ENERGY$C_Footprint = rowSums(ENERGY[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
      ENERGY$N_Footprint = rowSums(ENERGY[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
      
      Energy_R_ = ENERGY  
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 4 Energy_R_
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Fuel Optimization"){
      ENERGY = ENERGY_TABLE_R()
      # FOOTPRINT CALCULATIONS
      #CARBON_____________________________________________________________________
      # Result units = kg CO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
      ENERGY$CO2_r = ENERGY$inventory * ENERGY$CO2.EF
      
      # Result units = kg eCO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
      ENERGY$eCO2_r = ENERGY$inventory * ENERGY$eCO2.EF
      
      # Result units = kg CH4
      # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
      ENERGY$CH4_r = ENERGY$inventory * ENERGY$CH4.EF
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      ENERGY$N2O_r = ENERGY$inventory * ENERGY$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      ENERGY$NOx_r = ENERGY$inventory * ENERGY$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      ENERGY$OtherN_r = ENERGY$inventory * ENERGY$Other.N.EF
      
      #INTERMEDIATE C & N _______________________________________________________________
      
      # calculate Footprints by category (divide by 1000 to convert from kg to MT)
      # Units of GWP 
      ENERGY$CO2_MTCDE = ENERGY$CO2_r/1000  # MT CO2e
      ENERGY$eCO2_MTCDE = ENERGY$eCO2_r/1000 # MT CO2e
      ENERGY$CH4_MTCDE = ENERGY$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
      ENERGY$N2O_MTCDE = ENERGY$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
      
      # intermediate N
      ENERGY$N2O_MTN = ENERGY$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
      ENERGY$NOx_MTN = ENERGY$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
      ENERGY$OtherN_MTN = ENERGY$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C & N_____________________________________________________________________
      # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
      ENERGY$C_Footprint = rowSums(ENERGY[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
      ENERGY$N_Footprint = rowSums(ENERGY[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
      
      Energy_R_ = ENERGY  
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 5 Energy_R_
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Implementing All Scenarios"){
      ENERGY = ENERGY_TABLE_R()
      # FOOTPRINT CALCULATIONS
      #CARBON_____________________________________________________________________
      # Result units = kg CO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg CO2 / inventory unit
      ENERGY$CO2_r = ENERGY$inventory * ENERGY$CO2.EF
      
      # Result units = kg eCO2
      # Inventory unit (e.g. lb or gallon or kWh) * kg eCO2 / inventory unit
      ENERGY$eCO2_r = ENERGY$inventory * ENERGY$eCO2.EF
      
      # Result units = kg CH4
      # Inventory unit (e.g. lb or gallon or kWh) * kg CH4 / inventory unit
      ENERGY$CH4_r = ENERGY$inventory * ENERGY$CH4.EF
      
      #NITROGEN_____________________________________________________________________
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      ENERGY$N2O_r = ENERGY$inventory * ENERGY$N2O.EF
      
      # Result units = kg NOx
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      ENERGY$NOx_r = ENERGY$inventory * ENERGY$NOx.EF
      
      # Result units = kg N20
      # Inventory unit (e.g. lb or gallon or kWh) * kg N20 / inventory unit
      ENERGY$OtherN_r = ENERGY$inventory * ENERGY$Other.N.EF
      
      #INTERMEDIATE C & N _______________________________________________________________
      
      # calculate Footprints by category (divide by 1000 to convert from kg to MT)
      # Units of GWP 
      ENERGY$CO2_MTCDE = ENERGY$CO2_r/1000  # MT CO2e
      ENERGY$eCO2_MTCDE = ENERGY$eCO2_r/1000 # MT CO2e
      ENERGY$CH4_MTCDE = ENERGY$CH4_r * gwp[gwp$Pollutant=='CH4',]$GWP/1000 # MT CO2e
      ENERGY$N2O_MTCDE = ENERGY$N2O_r * gwp[gwp$Pollutant=='N2O',]$GWP/1000 # MT CO2e
      
      # intermediate N
      ENERGY$N2O_MTN = ENERGY$N2O_r * N_Convers[N_Convers$Pollutant=='N2O',]$Perc_N/1000 # MT N
      ENERGY$NOx_MTN = ENERGY$NOx_r * N_Convers[N_Convers$Pollutant=='NOx',]$Perc_N/1000 # MT N
      ENERGY$OtherN_MTN = ENERGY$OtherN_r * N_Convers[N_Convers$Pollutant=='Other N',]$Perc_N/1000 # MT N
      
      #*****************************************************************************************************
      # FOOTPRINT Calculations
      #*****************************************************************************************************
      
      # CALCULATING FOOTPRINT C & N_____________________________________________________________________
      # Units C_Footprint = Metric Tons, N_Footprint = Metric Tons
      ENERGY$C_Footprint = rowSums(ENERGY[,c('CO2_MTCDE','eCO2_MTCDE','CH4_MTCDE','N2O_MTCDE')],na.rm=T) 
      ENERGY$N_Footprint = rowSums(ENERGY[,c('N2O_MTN','NOx_MTN','OtherN_MTN')],na.rm=T) 
      
      Energy_R_ = ENERGY  
    } # Scenario 
    
  }) # reactive 
  
  Energy_R <- reactive({
    
    # # Campus Vs. Individual
    # if(input$campusVindividual == "Campus"){
    #   uva = uva_R()
    #   food = food
    # }
    # 
    # else if(input$campusVindividual == "Individual"){
    #   uva = uva_individual
    #   food = food_individual
    # }
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 0
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    if(input$scenario == "Manual Scenario"){
    ENERGY = Energy_R_()
    #*****************************************************************************************************
    # FOOTPRINT DATA OUTPUT
    #*****************************************************************************************************
    
    # Summarize by Category___________________________________________________________________________
    # Units are MT C, MT N, MT P, Gallons Water 
    
    ENERGY1 = ENERGY[ENERGY$Timeframe == 'Baseline',] %>% 
      group_by(Category,Sub_category,Source) %>% 
      summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                Total_N_Footprint = sum(N_Footprint,na.rm=T))
    ENERGY2 = ENERGY[ENERGY$Timeframe == 'Projected',] %>%
      group_by(Category,Sub_category,Source) %>% 
      summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
    
    ENERGY1$Timeframe = 'Baseline'
    ENERGY2$Timeframe = 'Projected'
    
    Energy_R = rbind(ENERGY1,ENERGY2)
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 1 Energy_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Business as Usual Growth to 2025"){
      ENERGY = Energy_R_()
    #*****************************************************************************************************
    # FOOTPRINT DATA OUTPUT
    #*****************************************************************************************************
    
    # Summarize by Category___________________________________________________________________________
    # Units are MT C, MT N, MT P, Gallons Water 
    
    ENERGY1 = ENERGY[ENERGY$Timeframe == 'Baseline',] %>% 
      group_by(Category,Sub_category,Source) %>% 
      summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                Total_N_Footprint = sum(N_Footprint,na.rm=T))
    ENERGY2 = ENERGY[ENERGY$Timeframe == 'Projected',] %>%
      group_by(Category,Sub_category,Source) %>% 
      summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
    
    ENERGY1$Timeframe = 'Baseline'
    ENERGY2$Timeframe = 'Projected'
    
    Energy_R = rbind(ENERGY1,ENERGY2)  
  } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 2 Energy_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "15% Vegetarian Meals"){
      ENERGY = Energy_R_()
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      ENERGY1 = ENERGY[ENERGY$Timeframe == 'Baseline',] %>% 
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T))
      ENERGY2 = ENERGY[ENERGY$Timeframe == 'Projected',] %>%
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
      
      ENERGY1$Timeframe = 'Baseline'
      ENERGY2$Timeframe = 'Projected'
      
      Energy_R = rbind(ENERGY1,ENERGY2)  
    } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 3 Energy_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Replacement of 20% beef with Chicken"){
      ENERGY = Energy_R_()
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      ENERGY1 = ENERGY[ENERGY$Timeframe == 'Baseline',] %>% 
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T))
      ENERGY2 = ENERGY[ENERGY$Timeframe == 'Projected',] %>%
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
      
      ENERGY1$Timeframe = 'Baseline'
      ENERGY2$Timeframe = 'Projected'
      
      Energy_R = rbind(ENERGY1,ENERGY2)  
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 4 Energy_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Fuel Optimization"){
      ENERGY = Energy_R_()
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      ENERGY1 = ENERGY[ENERGY$Timeframe == 'Baseline',] %>% 
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T))
      ENERGY2 = ENERGY[ENERGY$Timeframe == 'Projected',] %>%
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
      
      ENERGY1$Timeframe = 'Baseline'
      ENERGY2$Timeframe = 'Projected'
      
      Energy_R = rbind(ENERGY1,ENERGY2)  
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 5 Energy_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Implementing All Scenarios"){
      ENERGY = Energy_R_()
      #*****************************************************************************************************
      # FOOTPRINT DATA OUTPUT
      #*****************************************************************************************************
      
      # Summarize by Category___________________________________________________________________________
      # Units are MT C, MT N, MT P, Gallons Water 
      
      ENERGY1 = ENERGY[ENERGY$Timeframe == 'Baseline',] %>% 
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T))
      ENERGY2 = ENERGY[ENERGY$Timeframe == 'Projected',] %>%
        group_by(Category,Sub_category,Source) %>% 
        summarize(Total_C_Footprint = sum(C_Footprint,na.rm=T),
                  Total_N_Footprint = sum(N_Footprint,na.rm=T)) 
      
      ENERGY1$Timeframe = 'Baseline'
      ENERGY2$Timeframe = 'Projected'
      
      Energy_R = rbind(ENERGY1,ENERGY2)  
    } # Scenario 
    
  }) # reactive
  
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  # STEP_17 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  # COST REACTIVE
  COST_R <- reactive({
    
    # # Campus Vs. Individual
    # if(input$campusVindividual == "Campus"){
    #   uva = uva_R()
    #   food = food
    # }
    # 
    # else if(input$campusVindividual == "Individual"){
    #   uva = uva_individual
    #   food = food_individual
    # }
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 0
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    if(input$scenario == "Manual Scenario"){
    # COST = COMBO_R_
    # COMMUT = rbind(Commut_Fac_R_,Commut_Staff_R_,Commut_Stud_R_)
    # ENERGY = Energy_R_
    
    COST = COMBO_R_()
    COMMUT = rbind(Commut_Fac_R_(),Commut_Staff_R_(),Commut_Stud_R_())
    ENERGY = Energy_R_()
    
    # Remove the COMMUTING and ENERGY from main dataframe
    COST = COST[COST$Category != 'Commuting',]
    COST = COST[COST$Category != 'On-Campus Stationary Sources',]
    
    
    # Get the dataframes to have same fields
    COST = COST[,c('Scope','Category','Sub_category','Source','Units',
                   'inventory','NOx_MTN','N2O_MTN','OtherN_MTN',
                   'C_Footprint','N_Footprint','Timeframe')]
    COMMUT = COMMUT[,c('Scope','Category','Sub_category','Source','Units',
                       'inventory','NOx_MTN','N2O_MTN','OtherN_MTN',
                       'C_Footprint','N_Footprint','Timeframe')]
    ENERGY = ENERGY[,c('Scope','Category','Sub_category','Source','Units',
                       'inventory','NOx_MTN','N2O_MTN','OtherN_MTN',
                       'C_Footprint','N_Footprint','Timeframe')]
    
    
    #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    # CARBON COSTS ********************************************************************
    # Jana Compton: For Carbon costs, we recommend using $2-$50 per ton of CO2 equivalent 
    # That covers the range we are using in our paper.  
    # Units of C_Footprint are MT for COST and kg for food data
    COST$C_Cost_min = 2*COST$C_Footprint # Initial Units are MT
    COST$C_Cost_max = 50*COST$C_Footprint # Initial Units are MT
    COST$C_Cost_mid = 30*COST$C_Footprint # Initial Units are MT
    
    COMMUT$C_Cost_min = 2*COMMUT$C_Footprint # Initial Units are MT
    COMMUT$C_Cost_max = 50*COMMUT$C_Footprint # Initial Units are MT
    COMMUT$C_Cost_mid = 30*COMMUT$C_Footprint # Initial Units are MT
    
    ENERGY$C_Cost_min = 2*ENERGY$C_Footprint # Initial Units are MT
    ENERGY$C_Cost_max = 50*ENERGY$C_Footprint # Initial Units are MT
    ENERGY$C_Cost_mid = 30*ENERGY$C_Footprint # Initial Units are MT
    
    # NITROGEN COSTS ******************************************************************
    # Other N  contributs to fertilizer and wastewater inventories, 
    # The fertilizer component can be split into NOx, N2O, NH3, and N to Water 
    # Using the following percentages 20%, 3%, 13%, 21%, respectively
    # Wastewater component contributes to the N to water
    
    # Baseline
    N_Fert_c = 1000*COST[COST$Sub_category == 'Fertilizer' & COST$Timeframe == 'Baseline',]$OtherN_MTN 
    N_Fert_NOx_c = N_Fert_c * 0.2
    N_Fert_N2O_c = N_Fert_c * 0.03
    N_Fert_NH3_c = N_Fert_c * 0.13
    N_Fert_SW_c = N_Fert_c * 0.21 # proportion that goes to SW (Houlton et al. 2013)
    N_Fert_GW_c = N_Fert_c * .79 * .33 # proportion that goes to GW (Sabota et al. 2015)
    N_Fert_coast_c = N_Fert_SW_c * .40 # proportion of SW that goes to coast (Sabota et al. 2015)
    
    # Projected
    N_Fert_p = 1000*COST[COST$Sub_category == 'Fertilizer' & COST$Timeframe == 'Projected',]$OtherN_MTN 
    N_Fert_NOx_p = N_Fert_p * 0.2
    N_Fert_N2O_p = N_Fert_p * 0.03
    N_Fert_NH3_p = N_Fert_p * 0.13
    N_Fert_SW_p = N_Fert_p * 0.21 # proportion that goes to SW (Houlton et al. 2013)
    N_Fert_GW_p = N_Fert_p * .79 * .33 # proportion that goes to GW (Sabota et al. 2015)
    N_Fert_coast_p = N_Fert_SW_p * .40 # proportion of SW that goes to coast (Sabota et al. 2015)
    
    #********************************************************************************
    
    COST1 = COST[COST$Timeframe == 'Baseline',]
    COST2 = COST[COST$Timeframe == 'Projected',]
    
    # Units are MT N2O or NOx - so multiplying by 1000 to convert to kg
    # h = health/social; a = agriculure; e = Ecosystems; c = climate
    COST1$N_Cost_NOx_atm_h = 1000*COST1$NOx_MTN * 32.20 # $/kgN Human respiratory health 
    COST1$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health (zero unless fertilzer - see below)
    COST1$N_Cost_NOx_atm_e = 1000*COST1$NOx_MTN * 0.43 # $/kgN visibility damages 
    COST1$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages (zero unless fertilzer - see below)
    COST1$N_Cost_N2O_atm_c = 1000*COST1$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
    COST1$N_Cost_NOx_atm_c = 1000*COST1$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
    COST1$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits (zero unless fertilzer - see below)
    COST1$N_Cost_NOx_ter_h = 1000*COST1$NOx_MTN * 0.12 # $/kgN Damages to structures  
    COST1$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures (zero unless fertilzer - see below)
    COST1$N_Cost_NOx_ter_a = 1000*COST1$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
    COST1$N_Cost_N2O_ter_a = 1000*COST1$N2O_MTN * 1.48 # $/kgN UV damages to crops 
    COST1$N_Cost_NOx_ter_e = 1000*COST1$NOx_MTN * 1.24 # $/kgN Ozone damages to forests  
    
    COST1$N_Cost_NOx_atm_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 32.20 # $/kgN Human respiratory health
    COST1$N_Cost_NH3_atm_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * 6.87 # $/kgN Human respiratory health 
    COST1$N_Cost_NOx_atm_e[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 0.43 # $/kgN visibility damages 
    COST1$N_Cost_NH3_atm_e[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * 0.43 # $/kgN visibility damages 
    COST1$N_Cost_N2O_atm_c[COST1$Sub_category == 'Fertilizer' ] = N_Fert_N2O_c * 15.07 # $/kgN Greenhouse damages 
    COST1$N_Cost_NOx_atm_c[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * (-5.02) # $/kgN Climate Cooling Benefits
    COST1$N_Cost_NH3_atm_c[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * (-5.02) # $/kgN Climate Cooling Benefits 
    COST1$N_Cost_NOx_ter_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 0.12 # $/kgN Damages to structures
    COST1$N_Cost_NH3_ter_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * 0.12 # $/kgN Damages to structures
    COST1$N_Cost_NOx_ter_a[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 2.11 # $/kgN Ozone damages to crops  
    COST1$N_Cost_N2O_ter_a[COST1$Sub_category == 'Fertilizer' ] = N_Fert_N2O_c * 1.48 # $/kgN UV damages to crops 
    COST1$N_Cost_NOx_ter_e[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 1.24 # $/kgN Ozone damages to forests  
    
    COST2$N_Cost_NOx_atm_h = 1000*COST2$NOx_MTN * 32.20 # $/kgN Human respiratory health 
    COST2$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health (zero unless fertilzer - see below)
    COST2$N_Cost_NOx_atm_e = 1000*COST2$NOx_MTN * 0.43 # $/kgN visibility damages 
    COST2$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages (zero unless fertilzer - see below)
    COST2$N_Cost_N2O_atm_c = 1000*COST2$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
    COST2$N_Cost_NOx_atm_c = 1000*COST2$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
    COST2$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits (zero unless fertilzer - see below)
    COST2$N_Cost_NOx_ter_h = 1000*COST2$NOx_MTN * 0.12 # $/kgN Damages to structures  
    COST2$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures (zero unless fertilzer - see below)
    COST2$N_Cost_NOx_ter_a = 1000*COST2$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
    COST2$N_Cost_N2O_ter_a = 1000*COST2$N2O_MTN * 1.48 # $/kgN UV damages to crops 
    COST2$N_Cost_NOx_ter_e = 1000*COST2$NOx_MTN * 1.24 # $/kgN Ozone damages to forests  
    
    COST2$N_Cost_NOx_atm_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 32.20 # $/kgN Human respiratory health
    COST2$N_Cost_NH3_atm_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * 6.87 # $/kgN Human respiratory health 
    COST2$N_Cost_NOx_atm_e[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 0.43 # $/kgN visibility damages 
    COST2$N_Cost_NH3_atm_e[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * 0.43 # $/kgN visibility damages 
    COST2$N_Cost_N2O_atm_c[COST2$Sub_category == 'Fertilizer' ] = N_Fert_N2O_p * 15.07 # $/kgN Greenhouse damages 
    COST2$N_Cost_NOx_atm_c[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * (-5.02) # $/kgN Climate Cooling Benefits
    COST2$N_Cost_NH3_atm_c[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * (-5.02) # $/kgN Climate Cooling Benefits 
    COST2$N_Cost_NOx_ter_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 0.12 # $/kgN Damages to structures
    COST2$N_Cost_NH3_ter_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * 0.12 # $/kgN Damages to structures
    COST2$N_Cost_NOx_ter_a[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 2.11 # $/kgN Ozone damages to crops  
    COST2$N_Cost_N2O_ter_a[COST2$Sub_category == 'Fertilizer' ] = N_Fert_N2O_p * 1.48 # $/kgN UV damages to crops 
    COST2$N_Cost_NOx_ter_e[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 1.24 # $/kgN Ozone damages to forests  
    
    COST = rbind(COST1,COST2)
    
    COST$N_SW_kg = 0.21 * 1000*(rowSums(COST[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # all N sources (not N2O), # proportion that goes to SW (Houlton et al. 2013)
    COST$N_GW_kg = 0.79 * .33 * 1000*(rowSums(COST[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # proportion that goes to GW (Sabota et al. 2015) 
    COST$N_coast_kg = .40 * COST$N_SW_kg # proportion of SW that goes to coast (Sabota et al. 2015)
    
    COST1 = COST[COST$Timeframe == 'Baseline',]
    COST2 = COST[COST$Timeframe == 'Projected',]
    
    COST1$N_SW_kg[COST1$Sub_category == 'Fertilizer' ] = N_Fert_SW_c
    COST1$N_GW_kg[COST1$Sub_category == 'Fertilizer' ] = N_Fert_GW_c 
    COST1$N_coast_kg[COST1$Sub_category == 'Fertilizer' ] = N_Fert_coast_c 
    COST2$N_SW_kg[COST2$Sub_category == 'Fertilizer' ] = N_Fert_SW_p
    COST2$N_GW_kg[COST2$Sub_category == 'Fertilizer' ] = N_Fert_GW_p 
    COST2$N_coast_kg[COST2$Sub_category == 'Fertilizer' ] = N_Fert_coast_p 
    
    COST = rbind(COST1,COST2)
    
    # Update below 
    COST$N_Cost_aquaFresh_e = 
      COST$N_SW_kg * 0.23 + # $/kgN Lake waterfront property values
      COST$N_SW_kg * 0.19 + # $/kgN Recreational Freshwater use
      COST$N_SW_kg * 0.01 # $/kgN Endangered species protection
    COST$N_Cost_aquaGround_h = 
      COST$N_GW_kg * 0.15 + # $/kgN Replacement with bottled water
      COST$N_GW_kg * 0.60 # $/kgN Treatment of private well water 
    COST$N_Cost_aquaCoast_e = 
      COST$N_coast_kg * 7.11 # $/kgN Recreational use of estuary
    
    
    # No NH3 emissions factor data for Commuting
    COMMUT$N_Cost_NOx_atm_h = 1000*COMMUT$NOx_MTN * 32.20 # $/kgN Human respiratory health 
    COMMUT$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health 
    COMMUT$N_Cost_NOx_atm_e = 1000*COMMUT$NOx_MTN * 0.43 # $/kgN visibility damages 
    COMMUT$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages 
    COMMUT$N_Cost_N2O_atm_c = 1000*COMMUT$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
    COMMUT$N_Cost_NOx_atm_c = 1000*COMMUT$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
    COMMUT$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits 
    COMMUT$N_Cost_NOx_ter_h = 1000*COMMUT$NOx_MTN * 0.12 # $/kgN Damages to structures  
    COMMUT$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures  
    COMMUT$N_Cost_NOx_ter_a = 1000*COMMUT$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
    COMMUT$N_Cost_N2O_ter_a = 1000*COMMUT$N2O_MTN * 1.48 # $/kgN UV damages to crops 
    COMMUT$N_Cost_NOx_ter_e = 1000*COMMUT$NOx_MTN * 1.24 # $/kgN Ozone damages to forests
    
    # No NH3 emissions factor data for Energy sources
    ENERGY$N_Cost_NOx_atm_h = 1000*ENERGY$NOx_MTN * 32.20 # $/kgN Human respiratory health 
    ENERGY$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health 
    ENERGY$N_Cost_NOx_atm_e = 1000*ENERGY$NOx_MTN * 0.43 # $/kgN visibility damages 
    ENERGY$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages 
    ENERGY$N_Cost_N2O_atm_c = 1000*ENERGY$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
    ENERGY$N_Cost_NOx_atm_c = 1000*ENERGY$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
    ENERGY$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits 
    ENERGY$N_Cost_NOx_ter_h = 1000*ENERGY$NOx_MTN * 0.12 # $/kgN Damages to structures  
    ENERGY$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures  
    ENERGY$N_Cost_NOx_ter_a = 1000*ENERGY$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
    ENERGY$N_Cost_N2O_ter_a = 1000*ENERGY$N2O_MTN * 1.48 # $/kgN UV damages to crops 
    ENERGY$N_Cost_NOx_ter_e = 1000*ENERGY$NOx_MTN * 1.24 # $/kgN Ozone damages to forests
    
    COMMUT$N_SW_kg = 0.21 * 1000*(rowSums(COMMUT[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # all N sources (not N2O), # proportion that goes to SW (Houlton et al. 2013)
    COMMUT$N_GW_kg = 0.79 * .33 *  1000*(rowSums(COMMUT[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # proportion that goes to GW (Sabota et al. 2015) 
    COMMUT$N_coast_kg = 0.40 * COMMUT$N_SW_kg # proportion of SW that goes to coast (Sabota et al. 2015)
    
    ENERGY$N_SW_kg = 0.21 * 1000*(rowSums(ENERGY[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # all N sources (not N2O),  # proportion that goes to SW (Houlton et al. 2013)
    ENERGY$N_GW_kg = 0.79 * .33 *  1000*(rowSums(ENERGY[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # proportion that goes to GW (Sabota et al. 2015) 
    ENERGY$N_coast_kg = 0.40 * ENERGY$N_SW_kg # proportion of SW that goes to coast (Sabota et al. 2015)
    
    COMMUT$N_Cost_aquaFresh_e = 
      COMMUT$N_SW_kg * 0.23 + # $/kgN Lake waterfront property values
      COMMUT$N_SW_kg * 0.19 + # $/kgN Recreational Freshwater use
      COMMUT$N_SW_kg * 0.01 # $/kgN Endangered species protection
    COMMUT$N_Cost_aquaGround_h = 
      COMMUT$N_GW_kg * 0.15 + # $/kgN Replacement with bottled water
      COMMUT$N_GW_kg * 0.60 # $/kgN Treatment of private well water 
    COMMUT$N_Cost_aquaCoast_e = 
      COMMUT$N_coast_kg * 7.11 # $/kgN Recreational use of estuary
    
    ENERGY$N_Cost_aquaFresh_e = 
      ENERGY$N_SW_kg * 0.23 + # $/kgN Lake waterfront property values
      ENERGY$N_SW_kg * 0.19 + # $/kgN Recreational Freshwater use
      ENERGY$N_SW_kg * 0.01 # $/kgN Endangered species protection
    ENERGY$N_Cost_aquaGround_h = 
      ENERGY$N_GW_kg * 0.15 + # $/kgN Replacement with bottled water
      ENERGY$N_GW_kg * 0.60 # $/kgN Treatment of private well water 
    ENERGY$N_Cost_aquaCoast_e = 
      ENERGY$N_coast_kg * 7.11 # $/kgN Recreational use of estuary
    
    COST$N_Cost_Total = 
      rowSums(COST[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                      'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                      'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                      'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                      'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                      'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                      'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                      'N_Cost_aquaCoast_e')], na.rm=T)
    
    COMMUT$N_Cost_Total = 
      rowSums(COMMUT[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                        'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                        'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                        'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                        'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                        'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                        'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                        'N_Cost_aquaCoast_e')], na.rm=T)
    
    ENERGY$N_Cost_Total = 
      rowSums(ENERGY[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                        'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                        'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                        'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                        'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                        'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                        'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                        'N_Cost_aquaCoast_e')], na.rm=T)
    
    # Add back on COMMUTING AND ENERGY
    COST = rbind(COST,COMMUT,ENERGY)
    
    COST_R = COST
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 1 COST_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Business as Usual Growth to 2025"){
      # COST = COMBO_R_
      # COMMUT = rbind(Commut_Fac_R_,Commut_Staff_R_,Commut_Stud_R_)
      # ENERGY = Energy_R_
      
      COST = COMBO_R_()
      COMMUT = rbind(Commut_Fac_R_(),Commut_Staff_R_(),Commut_Stud_R_())
      ENERGY = Energy_R_()
      
      # Remove the COMMUTING and ENERGY from main dataframe
      COST = COST[COST$Category != 'Commuting',]
      COST = COST[COST$Category != 'On-Campus Stationary Sources',]
      
      
      # Get the dataframes to have same fields
      COST = COST[,c('Scope','Category','Sub_category','Source','Units',
                     'inventory','NOx_MTN','N2O_MTN','OtherN_MTN',
                     'C_Footprint','N_Footprint','Timeframe')]
      COMMUT = COMMUT[,c('Scope','Category','Sub_category','Source','Units',
                         'inventory','NOx_MTN','N2O_MTN','OtherN_MTN',
                         'C_Footprint','N_Footprint','Timeframe')]
      ENERGY = ENERGY[,c('Scope','Category','Sub_category','Source','Units',
                         'inventory','NOx_MTN','N2O_MTN','OtherN_MTN',
                         'C_Footprint','N_Footprint','Timeframe')]
      
      
      #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
      # CARBON COSTS ********************************************************************
      # Jana Compton: For Carbon costs, we recommend using $2-$50 per ton of CO2 equivalent 
      # That covers the range we are using in our paper.  
      # Units of C_Footprint are MT for COST and kg for food data
      COST$C_Cost_min = 2*COST$C_Footprint # Initial Units are MT
      COST$C_Cost_max = 50*COST$C_Footprint # Initial Units are MT
      COST$C_Cost_mid = 30*COST$C_Footprint # Initial Units are MT
      
      COMMUT$C_Cost_min = 2*COMMUT$C_Footprint # Initial Units are MT
      COMMUT$C_Cost_max = 50*COMMUT$C_Footprint # Initial Units are MT
      COMMUT$C_Cost_mid = 30*COMMUT$C_Footprint # Initial Units are MT
      
      ENERGY$C_Cost_min = 2*ENERGY$C_Footprint # Initial Units are MT
      ENERGY$C_Cost_max = 50*ENERGY$C_Footprint # Initial Units are MT
      ENERGY$C_Cost_mid = 30*ENERGY$C_Footprint # Initial Units are MT
      
      # NITROGEN COSTS ******************************************************************
      # Other N  contributs to fertilizer and wastewater inventories, 
      # The fertilizer component can be split into NOx, N2O, NH3, and N to Water 
      # Using the following percentages 20%, 3%, 13%, 21%, respectively
      # Wastewater component contributes to the N to water
      
      # Baseline
      N_Fert_c = 1000*COST[COST$Sub_category == 'Fertilizer' & COST$Timeframe == 'Baseline',]$OtherN_MTN 
      N_Fert_NOx_c = N_Fert_c * 0.2
      N_Fert_N2O_c = N_Fert_c * 0.03
      N_Fert_NH3_c = N_Fert_c * 0.13
      N_Fert_SW_c = N_Fert_c * 0.21 # proportion that goes to SW (Houlton et al. 2013)
      N_Fert_GW_c = N_Fert_c * .79 * .33 # proportion that goes to GW (Sabota et al. 2015)
      N_Fert_coast_c = N_Fert_SW_c * .40 # proportion of SW that goes to coast (Sabota et al. 2015)
      
      # Projected
      N_Fert_p = 1000*COST[COST$Sub_category == 'Fertilizer' & COST$Timeframe == 'Projected',]$OtherN_MTN 
      N_Fert_NOx_p = N_Fert_p * 0.2
      N_Fert_N2O_p = N_Fert_p * 0.03
      N_Fert_NH3_p = N_Fert_p * 0.13
      N_Fert_SW_p = N_Fert_p * 0.21 # proportion that goes to SW (Houlton et al. 2013)
      N_Fert_GW_p = N_Fert_p * .79 * .33 # proportion that goes to GW (Sabota et al. 2015)
      N_Fert_coast_p = N_Fert_SW_p * .40 # proportion of SW that goes to coast (Sabota et al. 2015)
      
      #********************************************************************************
      
      COST1 = COST[COST$Timeframe == 'Baseline',]
      COST2 = COST[COST$Timeframe == 'Projected',]
      
      # Units are MT N2O or NOx - so multiplying by 1000 to convert to kg
      # h = health/social; a = agriculure; e = Ecosystems; c = climate
      COST1$N_Cost_NOx_atm_h = 1000*COST1$NOx_MTN * 32.20 # $/kgN Human respiratory health 
      COST1$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health (zero unless fertilzer - see below)
      COST1$N_Cost_NOx_atm_e = 1000*COST1$NOx_MTN * 0.43 # $/kgN visibility damages 
      COST1$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages (zero unless fertilzer - see below)
      COST1$N_Cost_N2O_atm_c = 1000*COST1$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
      COST1$N_Cost_NOx_atm_c = 1000*COST1$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
      COST1$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits (zero unless fertilzer - see below)
      COST1$N_Cost_NOx_ter_h = 1000*COST1$NOx_MTN * 0.12 # $/kgN Damages to structures  
      COST1$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures (zero unless fertilzer - see below)
      COST1$N_Cost_NOx_ter_a = 1000*COST1$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
      COST1$N_Cost_N2O_ter_a = 1000*COST1$N2O_MTN * 1.48 # $/kgN UV damages to crops 
      COST1$N_Cost_NOx_ter_e = 1000*COST1$NOx_MTN * 1.24 # $/kgN Ozone damages to forests  
      
      COST1$N_Cost_NOx_atm_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 32.20 # $/kgN Human respiratory health
      COST1$N_Cost_NH3_atm_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * 6.87 # $/kgN Human respiratory health 
      COST1$N_Cost_NOx_atm_e[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 0.43 # $/kgN visibility damages 
      COST1$N_Cost_NH3_atm_e[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * 0.43 # $/kgN visibility damages 
      COST1$N_Cost_N2O_atm_c[COST1$Sub_category == 'Fertilizer' ] = N_Fert_N2O_c * 15.07 # $/kgN Greenhouse damages 
      COST1$N_Cost_NOx_atm_c[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * (-5.02) # $/kgN Climate Cooling Benefits
      COST1$N_Cost_NH3_atm_c[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * (-5.02) # $/kgN Climate Cooling Benefits 
      COST1$N_Cost_NOx_ter_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 0.12 # $/kgN Damages to structures
      COST1$N_Cost_NH3_ter_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * 0.12 # $/kgN Damages to structures
      COST1$N_Cost_NOx_ter_a[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 2.11 # $/kgN Ozone damages to crops  
      COST1$N_Cost_N2O_ter_a[COST1$Sub_category == 'Fertilizer' ] = N_Fert_N2O_c * 1.48 # $/kgN UV damages to crops 
      COST1$N_Cost_NOx_ter_e[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 1.24 # $/kgN Ozone damages to forests  
      
      COST2$N_Cost_NOx_atm_h = 1000*COST2$NOx_MTN * 32.20 # $/kgN Human respiratory health 
      COST2$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health (zero unless fertilzer - see below)
      COST2$N_Cost_NOx_atm_e = 1000*COST2$NOx_MTN * 0.43 # $/kgN visibility damages 
      COST2$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages (zero unless fertilzer - see below)
      COST2$N_Cost_N2O_atm_c = 1000*COST2$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
      COST2$N_Cost_NOx_atm_c = 1000*COST2$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
      COST2$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits (zero unless fertilzer - see below)
      COST2$N_Cost_NOx_ter_h = 1000*COST2$NOx_MTN * 0.12 # $/kgN Damages to structures  
      COST2$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures (zero unless fertilzer - see below)
      COST2$N_Cost_NOx_ter_a = 1000*COST2$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
      COST2$N_Cost_N2O_ter_a = 1000*COST2$N2O_MTN * 1.48 # $/kgN UV damages to crops 
      COST2$N_Cost_NOx_ter_e = 1000*COST2$NOx_MTN * 1.24 # $/kgN Ozone damages to forests  
      
      COST2$N_Cost_NOx_atm_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 32.20 # $/kgN Human respiratory health
      COST2$N_Cost_NH3_atm_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * 6.87 # $/kgN Human respiratory health 
      COST2$N_Cost_NOx_atm_e[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 0.43 # $/kgN visibility damages 
      COST2$N_Cost_NH3_atm_e[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * 0.43 # $/kgN visibility damages 
      COST2$N_Cost_N2O_atm_c[COST2$Sub_category == 'Fertilizer' ] = N_Fert_N2O_p * 15.07 # $/kgN Greenhouse damages 
      COST2$N_Cost_NOx_atm_c[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * (-5.02) # $/kgN Climate Cooling Benefits
      COST2$N_Cost_NH3_atm_c[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * (-5.02) # $/kgN Climate Cooling Benefits 
      COST2$N_Cost_NOx_ter_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 0.12 # $/kgN Damages to structures
      COST2$N_Cost_NH3_ter_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * 0.12 # $/kgN Damages to structures
      COST2$N_Cost_NOx_ter_a[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 2.11 # $/kgN Ozone damages to crops  
      COST2$N_Cost_N2O_ter_a[COST2$Sub_category == 'Fertilizer' ] = N_Fert_N2O_p * 1.48 # $/kgN UV damages to crops 
      COST2$N_Cost_NOx_ter_e[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 1.24 # $/kgN Ozone damages to forests  
      
      COST = rbind(COST1,COST2)
      
      COST$N_SW_kg = 0.21 * 1000*(rowSums(COST[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # all N sources (not N2O), # proportion that goes to SW (Houlton et al. 2013)
      COST$N_GW_kg = 0.79 * .33 * 1000*(rowSums(COST[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # proportion that goes to GW (Sabota et al. 2015) 
      COST$N_coast_kg = .40 * COST$N_SW_kg # proportion of SW that goes to coast (Sabota et al. 2015)
      
      COST1 = COST[COST$Timeframe == 'Baseline',]
      COST2 = COST[COST$Timeframe == 'Projected',]
      
      COST1$N_SW_kg[COST1$Sub_category == 'Fertilizer' ] = N_Fert_SW_c
      COST1$N_GW_kg[COST1$Sub_category == 'Fertilizer' ] = N_Fert_GW_c 
      COST1$N_coast_kg[COST1$Sub_category == 'Fertilizer' ] = N_Fert_coast_c 
      COST2$N_SW_kg[COST2$Sub_category == 'Fertilizer' ] = N_Fert_SW_p
      COST2$N_GW_kg[COST2$Sub_category == 'Fertilizer' ] = N_Fert_GW_p 
      COST2$N_coast_kg[COST2$Sub_category == 'Fertilizer' ] = N_Fert_coast_p 
      
      COST = rbind(COST1,COST2)
      
      # Update below 
      COST$N_Cost_aquaFresh_e = 
        COST$N_SW_kg * 0.23 + # $/kgN Lake waterfront property values
        COST$N_SW_kg * 0.19 + # $/kgN Recreational Freshwater use
        COST$N_SW_kg * 0.01 # $/kgN Endangered species protection
      COST$N_Cost_aquaGround_h = 
        COST$N_GW_kg * 0.15 + # $/kgN Replacement with bottled water
        COST$N_GW_kg * 0.60 # $/kgN Treatment of private well water 
      COST$N_Cost_aquaCoast_e = 
        COST$N_coast_kg * 7.11 # $/kgN Recreational use of estuary
      
      
      # No NH3 emissions factor data for Commuting
      COMMUT$N_Cost_NOx_atm_h = 1000*COMMUT$NOx_MTN * 32.20 # $/kgN Human respiratory health 
      COMMUT$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health 
      COMMUT$N_Cost_NOx_atm_e = 1000*COMMUT$NOx_MTN * 0.43 # $/kgN visibility damages 
      COMMUT$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages 
      COMMUT$N_Cost_N2O_atm_c = 1000*COMMUT$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
      COMMUT$N_Cost_NOx_atm_c = 1000*COMMUT$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
      COMMUT$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits 
      COMMUT$N_Cost_NOx_ter_h = 1000*COMMUT$NOx_MTN * 0.12 # $/kgN Damages to structures  
      COMMUT$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures  
      COMMUT$N_Cost_NOx_ter_a = 1000*COMMUT$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
      COMMUT$N_Cost_N2O_ter_a = 1000*COMMUT$N2O_MTN * 1.48 # $/kgN UV damages to crops 
      COMMUT$N_Cost_NOx_ter_e = 1000*COMMUT$NOx_MTN * 1.24 # $/kgN Ozone damages to forests
      
      # No NH3 emissions factor data for Energy sources
      ENERGY$N_Cost_NOx_atm_h = 1000*ENERGY$NOx_MTN * 32.20 # $/kgN Human respiratory health 
      ENERGY$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health 
      ENERGY$N_Cost_NOx_atm_e = 1000*ENERGY$NOx_MTN * 0.43 # $/kgN visibility damages 
      ENERGY$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages 
      ENERGY$N_Cost_N2O_atm_c = 1000*ENERGY$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
      ENERGY$N_Cost_NOx_atm_c = 1000*ENERGY$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
      ENERGY$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits 
      ENERGY$N_Cost_NOx_ter_h = 1000*ENERGY$NOx_MTN * 0.12 # $/kgN Damages to structures  
      ENERGY$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures  
      ENERGY$N_Cost_NOx_ter_a = 1000*ENERGY$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
      ENERGY$N_Cost_N2O_ter_a = 1000*ENERGY$N2O_MTN * 1.48 # $/kgN UV damages to crops 
      ENERGY$N_Cost_NOx_ter_e = 1000*ENERGY$NOx_MTN * 1.24 # $/kgN Ozone damages to forests
      
      COMMUT$N_SW_kg = 0.21 * 1000*(rowSums(COMMUT[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # all N sources (not N2O), # proportion that goes to SW (Houlton et al. 2013)
      COMMUT$N_GW_kg = 0.79 * .33 *  1000*(rowSums(COMMUT[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # proportion that goes to GW (Sabota et al. 2015) 
      COMMUT$N_coast_kg = 0.40 * COMMUT$N_SW_kg # proportion of SW that goes to coast (Sabota et al. 2015)
      
      ENERGY$N_SW_kg = 0.21 * 1000*(rowSums(ENERGY[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # all N sources (not N2O),  # proportion that goes to SW (Houlton et al. 2013)
      ENERGY$N_GW_kg = 0.79 * .33 *  1000*(rowSums(ENERGY[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # proportion that goes to GW (Sabota et al. 2015) 
      ENERGY$N_coast_kg = 0.40 * ENERGY$N_SW_kg # proportion of SW that goes to coast (Sabota et al. 2015)
      
      COMMUT$N_Cost_aquaFresh_e = 
        COMMUT$N_SW_kg * 0.23 + # $/kgN Lake waterfront property values
        COMMUT$N_SW_kg * 0.19 + # $/kgN Recreational Freshwater use
        COMMUT$N_SW_kg * 0.01 # $/kgN Endangered species protection
      COMMUT$N_Cost_aquaGround_h = 
        COMMUT$N_GW_kg * 0.15 + # $/kgN Replacement with bottled water
        COMMUT$N_GW_kg * 0.60 # $/kgN Treatment of private well water 
      COMMUT$N_Cost_aquaCoast_e = 
        COMMUT$N_coast_kg * 7.11 # $/kgN Recreational use of estuary
      
      ENERGY$N_Cost_aquaFresh_e = 
        ENERGY$N_SW_kg * 0.23 + # $/kgN Lake waterfront property values
        ENERGY$N_SW_kg * 0.19 + # $/kgN Recreational Freshwater use
        ENERGY$N_SW_kg * 0.01 # $/kgN Endangered species protection
      ENERGY$N_Cost_aquaGround_h = 
        ENERGY$N_GW_kg * 0.15 + # $/kgN Replacement with bottled water
        ENERGY$N_GW_kg * 0.60 # $/kgN Treatment of private well water 
      ENERGY$N_Cost_aquaCoast_e = 
        ENERGY$N_coast_kg * 7.11 # $/kgN Recreational use of estuary
      
      COST$N_Cost_Total = 
        rowSums(COST[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                        'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                        'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                        'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                        'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                        'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                        'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                        'N_Cost_aquaCoast_e')], na.rm=T)
      
      COMMUT$N_Cost_Total = 
        rowSums(COMMUT[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                          'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                          'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                          'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                          'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                          'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                          'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                          'N_Cost_aquaCoast_e')], na.rm=T)
      
      ENERGY$N_Cost_Total = 
        rowSums(ENERGY[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                          'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                          'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                          'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                          'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                          'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                          'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                          'N_Cost_aquaCoast_e')], na.rm=T)
      
      # Add back on COMMUTING AND ENERGY
      COST = rbind(COST,COMMUT,ENERGY)
      
      COST_R = COST  
    } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 2 COST_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "15% Vegetarian Meals"){
      # COST = COMBO_R_
      # COMMUT = rbind(Commut_Fac_R_,Commut_Staff_R_,Commut_Stud_R_)
      # ENERGY = Energy_R_
      
      COST = COMBO_R_()
      COMMUT = rbind(Commut_Fac_R_(),Commut_Staff_R_(),Commut_Stud_R_())
      ENERGY = Energy_R_()
      
      # Remove the COMMUTING and ENERGY from main dataframe
      COST = COST[COST$Category != 'Commuting',]
      COST = COST[COST$Category != 'On-Campus Stationary Sources',]
      
      
      # Get the dataframes to have same fields
      COST = COST[,c('Scope','Category','Sub_category','Source','Units',
                     'inventory','NOx_MTN','N2O_MTN','OtherN_MTN',
                     'C_Footprint','N_Footprint','Timeframe')]
      COMMUT = COMMUT[,c('Scope','Category','Sub_category','Source','Units',
                         'inventory','NOx_MTN','N2O_MTN','OtherN_MTN',
                         'C_Footprint','N_Footprint','Timeframe')]
      ENERGY = ENERGY[,c('Scope','Category','Sub_category','Source','Units',
                         'inventory','NOx_MTN','N2O_MTN','OtherN_MTN',
                         'C_Footprint','N_Footprint','Timeframe')]
      
      
      #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
      # CARBON COSTS ********************************************************************
      # Jana Compton: For Carbon costs, we recommend using $2-$50 per ton of CO2 equivalent 
      # That covers the range we are using in our paper.  
      # Units of C_Footprint are MT for COST and kg for food data
      COST$C_Cost_min = 2*COST$C_Footprint # Initial Units are MT
      COST$C_Cost_max = 50*COST$C_Footprint # Initial Units are MT
      COST$C_Cost_mid = 30*COST$C_Footprint # Initial Units are MT
      
      COMMUT$C_Cost_min = 2*COMMUT$C_Footprint # Initial Units are MT
      COMMUT$C_Cost_max = 50*COMMUT$C_Footprint # Initial Units are MT
      COMMUT$C_Cost_mid = 30*COMMUT$C_Footprint # Initial Units are MT
      
      ENERGY$C_Cost_min = 2*ENERGY$C_Footprint # Initial Units are MT
      ENERGY$C_Cost_max = 50*ENERGY$C_Footprint # Initial Units are MT
      ENERGY$C_Cost_mid = 30*ENERGY$C_Footprint # Initial Units are MT
      
      # NITROGEN COSTS ******************************************************************
      # Other N  contributs to fertilizer and wastewater inventories, 
      # The fertilizer component can be split into NOx, N2O, NH3, and N to Water 
      # Using the following percentages 20%, 3%, 13%, 21%, respectively
      # Wastewater component contributes to the N to water
      
      # Baseline
      N_Fert_c = 1000*COST[COST$Sub_category == 'Fertilizer' & COST$Timeframe == 'Baseline',]$OtherN_MTN 
      N_Fert_NOx_c = N_Fert_c * 0.2
      N_Fert_N2O_c = N_Fert_c * 0.03
      N_Fert_NH3_c = N_Fert_c * 0.13
      N_Fert_SW_c = N_Fert_c * 0.21 # proportion that goes to SW (Houlton et al. 2013)
      N_Fert_GW_c = N_Fert_c * .79 * .33 # proportion that goes to GW (Sabota et al. 2015)
      N_Fert_coast_c = N_Fert_SW_c * .40 # proportion of SW that goes to coast (Sabota et al. 2015)
      
      # Projected
      N_Fert_p = 1000*COST[COST$Sub_category == 'Fertilizer' & COST$Timeframe == 'Projected',]$OtherN_MTN 
      N_Fert_NOx_p = N_Fert_p * 0.2
      N_Fert_N2O_p = N_Fert_p * 0.03
      N_Fert_NH3_p = N_Fert_p * 0.13
      N_Fert_SW_p = N_Fert_p * 0.21 # proportion that goes to SW (Houlton et al. 2013)
      N_Fert_GW_p = N_Fert_p * .79 * .33 # proportion that goes to GW (Sabota et al. 2015)
      N_Fert_coast_p = N_Fert_SW_p * .40 # proportion of SW that goes to coast (Sabota et al. 2015)
      
      #********************************************************************************
      
      COST1 = COST[COST$Timeframe == 'Baseline',]
      COST2 = COST[COST$Timeframe == 'Projected',]
      
      # Units are MT N2O or NOx - so multiplying by 1000 to convert to kg
      # h = health/social; a = agriculure; e = Ecosystems; c = climate
      COST1$N_Cost_NOx_atm_h = 1000*COST1$NOx_MTN * 32.20 # $/kgN Human respiratory health 
      COST1$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health (zero unless fertilzer - see below)
      COST1$N_Cost_NOx_atm_e = 1000*COST1$NOx_MTN * 0.43 # $/kgN visibility damages 
      COST1$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages (zero unless fertilzer - see below)
      COST1$N_Cost_N2O_atm_c = 1000*COST1$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
      COST1$N_Cost_NOx_atm_c = 1000*COST1$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
      COST1$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits (zero unless fertilzer - see below)
      COST1$N_Cost_NOx_ter_h = 1000*COST1$NOx_MTN * 0.12 # $/kgN Damages to structures  
      COST1$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures (zero unless fertilzer - see below)
      COST1$N_Cost_NOx_ter_a = 1000*COST1$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
      COST1$N_Cost_N2O_ter_a = 1000*COST1$N2O_MTN * 1.48 # $/kgN UV damages to crops 
      COST1$N_Cost_NOx_ter_e = 1000*COST1$NOx_MTN * 1.24 # $/kgN Ozone damages to forests  
      
      COST1$N_Cost_NOx_atm_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 32.20 # $/kgN Human respiratory health
      COST1$N_Cost_NH3_atm_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * 6.87 # $/kgN Human respiratory health 
      COST1$N_Cost_NOx_atm_e[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 0.43 # $/kgN visibility damages 
      COST1$N_Cost_NH3_atm_e[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * 0.43 # $/kgN visibility damages 
      COST1$N_Cost_N2O_atm_c[COST1$Sub_category == 'Fertilizer' ] = N_Fert_N2O_c * 15.07 # $/kgN Greenhouse damages 
      COST1$N_Cost_NOx_atm_c[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * (-5.02) # $/kgN Climate Cooling Benefits
      COST1$N_Cost_NH3_atm_c[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * (-5.02) # $/kgN Climate Cooling Benefits 
      COST1$N_Cost_NOx_ter_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 0.12 # $/kgN Damages to structures
      COST1$N_Cost_NH3_ter_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * 0.12 # $/kgN Damages to structures
      COST1$N_Cost_NOx_ter_a[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 2.11 # $/kgN Ozone damages to crops  
      COST1$N_Cost_N2O_ter_a[COST1$Sub_category == 'Fertilizer' ] = N_Fert_N2O_c * 1.48 # $/kgN UV damages to crops 
      COST1$N_Cost_NOx_ter_e[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 1.24 # $/kgN Ozone damages to forests  
      
      COST2$N_Cost_NOx_atm_h = 1000*COST2$NOx_MTN * 32.20 # $/kgN Human respiratory health 
      COST2$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health (zero unless fertilzer - see below)
      COST2$N_Cost_NOx_atm_e = 1000*COST2$NOx_MTN * 0.43 # $/kgN visibility damages 
      COST2$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages (zero unless fertilzer - see below)
      COST2$N_Cost_N2O_atm_c = 1000*COST2$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
      COST2$N_Cost_NOx_atm_c = 1000*COST2$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
      COST2$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits (zero unless fertilzer - see below)
      COST2$N_Cost_NOx_ter_h = 1000*COST2$NOx_MTN * 0.12 # $/kgN Damages to structures  
      COST2$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures (zero unless fertilzer - see below)
      COST2$N_Cost_NOx_ter_a = 1000*COST2$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
      COST2$N_Cost_N2O_ter_a = 1000*COST2$N2O_MTN * 1.48 # $/kgN UV damages to crops 
      COST2$N_Cost_NOx_ter_e = 1000*COST2$NOx_MTN * 1.24 # $/kgN Ozone damages to forests  
      
      COST2$N_Cost_NOx_atm_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 32.20 # $/kgN Human respiratory health
      COST2$N_Cost_NH3_atm_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * 6.87 # $/kgN Human respiratory health 
      COST2$N_Cost_NOx_atm_e[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 0.43 # $/kgN visibility damages 
      COST2$N_Cost_NH3_atm_e[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * 0.43 # $/kgN visibility damages 
      COST2$N_Cost_N2O_atm_c[COST2$Sub_category == 'Fertilizer' ] = N_Fert_N2O_p * 15.07 # $/kgN Greenhouse damages 
      COST2$N_Cost_NOx_atm_c[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * (-5.02) # $/kgN Climate Cooling Benefits
      COST2$N_Cost_NH3_atm_c[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * (-5.02) # $/kgN Climate Cooling Benefits 
      COST2$N_Cost_NOx_ter_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 0.12 # $/kgN Damages to structures
      COST2$N_Cost_NH3_ter_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * 0.12 # $/kgN Damages to structures
      COST2$N_Cost_NOx_ter_a[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 2.11 # $/kgN Ozone damages to crops  
      COST2$N_Cost_N2O_ter_a[COST2$Sub_category == 'Fertilizer' ] = N_Fert_N2O_p * 1.48 # $/kgN UV damages to crops 
      COST2$N_Cost_NOx_ter_e[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 1.24 # $/kgN Ozone damages to forests  
      
      COST = rbind(COST1,COST2)
      
      COST$N_SW_kg = 0.21 * 1000*(rowSums(COST[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # all N sources (not N2O), # proportion that goes to SW (Houlton et al. 2013)
      COST$N_GW_kg = 0.79 * .33 * 1000*(rowSums(COST[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # proportion that goes to GW (Sabota et al. 2015) 
      COST$N_coast_kg = .40 * COST$N_SW_kg # proportion of SW that goes to coast (Sabota et al. 2015)
      
      COST1 = COST[COST$Timeframe == 'Baseline',]
      COST2 = COST[COST$Timeframe == 'Projected',]
      
      COST1$N_SW_kg[COST1$Sub_category == 'Fertilizer' ] = N_Fert_SW_c
      COST1$N_GW_kg[COST1$Sub_category == 'Fertilizer' ] = N_Fert_GW_c 
      COST1$N_coast_kg[COST1$Sub_category == 'Fertilizer' ] = N_Fert_coast_c 
      COST2$N_SW_kg[COST2$Sub_category == 'Fertilizer' ] = N_Fert_SW_p
      COST2$N_GW_kg[COST2$Sub_category == 'Fertilizer' ] = N_Fert_GW_p 
      COST2$N_coast_kg[COST2$Sub_category == 'Fertilizer' ] = N_Fert_coast_p 
      
      COST = rbind(COST1,COST2)
      
      # Update below 
      COST$N_Cost_aquaFresh_e = 
        COST$N_SW_kg * 0.23 + # $/kgN Lake waterfront property values
        COST$N_SW_kg * 0.19 + # $/kgN Recreational Freshwater use
        COST$N_SW_kg * 0.01 # $/kgN Endangered species protection
      COST$N_Cost_aquaGround_h = 
        COST$N_GW_kg * 0.15 + # $/kgN Replacement with bottled water
        COST$N_GW_kg * 0.60 # $/kgN Treatment of private well water 
      COST$N_Cost_aquaCoast_e = 
        COST$N_coast_kg * 7.11 # $/kgN Recreational use of estuary
      
      
      # No NH3 emissions factor data for Commuting
      COMMUT$N_Cost_NOx_atm_h = 1000*COMMUT$NOx_MTN * 32.20 # $/kgN Human respiratory health 
      COMMUT$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health 
      COMMUT$N_Cost_NOx_atm_e = 1000*COMMUT$NOx_MTN * 0.43 # $/kgN visibility damages 
      COMMUT$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages 
      COMMUT$N_Cost_N2O_atm_c = 1000*COMMUT$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
      COMMUT$N_Cost_NOx_atm_c = 1000*COMMUT$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
      COMMUT$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits 
      COMMUT$N_Cost_NOx_ter_h = 1000*COMMUT$NOx_MTN * 0.12 # $/kgN Damages to structures  
      COMMUT$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures  
      COMMUT$N_Cost_NOx_ter_a = 1000*COMMUT$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
      COMMUT$N_Cost_N2O_ter_a = 1000*COMMUT$N2O_MTN * 1.48 # $/kgN UV damages to crops 
      COMMUT$N_Cost_NOx_ter_e = 1000*COMMUT$NOx_MTN * 1.24 # $/kgN Ozone damages to forests
      
      # No NH3 emissions factor data for Energy sources
      ENERGY$N_Cost_NOx_atm_h = 1000*ENERGY$NOx_MTN * 32.20 # $/kgN Human respiratory health 
      ENERGY$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health 
      ENERGY$N_Cost_NOx_atm_e = 1000*ENERGY$NOx_MTN * 0.43 # $/kgN visibility damages 
      ENERGY$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages 
      ENERGY$N_Cost_N2O_atm_c = 1000*ENERGY$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
      ENERGY$N_Cost_NOx_atm_c = 1000*ENERGY$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
      ENERGY$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits 
      ENERGY$N_Cost_NOx_ter_h = 1000*ENERGY$NOx_MTN * 0.12 # $/kgN Damages to structures  
      ENERGY$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures  
      ENERGY$N_Cost_NOx_ter_a = 1000*ENERGY$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
      ENERGY$N_Cost_N2O_ter_a = 1000*ENERGY$N2O_MTN * 1.48 # $/kgN UV damages to crops 
      ENERGY$N_Cost_NOx_ter_e = 1000*ENERGY$NOx_MTN * 1.24 # $/kgN Ozone damages to forests
      
      COMMUT$N_SW_kg = 0.21 * 1000*(rowSums(COMMUT[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # all N sources (not N2O), # proportion that goes to SW (Houlton et al. 2013)
      COMMUT$N_GW_kg = 0.79 * .33 *  1000*(rowSums(COMMUT[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # proportion that goes to GW (Sabota et al. 2015) 
      COMMUT$N_coast_kg = 0.40 * COMMUT$N_SW_kg # proportion of SW that goes to coast (Sabota et al. 2015)
      
      ENERGY$N_SW_kg = 0.21 * 1000*(rowSums(ENERGY[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # all N sources (not N2O),  # proportion that goes to SW (Houlton et al. 2013)
      ENERGY$N_GW_kg = 0.79 * .33 *  1000*(rowSums(ENERGY[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # proportion that goes to GW (Sabota et al. 2015) 
      ENERGY$N_coast_kg = 0.40 * ENERGY$N_SW_kg # proportion of SW that goes to coast (Sabota et al. 2015)
      
      COMMUT$N_Cost_aquaFresh_e = 
        COMMUT$N_SW_kg * 0.23 + # $/kgN Lake waterfront property values
        COMMUT$N_SW_kg * 0.19 + # $/kgN Recreational Freshwater use
        COMMUT$N_SW_kg * 0.01 # $/kgN Endangered species protection
      COMMUT$N_Cost_aquaGround_h = 
        COMMUT$N_GW_kg * 0.15 + # $/kgN Replacement with bottled water
        COMMUT$N_GW_kg * 0.60 # $/kgN Treatment of private well water 
      COMMUT$N_Cost_aquaCoast_e = 
        COMMUT$N_coast_kg * 7.11 # $/kgN Recreational use of estuary
      
      ENERGY$N_Cost_aquaFresh_e = 
        ENERGY$N_SW_kg * 0.23 + # $/kgN Lake waterfront property values
        ENERGY$N_SW_kg * 0.19 + # $/kgN Recreational Freshwater use
        ENERGY$N_SW_kg * 0.01 # $/kgN Endangered species protection
      ENERGY$N_Cost_aquaGround_h = 
        ENERGY$N_GW_kg * 0.15 + # $/kgN Replacement with bottled water
        ENERGY$N_GW_kg * 0.60 # $/kgN Treatment of private well water 
      ENERGY$N_Cost_aquaCoast_e = 
        ENERGY$N_coast_kg * 7.11 # $/kgN Recreational use of estuary
      
      COST$N_Cost_Total = 
        rowSums(COST[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                        'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                        'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                        'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                        'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                        'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                        'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                        'N_Cost_aquaCoast_e')], na.rm=T)
      
      COMMUT$N_Cost_Total = 
        rowSums(COMMUT[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                          'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                          'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                          'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                          'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                          'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                          'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                          'N_Cost_aquaCoast_e')], na.rm=T)
      
      ENERGY$N_Cost_Total = 
        rowSums(ENERGY[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                          'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                          'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                          'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                          'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                          'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                          'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                          'N_Cost_aquaCoast_e')], na.rm=T)
      
      # Add back on COMMUTING AND ENERGY
      COST = rbind(COST,COMMUT,ENERGY)
      
      COST_R = COST  
    } # Scenario
    
    
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 3 COST_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Replacement of 20% beef with Chicken"){
      # COST = COMBO_R_
      # COMMUT = rbind(Commut_Fac_R_,Commut_Staff_R_,Commut_Stud_R_)
      # ENERGY = Energy_R_
      
      COST = COMBO_R_()
      COMMUT = rbind(Commut_Fac_R_(),Commut_Staff_R_(),Commut_Stud_R_())
      ENERGY = Energy_R_()
      
      # Remove the COMMUTING and ENERGY from main dataframe
      COST = COST[COST$Category != 'Commuting',]
      COST = COST[COST$Category != 'On-Campus Stationary Sources',]
      
      
      # Get the dataframes to have same fields
      COST = COST[,c('Scope','Category','Sub_category','Source','Units',
                     'inventory','NOx_MTN','N2O_MTN','OtherN_MTN',
                     'C_Footprint','N_Footprint','Timeframe')]
      COMMUT = COMMUT[,c('Scope','Category','Sub_category','Source','Units',
                         'inventory','NOx_MTN','N2O_MTN','OtherN_MTN',
                         'C_Footprint','N_Footprint','Timeframe')]
      ENERGY = ENERGY[,c('Scope','Category','Sub_category','Source','Units',
                         'inventory','NOx_MTN','N2O_MTN','OtherN_MTN',
                         'C_Footprint','N_Footprint','Timeframe')]
      
      
      #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
      # CARBON COSTS ********************************************************************
      # Jana Compton: For Carbon costs, we recommend using $2-$50 per ton of CO2 equivalent 
      # That covers the range we are using in our paper.  
      # Units of C_Footprint are MT for COST and kg for food data
      COST$C_Cost_min = 2*COST$C_Footprint # Initial Units are MT
      COST$C_Cost_max = 50*COST$C_Footprint # Initial Units are MT
      COST$C_Cost_mid = 30*COST$C_Footprint # Initial Units are MT
      
      COMMUT$C_Cost_min = 2*COMMUT$C_Footprint # Initial Units are MT
      COMMUT$C_Cost_max = 50*COMMUT$C_Footprint # Initial Units are MT
      COMMUT$C_Cost_mid = 30*COMMUT$C_Footprint # Initial Units are MT
      
      ENERGY$C_Cost_min = 2*ENERGY$C_Footprint # Initial Units are MT
      ENERGY$C_Cost_max = 50*ENERGY$C_Footprint # Initial Units are MT
      ENERGY$C_Cost_mid = 30*ENERGY$C_Footprint # Initial Units are MT
      
      # NITROGEN COSTS ******************************************************************
      # Other N  contributs to fertilizer and wastewater inventories, 
      # The fertilizer component can be split into NOx, N2O, NH3, and N to Water 
      # Using the following percentages 20%, 3%, 13%, 21%, respectively
      # Wastewater component contributes to the N to water
      
      # Baseline
      N_Fert_c = 1000*COST[COST$Sub_category == 'Fertilizer' & COST$Timeframe == 'Baseline',]$OtherN_MTN 
      N_Fert_NOx_c = N_Fert_c * 0.2
      N_Fert_N2O_c = N_Fert_c * 0.03
      N_Fert_NH3_c = N_Fert_c * 0.13
      N_Fert_SW_c = N_Fert_c * 0.21 # proportion that goes to SW (Houlton et al. 2013)
      N_Fert_GW_c = N_Fert_c * .79 * .33 # proportion that goes to GW (Sabota et al. 2015)
      N_Fert_coast_c = N_Fert_SW_c * .40 # proportion of SW that goes to coast (Sabota et al. 2015)
      
      # Projected
      N_Fert_p = 1000*COST[COST$Sub_category == 'Fertilizer' & COST$Timeframe == 'Projected',]$OtherN_MTN 
      N_Fert_NOx_p = N_Fert_p * 0.2
      N_Fert_N2O_p = N_Fert_p * 0.03
      N_Fert_NH3_p = N_Fert_p * 0.13
      N_Fert_SW_p = N_Fert_p * 0.21 # proportion that goes to SW (Houlton et al. 2013)
      N_Fert_GW_p = N_Fert_p * .79 * .33 # proportion that goes to GW (Sabota et al. 2015)
      N_Fert_coast_p = N_Fert_SW_p * .40 # proportion of SW that goes to coast (Sabota et al. 2015)
      
      #********************************************************************************
      
      COST1 = COST[COST$Timeframe == 'Baseline',]
      COST2 = COST[COST$Timeframe == 'Projected',]
      
      # Units are MT N2O or NOx - so multiplying by 1000 to convert to kg
      # h = health/social; a = agriculure; e = Ecosystems; c = climate
      COST1$N_Cost_NOx_atm_h = 1000*COST1$NOx_MTN * 32.20 # $/kgN Human respiratory health 
      COST1$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health (zero unless fertilzer - see below)
      COST1$N_Cost_NOx_atm_e = 1000*COST1$NOx_MTN * 0.43 # $/kgN visibility damages 
      COST1$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages (zero unless fertilzer - see below)
      COST1$N_Cost_N2O_atm_c = 1000*COST1$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
      COST1$N_Cost_NOx_atm_c = 1000*COST1$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
      COST1$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits (zero unless fertilzer - see below)
      COST1$N_Cost_NOx_ter_h = 1000*COST1$NOx_MTN * 0.12 # $/kgN Damages to structures  
      COST1$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures (zero unless fertilzer - see below)
      COST1$N_Cost_NOx_ter_a = 1000*COST1$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
      COST1$N_Cost_N2O_ter_a = 1000*COST1$N2O_MTN * 1.48 # $/kgN UV damages to crops 
      COST1$N_Cost_NOx_ter_e = 1000*COST1$NOx_MTN * 1.24 # $/kgN Ozone damages to forests  
      
      COST1$N_Cost_NOx_atm_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 32.20 # $/kgN Human respiratory health
      COST1$N_Cost_NH3_atm_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * 6.87 # $/kgN Human respiratory health 
      COST1$N_Cost_NOx_atm_e[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 0.43 # $/kgN visibility damages 
      COST1$N_Cost_NH3_atm_e[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * 0.43 # $/kgN visibility damages 
      COST1$N_Cost_N2O_atm_c[COST1$Sub_category == 'Fertilizer' ] = N_Fert_N2O_c * 15.07 # $/kgN Greenhouse damages 
      COST1$N_Cost_NOx_atm_c[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * (-5.02) # $/kgN Climate Cooling Benefits
      COST1$N_Cost_NH3_atm_c[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * (-5.02) # $/kgN Climate Cooling Benefits 
      COST1$N_Cost_NOx_ter_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 0.12 # $/kgN Damages to structures
      COST1$N_Cost_NH3_ter_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * 0.12 # $/kgN Damages to structures
      COST1$N_Cost_NOx_ter_a[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 2.11 # $/kgN Ozone damages to crops  
      COST1$N_Cost_N2O_ter_a[COST1$Sub_category == 'Fertilizer' ] = N_Fert_N2O_c * 1.48 # $/kgN UV damages to crops 
      COST1$N_Cost_NOx_ter_e[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 1.24 # $/kgN Ozone damages to forests  
      
      COST2$N_Cost_NOx_atm_h = 1000*COST2$NOx_MTN * 32.20 # $/kgN Human respiratory health 
      COST2$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health (zero unless fertilzer - see below)
      COST2$N_Cost_NOx_atm_e = 1000*COST2$NOx_MTN * 0.43 # $/kgN visibility damages 
      COST2$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages (zero unless fertilzer - see below)
      COST2$N_Cost_N2O_atm_c = 1000*COST2$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
      COST2$N_Cost_NOx_atm_c = 1000*COST2$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
      COST2$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits (zero unless fertilzer - see below)
      COST2$N_Cost_NOx_ter_h = 1000*COST2$NOx_MTN * 0.12 # $/kgN Damages to structures  
      COST2$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures (zero unless fertilzer - see below)
      COST2$N_Cost_NOx_ter_a = 1000*COST2$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
      COST2$N_Cost_N2O_ter_a = 1000*COST2$N2O_MTN * 1.48 # $/kgN UV damages to crops 
      COST2$N_Cost_NOx_ter_e = 1000*COST2$NOx_MTN * 1.24 # $/kgN Ozone damages to forests  
      
      COST2$N_Cost_NOx_atm_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 32.20 # $/kgN Human respiratory health
      COST2$N_Cost_NH3_atm_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * 6.87 # $/kgN Human respiratory health 
      COST2$N_Cost_NOx_atm_e[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 0.43 # $/kgN visibility damages 
      COST2$N_Cost_NH3_atm_e[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * 0.43 # $/kgN visibility damages 
      COST2$N_Cost_N2O_atm_c[COST2$Sub_category == 'Fertilizer' ] = N_Fert_N2O_p * 15.07 # $/kgN Greenhouse damages 
      COST2$N_Cost_NOx_atm_c[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * (-5.02) # $/kgN Climate Cooling Benefits
      COST2$N_Cost_NH3_atm_c[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * (-5.02) # $/kgN Climate Cooling Benefits 
      COST2$N_Cost_NOx_ter_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 0.12 # $/kgN Damages to structures
      COST2$N_Cost_NH3_ter_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * 0.12 # $/kgN Damages to structures
      COST2$N_Cost_NOx_ter_a[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 2.11 # $/kgN Ozone damages to crops  
      COST2$N_Cost_N2O_ter_a[COST2$Sub_category == 'Fertilizer' ] = N_Fert_N2O_p * 1.48 # $/kgN UV damages to crops 
      COST2$N_Cost_NOx_ter_e[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 1.24 # $/kgN Ozone damages to forests  
      
      COST = rbind(COST1,COST2)
      
      COST$N_SW_kg = 0.21 * 1000*(rowSums(COST[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # all N sources (not N2O), # proportion that goes to SW (Houlton et al. 2013)
      COST$N_GW_kg = 0.79 * .33 * 1000*(rowSums(COST[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # proportion that goes to GW (Sabota et al. 2015) 
      COST$N_coast_kg = .40 * COST$N_SW_kg # proportion of SW that goes to coast (Sabota et al. 2015)
      
      COST1 = COST[COST$Timeframe == 'Baseline',]
      COST2 = COST[COST$Timeframe == 'Projected',]
      
      COST1$N_SW_kg[COST1$Sub_category == 'Fertilizer' ] = N_Fert_SW_c
      COST1$N_GW_kg[COST1$Sub_category == 'Fertilizer' ] = N_Fert_GW_c 
      COST1$N_coast_kg[COST1$Sub_category == 'Fertilizer' ] = N_Fert_coast_c 
      COST2$N_SW_kg[COST2$Sub_category == 'Fertilizer' ] = N_Fert_SW_p
      COST2$N_GW_kg[COST2$Sub_category == 'Fertilizer' ] = N_Fert_GW_p 
      COST2$N_coast_kg[COST2$Sub_category == 'Fertilizer' ] = N_Fert_coast_p 
      
      COST = rbind(COST1,COST2)
      
      # Update below 
      COST$N_Cost_aquaFresh_e = 
        COST$N_SW_kg * 0.23 + # $/kgN Lake waterfront property values
        COST$N_SW_kg * 0.19 + # $/kgN Recreational Freshwater use
        COST$N_SW_kg * 0.01 # $/kgN Endangered species protection
      COST$N_Cost_aquaGround_h = 
        COST$N_GW_kg * 0.15 + # $/kgN Replacement with bottled water
        COST$N_GW_kg * 0.60 # $/kgN Treatment of private well water 
      COST$N_Cost_aquaCoast_e = 
        COST$N_coast_kg * 7.11 # $/kgN Recreational use of estuary
      
      
      # No NH3 emissions factor data for Commuting
      COMMUT$N_Cost_NOx_atm_h = 1000*COMMUT$NOx_MTN * 32.20 # $/kgN Human respiratory health 
      COMMUT$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health 
      COMMUT$N_Cost_NOx_atm_e = 1000*COMMUT$NOx_MTN * 0.43 # $/kgN visibility damages 
      COMMUT$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages 
      COMMUT$N_Cost_N2O_atm_c = 1000*COMMUT$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
      COMMUT$N_Cost_NOx_atm_c = 1000*COMMUT$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
      COMMUT$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits 
      COMMUT$N_Cost_NOx_ter_h = 1000*COMMUT$NOx_MTN * 0.12 # $/kgN Damages to structures  
      COMMUT$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures  
      COMMUT$N_Cost_NOx_ter_a = 1000*COMMUT$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
      COMMUT$N_Cost_N2O_ter_a = 1000*COMMUT$N2O_MTN * 1.48 # $/kgN UV damages to crops 
      COMMUT$N_Cost_NOx_ter_e = 1000*COMMUT$NOx_MTN * 1.24 # $/kgN Ozone damages to forests
      
      # No NH3 emissions factor data for Energy sources
      ENERGY$N_Cost_NOx_atm_h = 1000*ENERGY$NOx_MTN * 32.20 # $/kgN Human respiratory health 
      ENERGY$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health 
      ENERGY$N_Cost_NOx_atm_e = 1000*ENERGY$NOx_MTN * 0.43 # $/kgN visibility damages 
      ENERGY$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages 
      ENERGY$N_Cost_N2O_atm_c = 1000*ENERGY$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
      ENERGY$N_Cost_NOx_atm_c = 1000*ENERGY$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
      ENERGY$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits 
      ENERGY$N_Cost_NOx_ter_h = 1000*ENERGY$NOx_MTN * 0.12 # $/kgN Damages to structures  
      ENERGY$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures  
      ENERGY$N_Cost_NOx_ter_a = 1000*ENERGY$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
      ENERGY$N_Cost_N2O_ter_a = 1000*ENERGY$N2O_MTN * 1.48 # $/kgN UV damages to crops 
      ENERGY$N_Cost_NOx_ter_e = 1000*ENERGY$NOx_MTN * 1.24 # $/kgN Ozone damages to forests
      
      COMMUT$N_SW_kg = 0.21 * 1000*(rowSums(COMMUT[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # all N sources (not N2O), # proportion that goes to SW (Houlton et al. 2013)
      COMMUT$N_GW_kg = 0.79 * .33 *  1000*(rowSums(COMMUT[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # proportion that goes to GW (Sabota et al. 2015) 
      COMMUT$N_coast_kg = 0.40 * COMMUT$N_SW_kg # proportion of SW that goes to coast (Sabota et al. 2015)
      
      ENERGY$N_SW_kg = 0.21 * 1000*(rowSums(ENERGY[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # all N sources (not N2O),  # proportion that goes to SW (Houlton et al. 2013)
      ENERGY$N_GW_kg = 0.79 * .33 *  1000*(rowSums(ENERGY[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # proportion that goes to GW (Sabota et al. 2015) 
      ENERGY$N_coast_kg = 0.40 * ENERGY$N_SW_kg # proportion of SW that goes to coast (Sabota et al. 2015)
      
      COMMUT$N_Cost_aquaFresh_e = 
        COMMUT$N_SW_kg * 0.23 + # $/kgN Lake waterfront property values
        COMMUT$N_SW_kg * 0.19 + # $/kgN Recreational Freshwater use
        COMMUT$N_SW_kg * 0.01 # $/kgN Endangered species protection
      COMMUT$N_Cost_aquaGround_h = 
        COMMUT$N_GW_kg * 0.15 + # $/kgN Replacement with bottled water
        COMMUT$N_GW_kg * 0.60 # $/kgN Treatment of private well water 
      COMMUT$N_Cost_aquaCoast_e = 
        COMMUT$N_coast_kg * 7.11 # $/kgN Recreational use of estuary
      
      ENERGY$N_Cost_aquaFresh_e = 
        ENERGY$N_SW_kg * 0.23 + # $/kgN Lake waterfront property values
        ENERGY$N_SW_kg * 0.19 + # $/kgN Recreational Freshwater use
        ENERGY$N_SW_kg * 0.01 # $/kgN Endangered species protection
      ENERGY$N_Cost_aquaGround_h = 
        ENERGY$N_GW_kg * 0.15 + # $/kgN Replacement with bottled water
        ENERGY$N_GW_kg * 0.60 # $/kgN Treatment of private well water 
      ENERGY$N_Cost_aquaCoast_e = 
        ENERGY$N_coast_kg * 7.11 # $/kgN Recreational use of estuary
      
      COST$N_Cost_Total = 
        rowSums(COST[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                        'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                        'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                        'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                        'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                        'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                        'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                        'N_Cost_aquaCoast_e')], na.rm=T)
      
      COMMUT$N_Cost_Total = 
        rowSums(COMMUT[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                          'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                          'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                          'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                          'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                          'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                          'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                          'N_Cost_aquaCoast_e')], na.rm=T)
      
      ENERGY$N_Cost_Total = 
        rowSums(ENERGY[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                          'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                          'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                          'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                          'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                          'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                          'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                          'N_Cost_aquaCoast_e')], na.rm=T)
      
      # Add back on COMMUTING AND ENERGY
      COST = rbind(COST,COMMUT,ENERGY)
      
      COST_R = COST  
    } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 4 COST_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    
    else if(input$scenario == "Fuel Optimization"){
      # COST = COMBO_R_
      # COMMUT = rbind(Commut_Fac_R_,Commut_Staff_R_,Commut_Stud_R_)
      # ENERGY = Energy_R_
      
      COST = COMBO_R_()
      COMMUT = rbind(Commut_Fac_R_(),Commut_Staff_R_(),Commut_Stud_R_())
      ENERGY = Energy_R_()
      
      # Remove the COMMUTING and ENERGY from main dataframe
      COST = COST[COST$Category != 'Commuting',]
      COST = COST[COST$Category != 'On-Campus Stationary Sources',]
      
      
      # Get the dataframes to have same fields
      COST = COST[,c('Scope','Category','Sub_category','Source','Units',
                     'inventory','NOx_MTN','N2O_MTN','OtherN_MTN',
                     'C_Footprint','N_Footprint','Timeframe')]
      COMMUT = COMMUT[,c('Scope','Category','Sub_category','Source','Units',
                         'inventory','NOx_MTN','N2O_MTN','OtherN_MTN',
                         'C_Footprint','N_Footprint','Timeframe')]
      ENERGY = ENERGY[,c('Scope','Category','Sub_category','Source','Units',
                         'inventory','NOx_MTN','N2O_MTN','OtherN_MTN',
                         'C_Footprint','N_Footprint','Timeframe')]
      
      
      #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
      # CARBON COSTS ********************************************************************
      # Jana Compton: For Carbon costs, we recommend using $2-$50 per ton of CO2 equivalent 
      # That covers the range we are using in our paper.  
      # Units of C_Footprint are MT for COST and kg for food data
      COST$C_Cost_min = 2*COST$C_Footprint # Initial Units are MT
      COST$C_Cost_max = 50*COST$C_Footprint # Initial Units are MT
      COST$C_Cost_mid = 30*COST$C_Footprint # Initial Units are MT
      
      COMMUT$C_Cost_min = 2*COMMUT$C_Footprint # Initial Units are MT
      COMMUT$C_Cost_max = 50*COMMUT$C_Footprint # Initial Units are MT
      COMMUT$C_Cost_mid = 30*COMMUT$C_Footprint # Initial Units are MT
      
      ENERGY$C_Cost_min = 2*ENERGY$C_Footprint # Initial Units are MT
      ENERGY$C_Cost_max = 50*ENERGY$C_Footprint # Initial Units are MT
      ENERGY$C_Cost_mid = 30*ENERGY$C_Footprint # Initial Units are MT
      
      # NITROGEN COSTS ******************************************************************
      # Other N  contributs to fertilizer and wastewater inventories, 
      # The fertilizer component can be split into NOx, N2O, NH3, and N to Water 
      # Using the following percentages 20%, 3%, 13%, 21%, respectively
      # Wastewater component contributes to the N to water
      
      # Baseline
      N_Fert_c = 1000*COST[COST$Sub_category == 'Fertilizer' & COST$Timeframe == 'Baseline',]$OtherN_MTN 
      N_Fert_NOx_c = N_Fert_c * 0.2
      N_Fert_N2O_c = N_Fert_c * 0.03
      N_Fert_NH3_c = N_Fert_c * 0.13
      N_Fert_SW_c = N_Fert_c * 0.21 # proportion that goes to SW (Houlton et al. 2013)
      N_Fert_GW_c = N_Fert_c * .79 * .33 # proportion that goes to GW (Sabota et al. 2015)
      N_Fert_coast_c = N_Fert_SW_c * .40 # proportion of SW that goes to coast (Sabota et al. 2015)
      
      # Projected
      N_Fert_p = 1000*COST[COST$Sub_category == 'Fertilizer' & COST$Timeframe == 'Projected',]$OtherN_MTN 
      N_Fert_NOx_p = N_Fert_p * 0.2
      N_Fert_N2O_p = N_Fert_p * 0.03
      N_Fert_NH3_p = N_Fert_p * 0.13
      N_Fert_SW_p = N_Fert_p * 0.21 # proportion that goes to SW (Houlton et al. 2013)
      N_Fert_GW_p = N_Fert_p * .79 * .33 # proportion that goes to GW (Sabota et al. 2015)
      N_Fert_coast_p = N_Fert_SW_p * .40 # proportion of SW that goes to coast (Sabota et al. 2015)
      
      #********************************************************************************
      
      COST1 = COST[COST$Timeframe == 'Baseline',]
      COST2 = COST[COST$Timeframe == 'Projected',]
      
      # Units are MT N2O or NOx - so multiplying by 1000 to convert to kg
      # h = health/social; a = agriculure; e = Ecosystems; c = climate
      COST1$N_Cost_NOx_atm_h = 1000*COST1$NOx_MTN * 32.20 # $/kgN Human respiratory health 
      COST1$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health (zero unless fertilzer - see below)
      COST1$N_Cost_NOx_atm_e = 1000*COST1$NOx_MTN * 0.43 # $/kgN visibility damages 
      COST1$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages (zero unless fertilzer - see below)
      COST1$N_Cost_N2O_atm_c = 1000*COST1$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
      COST1$N_Cost_NOx_atm_c = 1000*COST1$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
      COST1$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits (zero unless fertilzer - see below)
      COST1$N_Cost_NOx_ter_h = 1000*COST1$NOx_MTN * 0.12 # $/kgN Damages to structures  
      COST1$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures (zero unless fertilzer - see below)
      COST1$N_Cost_NOx_ter_a = 1000*COST1$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
      COST1$N_Cost_N2O_ter_a = 1000*COST1$N2O_MTN * 1.48 # $/kgN UV damages to crops 
      COST1$N_Cost_NOx_ter_e = 1000*COST1$NOx_MTN * 1.24 # $/kgN Ozone damages to forests  
      
      COST1$N_Cost_NOx_atm_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 32.20 # $/kgN Human respiratory health
      COST1$N_Cost_NH3_atm_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * 6.87 # $/kgN Human respiratory health 
      COST1$N_Cost_NOx_atm_e[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 0.43 # $/kgN visibility damages 
      COST1$N_Cost_NH3_atm_e[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * 0.43 # $/kgN visibility damages 
      COST1$N_Cost_N2O_atm_c[COST1$Sub_category == 'Fertilizer' ] = N_Fert_N2O_c * 15.07 # $/kgN Greenhouse damages 
      COST1$N_Cost_NOx_atm_c[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * (-5.02) # $/kgN Climate Cooling Benefits
      COST1$N_Cost_NH3_atm_c[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * (-5.02) # $/kgN Climate Cooling Benefits 
      COST1$N_Cost_NOx_ter_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 0.12 # $/kgN Damages to structures
      COST1$N_Cost_NH3_ter_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * 0.12 # $/kgN Damages to structures
      COST1$N_Cost_NOx_ter_a[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 2.11 # $/kgN Ozone damages to crops  
      COST1$N_Cost_N2O_ter_a[COST1$Sub_category == 'Fertilizer' ] = N_Fert_N2O_c * 1.48 # $/kgN UV damages to crops 
      COST1$N_Cost_NOx_ter_e[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 1.24 # $/kgN Ozone damages to forests  
      
      COST2$N_Cost_NOx_atm_h = 1000*COST2$NOx_MTN * 32.20 # $/kgN Human respiratory health 
      COST2$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health (zero unless fertilzer - see below)
      COST2$N_Cost_NOx_atm_e = 1000*COST2$NOx_MTN * 0.43 # $/kgN visibility damages 
      COST2$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages (zero unless fertilzer - see below)
      COST2$N_Cost_N2O_atm_c = 1000*COST2$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
      COST2$N_Cost_NOx_atm_c = 1000*COST2$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
      COST2$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits (zero unless fertilzer - see below)
      COST2$N_Cost_NOx_ter_h = 1000*COST2$NOx_MTN * 0.12 # $/kgN Damages to structures  
      COST2$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures (zero unless fertilzer - see below)
      COST2$N_Cost_NOx_ter_a = 1000*COST2$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
      COST2$N_Cost_N2O_ter_a = 1000*COST2$N2O_MTN * 1.48 # $/kgN UV damages to crops 
      COST2$N_Cost_NOx_ter_e = 1000*COST2$NOx_MTN * 1.24 # $/kgN Ozone damages to forests  
      
      COST2$N_Cost_NOx_atm_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 32.20 # $/kgN Human respiratory health
      COST2$N_Cost_NH3_atm_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * 6.87 # $/kgN Human respiratory health 
      COST2$N_Cost_NOx_atm_e[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 0.43 # $/kgN visibility damages 
      COST2$N_Cost_NH3_atm_e[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * 0.43 # $/kgN visibility damages 
      COST2$N_Cost_N2O_atm_c[COST2$Sub_category == 'Fertilizer' ] = N_Fert_N2O_p * 15.07 # $/kgN Greenhouse damages 
      COST2$N_Cost_NOx_atm_c[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * (-5.02) # $/kgN Climate Cooling Benefits
      COST2$N_Cost_NH3_atm_c[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * (-5.02) # $/kgN Climate Cooling Benefits 
      COST2$N_Cost_NOx_ter_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 0.12 # $/kgN Damages to structures
      COST2$N_Cost_NH3_ter_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * 0.12 # $/kgN Damages to structures
      COST2$N_Cost_NOx_ter_a[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 2.11 # $/kgN Ozone damages to crops  
      COST2$N_Cost_N2O_ter_a[COST2$Sub_category == 'Fertilizer' ] = N_Fert_N2O_p * 1.48 # $/kgN UV damages to crops 
      COST2$N_Cost_NOx_ter_e[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 1.24 # $/kgN Ozone damages to forests  
      
      COST = rbind(COST1,COST2)
      
      COST$N_SW_kg = 0.21 * 1000*(rowSums(COST[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # all N sources (not N2O), # proportion that goes to SW (Houlton et al. 2013)
      COST$N_GW_kg = 0.79 * .33 * 1000*(rowSums(COST[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # proportion that goes to GW (Sabota et al. 2015) 
      COST$N_coast_kg = .40 * COST$N_SW_kg # proportion of SW that goes to coast (Sabota et al. 2015)
      
      COST1 = COST[COST$Timeframe == 'Baseline',]
      COST2 = COST[COST$Timeframe == 'Projected',]
      
      COST1$N_SW_kg[COST1$Sub_category == 'Fertilizer' ] = N_Fert_SW_c
      COST1$N_GW_kg[COST1$Sub_category == 'Fertilizer' ] = N_Fert_GW_c 
      COST1$N_coast_kg[COST1$Sub_category == 'Fertilizer' ] = N_Fert_coast_c 
      COST2$N_SW_kg[COST2$Sub_category == 'Fertilizer' ] = N_Fert_SW_p
      COST2$N_GW_kg[COST2$Sub_category == 'Fertilizer' ] = N_Fert_GW_p 
      COST2$N_coast_kg[COST2$Sub_category == 'Fertilizer' ] = N_Fert_coast_p 
      
      COST = rbind(COST1,COST2)
      
      # Update below 
      COST$N_Cost_aquaFresh_e = 
        COST$N_SW_kg * 0.23 + # $/kgN Lake waterfront property values
        COST$N_SW_kg * 0.19 + # $/kgN Recreational Freshwater use
        COST$N_SW_kg * 0.01 # $/kgN Endangered species protection
      COST$N_Cost_aquaGround_h = 
        COST$N_GW_kg * 0.15 + # $/kgN Replacement with bottled water
        COST$N_GW_kg * 0.60 # $/kgN Treatment of private well water 
      COST$N_Cost_aquaCoast_e = 
        COST$N_coast_kg * 7.11 # $/kgN Recreational use of estuary
      
      
      # No NH3 emissions factor data for Commuting
      COMMUT$N_Cost_NOx_atm_h = 1000*COMMUT$NOx_MTN * 32.20 # $/kgN Human respiratory health 
      COMMUT$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health 
      COMMUT$N_Cost_NOx_atm_e = 1000*COMMUT$NOx_MTN * 0.43 # $/kgN visibility damages 
      COMMUT$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages 
      COMMUT$N_Cost_N2O_atm_c = 1000*COMMUT$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
      COMMUT$N_Cost_NOx_atm_c = 1000*COMMUT$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
      COMMUT$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits 
      COMMUT$N_Cost_NOx_ter_h = 1000*COMMUT$NOx_MTN * 0.12 # $/kgN Damages to structures  
      COMMUT$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures  
      COMMUT$N_Cost_NOx_ter_a = 1000*COMMUT$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
      COMMUT$N_Cost_N2O_ter_a = 1000*COMMUT$N2O_MTN * 1.48 # $/kgN UV damages to crops 
      COMMUT$N_Cost_NOx_ter_e = 1000*COMMUT$NOx_MTN * 1.24 # $/kgN Ozone damages to forests
      
      # No NH3 emissions factor data for Energy sources
      ENERGY$N_Cost_NOx_atm_h = 1000*ENERGY$NOx_MTN * 32.20 # $/kgN Human respiratory health 
      ENERGY$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health 
      ENERGY$N_Cost_NOx_atm_e = 1000*ENERGY$NOx_MTN * 0.43 # $/kgN visibility damages 
      ENERGY$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages 
      ENERGY$N_Cost_N2O_atm_c = 1000*ENERGY$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
      ENERGY$N_Cost_NOx_atm_c = 1000*ENERGY$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
      ENERGY$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits 
      ENERGY$N_Cost_NOx_ter_h = 1000*ENERGY$NOx_MTN * 0.12 # $/kgN Damages to structures  
      ENERGY$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures  
      ENERGY$N_Cost_NOx_ter_a = 1000*ENERGY$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
      ENERGY$N_Cost_N2O_ter_a = 1000*ENERGY$N2O_MTN * 1.48 # $/kgN UV damages to crops 
      ENERGY$N_Cost_NOx_ter_e = 1000*ENERGY$NOx_MTN * 1.24 # $/kgN Ozone damages to forests
      
      COMMUT$N_SW_kg = 0.21 * 1000*(rowSums(COMMUT[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # all N sources (not N2O), # proportion that goes to SW (Houlton et al. 2013)
      COMMUT$N_GW_kg = 0.79 * .33 *  1000*(rowSums(COMMUT[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # proportion that goes to GW (Sabota et al. 2015) 
      COMMUT$N_coast_kg = 0.40 * COMMUT$N_SW_kg # proportion of SW that goes to coast (Sabota et al. 2015)
      
      ENERGY$N_SW_kg = 0.21 * 1000*(rowSums(ENERGY[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # all N sources (not N2O),  # proportion that goes to SW (Houlton et al. 2013)
      ENERGY$N_GW_kg = 0.79 * .33 *  1000*(rowSums(ENERGY[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # proportion that goes to GW (Sabota et al. 2015) 
      ENERGY$N_coast_kg = 0.40 * ENERGY$N_SW_kg # proportion of SW that goes to coast (Sabota et al. 2015)
      
      COMMUT$N_Cost_aquaFresh_e = 
        COMMUT$N_SW_kg * 0.23 + # $/kgN Lake waterfront property values
        COMMUT$N_SW_kg * 0.19 + # $/kgN Recreational Freshwater use
        COMMUT$N_SW_kg * 0.01 # $/kgN Endangered species protection
      COMMUT$N_Cost_aquaGround_h = 
        COMMUT$N_GW_kg * 0.15 + # $/kgN Replacement with bottled water
        COMMUT$N_GW_kg * 0.60 # $/kgN Treatment of private well water 
      COMMUT$N_Cost_aquaCoast_e = 
        COMMUT$N_coast_kg * 7.11 # $/kgN Recreational use of estuary
      
      ENERGY$N_Cost_aquaFresh_e = 
        ENERGY$N_SW_kg * 0.23 + # $/kgN Lake waterfront property values
        ENERGY$N_SW_kg * 0.19 + # $/kgN Recreational Freshwater use
        ENERGY$N_SW_kg * 0.01 # $/kgN Endangered species protection
      ENERGY$N_Cost_aquaGround_h = 
        ENERGY$N_GW_kg * 0.15 + # $/kgN Replacement with bottled water
        ENERGY$N_GW_kg * 0.60 # $/kgN Treatment of private well water 
      ENERGY$N_Cost_aquaCoast_e = 
        ENERGY$N_coast_kg * 7.11 # $/kgN Recreational use of estuary
      
      COST$N_Cost_Total = 
        rowSums(COST[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                        'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                        'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                        'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                        'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                        'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                        'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                        'N_Cost_aquaCoast_e')], na.rm=T)
      
      COMMUT$N_Cost_Total = 
        rowSums(COMMUT[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                          'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                          'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                          'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                          'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                          'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                          'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                          'N_Cost_aquaCoast_e')], na.rm=T)
      
      ENERGY$N_Cost_Total = 
        rowSums(ENERGY[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                          'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                          'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                          'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                          'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                          'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                          'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                          'N_Cost_aquaCoast_e')], na.rm=T)
      
      # Add back on COMMUTING AND ENERGY
      COST = rbind(COST,COMMUT,ENERGY)
      
      COST_R = COST  
    } # Scenario
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 5 COST_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    
    else if(input$scenario == "Implementing All Scenarios"){
      # COST = COMBO_R_
      # COMMUT = rbind(Commut_Fac_R_,Commut_Staff_R_,Commut_Stud_R_)
      # ENERGY = Energy_R_
      
      COST = COMBO_R_()
      COMMUT = rbind(Commut_Fac_R_(),Commut_Staff_R_(),Commut_Stud_R_())
      ENERGY = Energy_R_()
      
      # Remove the COMMUTING and ENERGY from main dataframe
      COST = COST[COST$Category != 'Commuting',]
      COST = COST[COST$Category != 'On-Campus Stationary Sources',]
      
      
      # Get the dataframes to have same fields
      COST = COST[,c('Scope','Category','Sub_category','Source','Units',
                     'inventory','NOx_MTN','N2O_MTN','OtherN_MTN',
                     'C_Footprint','N_Footprint','Timeframe')]
      COMMUT = COMMUT[,c('Scope','Category','Sub_category','Source','Units',
                         'inventory','NOx_MTN','N2O_MTN','OtherN_MTN',
                         'C_Footprint','N_Footprint','Timeframe')]
      ENERGY = ENERGY[,c('Scope','Category','Sub_category','Source','Units',
                         'inventory','NOx_MTN','N2O_MTN','OtherN_MTN',
                         'C_Footprint','N_Footprint','Timeframe')]
      
      
      #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
      # CARBON COSTS ********************************************************************
      # Jana Compton: For Carbon costs, we recommend using $2-$50 per ton of CO2 equivalent 
      # That covers the range we are using in our paper.  
      # Units of C_Footprint are MT for COST and kg for food data
      COST$C_Cost_min = 2*COST$C_Footprint # Initial Units are MT
      COST$C_Cost_max = 50*COST$C_Footprint # Initial Units are MT
      COST$C_Cost_mid = 30*COST$C_Footprint # Initial Units are MT
      
      COMMUT$C_Cost_min = 2*COMMUT$C_Footprint # Initial Units are MT
      COMMUT$C_Cost_max = 50*COMMUT$C_Footprint # Initial Units are MT
      COMMUT$C_Cost_mid = 30*COMMUT$C_Footprint # Initial Units are MT
      
      ENERGY$C_Cost_min = 2*ENERGY$C_Footprint # Initial Units are MT
      ENERGY$C_Cost_max = 50*ENERGY$C_Footprint # Initial Units are MT
      ENERGY$C_Cost_mid = 30*ENERGY$C_Footprint # Initial Units are MT
      
      # NITROGEN COSTS ******************************************************************
      # Other N  contributs to fertilizer and wastewater inventories, 
      # The fertilizer component can be split into NOx, N2O, NH3, and N to Water 
      # Using the following percentages 20%, 3%, 13%, 21%, respectively
      # Wastewater component contributes to the N to water
      
      # Baseline
      N_Fert_c = 1000*COST[COST$Sub_category == 'Fertilizer' & COST$Timeframe == 'Baseline',]$OtherN_MTN 
      N_Fert_NOx_c = N_Fert_c * 0.2
      N_Fert_N2O_c = N_Fert_c * 0.03
      N_Fert_NH3_c = N_Fert_c * 0.13
      N_Fert_SW_c = N_Fert_c * 0.21 # proportion that goes to SW (Houlton et al. 2013)
      N_Fert_GW_c = N_Fert_c * .79 * .33 # proportion that goes to GW (Sabota et al. 2015)
      N_Fert_coast_c = N_Fert_SW_c * .40 # proportion of SW that goes to coast (Sabota et al. 2015)
      
      # Projected
      N_Fert_p = 1000*COST[COST$Sub_category == 'Fertilizer' & COST$Timeframe == 'Projected',]$OtherN_MTN 
      N_Fert_NOx_p = N_Fert_p * 0.2
      N_Fert_N2O_p = N_Fert_p * 0.03
      N_Fert_NH3_p = N_Fert_p * 0.13
      N_Fert_SW_p = N_Fert_p * 0.21 # proportion that goes to SW (Houlton et al. 2013)
      N_Fert_GW_p = N_Fert_p * .79 * .33 # proportion that goes to GW (Sabota et al. 2015)
      N_Fert_coast_p = N_Fert_SW_p * .40 # proportion of SW that goes to coast (Sabota et al. 2015)
      
      #********************************************************************************
      
      COST1 = COST[COST$Timeframe == 'Baseline',]
      COST2 = COST[COST$Timeframe == 'Projected',]
      
      # Units are MT N2O or NOx - so multiplying by 1000 to convert to kg
      # h = health/social; a = agriculure; e = Ecosystems; c = climate
      COST1$N_Cost_NOx_atm_h = 1000*COST1$NOx_MTN * 32.20 # $/kgN Human respiratory health 
      COST1$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health (zero unless fertilzer - see below)
      COST1$N_Cost_NOx_atm_e = 1000*COST1$NOx_MTN * 0.43 # $/kgN visibility damages 
      COST1$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages (zero unless fertilzer - see below)
      COST1$N_Cost_N2O_atm_c = 1000*COST1$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
      COST1$N_Cost_NOx_atm_c = 1000*COST1$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
      COST1$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits (zero unless fertilzer - see below)
      COST1$N_Cost_NOx_ter_h = 1000*COST1$NOx_MTN * 0.12 # $/kgN Damages to structures  
      COST1$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures (zero unless fertilzer - see below)
      COST1$N_Cost_NOx_ter_a = 1000*COST1$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
      COST1$N_Cost_N2O_ter_a = 1000*COST1$N2O_MTN * 1.48 # $/kgN UV damages to crops 
      COST1$N_Cost_NOx_ter_e = 1000*COST1$NOx_MTN * 1.24 # $/kgN Ozone damages to forests  
      
      COST1$N_Cost_NOx_atm_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 32.20 # $/kgN Human respiratory health
      COST1$N_Cost_NH3_atm_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * 6.87 # $/kgN Human respiratory health 
      COST1$N_Cost_NOx_atm_e[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 0.43 # $/kgN visibility damages 
      COST1$N_Cost_NH3_atm_e[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * 0.43 # $/kgN visibility damages 
      COST1$N_Cost_N2O_atm_c[COST1$Sub_category == 'Fertilizer' ] = N_Fert_N2O_c * 15.07 # $/kgN Greenhouse damages 
      COST1$N_Cost_NOx_atm_c[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * (-5.02) # $/kgN Climate Cooling Benefits
      COST1$N_Cost_NH3_atm_c[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * (-5.02) # $/kgN Climate Cooling Benefits 
      COST1$N_Cost_NOx_ter_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 0.12 # $/kgN Damages to structures
      COST1$N_Cost_NH3_ter_h[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NH3_c * 0.12 # $/kgN Damages to structures
      COST1$N_Cost_NOx_ter_a[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 2.11 # $/kgN Ozone damages to crops  
      COST1$N_Cost_N2O_ter_a[COST1$Sub_category == 'Fertilizer' ] = N_Fert_N2O_c * 1.48 # $/kgN UV damages to crops 
      COST1$N_Cost_NOx_ter_e[COST1$Sub_category == 'Fertilizer' ] = N_Fert_NOx_c * 1.24 # $/kgN Ozone damages to forests  
      
      COST2$N_Cost_NOx_atm_h = 1000*COST2$NOx_MTN * 32.20 # $/kgN Human respiratory health 
      COST2$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health (zero unless fertilzer - see below)
      COST2$N_Cost_NOx_atm_e = 1000*COST2$NOx_MTN * 0.43 # $/kgN visibility damages 
      COST2$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages (zero unless fertilzer - see below)
      COST2$N_Cost_N2O_atm_c = 1000*COST2$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
      COST2$N_Cost_NOx_atm_c = 1000*COST2$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
      COST2$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits (zero unless fertilzer - see below)
      COST2$N_Cost_NOx_ter_h = 1000*COST2$NOx_MTN * 0.12 # $/kgN Damages to structures  
      COST2$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures (zero unless fertilzer - see below)
      COST2$N_Cost_NOx_ter_a = 1000*COST2$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
      COST2$N_Cost_N2O_ter_a = 1000*COST2$N2O_MTN * 1.48 # $/kgN UV damages to crops 
      COST2$N_Cost_NOx_ter_e = 1000*COST2$NOx_MTN * 1.24 # $/kgN Ozone damages to forests  
      
      COST2$N_Cost_NOx_atm_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 32.20 # $/kgN Human respiratory health
      COST2$N_Cost_NH3_atm_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * 6.87 # $/kgN Human respiratory health 
      COST2$N_Cost_NOx_atm_e[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 0.43 # $/kgN visibility damages 
      COST2$N_Cost_NH3_atm_e[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * 0.43 # $/kgN visibility damages 
      COST2$N_Cost_N2O_atm_c[COST2$Sub_category == 'Fertilizer' ] = N_Fert_N2O_p * 15.07 # $/kgN Greenhouse damages 
      COST2$N_Cost_NOx_atm_c[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * (-5.02) # $/kgN Climate Cooling Benefits
      COST2$N_Cost_NH3_atm_c[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * (-5.02) # $/kgN Climate Cooling Benefits 
      COST2$N_Cost_NOx_ter_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 0.12 # $/kgN Damages to structures
      COST2$N_Cost_NH3_ter_h[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NH3_p * 0.12 # $/kgN Damages to structures
      COST2$N_Cost_NOx_ter_a[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 2.11 # $/kgN Ozone damages to crops  
      COST2$N_Cost_N2O_ter_a[COST2$Sub_category == 'Fertilizer' ] = N_Fert_N2O_p * 1.48 # $/kgN UV damages to crops 
      COST2$N_Cost_NOx_ter_e[COST2$Sub_category == 'Fertilizer' ] = N_Fert_NOx_p * 1.24 # $/kgN Ozone damages to forests  
      
      COST = rbind(COST1,COST2)
      
      COST$N_SW_kg = 0.21 * 1000*(rowSums(COST[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # all N sources (not N2O), # proportion that goes to SW (Houlton et al. 2013)
      COST$N_GW_kg = 0.79 * .33 * 1000*(rowSums(COST[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # proportion that goes to GW (Sabota et al. 2015) 
      COST$N_coast_kg = .40 * COST$N_SW_kg # proportion of SW that goes to coast (Sabota et al. 2015)
      
      COST1 = COST[COST$Timeframe == 'Baseline',]
      COST2 = COST[COST$Timeframe == 'Projected',]
      
      COST1$N_SW_kg[COST1$Sub_category == 'Fertilizer' ] = N_Fert_SW_c
      COST1$N_GW_kg[COST1$Sub_category == 'Fertilizer' ] = N_Fert_GW_c 
      COST1$N_coast_kg[COST1$Sub_category == 'Fertilizer' ] = N_Fert_coast_c 
      COST2$N_SW_kg[COST2$Sub_category == 'Fertilizer' ] = N_Fert_SW_p
      COST2$N_GW_kg[COST2$Sub_category == 'Fertilizer' ] = N_Fert_GW_p 
      COST2$N_coast_kg[COST2$Sub_category == 'Fertilizer' ] = N_Fert_coast_p 
      
      COST = rbind(COST1,COST2)
      
      # Update below 
      COST$N_Cost_aquaFresh_e = 
        COST$N_SW_kg * 0.23 + # $/kgN Lake waterfront property values
        COST$N_SW_kg * 0.19 + # $/kgN Recreational Freshwater use
        COST$N_SW_kg * 0.01 # $/kgN Endangered species protection
      COST$N_Cost_aquaGround_h = 
        COST$N_GW_kg * 0.15 + # $/kgN Replacement with bottled water
        COST$N_GW_kg * 0.60 # $/kgN Treatment of private well water 
      COST$N_Cost_aquaCoast_e = 
        COST$N_coast_kg * 7.11 # $/kgN Recreational use of estuary
      
      
      # No NH3 emissions factor data for Commuting
      COMMUT$N_Cost_NOx_atm_h = 1000*COMMUT$NOx_MTN * 32.20 # $/kgN Human respiratory health 
      COMMUT$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health 
      COMMUT$N_Cost_NOx_atm_e = 1000*COMMUT$NOx_MTN * 0.43 # $/kgN visibility damages 
      COMMUT$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages 
      COMMUT$N_Cost_N2O_atm_c = 1000*COMMUT$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
      COMMUT$N_Cost_NOx_atm_c = 1000*COMMUT$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
      COMMUT$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits 
      COMMUT$N_Cost_NOx_ter_h = 1000*COMMUT$NOx_MTN * 0.12 # $/kgN Damages to structures  
      COMMUT$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures  
      COMMUT$N_Cost_NOx_ter_a = 1000*COMMUT$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
      COMMUT$N_Cost_N2O_ter_a = 1000*COMMUT$N2O_MTN * 1.48 # $/kgN UV damages to crops 
      COMMUT$N_Cost_NOx_ter_e = 1000*COMMUT$NOx_MTN * 1.24 # $/kgN Ozone damages to forests
      
      # No NH3 emissions factor data for Energy sources
      ENERGY$N_Cost_NOx_atm_h = 1000*ENERGY$NOx_MTN * 32.20 # $/kgN Human respiratory health 
      ENERGY$N_Cost_NH3_atm_h = 0 * 6.87 # $/kgN Human respiratory health 
      ENERGY$N_Cost_NOx_atm_e = 1000*ENERGY$NOx_MTN * 0.43 # $/kgN visibility damages 
      ENERGY$N_Cost_NH3_atm_e = 0 * 0.43 # $/kgN visibility damages 
      ENERGY$N_Cost_N2O_atm_c = 1000*ENERGY$N2O_MTN * 15.07 # $/kgN Greenhouse damages 
      ENERGY$N_Cost_NOx_atm_c = 1000*ENERGY$NOx_MTN * (-5.02) # $/kgN Climate Cooling Benefits 
      ENERGY$N_Cost_NH3_atm_c = 0 * (-5.02) # $/kgN Climate Cooling Benefits 
      ENERGY$N_Cost_NOx_ter_h = 1000*ENERGY$NOx_MTN * 0.12 # $/kgN Damages to structures  
      ENERGY$N_Cost_NH3_ter_h = 0 * 0.12 # $/kgN Damages to structures  
      ENERGY$N_Cost_NOx_ter_a = 1000*ENERGY$NOx_MTN * 2.11 # $/kgN Ozone damages to crops  
      ENERGY$N_Cost_N2O_ter_a = 1000*ENERGY$N2O_MTN * 1.48 # $/kgN UV damages to crops 
      ENERGY$N_Cost_NOx_ter_e = 1000*ENERGY$NOx_MTN * 1.24 # $/kgN Ozone damages to forests
      
      COMMUT$N_SW_kg = 0.21 * 1000*(rowSums(COMMUT[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # all N sources (not N2O), # proportion that goes to SW (Houlton et al. 2013)
      COMMUT$N_GW_kg = 0.79 * .33 *  1000*(rowSums(COMMUT[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # proportion that goes to GW (Sabota et al. 2015) 
      COMMUT$N_coast_kg = 0.40 * COMMUT$N_SW_kg # proportion of SW that goes to coast (Sabota et al. 2015)
      
      ENERGY$N_SW_kg = 0.21 * 1000*(rowSums(ENERGY[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # all N sources (not N2O),  # proportion that goes to SW (Houlton et al. 2013)
      ENERGY$N_GW_kg = 0.79 * .33 *  1000*(rowSums(ENERGY[,c('NOx_MTN','OtherN_MTN')],na.rm=T)) # proportion that goes to GW (Sabota et al. 2015) 
      ENERGY$N_coast_kg = 0.40 * ENERGY$N_SW_kg # proportion of SW that goes to coast (Sabota et al. 2015)
      
      COMMUT$N_Cost_aquaFresh_e = 
        COMMUT$N_SW_kg * 0.23 + # $/kgN Lake waterfront property values
        COMMUT$N_SW_kg * 0.19 + # $/kgN Recreational Freshwater use
        COMMUT$N_SW_kg * 0.01 # $/kgN Endangered species protection
      COMMUT$N_Cost_aquaGround_h = 
        COMMUT$N_GW_kg * 0.15 + # $/kgN Replacement with bottled water
        COMMUT$N_GW_kg * 0.60 # $/kgN Treatment of private well water 
      COMMUT$N_Cost_aquaCoast_e = 
        COMMUT$N_coast_kg * 7.11 # $/kgN Recreational use of estuary
      
      ENERGY$N_Cost_aquaFresh_e = 
        ENERGY$N_SW_kg * 0.23 + # $/kgN Lake waterfront property values
        ENERGY$N_SW_kg * 0.19 + # $/kgN Recreational Freshwater use
        ENERGY$N_SW_kg * 0.01 # $/kgN Endangered species protection
      ENERGY$N_Cost_aquaGround_h = 
        ENERGY$N_GW_kg * 0.15 + # $/kgN Replacement with bottled water
        ENERGY$N_GW_kg * 0.60 # $/kgN Treatment of private well water 
      ENERGY$N_Cost_aquaCoast_e = 
        ENERGY$N_coast_kg * 7.11 # $/kgN Recreational use of estuary
      
      COST$N_Cost_Total = 
        rowSums(COST[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                        'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                        'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                        'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                        'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                        'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                        'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                        'N_Cost_aquaCoast_e')], na.rm=T)
      
      COMMUT$N_Cost_Total = 
        rowSums(COMMUT[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                          'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                          'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                          'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                          'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                          'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                          'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                          'N_Cost_aquaCoast_e')], na.rm=T)
      
      ENERGY$N_Cost_Total = 
        rowSums(ENERGY[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                          'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                          'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                          'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                          'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                          'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                          'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                          'N_Cost_aquaCoast_e')], na.rm=T)
      
      # Add back on COMMUTING AND ENERGY
      COST = rbind(COST,COMMUT,ENERGY)
      
      COST_R = COST  
    } # Scenario
    
  }) # reactive 
  
  FOOD_COST_R <- reactive({
    
    # # Campus Vs. Individual
    # if(input$campusVindividual == "Campus"){
    #   uva = uva_R()
    #   food = food
    # }
    # 
    # else if(input$campusVindividual == "Individual"){
    #   uva = uva_individual
    #   food = food_individual
    # }
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 0
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    if(input$scenario == "Manual Scenario"){
    FOOD = FOOD_R()
    
    # C Costs
    # Jana Compton: For Carbon costs, we recommend using $2-$50 per ton of CO2 equivalent 
    # That covers the range we are using in our paper.  
    # Units of C_Footprint are MT for COST and kg for food data
    FOOD$C_Cost_min = 2*FOOD$C_Footprint/1000 # Initial Units are kg
    FOOD$C_Cost_max = 50*FOOD$C_Footprint/1000 # Initial Units are kg
    FOOD$C_Cost_mid = 30*FOOD$C_Footprint/1000 # Initial Units are kg
    
    # N Costs
    #Food footprint is in kg N
    FOOD$N_NOx = FOOD$N_virtual* 0.20 # Virtual N Emission conribution
    FOOD$N_N2O = FOOD$N_virtual * 0.03 # Virtual N Emission conribution
    FOOD$N_NH3 = FOOD$N_virtual * 0.13 # Virtual N Emission conribution
    FOOD$N_SW = FOOD$N_virtual * 0.21 # Virtual N to water (Houlton et al. 2013)
    FOOD$N_GW = FOOD$N_virtual * .79 * .33 # N to groundwater (Sabota et al. 2015)
    FOOD$N_Coast = FOOD$N_SW * .40 # N to coast water (Sabota et al. 2015)
    
    FOOD$N_Cost_NOx_atm_h = FOOD$N_NOx * 32.20 # $/kgN Human respiratory health 
    FOOD$N_Cost_NH3_atm_h = FOOD$N_NH3 * 6.87 # $/kgN Human respiratory health 
    FOOD$N_Cost_NOx_atm_e = FOOD$N_NOx * 0.43 # $/kgN visibility damages 
    FOOD$N_Cost_NH3_atm_e = FOOD$N_NH3 * 0.43 # $/kgN visibility damages 
    FOOD$N_Cost_N2O_atm_c = FOOD$N_N2O * 15.07 # $/kgN Greenhouse damages 
    FOOD$N_Cost_NOx_atm_c = FOOD$N_NOx * (-5.02) # $/kgN Climate Cooling Benefits 
    FOOD$N_Cost_NH3_atm_c = FOOD$N_NH3 * (-5.02) # $/kgN Climate Cooling Benefits 
    FOOD$N_Cost_NOx_ter_h = FOOD$N_NOx * 0.12 # $/kgN Damages to structures  
    FOOD$N_Cost_NH3_ter_h = FOOD$N_NH3 * 0.12 # $/kgN Damages to structures  
    FOOD$N_Cost_NOx_ter_a = FOOD$N_NOx * 2.11 # $/kgN Ozone damages to crops  
    FOOD$N_Cost_N2O_ter_a = FOOD$N_N2O * 1.48 # $/kgN UV damages to crops 
    FOOD$N_Cost_NOx_ter_e = FOOD$N_NOx * 1.24 # $/kgN Ozone damages to forests  
    
    FOOD$N_Cost_aquaFresh_e = 
      FOOD$N_SW * 0.23 + # $/kgN Lake waterfront property values
      FOOD$N_SW * 0.19 + # $/kgN Recreational Freshwater use
      FOOD$N_SW * 0.01 # $/kgN Endangered species protection
    FOOD$N_Cost_aquaGround_h = 
      FOOD$N_GW * 0.15 + # $/kgN Replacement with bottled water
      FOOD$N_GW * 0.60 # $/kgN Treatment of private well water 
    FOOD$N_Cost_aquaCoast_e = 
      FOOD$N_Coast * 7.11 # $/kgN Recreational use of estuary
    
    FOOD$N_Cost_water =  FOOD$N_Cost_aquaFresh_e + FOOD$N_Cost_aquaGround_h + FOOD$N_Cost_aquaCoast_e
    
    FOOD$N_Cost_virtual =  # = Food Production Value, previously labeled as N_Cost_Total
      rowSums(FOOD[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                      'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                      'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                      'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                      'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                      'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                      'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                      'N_Cost_aquaCoast_e')], na.rm=T)
    
    # DOn't need to calculate  food waste, don't have the right data
    #costs = 39.07+0.43+10.05+0.12+3.59+1.24+0.43+0.75+7.11
    #FOOD$N_Cost_waste = FOOD$N_waste * costs  # for Food Waste Calculation
    #FOOD$N_Cost_virtual = FOOD$N_virtual * costs # for Food production calculation
    
    FOOD_COST_R = FOOD  
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 1 FOOD_COST_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Business as Usual Growth to 2025"){
      FOOD = FOOD_R()
    
    # C Costs
    # Jana Compton: For Carbon costs, we recommend using $2-$50 per ton of CO2 equivalent 
    # That covers the range we are using in our paper.  
    # Units of C_Footprint are MT for COST and kg for food data
    FOOD$C_Cost_min = 2*FOOD$C_Footprint/1000 # Initial Units are kg
    FOOD$C_Cost_max = 50*FOOD$C_Footprint/1000 # Initial Units are kg
    FOOD$C_Cost_mid = 30*FOOD$C_Footprint/1000 # Initial Units are kg
    
    # N Costs
    #Food footprint is in kg N
    FOOD$N_NOx = FOOD$N_virtual* 0.20 # Virtual N Emission conribution
    FOOD$N_N2O = FOOD$N_virtual * 0.03 # Virtual N Emission conribution
    FOOD$N_NH3 = FOOD$N_virtual * 0.13 # Virtual N Emission conribution
    FOOD$N_SW = FOOD$N_virtual * 0.21 # Virtual N to water (Houlton et al. 2013)
    FOOD$N_GW = FOOD$N_virtual * .79 * .33 # N to groundwater (Sabota et al. 2015)
    FOOD$N_Coast = FOOD$N_SW * .40 # N to coast water (Sabota et al. 2015)
    
    FOOD$N_Cost_NOx_atm_h = FOOD$N_NOx * 32.20 # $/kgN Human respiratory health 
    FOOD$N_Cost_NH3_atm_h = FOOD$N_NH3 * 6.87 # $/kgN Human respiratory health 
    FOOD$N_Cost_NOx_atm_e = FOOD$N_NOx * 0.43 # $/kgN visibility damages 
    FOOD$N_Cost_NH3_atm_e = FOOD$N_NH3 * 0.43 # $/kgN visibility damages 
    FOOD$N_Cost_N2O_atm_c = FOOD$N_N2O * 15.07 # $/kgN Greenhouse damages 
    FOOD$N_Cost_NOx_atm_c = FOOD$N_NOx * (-5.02) # $/kgN Climate Cooling Benefits 
    FOOD$N_Cost_NH3_atm_c = FOOD$N_NH3 * (-5.02) # $/kgN Climate Cooling Benefits 
    FOOD$N_Cost_NOx_ter_h = FOOD$N_NOx * 0.12 # $/kgN Damages to structures  
    FOOD$N_Cost_NH3_ter_h = FOOD$N_NH3 * 0.12 # $/kgN Damages to structures  
    FOOD$N_Cost_NOx_ter_a = FOOD$N_NOx * 2.11 # $/kgN Ozone damages to crops  
    FOOD$N_Cost_N2O_ter_a = FOOD$N_N2O * 1.48 # $/kgN UV damages to crops 
    FOOD$N_Cost_NOx_ter_e = FOOD$N_NOx * 1.24 # $/kgN Ozone damages to forests  
    
    FOOD$N_Cost_aquaFresh_e = 
      FOOD$N_SW * 0.23 + # $/kgN Lake waterfront property values
      FOOD$N_SW * 0.19 + # $/kgN Recreational Freshwater use
      FOOD$N_SW * 0.01 # $/kgN Endangered species protection
    FOOD$N_Cost_aquaGround_h = 
      FOOD$N_GW * 0.15 + # $/kgN Replacement with bottled water
      FOOD$N_GW * 0.60 # $/kgN Treatment of private well water 
    FOOD$N_Cost_aquaCoast_e = 
      FOOD$N_Coast * 7.11 # $/kgN Recreational use of estuary
    
    FOOD$N_Cost_water =  FOOD$N_Cost_aquaFresh_e + FOOD$N_Cost_aquaGround_h + FOOD$N_Cost_aquaCoast_e
    
    FOOD$N_Cost_virtual =  # = Food Production Value, previously labeled as N_Cost_Total
      rowSums(FOOD[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                      'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                      'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                      'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                      'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                      'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                      'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                      'N_Cost_aquaCoast_e')], na.rm=T)
    
    # DOn't need to calculate  food waste, don't have the right data
    #costs = 39.07+0.43+10.05+0.12+3.59+1.24+0.43+0.75+7.11
    #FOOD$N_Cost_waste = FOOD$N_waste * costs  # for Food Waste Calculation
    #FOOD$N_Cost_virtual = FOOD$N_virtual * costs # for Food production calculation
    
    FOOD_COST_R = FOOD   
  } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 2 FOOD_COST_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "15% Vegetarian Meals"){
      FOOD = FOOD_R()
      
      # C Costs
      # Jana Compton: For Carbon costs, we recommend using $2-$50 per ton of CO2 equivalent 
      # That covers the range we are using in our paper.  
      # Units of C_Footprint are MT for COST and kg for food data
      FOOD$C_Cost_min = 2*FOOD$C_Footprint/1000 # Initial Units are kg
      FOOD$C_Cost_max = 50*FOOD$C_Footprint/1000 # Initial Units are kg
      FOOD$C_Cost_mid = 30*FOOD$C_Footprint/1000 # Initial Units are kg
      
      # N Costs
      #Food footprint is in kg N
      FOOD$N_NOx = FOOD$N_virtual* 0.20 # Virtual N Emission conribution
      FOOD$N_N2O = FOOD$N_virtual * 0.03 # Virtual N Emission conribution
      FOOD$N_NH3 = FOOD$N_virtual * 0.13 # Virtual N Emission conribution
      FOOD$N_SW = FOOD$N_virtual * 0.21 # Virtual N to water (Houlton et al. 2013)
      FOOD$N_GW = FOOD$N_virtual * .79 * .33 # N to groundwater (Sabota et al. 2015)
      FOOD$N_Coast = FOOD$N_SW * .40 # N to coast water (Sabota et al. 2015)
      
      FOOD$N_Cost_NOx_atm_h = FOOD$N_NOx * 32.20 # $/kgN Human respiratory health 
      FOOD$N_Cost_NH3_atm_h = FOOD$N_NH3 * 6.87 # $/kgN Human respiratory health 
      FOOD$N_Cost_NOx_atm_e = FOOD$N_NOx * 0.43 # $/kgN visibility damages 
      FOOD$N_Cost_NH3_atm_e = FOOD$N_NH3 * 0.43 # $/kgN visibility damages 
      FOOD$N_Cost_N2O_atm_c = FOOD$N_N2O * 15.07 # $/kgN Greenhouse damages 
      FOOD$N_Cost_NOx_atm_c = FOOD$N_NOx * (-5.02) # $/kgN Climate Cooling Benefits 
      FOOD$N_Cost_NH3_atm_c = FOOD$N_NH3 * (-5.02) # $/kgN Climate Cooling Benefits 
      FOOD$N_Cost_NOx_ter_h = FOOD$N_NOx * 0.12 # $/kgN Damages to structures  
      FOOD$N_Cost_NH3_ter_h = FOOD$N_NH3 * 0.12 # $/kgN Damages to structures  
      FOOD$N_Cost_NOx_ter_a = FOOD$N_NOx * 2.11 # $/kgN Ozone damages to crops  
      FOOD$N_Cost_N2O_ter_a = FOOD$N_N2O * 1.48 # $/kgN UV damages to crops 
      FOOD$N_Cost_NOx_ter_e = FOOD$N_NOx * 1.24 # $/kgN Ozone damages to forests  
      
      FOOD$N_Cost_aquaFresh_e = 
        FOOD$N_SW * 0.23 + # $/kgN Lake waterfront property values
        FOOD$N_SW * 0.19 + # $/kgN Recreational Freshwater use
        FOOD$N_SW * 0.01 # $/kgN Endangered species protection
      FOOD$N_Cost_aquaGround_h = 
        FOOD$N_GW * 0.15 + # $/kgN Replacement with bottled water
        FOOD$N_GW * 0.60 # $/kgN Treatment of private well water 
      FOOD$N_Cost_aquaCoast_e = 
        FOOD$N_Coast * 7.11 # $/kgN Recreational use of estuary
      
      FOOD$N_Cost_water =  FOOD$N_Cost_aquaFresh_e + FOOD$N_Cost_aquaGround_h + FOOD$N_Cost_aquaCoast_e
      
      FOOD$N_Cost_virtual =  # = Food Production Value, previously labeled as N_Cost_Total
        rowSums(FOOD[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                        'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                        'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                        'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                        'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                        'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                        'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                        'N_Cost_aquaCoast_e')], na.rm=T)
      
      # DOn't need to calculate  food waste, don't have the right data
      #costs = 39.07+0.43+10.05+0.12+3.59+1.24+0.43+0.75+7.11
      #FOOD$N_Cost_waste = FOOD$N_waste * costs  # for Food Waste Calculation
      #FOOD$N_Cost_virtual = FOOD$N_virtual * costs # for Food production calculation
      
      FOOD_COST_R = FOOD   
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 3 FOOD_COST_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Replacement of 20% beef with Chicken"){
      FOOD = FOOD_R()
      
      # C Costs
      # Jana Compton: For Carbon costs, we recommend using $2-$50 per ton of CO2 equivalent 
      # That covers the range we are using in our paper.  
      # Units of C_Footprint are MT for COST and kg for food data
      FOOD$C_Cost_min = 2*FOOD$C_Footprint/1000 # Initial Units are kg
      FOOD$C_Cost_max = 50*FOOD$C_Footprint/1000 # Initial Units are kg
      FOOD$C_Cost_mid = 30*FOOD$C_Footprint/1000 # Initial Units are kg
      
      # N Costs
      #Food footprint is in kg N
      FOOD$N_NOx = FOOD$N_virtual* 0.20 # Virtual N Emission conribution
      FOOD$N_N2O = FOOD$N_virtual * 0.03 # Virtual N Emission conribution
      FOOD$N_NH3 = FOOD$N_virtual * 0.13 # Virtual N Emission conribution
      FOOD$N_SW = FOOD$N_virtual * 0.21 # Virtual N to water (Houlton et al. 2013)
      FOOD$N_GW = FOOD$N_virtual * .79 * .33 # N to groundwater (Sabota et al. 2015)
      FOOD$N_Coast = FOOD$N_SW * .40 # N to coast water (Sabota et al. 2015)
      
      FOOD$N_Cost_NOx_atm_h = FOOD$N_NOx * 32.20 # $/kgN Human respiratory health 
      FOOD$N_Cost_NH3_atm_h = FOOD$N_NH3 * 6.87 # $/kgN Human respiratory health 
      FOOD$N_Cost_NOx_atm_e = FOOD$N_NOx * 0.43 # $/kgN visibility damages 
      FOOD$N_Cost_NH3_atm_e = FOOD$N_NH3 * 0.43 # $/kgN visibility damages 
      FOOD$N_Cost_N2O_atm_c = FOOD$N_N2O * 15.07 # $/kgN Greenhouse damages 
      FOOD$N_Cost_NOx_atm_c = FOOD$N_NOx * (-5.02) # $/kgN Climate Cooling Benefits 
      FOOD$N_Cost_NH3_atm_c = FOOD$N_NH3 * (-5.02) # $/kgN Climate Cooling Benefits 
      FOOD$N_Cost_NOx_ter_h = FOOD$N_NOx * 0.12 # $/kgN Damages to structures  
      FOOD$N_Cost_NH3_ter_h = FOOD$N_NH3 * 0.12 # $/kgN Damages to structures  
      FOOD$N_Cost_NOx_ter_a = FOOD$N_NOx * 2.11 # $/kgN Ozone damages to crops  
      FOOD$N_Cost_N2O_ter_a = FOOD$N_N2O * 1.48 # $/kgN UV damages to crops 
      FOOD$N_Cost_NOx_ter_e = FOOD$N_NOx * 1.24 # $/kgN Ozone damages to forests  
      
      FOOD$N_Cost_aquaFresh_e = 
        FOOD$N_SW * 0.23 + # $/kgN Lake waterfront property values
        FOOD$N_SW * 0.19 + # $/kgN Recreational Freshwater use
        FOOD$N_SW * 0.01 # $/kgN Endangered species protection
      FOOD$N_Cost_aquaGround_h = 
        FOOD$N_GW * 0.15 + # $/kgN Replacement with bottled water
        FOOD$N_GW * 0.60 # $/kgN Treatment of private well water 
      FOOD$N_Cost_aquaCoast_e = 
        FOOD$N_Coast * 7.11 # $/kgN Recreational use of estuary
      
      FOOD$N_Cost_water =  FOOD$N_Cost_aquaFresh_e + FOOD$N_Cost_aquaGround_h + FOOD$N_Cost_aquaCoast_e
      
      FOOD$N_Cost_virtual =  # = Food Production Value, previously labeled as N_Cost_Total
        rowSums(FOOD[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                        'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                        'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                        'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                        'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                        'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                        'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                        'N_Cost_aquaCoast_e')], na.rm=T)
      
      # DOn't need to calculate  food waste, don't have the right data
      #costs = 39.07+0.43+10.05+0.12+3.59+1.24+0.43+0.75+7.11
      #FOOD$N_Cost_waste = FOOD$N_waste * costs  # for Food Waste Calculation
      #FOOD$N_Cost_virtual = FOOD$N_virtual * costs # for Food production calculation
      
      FOOD_COST_R = FOOD   
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 4 FOOD_COST_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Fuel Optimization"){
      FOOD = FOOD_R()
      
      # C Costs
      # Jana Compton: For Carbon costs, we recommend using $2-$50 per ton of CO2 equivalent 
      # That covers the range we are using in our paper.  
      # Units of C_Footprint are MT for COST and kg for food data
      FOOD$C_Cost_min = 2*FOOD$C_Footprint/1000 # Initial Units are kg
      FOOD$C_Cost_max = 50*FOOD$C_Footprint/1000 # Initial Units are kg
      FOOD$C_Cost_mid = 30*FOOD$C_Footprint/1000 # Initial Units are kg
      
      # N Costs
      #Food footprint is in kg N
      FOOD$N_NOx = FOOD$N_virtual* 0.20 # Virtual N Emission conribution
      FOOD$N_N2O = FOOD$N_virtual * 0.03 # Virtual N Emission conribution
      FOOD$N_NH3 = FOOD$N_virtual * 0.13 # Virtual N Emission conribution
      FOOD$N_SW = FOOD$N_virtual * 0.21 # Virtual N to water (Houlton et al. 2013)
      FOOD$N_GW = FOOD$N_virtual * .79 * .33 # N to groundwater (Sabota et al. 2015)
      FOOD$N_Coast = FOOD$N_SW * .40 # N to coast water (Sabota et al. 2015)
      
      FOOD$N_Cost_NOx_atm_h = FOOD$N_NOx * 32.20 # $/kgN Human respiratory health 
      FOOD$N_Cost_NH3_atm_h = FOOD$N_NH3 * 6.87 # $/kgN Human respiratory health 
      FOOD$N_Cost_NOx_atm_e = FOOD$N_NOx * 0.43 # $/kgN visibility damages 
      FOOD$N_Cost_NH3_atm_e = FOOD$N_NH3 * 0.43 # $/kgN visibility damages 
      FOOD$N_Cost_N2O_atm_c = FOOD$N_N2O * 15.07 # $/kgN Greenhouse damages 
      FOOD$N_Cost_NOx_atm_c = FOOD$N_NOx * (-5.02) # $/kgN Climate Cooling Benefits 
      FOOD$N_Cost_NH3_atm_c = FOOD$N_NH3 * (-5.02) # $/kgN Climate Cooling Benefits 
      FOOD$N_Cost_NOx_ter_h = FOOD$N_NOx * 0.12 # $/kgN Damages to structures  
      FOOD$N_Cost_NH3_ter_h = FOOD$N_NH3 * 0.12 # $/kgN Damages to structures  
      FOOD$N_Cost_NOx_ter_a = FOOD$N_NOx * 2.11 # $/kgN Ozone damages to crops  
      FOOD$N_Cost_N2O_ter_a = FOOD$N_N2O * 1.48 # $/kgN UV damages to crops 
      FOOD$N_Cost_NOx_ter_e = FOOD$N_NOx * 1.24 # $/kgN Ozone damages to forests  
      
      FOOD$N_Cost_aquaFresh_e = 
        FOOD$N_SW * 0.23 + # $/kgN Lake waterfront property values
        FOOD$N_SW * 0.19 + # $/kgN Recreational Freshwater use
        FOOD$N_SW * 0.01 # $/kgN Endangered species protection
      FOOD$N_Cost_aquaGround_h = 
        FOOD$N_GW * 0.15 + # $/kgN Replacement with bottled water
        FOOD$N_GW * 0.60 # $/kgN Treatment of private well water 
      FOOD$N_Cost_aquaCoast_e = 
        FOOD$N_Coast * 7.11 # $/kgN Recreational use of estuary
      
      FOOD$N_Cost_water =  FOOD$N_Cost_aquaFresh_e + FOOD$N_Cost_aquaGround_h + FOOD$N_Cost_aquaCoast_e
      
      FOOD$N_Cost_virtual =  # = Food Production Value, previously labeled as N_Cost_Total
        rowSums(FOOD[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                        'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                        'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                        'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                        'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                        'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                        'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                        'N_Cost_aquaCoast_e')], na.rm=T)
      
      # DOn't need to calculate  food waste, don't have the right data
      #costs = 39.07+0.43+10.05+0.12+3.59+1.24+0.43+0.75+7.11
      #FOOD$N_Cost_waste = FOOD$N_waste * costs  # for Food Waste Calculation
      #FOOD$N_Cost_virtual = FOOD$N_virtual * costs # for Food production calculation
      
      FOOD_COST_R = FOOD   
    } # Scenario 
    
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    # Scenario section 5 FOOD_COST_R
    #>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
    else if(input$scenario == "Implementing All Scenarios"){
      FOOD = FOOD_R()
      
      # C Costs
      # Jana Compton: For Carbon costs, we recommend using $2-$50 per ton of CO2 equivalent 
      # That covers the range we are using in our paper.  
      # Units of C_Footprint are MT for COST and kg for food data
      FOOD$C_Cost_min = 2*FOOD$C_Footprint/1000 # Initial Units are kg
      FOOD$C_Cost_max = 50*FOOD$C_Footprint/1000 # Initial Units are kg
      FOOD$C_Cost_mid = 30*FOOD$C_Footprint/1000 # Initial Units are kg
      
      # N Costs
      #Food footprint is in kg N
      FOOD$N_NOx = FOOD$N_virtual* 0.20 # Virtual N Emission conribution
      FOOD$N_N2O = FOOD$N_virtual * 0.03 # Virtual N Emission conribution
      FOOD$N_NH3 = FOOD$N_virtual * 0.13 # Virtual N Emission conribution
      FOOD$N_SW = FOOD$N_virtual * 0.21 # Virtual N to water (Houlton et al. 2013)
      FOOD$N_GW = FOOD$N_virtual * .79 * .33 # N to groundwater (Sabota et al. 2015)
      FOOD$N_Coast = FOOD$N_SW * .40 # N to coast water (Sabota et al. 2015)
      
      FOOD$N_Cost_NOx_atm_h = FOOD$N_NOx * 32.20 # $/kgN Human respiratory health 
      FOOD$N_Cost_NH3_atm_h = FOOD$N_NH3 * 6.87 # $/kgN Human respiratory health 
      FOOD$N_Cost_NOx_atm_e = FOOD$N_NOx * 0.43 # $/kgN visibility damages 
      FOOD$N_Cost_NH3_atm_e = FOOD$N_NH3 * 0.43 # $/kgN visibility damages 
      FOOD$N_Cost_N2O_atm_c = FOOD$N_N2O * 15.07 # $/kgN Greenhouse damages 
      FOOD$N_Cost_NOx_atm_c = FOOD$N_NOx * (-5.02) # $/kgN Climate Cooling Benefits 
      FOOD$N_Cost_NH3_atm_c = FOOD$N_NH3 * (-5.02) # $/kgN Climate Cooling Benefits 
      FOOD$N_Cost_NOx_ter_h = FOOD$N_NOx * 0.12 # $/kgN Damages to structures  
      FOOD$N_Cost_NH3_ter_h = FOOD$N_NH3 * 0.12 # $/kgN Damages to structures  
      FOOD$N_Cost_NOx_ter_a = FOOD$N_NOx * 2.11 # $/kgN Ozone damages to crops  
      FOOD$N_Cost_N2O_ter_a = FOOD$N_N2O * 1.48 # $/kgN UV damages to crops 
      FOOD$N_Cost_NOx_ter_e = FOOD$N_NOx * 1.24 # $/kgN Ozone damages to forests  
      
      FOOD$N_Cost_aquaFresh_e = 
        FOOD$N_SW * 0.23 + # $/kgN Lake waterfront property values
        FOOD$N_SW * 0.19 + # $/kgN Recreational Freshwater use
        FOOD$N_SW * 0.01 # $/kgN Endangered species protection
      FOOD$N_Cost_aquaGround_h = 
        FOOD$N_GW * 0.15 + # $/kgN Replacement with bottled water
        FOOD$N_GW * 0.60 # $/kgN Treatment of private well water 
      FOOD$N_Cost_aquaCoast_e = 
        FOOD$N_Coast * 7.11 # $/kgN Recreational use of estuary
      
      FOOD$N_Cost_water =  FOOD$N_Cost_aquaFresh_e + FOOD$N_Cost_aquaGround_h + FOOD$N_Cost_aquaCoast_e
      
      FOOD$N_Cost_virtual =  # = Food Production Value, previously labeled as N_Cost_Total
        rowSums(FOOD[,c('N_Cost_NOx_atm_h', 'N_Cost_NH3_atm_h', 
                        'N_Cost_NOx_atm_e', 'N_Cost_NH3_atm_e',
                        'N_Cost_N2O_atm_c', 'N_Cost_NOx_atm_c', 
                        'N_Cost_NH3_atm_c', 'N_Cost_NOx_ter_h', 
                        'N_Cost_NH3_ter_h', 'N_Cost_NOx_ter_a',
                        'N_Cost_N2O_ter_a', 'N_Cost_NOx_ter_e', 
                        'N_Cost_aquaFresh_e', 'N_Cost_aquaGround_h', 
                        'N_Cost_aquaCoast_e')], na.rm=T)
      
      # DOn't need to calculate  food waste, don't have the right data
      #costs = 39.07+0.43+10.05+0.12+3.59+1.24+0.43+0.75+7.11
      #FOOD$N_Cost_waste = FOOD$N_waste * costs  # for Food Waste Calculation
      #FOOD$N_Cost_virtual = FOOD$N_virtual * costs # for Food production calculation
      
      FOOD_COST_R = FOOD   
    } # Scenario 
    
  }) # reactive
  
  
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  # STEP_16 >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  #**************************************************************************************************
  # PLOTS
  #**************************************************************************************************
  
  
  output$INVENT_TABLE1 <- DT::renderDataTable({

    #TABLE_R
    temp1_ = TABLE_R()[TABLE_R()$Timeframe == 'Baseline',]
    temp2_ = TABLE_R()[TABLE_R()$Timeframe == 'Projected',]
    # temp1_ = TABLE_R[TABLE_R$Timeframe == 'Baseline',]
    # temp2_ = TABLE_R[TABLE_R$Timeframe == 'Projected',]
    
    #temp1_ = COMBO_R_()[COMBO_R_()$Timeframe == 'Baseline',]
    #temp2_ = COMBO_R_()[COMBO_R_()$Timeframe == 'Projected',]
    # temp1_ = COMBO_R_[COMBO_R_$Timeframe == 'Baseline',]
    # temp2_ = COMBO_R_[COMBO_R_$Timeframe == 'Projected',]
    temp1 = temp1_[,c('Category','Sub_category','Source','Units','inventory')] 
    temp2 = temp2_[,c('Category','Sub_category','Source','Units','inventory')] 
    
    
    
    ##################################################################################
    # Get the Commuting and Energy Tables from Separate Reactive Sections
    # commut_fac2 = COMMUTING_FAC_TABLE_R[COMMUTING_FAC_TABLE_R$Timeframe == 'Projected',]
    # commut_staf2 = COMMUTING_STAFF_TABLE_R[COMMUTING_STAFF_TABLE_R$Timeframe == 'Projected',]
    # commut_stud2 = COMMUTING_STUD_TABLE_R[COMMUTING_STUD_TABLE_R$Timeframe == 'Projected',]
    # energy2 = ENERGY_TABLE_R[ENERGY_TABLE_R$Timeframe == 'Projected',]
    
    commut_fac2 = COMMUTING_FAC_TABLE_R()[COMMUTING_FAC_TABLE_R()$Timeframe == 'Projected',]
    commut_staf2 = COMMUTING_STAFF_TABLE_R()[COMMUTING_STAFF_TABLE_R()$Timeframe == 'Projected',]
    commut_stud2 = COMMUTING_STUD_TABLE_R()[COMMUTING_STUD_TABLE_R()$Timeframe == 'Projected',]
    energy2 = ENERGY_TABLE_R()[ENERGY_TABLE_R()$Timeframe == 'Projected',]
   
    # Get the Projected Inventory Value
    fac_auto = commut_fac2[commut_fac2$Source == "Automobile",]$inventory
    fac_Bike = commut_fac2[commut_fac2$Source == "Bike",]$inventory
    fac_carp = commut_fac2[commut_fac2$Source == "Carpool",]$inventory
    fac_Pbus = commut_fac2[commut_fac2$Source == "Public Bus",]$inventory
    fac_walk = commut_fac2[commut_fac2$Source == "Walk",]$inventory
    
    staf_auto = commut_staf2[commut_staf2$Source == "Automobile",]$inventory
    staf_Bike = commut_staf2[commut_staf2$Source == "Bike",]$inventory
    staf_carp = commut_staf2[commut_staf2$Source == "Carpool",]$inventory
    staf_Pbus = commut_staf2[commut_staf2$Source == "Public Bus",]$inventory
    staf_walk = commut_staf2[commut_staf2$Source == "Walk",]$inventory
    
    stud_auto = commut_stud2[commut_stud2$Source == "Automobile",]$inventory
    stud_Bike = commut_stud2[commut_stud2$Source == "Bike",]$inventory
    stud_carp = commut_stud2[commut_stud2$Source == "Carpool",]$inventory
    stud_Pbus = commut_stud2[commut_stud2$Source == "Public Bus",]$inventory
    stud_walk = commut_stud2[commut_stud2$Source == "Walk",]$inventory
    
    e_coal = energy2[energy2$Source == "Coal (Steam Coal)",]$inventory
    e_oil = energy2[energy2$Source == "Distillate Oil (#1-4)",]$inventory
    e_lpg = energy2[energy2$Source == "LPG (Propane)",]$inventory
    e_gas = energy2[energy2$Source == "Natural Gas",]$inventory
    
    
    # Exchange the commuting & energy value 
    temp2$inventory[temp2$Sub_category == "Faculty Commuting" & 
                     temp2$Source == "Automobile"] <- fac_auto
    temp2$inventory[temp2$Sub_category == "Faculty Commuting" & 
                      temp2$Source == "Bike"] <- fac_Bike
    temp2$inventory[temp2$Sub_category == "Faculty Commuting" & 
                      temp2$Source == "Carpool"] <- fac_carp
    temp2$inventory[temp2$Sub_category == "Faculty Commuting" & 
                      temp2$Source == "Public Bus"] <- fac_Pbus
    temp2$inventory[temp2$Sub_category == "Faculty Commuting" & 
                      temp2$Source == "Walk"] <- fac_walk
    
    temp2$inventory[temp2$Sub_category == "Staff Commuting" & 
                      temp2$Source == "Automobile"] <- staf_auto
    temp2$inventory[temp2$Sub_category == "Staff Commuting" & 
                      temp2$Source == "Bike"] <- staf_Bike
    temp2$inventory[temp2$Sub_category == "Staff Commuting" & 
                      temp2$Source == "Carpool"] <- staf_carp
    temp2$inventory[temp2$Sub_category == "Staff Commuting" & 
                      temp2$Source == "Public Bus"] <- staf_Pbus
    temp2$inventory[temp2$Sub_category == "Staff Commuting" & 
                      temp2$Source == "Walk"] <- staf_walk
    
    temp2$inventory[temp2$Sub_category == "Student Commuting" & 
                      temp2$Source == "Automobile"] <- stud_auto
    temp2$inventory[temp2$Sub_category == "Student Commuting" & 
                      temp2$Source == "Bike"] <- stud_Bike
    temp2$inventory[temp2$Sub_category == "Student Commuting" & 
                      temp2$Source == "Carpool"] <- stud_carp
    temp2$inventory[temp2$Sub_category == "Student Commuting" & 
                      temp2$Source == "Public Bus"] <- stud_Pbus
    temp2$inventory[temp2$Sub_category == "Student Commuting" & 
                      temp2$Source == "Walk"] <- stud_walk
    
    temp2$inventory[temp2$Source == "Coal (Steam Coal)"] <- e_coal
    temp2$inventory[temp2$Source == "Distillate Oil (#1-4)"] <- e_oil
    temp2$inventory[temp2$Source == "LPG (Propane)"] <- e_lpg
    temp2$inventory[temp2$Source == "Natural Gas"] <- e_gas
    
  
    ##################################################################################
    
    names(temp1)[5] = 'Baseline_Inventory'
    names(temp2)[5] = 'Projected_Inventory'
    
    temp1 = unique(temp1)
    temp2 = unique(temp2)   
    
    temp = merge(temp1,temp2,by=c('Category','Sub_category','Source','Units'))
    
    temp$Perc_Change = 100*(temp$Projected_Inventory - temp$Baseline_Inventory)/temp$Baseline_Inventory
    
    # Round decimal places
    temp$Baseline_Inventory = round(temp$Baseline_Inventory,0)
    temp$Projected_Inventory = round(temp$Projected_Inventory,0)
    temp$Perc_Change = round(temp$Perc_Change,0)
    
    datatable(colnames=c("Category","Sub-Category","Source","Units",
                         "Baseline Inventory","Projected Inventory", '% Change'),
              temp)
    
  }) 
  
  output$INVENT_TABLE2 <- DT::renderDataTable({
    #if(input$scenario == "Manual Scenario"){ # table
      
    food1 = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    food2 = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    # food1 = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
    # food2 = FOOD_R[FOOD_R$Timeframe == 'Projected',]
    food1 = food1[,c('Category','inventory')]; names(food1)[2] = 'Baseline_Inventory'
    food2 = food2[,c('Category','inventory')]; names(food2)[2] = 'Projected_Inventory'
    
    food = merge(food1,food2,by='Category')
    
    food$Perc_Change = 100*(food$Projected_Inventory - food$Baseline_Inventory)/food$Baseline_Inventory
    
    # Round decimal places
    food$Baseline_Inventory = round(food$Baseline_Inventory,0)
    food$Projected_Inventory = round(food$Projected_Inventory,0)
    food$Perc_Change = round(food$Perc_Change,0)
    
    datatable(colnames=c("Category","Baseline Inventory (kg)","Projected Inventory (kg)", '% Change'),
              food)
 
  }) 
  
  #************************************************************************************
  # CARBON PLOTS 
  #************************************************************************************
  
  # This it the plot output part
  output$C_Plot1 <- renderPlot({
    #if(input$scenario == "Manual Scenario"){ # plot
      
    ## Function to extract legend
    g_legend <- function(a.gplot){ 
      tmp <- ggplot_gtable(ggplot_build(a.gplot)) 
      leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box") 
      legend <- tmp$grobs[[leg]] 
      legend
    }
    
    # subsetting out DATA2 from above DATA_all    
    temp1 = Carbon_R()[Carbon_R()$Timeframe == 'Baseline',]
    temp2 = Carbon_R()[Carbon_R()$Timeframe == 'Projected',]
    # temp1 = Carbon_R[Carbon_R$Timeframe == 'Baseline',]
    # temp2 = Carbon_R[Carbon_R$Timeframe == 'Projected',]
    
    temp1 = temp1[,c('Category','Total_C_Footprint')]
    temp2 = temp2[,c('Category','Total_C_Footprint')]
    temp1$Footprint = temp1$Total_C_Footprint
    temp2$Footprint = temp2$Total_C_Footprint
    
    food1 = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    food2 = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    commut_fac1 = Commut_Fac_R()[Commut_Fac_R()$Timeframe == 'Baseline',]
    commut_fac2 = Commut_Fac_R()[Commut_Fac_R()$Timeframe == 'Projected',]
    commut_staf1 = Commut_Staff_R()[Commut_Staff_R()$Timeframe == 'Baseline',]
    commut_staf2 = Commut_Staff_R()[Commut_Staff_R()$Timeframe == 'Projected',]
    commut_stud1 = Commut_Stud_R()[Commut_Fac_R()$Timeframe == 'Baseline',]
    commut_stud2 = Commut_Stud_R()[Commut_Fac_R()$Timeframe == 'Projected',]
    energy1 = Energy_R()[Energy_R()$Timeframe == 'Baseline',]
    energy2 = Energy_R()[Energy_R()$Timeframe == 'Projected',]
    
    # food1 = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
    # food2 = FOOD_R[FOOD_R$Timeframe == 'Projected',]
    # commut_fac1 = Commut_Fac_R[Commut_Fac_R$Timeframe == 'Baseline',]
    # commut_fac2 = Commut_Fac_R[Commut_Fac_R$Timeframe == 'Projected',]
    # commut_staf1 = Commut_Staff_R[Commut_Staff_R$Timeframe == 'Baseline',]
    # commut_staf2 = Commut_Staff_R[Commut_Staff_R$Timeframe == 'Projected',]
    # commut_stud1 = Commut_Stud_R[Commut_Fac_R$Timeframe == 'Baseline',]
    # commut_stud2 = Commut_Stud_R[Commut_Fac_R$Timeframe == 'Projected',]
    # energy1 = Energy_R[Energy_R$Timeframe == 'Baseline',]
    # energy2 = Energy_R[Energy_R$Timeframe == 'Projected',]
    
    # Get food total from food tab - convert kg to MT by dividing by 1000
    Cfood1_tot = sum(food1$C_Footprint)/1000
    Cfood2_tot = sum(food2$C_Footprint)/1000
    
    # Get commuting total from commuting tab - keep units as MT C 
    fac_tot = sum(commut_fac2$Total_C_Footprint)
    staf_tot = sum(commut_staf2$Total_C_Footprint)
    stud_tot = sum(commut_stud2$Total_C_Footprint)
    Ccommut2_tot = fac_tot+staf_tot+stud_tot
    
    # Get energy total energy from tab - initial units MT
    #Cenergy1_tot = sum(energy1$Total_C_Footprint)
    Cenergy2_tot = sum(energy2$Total_C_Footprint)
    
    # Exchange the value with the one from food, commuting, and energy tabs
    temp1$Footprint[temp1$Category == "Food"] <- Cfood1_tot
    #temp1$Footprint[temp1$Category == "Commuting"] <- Ccommut1_tot
    #temp1$Footprint[temp1$Category == "On-Campus Stationary Sources"] <- Cenergy1_tot
    temp2$Footprint[temp2$Category == "Food"] <- Cfood2_tot
    temp2$Footprint[temp2$Category == "Commuting"] <- Ccommut2_tot
    temp2$Footprint[temp2$Category == "On-Campus Stationary Sources"] <- Cenergy2_tot
    
    # Add in Percent (%)
    temp1$Perc_Foot = round(100*temp1$Footprint/sum(temp1$Footprint),1)
    temp2$Perc_Foot = round(100*temp2$Footprint/sum(temp2$Footprint),1)
    
    # Change order of categories
    temp1$Category <- factor(temp1$Category, levels = worder)
    temp2$Category <- factor(temp2$Category, levels = worder)
    
    # gives common variable names
    temp1$variable = temp1$Category
    temp1$value = temp1$Perc_Foot
    temp1$value2 = paste0(temp1$value,'%')
    temp2$variable = temp2$Category
    temp2$value = temp2$Perc_Foot
    temp2$value2 = paste0(temp2$value,'%')
    
    # Compute the position of the text labels as the cumulative sum of the proportion
    temp1 <- temp1 %>%
      arrange(desc(variable)) %>%
      mutate(lab.ypos = cumsum(value) - 0.5*value)
    temp2 <- temp2 %>%
      arrange(desc(variable)) %>%
      mutate(lab.ypos = cumsum(value) - 0.5*value)
    
    # For the color Pallete
    lvls = c(levels(factor(temp1$Category)))
    mypal = brewer.pal(length(lvls),"Paired") # Color Blind Friendly Palette
    #getPalette = colorRampPalette(brewer.pal(9, "Set1"))
    #getPalette = colorRampPalette(brewer.pal(12, "Paired"))
    #mypal = getPalette(length(lvls))
    
    # This first plot is just for the legend
    legen = ggplot(data = temp1)+ 
      geom_bar(aes(x="", y=value, fill=Category), stat="identity", width = 1)+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")
    
    # Pie Chart Baseline
    p1 = ggplot(data=temp1)+
      geom_bar(aes(x="", y=value, fill=Category), stat="identity", width = 1)+
      coord_polar("y", start=0,  direction = -1)+
      theme_void()+
      ggtitle( "Baseline")+
      geom_text_repel(aes(x=1.3, y = lab.ypos, label = value2),size=6)+
      guides(colour = guide_legend(reverse=T))+
      scale_fill_manual(values = mypal)+
      theme(legend.position = "none")+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      guides(fill=guide_legend(title="Categories"))#+
    
    # Pie Chart Projected
    p2 = ggplot(data=temp2)+
      geom_bar(aes(x="", y=value, fill=Category), stat="identity", width = 1)+
      coord_polar("y", start=0,  direction = -1)+
      theme_void()+
      ggtitle( "Projected")+
      geom_text_repel(aes(x=1.3, y = lab.ypos, label = value2),size=6)+
      guides(colour = guide_legend(reverse=T))+
      scale_fill_manual(values = mypal)+
      theme(legend.position = "none")+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      guides(fill=guide_legend(title="Categories"))#+
    
    leg1 <- g_legend(legen)
    
    grid.arrange(p1,p2,leg1,nrow=1,ncol=3)
    
    
  }) 
  
  output$C_Plot2 <- renderPlot({
    #if(input$scenario == "Manual Scenario"){ # plot
      
    temp1 = Carbon_R()[Carbon_R()$Timeframe == 'Baseline',]
    temp2 = Carbon_R()[Carbon_R()$Timeframe == 'Projected',]
    # temp1 = Carbon_R[Carbon_R$Timeframe == 'Baseline',]
    # temp2 = Carbon_R[Carbon_R$Timeframe == 'Projected',]
    
    temp1 = temp1[,c('Category','Total_C_Footprint','Timeframe')]
    temp2 = temp2[,c('Category','Total_C_Footprint','Timeframe')]
    temp1$Footprint = temp1$Total_C_Footprint
    temp2$Footprint = temp2$Total_C_Footprint
    
    food1 = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    food2 = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    energy1 = Energy_R()[Energy_R()$Timeframe == 'Baseline',]
    energy2 = Energy_R()[Energy_R()$Timeframe == 'Projected',]
    commut_fac1 = Commut_Fac_R()[Commut_Fac_R()$Timeframe == 'Baseline',]
    commut_fac2 = Commut_Fac_R()[Commut_Fac_R()$Timeframe == 'Projected',]
    commut_staf1 = Commut_Staff_R()[Commut_Staff_R()$Timeframe == 'Baseline',]
    commut_staf2 = Commut_Staff_R()[Commut_Staff_R()$Timeframe == 'Projected',]
    commut_stud1 = Commut_Stud_R()[Commut_Stud_R()$Timeframe == 'Baseline',]
    commut_stud2 = Commut_Stud_R()[Commut_Stud_R()$Timeframe == 'Projected',]
    
    
    # Get food total from food tab - convert kg to MT by dividing by 1000
    Cfood1_tot = sum(food1$C_Footprint)/1000
    Cfood2_tot = sum(food2$C_Footprint)/1000
    
    # Get commuting total from commuting tab - keep units as MT C 
    fac_tot = sum(commut_fac2$Total_C_Footprint)
    staf_tot = sum(commut_staf2$Total_C_Footprint)
    stud_tot = sum(commut_stud2$Total_C_Footprint)
    Ccommut2_tot = fac_tot+staf_tot+stud_tot
    
    # Get energy total energy from tab - initial units MT
    #Cenergy1_tot = sum(energy1$Total_C_Footprint)
    Cenergy2_tot = sum(energy2$Total_C_Footprint)
    
    # Exchange the value with the one from food, commuting, and energy tabs
    temp1$Footprint[temp1$Category == "Food"] <- Cfood1_tot
    #temp1$Footprint[temp1$Category == "Commuting"] <- Ccommut1_tot
    #temp1$Footprint[temp1$Category == "On-Campus Stationary Sources"] <- Cenergy1_tot
    temp2$Footprint[temp2$Category == "Food"] <- Cfood2_tot
    temp2$Footprint[temp2$Category == "Commuting"] <- Ccommut2_tot
    temp2$Footprint[temp2$Category == "On-Campus Stationary Sources"] <- Cenergy2_tot
    
    
    # Recombine 'Baseline' and 'Projected'
    DATA_all_C2 = rbind(temp1,temp2)
    
    # Change order of categories
    DATA_all_C2$Category <- factor(DATA_all_C2$Category, levels = worder)
    
    # For the color Pallete
    lvls = c(levels(factor(DATA_all_C2$Category)))
    mypal = brewer.pal(length(lvls),"Paired") # Color Blind Friendly Palette
    #getPalette = colorRampPalette(brewer.pal(9, "Set1"))
    #getPalette = colorRampPalette(brewer.pal(12, "Paired"))
    #mypal = getPalette(length(lvls))
    
    # Stacked Bar Chart
    ggplot(data = DATA_all_C2, aes(x = Timeframe, y=Footprint,fill = Category))+ 
      geom_bar(stat="identity")+ 
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Baseline vs. Projected")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="C MTCDE")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      #scale_y_continuous(breaks= seq(0, 500, by=100),limits = c(0,500))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
  
  })
  
  
  #************************************************************************************
  # NITROGEN PLOTS
  #************************************************************************************
  
  output$N_Plot1 <- renderPlot({
    #if(input$scenario == "Manual Scenario"){ # plot
      
    ## Function to extract legend
    g_legend <- function(a.gplot){ 
      tmp <- ggplot_gtable(ggplot_build(a.gplot)) 
      leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box") 
      legend <- tmp$grobs[[leg]] 
      legend
    }
    
    # subsetting out DATA2 from above DATA_all    
    temp1 = Nitrogen_R()[Nitrogen_R()$Timeframe == 'Baseline',]
    temp2 = Nitrogen_R()[Nitrogen_R()$Timeframe == 'Projected',]
    #temp1 = Nitrogen_R[Nitrogen_R$Timeframe == 'Baseline',]
    #temp2 = Nitrogen_R[Nitrogen_R$Timeframe == 'Projected',]
    
    temp1 = temp1[,c('Category','Total_N_Footprint')]
    temp2 = temp2[,c('Category','Total_N_Footprint')]
    temp1$Footprint = temp1$Total_N_Footprint
    temp2$Footprint = temp2$Total_N_Footprint
    
    food1 = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    food2 = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    energy1 = Energy_R()[Energy_R()$Timeframe == 'Baseline',]
    energy2 = Energy_R()[Energy_R()$Timeframe == 'Projected',]
    commut_fac1 = Commut_Fac_R()[Commut_Fac_R()$Timeframe == 'Baseline',]
    commut_fac2 = Commut_Fac_R()[Commut_Fac_R()$Timeframe == 'Projected',]
    commut_staf1 = Commut_Staff_R()[Commut_Staff_R()$Timeframe == 'Baseline',]
    commut_staf2 = Commut_Staff_R()[Commut_Staff_R()$Timeframe == 'Projected',]
    commut_stud1 = Commut_Stud_R()[Commut_Stud_R()$Timeframe == 'Baseline',]
    commut_stud2 = Commut_Stud_R()[Commut_Stud_R()$Timeframe == 'Projected',]
    
    # Get food total from food tab - convert kg to MT by dividing by 1000
    Nfood1_tot = sum(food1$N_Footprint)/1000
    Nfood2_tot = sum(food2$N_Footprint)/1000
    
    # Get commuting total from commuting tab - units are MT
    fac_tot = sum(commut_fac2$Total_N_Footprint)
    staf_tot = sum(commut_staf2$Total_N_Footprint)
    stud_tot = sum(commut_stud2$Total_N_Footprint)
    Ncommut2_tot = fac_tot+staf_tot+stud_tot
    
    # Get energy total energy from tab - units are MT Nitrogen
    #Nenergy1_tot = sum(energy1$Total_N_Footprint)
    Nenergy2_tot = sum(energy2$Total_N_Footprint)
    
    # Exchange the value with the one from food, commuting, and energy tabs
    temp1$Footprint[temp1$Category == "Food"] <- Nfood1_tot
    # temp1$Footprint[temp1$Category == "Commuting"] <- Ncommut1_tot
    # temp1$Footprint[temp1$Category == "On-Campus Stationary Sources"] <- Nenergy1_tot
    temp2$Footprint[temp2$Category == "Food"] <- Nfood2_tot
    temp2$Footprint[temp2$Category == "Commuting"] <- Ncommut2_tot
    temp2$Footprint[temp2$Category == "On-Campus Stationary Sources"] <- Nenergy2_tot
    
    # Add in Percent (%)
    temp1$Perc_N_Foot = round(100*temp1$Footprint/sum(temp1$Footprint))
    temp2$Perc_N_Foot = round(100*temp2$Footprint/sum(temp2$Footprint))
    temp1$Perc_Foot = temp1$Perc_N_Foot
    temp2$Perc_Foot = temp2$Perc_N_Foot
    
    # Change order of categories
    temp1$Category <- factor(temp1$Category, levels = catorder)
    temp2$Category <- factor(temp2$Category, levels = catorder)
    
    # gives common variable names
    temp1$variable = temp1$Category
    temp1$value = temp1$Perc_Foot
    temp1$value2 = paste0(temp1$value,'%')
    temp2$variable = temp2$Category
    temp2$value = temp2$Perc_Foot
    temp2$value2 = paste0(temp2$value,'%')
    
    # Compute the position of the text labels as the cumulative sum of the proportion
    temp1 <- temp1 %>%
      arrange(desc(variable)) %>%
      mutate(lab.ypos = cumsum(value) - 0.5*value)
    temp2 <- temp2 %>%
      arrange(desc(variable)) %>%
      mutate(lab.ypos = cumsum(value) - 0.5*value)
    
    # For the color Pallete
    lvls = c(levels(factor(temp1$Category)))
    mypal = brewer.pal(length(lvls),"Paired") # Color Blind Friendly Palette
    #getPalette = colorRampPalette(brewer.pal(9, "Set1"))
    #getPalette = colorRampPalette(brewer.pal(12, "Paired"))
    #mypal = getPalette(length(lvls))
    
    # This first plot is just for the legend
    legen = ggplot(data = temp1)+ 
      geom_bar(aes(x="", y=value, fill=Category), stat="identity", width = 1)+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")
    
    # Pie Chart Baseline
    n1 = ggplot(data=temp1)+
      geom_bar(aes(x="", y=value, fill=Category), stat="identity", width = 1)+
      coord_polar("y", start=0,  direction = -1)+
      theme_void()+
      ggtitle( "Baseline")+
      geom_text_repel(aes(x=1.3, y = lab.ypos, label = value2),size=6)+
      guides(colour = guide_legend(reverse=T))+
      scale_fill_manual(values = mypal)+
      theme(legend.position = "none")+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      guides(fill=guide_legend(title="Categories"))#+
    
    # Pie Chart Projected
    n2 = ggplot(data=temp2)+
      geom_bar(aes(x="", y=value, fill=Category), stat="identity", width = 1)+
      coord_polar("y", start=0,  direction = -1)+
      theme_void()+
      ggtitle( "Projected")+
      geom_text_repel(aes(x=1.3, y = lab.ypos, label = value2),size=6)+
      guides(colour = guide_legend(reverse=T))+
      scale_fill_manual(values = mypal)+
      theme(legend.position = "none")+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      guides(fill=guide_legend(title="Categories"))#+
    
    leg2 <- g_legend(legen)
    
    grid.arrange(n1,n2,leg2,nrow=1,ncol=3)
     
  })
  
  output$N_Plot2 <- renderPlot({
    #if(input$scenario == "Manual Scenario"){ # plot
      
    temp1 = Nitrogen_R()[Nitrogen_R()$Timeframe == 'Baseline',]
    temp2 = Nitrogen_R()[Nitrogen_R()$Timeframe == 'Projected',]
    #temp1 = Nitrogen_R[Nitrogen_R$Timeframe == 'Baseline',]
    #temp2 = Nitrogen_R[Nitrogen_R$Timeframe == 'Projected',]
    
    temp1 = temp1[,c('Category','Total_N_Footprint','Timeframe')]
    temp2 = temp2[,c('Category','Total_N_Footprint','Timeframe')]
    temp1$Footprint = temp1$Total_N_Footprint
    temp2$Footprint = temp2$Total_N_Footprint
    
    food1 = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    food2 = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    energy1 = Energy_R()[Energy_R()$Timeframe == 'Baseline',]
    energy2 = Energy_R()[Energy_R()$Timeframe == 'Projected',]
    commut_fac1 = Commut_Fac_R()[Commut_Fac_R()$Timeframe == 'Baseline',]
    commut_fac2 = Commut_Fac_R()[Commut_Fac_R()$Timeframe == 'Projected',]
    commut_staf1 = Commut_Staff_R()[Commut_Staff_R()$Timeframe == 'Baseline',]
    commut_staf2 = Commut_Staff_R()[Commut_Staff_R()$Timeframe == 'Projected',]
    commut_stud1 = Commut_Stud_R()[Commut_Stud_R()$Timeframe == 'Baseline',]
    commut_stud2 = Commut_Stud_R()[Commut_Stud_R()$Timeframe == 'Projected',]
    
    # Get food total from food tab - convert kg to MT by dividing by 1000
    Nfood1_tot = sum(food1$N_Footprint)/1000
    Nfood2_tot = sum(food2$N_Footprint)/1000
    
    # Get commuting total from commuting tab - units are MT
    fac_tot = sum(commut_fac2$Total_N_Footprint)
    staf_tot = sum(commut_staf2$Total_N_Footprint)
    stud_tot = sum(commut_stud2$Total_N_Footprint)
    Ncommut2_tot = fac_tot+staf_tot+stud_tot
    
    # Get energy total energy from tab - initial units MT
    #Nenergy1_tot = sum(energy1$Total_N_Footprint)
    Nenergy2_tot = sum(energy2$Total_N_Footprint)
    
    # Exchange the value with the one from food, commuting, and energy tabs
    temp1$Footprint[temp1$Category == "Food"] <- Nfood1_tot
    #temp1$Footprint[temp1$Category == "Commuting"] <- Ncommut1_tot
    #temp1$Footprint[temp1$Category == "On-Campus Stationary Sources"] <- Nenergy1_tot
    temp2$Footprint[temp2$Category == "Food"] <- Nfood2_tot
    temp2$Footprint[temp2$Category == "Commuting"] <- Ncommut2_tot
    temp2$Footprint[temp2$Category == "On-Campus Stationary Sources"] <- Nenergy2_tot
    
    # Recombine 'Baseline' and 'Projected'
    DATA_all_N2 = rbind(temp1,temp2)
    
    # Change order of categories
    DATA_all_N2$Category <- factor(DATA_all_N2$Category, levels = worder)
    
    # For the color Pallete
    lvls = c(levels(factor(DATA_all_N2$Category)))
    mypal = brewer.pal(length(lvls),"Paired") # Color Blind Friendly Palette
    #getPalette = colorRampPalette(brewer.pal(9, "Set1"))
    #getPalette = colorRampPalette(brewer.pal(12, "Paired"))
    #mypal = getPalette(length(lvls))
    
    # Stacked Bar Chart
    ggplot(data = DATA_all_N2, aes(x = Timeframe, y=Footprint,fill = Category))+ 
      geom_bar(stat="identity")+ 
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Baseline vs. Projected")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="Metric Tons of N")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      #scale_y_continuous(breaks= seq(0, 500, by=100),limits = c(0,500))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
  })
  
  #************************************************************************************
  # PHOSPHORUS PLOTS
  #************************************************************************************
  
  output$P_Plot1 <- renderPlot({
    #if(input$scenario == "Manual Scenario"){ # plot
      
    ## Function to extract legend
    g_legend <- function(a.gplot){ 
      tmp <- ggplot_gtable(ggplot_build(a.gplot)) 
      leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box") 
      legend <- tmp$grobs[[leg]] 
      legend
    }
    
    # subsetting out DATA2 from above DATA_all    
    temp1 = Phosphorus_R()[Phosphorus_R()$Timeframe == 'Baseline',]
    temp2 = Phosphorus_R()[Phosphorus_R()$Timeframe == 'Projected',]
    #temp1 = Phosphorus_R[Phosphorus_R$Timeframe == 'Baseline',]
    #temp2 = Phosphorus_R[Phosphorus_R$Timeframe == 'Projected',]
    
    temp1 = temp1[,c('Category','Total_P_Footprint')]
    temp2 = temp2[,c('Category','Total_P_Footprint')]
    temp1$Footprint = temp1$Total_P_Footprint
    temp2$Footprint = temp2$Total_P_Footprint
    
    food1 = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    food2 = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    
    # Get food total from food tab - convert kg to MT by dividing by 1000
    Pfood1_tot = sum(food1$P_Footprint)/1000
    Pfood2_tot = sum(food2$P_Footprint)/1000
    
    # Exchange the value with the one from food, commuting, and energy tabs
    temp1$Footprint[temp1$Category == "Food"] <- Pfood1_tot
    temp2$Footprint[temp2$Category == "Food"] <- Pfood2_tot
    
    # Add in Percent (%)
    temp1$Perc_P_Foot = round(100*temp1$Footprint/sum(temp1$Footprint))
    temp2$Perc_P_Foot = round(100*temp2$Footprint/sum(temp2$Footprint))
    temp1$Perc_Foot = temp1$Perc_P_Foot
    temp2$Perc_Foot = temp2$Perc_P_Foot
    
    # Change order of categories
    temp1$Category <- factor(temp1$Category, levels = worder)
    temp2$Category <- factor(temp2$Category, levels = worder)
    
    # gives common variable names
    temp1$variable = temp1$Category
    temp1$value = temp1$Perc_Foot
    temp1$value2 = paste0(temp1$value,'%')
    temp2$variable = temp2$Category
    temp2$value = temp2$Perc_Foot
    temp2$value2 = paste0(temp2$value,'%')
    
    # Compute the position of the text labels as the cumulative sum of the proportion
    temp1 <- temp1 %>%
      arrange(desc(variable)) %>%
      mutate(lab.ypos = cumsum(value) - 0.5*value)
    temp2 <- temp2 %>%
      arrange(desc(variable)) %>%
      mutate(lab.ypos = cumsum(value) - 0.5*value)
    
    # For the color Pallete
    lvls = c(levels(factor(temp1$Category)))
    mypal = brewer.pal(length(lvls),"Paired") # Color Blind Friendly Palette
    #getPalette = colorRampPalette(brewer.pal(9, "Set1"))
    #getPalette = colorRampPalette(brewer.pal(12, "Paired"))
    #mypal = getPalette(length(lvls))
    
    # This first plot is just for the legend
    legen = ggplot(data = temp1)+ 
      geom_bar(aes(x="", y=value, fill=Category), stat="identity", width = 1)+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")
    
    # Pie Chart Baseline
    p1 = ggplot(data=temp1)+
      geom_bar(aes(x="", y=value, fill=Category), stat="identity", width = 1)+
      coord_polar("y", start=0,  direction = -1)+
      theme_void()+
      ggtitle( "Baseline")+
      geom_text_repel(aes(x=1.3, y = lab.ypos, label = value2),size=6)+
      guides(colour = guide_legend(reverse=T))+
      scale_fill_manual(values = mypal)+
      theme(legend.position = "none")+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      guides(fill=guide_legend(title="Categories"))#+
    
    # Pie Chart Projected
    p2 = ggplot(data=temp2)+
      geom_bar(aes(x="", y=value, fill=Category), stat="identity", width = 1)+
      coord_polar("y", start=0,  direction = -1)+
      theme_void()+
      ggtitle( "Projected")+
      geom_text_repel(aes(x=1.3, y = lab.ypos, label = value2),size=6)+
      guides(colour = guide_legend(reverse=T))+
      scale_fill_manual(values = mypal)+
      theme(legend.position = "none")+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      guides(fill=guide_legend(title="Categories"))#+
    
    leg2 <- g_legend(legen)
    
    grid.arrange(p1,p2,leg2,nrow=1,ncol=3)
    
  })
  
  output$P_Plot2 <- renderPlot({
    #if(input$scenario == "Manual Scenario"){ # plot
      
    temp1 = Phosphorus_R()[Phosphorus_R()$Timeframe == 'Baseline',]
    temp2 = Phosphorus_R()[Phosphorus_R()$Timeframe == 'Projected',]
    
    temp1 = temp1[,c('Category','Total_P_Footprint','Timeframe')]
    temp2 = temp2[,c('Category','Total_P_Footprint','Timeframe')]
    temp1$Footprint = temp1$Total_P_Footprint
    temp2$Footprint = temp2$Total_P_Footprint
    
    food1 = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    food2 = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    
    # Get food total from food tab - convert kg to MT by dividing by 1000
    Pfood1_tot = sum(food1$P_Footprint)/1000
    Pfood2_tot = sum(food2$P_Footprint)/1000
    
    # Exchange the value with the one from food, commuting, and energy tabs
    temp1$Footprint[temp1$Category == "Food"] <- Pfood1_tot
    temp2$Footprint[temp2$Category == "Food"] <- Pfood2_tot
    
    # Recombine 'Baseline' and 'Projected'
    DATA_all_P2 = rbind(temp1,temp2)
    
    # Change order of categories
    DATA_all_P2$Category <- factor(DATA_all_P2$Category, levels = worder)
    
    # For the color Pallete
    lvls = c(levels(factor(DATA_all_P2$Category)))
    mypal = brewer.pal(length(lvls),"Paired") # Color Blind Friendly Palette
    #getPalette = colorRampPalette(brewer.pal(9, "Set1"))
    #getPalette = colorRampPalette(brewer.pal(12, "Paired"))
    #mypal = getPalette(length(lvls))
    
    # Stacked Bar Chart
    ggplot(data = DATA_all_P2, aes(x = Timeframe, y=Footprint,fill = Category))+ 
      geom_bar(stat="identity")+ 
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Baseline vs. Projected")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="Metric Tons of P")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      #scale_y_continuous(breaks= seq(0, 500, by=100),limits = c(0,500))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
  })
  
  #************************************************************************************
  # WATER PLOTS
  #************************************************************************************
  
  output$W_Plot1 <- renderPlot({
    #if(input$scenario == "Manual Scenario"){ # plot
      
    ## Function to extract legend
    g_legend <- function(a.gplot){ 
      tmp <- ggplot_gtable(ggplot_build(a.gplot)) 
      leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box") 
      legend <- tmp$grobs[[leg]] 
      legend
    }
    
    # subsetting out DATA2 from above DATA_all    
    temp1 = Water_R()[Water_R()$Timeframe == 'Baseline',]
    temp2 = Water_R()[Water_R()$Timeframe == 'Projected',]
    #temp1 = Water_R[Water_R$Timeframe == 'Baseline',]
    #temp2 = Water_R[Water_R$Timeframe == 'Projected',]
    
    temp1 = temp1[,c('Category','Total_W_Footprint')] # Units = gallons
    temp2 = temp2[,c('Category','Total_W_Footprint')] # Units = gallons
    temp1$Footprint = temp1$Total_W_Footprint
    temp2$Footprint = temp2$Total_W_Footprint
    
    food1 = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    food2 = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    
    # Get food total from food tab - units = gallons
    Wfood1_tot = sum(food1$B_Footprint)
    Wfood2_tot = sum(food2$B_Footprint)
    
    # Exchange the value with the one from food, commuting, and energy tabs
    temp1$Footprint[temp1$Category == "Food"] <- Wfood1_tot
    temp2$Footprint[temp2$Category == "Food"] <- Wfood2_tot
    
    # Convert gallons to m3
    temp1$Footprint = temp1$Footprint*0.00378541
    temp2$Footprint = temp2$Footprint*0.00378541
    
    # Add in Percent (%)
    temp1$Perc_P_Foot = round(100*temp1$Footprint/sum(temp1$Footprint))
    temp2$Perc_P_Foot = round(100*temp2$Footprint/sum(temp2$Footprint))
    temp1$Perc_Foot = temp1$Perc_P_Foot
    temp2$Perc_Foot = temp2$Perc_P_Foot
    
    # Change order of categories
    temp1$Category <- factor(temp1$Category, levels = worder)
    temp2$Category <- factor(temp2$Category, levels = worder)
    
    # gives common variable names
    temp1$variable = temp1$Category
    temp1$value = temp1$Perc_Foot
    temp1$value2 = paste0(temp1$value,'%')
    temp2$variable = temp2$Category
    temp2$value = temp2$Perc_Foot
    temp2$value2 = paste0(temp2$value,'%')
    
    # Compute the position of the text labels as the cumulative sum of the proportion
    temp1 <- temp1 %>%
      arrange(desc(variable)) %>%
      mutate(lab.ypos = cumsum(value) - 0.5*value)
    temp2 <- temp2 %>%
      arrange(desc(variable)) %>%
      mutate(lab.ypos = cumsum(value) - 0.5*value)
    
    # For the color Pallete
    lvls = c(levels(factor(temp1$Category)))
    mypal = brewer.pal(length(lvls),"Paired") # Color Blind Friendly Palette
    #getPalette = colorRampPalette(brewer.pal(9, "Set1"))
    #getPalette = colorRampPalette(brewer.pal(12, "Paired"))
    #mypal = getPalette(length(lvls))
    
    # This first plot is just for the legend
    legen = ggplot(data = temp1)+ 
      geom_bar(aes(x="", y=value, fill=Category), stat="identity", width = 1)+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")
    
    # Pie Chart Baseline
    w1 = ggplot(data=temp1)+
      geom_bar(aes(x="", y=value, fill=Category), stat="identity", width = 1)+
      coord_polar("y", start=0,  direction = -1)+
      theme_void()+
      ggtitle( "Baseline")+
      geom_text_repel(aes(x=1.3, y = lab.ypos, label = value2),size=6)+
      guides(colour = guide_legend(reverse=T))+
      scale_fill_manual(values = mypal)+
      theme(legend.position = "none")+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      guides(fill=guide_legend(title="Categories"))#+
    
    # Pie Chart Projected
    w2 = ggplot(data=temp2)+
      geom_bar(aes(x="", y=value, fill=Category), stat="identity", width = 1)+
      coord_polar("y", start=0,  direction = -1)+
      theme_void()+
      ggtitle( "Projected")+
      geom_text_repel(aes(x=1.3, y = lab.ypos, label = value2),size=6)+
      guides(colour = guide_legend(reverse=T))+
      scale_fill_manual(values = mypal)+
      theme(legend.position = "none")+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      guides(fill=guide_legend(title="Categories"))#+
    
    leg2 <- g_legend(legen)
    
    grid.arrange(w1,w2,leg2,nrow=1,ncol=3)
      
  })
  
  output$W_Plot2 <- renderPlot({
    #if(input$scenario == "Manual Scenario"){ # plot
      
    temp1 = Water_R()[Water_R()$Timeframe == 'Baseline',]
    temp2 = Water_R()[Water_R()$Timeframe == 'Projected',]
    
    temp1 = temp1[,c('Category','Total_W_Footprint','Timeframe')] # Units = gallons
    temp2 = temp2[,c('Category','Total_W_Footprint','Timeframe')] # Units = gallons
    temp1$Footprint = temp1$Total_W_Footprint
    temp2$Footprint = temp2$Total_W_Footprint
    
    food1 = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    food2 = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    
    # Get food total from food tab - units = gallons
    Wfood1_tot = sum(food1$B_Footprint)
    Wfood2_tot = sum(food2$B_Footprint)
    
    # Exchange the value with the one from food, commuting, and energy tabs
    temp1$Footprint[temp1$Category == "Food"] <- Wfood1_tot
    temp2$Footprint[temp2$Category == "Food"] <- Wfood2_tot
    
    # Convert gallons to m3
    temp1$Footprint = temp1$Footprint*0.00378541
    temp2$Footprint = temp2$Footprint*0.00378541
    
    # Recombine 'Baseline' and 'Projected'
    DATA_all_W2 = rbind(temp1,temp2)
    
    # Change order of categories
    DATA_all_W2$Category <- factor(DATA_all_W2$Category, levels = worder)
    
    # For the color Pallete
    lvls = c(levels(factor(DATA_all_W2$Category)))
    mypal = brewer.pal(length(lvls),"Paired") # Color Blind Friendly Palette
    #getPalette = colorRampPalette(brewer.pal(9, "Set1"))
    #getPalette = colorRampPalette(brewer.pal(12, "Paired"))
    #mypal = getPalette(length(lvls))
    
    # Stacked Bar Chart
    ggplot(data = DATA_all_W2, aes(x = Timeframe, y=Footprint,fill = Category))+ 
      geom_bar(stat="identity")+ 
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Baseline vs. Projected")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="Cubic Meters of Water")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      #scale_y_continuous(breaks= seq(0, 500, by=100),limits = c(0,500))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
  })
  
  #************************************************************************************
  # C,N,P,W PLOTS
  #************************************************************************************
  
  # This it the plot output part
  output$CNPW_Plot1 <- renderPlot({
    #if(input$scenario == "Manual Scenario"){ # plot
      
    ## Function to extract legend
    g_legend <- function(a.gplot){ 
      tmp <- ggplot_gtable(ggplot_build(a.gplot)) 
      leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box") 
      legend <- tmp$grobs[[leg]] 
      legend
    }
    
    # temp1 = COMBO_R[COMBO_R$Timeframe == 'Baseline',]
    # temp2 = COMBO_R[COMBO_R$Timeframe == 'Projected',]
    temp1 = COMBO_R()[COMBO_R()$Timeframe == 'Baseline',]
    temp2 = COMBO_R()[COMBO_R()$Timeframe == 'Projected',]
    
    C_data1 = temp1[,c('Category','Total_C_Footprint','Timeframe')] # Units = MT
    C_data2 = temp2[,c('Category','Total_C_Footprint','Timeframe')] # Units = MT
    N_data1 = temp1[,c('Category','Total_N_Footprint','Timeframe')] # Units = MT
    N_data2 = temp2[,c('Category','Total_N_Footprint','Timeframe')] # Units = MT
    P_data1 = temp1[,c('Category','Total_P_Footprint','Timeframe')] # Units = MT
    P_data2 = temp2[,c('Category','Total_P_Footprint','Timeframe')] # Units = MT
    W_data1 = temp1[,c('Category','Total_W_Footprint','Timeframe')] # Units = gallons
    W_data2 = temp2[,c('Category','Total_W_Footprint','Timeframe')] # Units = gallons
    
    C_data1$Footprint = C_data1$Total_C_Footprint
    C_data2$Footprint = C_data2$Total_C_Footprint
    N_data1$Footprint = N_data1$Total_N_Footprint
    N_data2$Footprint = N_data2$Total_N_Footprint
    P_data1$Footprint = P_data1$Total_P_Footprint
    P_data2$Footprint = P_data2$Total_P_Footprint
    W_data1$Footprint = W_data1$Total_W_Footprint
    W_data2$Footprint = W_data2$Total_W_Footprint
    
    C_data1 = C_data1[,c('Category','Footprint','Timeframe')]
    C_data2 = C_data2[,c('Category','Footprint','Timeframe')]
    N_data1 = N_data1[,c('Category','Footprint','Timeframe')]
    N_data2 = N_data2[,c('Category','Footprint','Timeframe')]
    P_data1 = P_data1[,c('Category','Footprint','Timeframe')]
    P_data2 = P_data2[,c('Category','Footprint','Timeframe')]
    W_data1 = W_data1[,c('Category','Footprint','Timeframe')]
    W_data2 = W_data2[,c('Category','Footprint','Timeframe')]
    
    C_data1$NAME = 'Carbon'
    C_data2$NAME = 'Carbon'
    N_data1$NAME = 'Nitrogen'
    N_data2$NAME = 'Nitrogen'
    P_data1$NAME = 'Phosphorus'
    P_data2$NAME = 'Phosphorus'
    W_data1$NAME = 'Water'
    W_data2$NAME = 'Water'
    
    food1 = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    food2 = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    energy1 = Energy_R()[Energy_R()$Timeframe == 'Baseline',]
    energy2 = Energy_R()[Energy_R()$Timeframe == 'Projected',]
    commut_fac1 = Commut_Fac_R()[Commut_Fac_R()$Timeframe == 'Baseline',]
    commut_fac2 = Commut_Fac_R()[Commut_Fac_R()$Timeframe == 'Projected',]
    commut_staf1 = Commut_Staff_R()[Commut_Staff_R()$Timeframe == 'Baseline',]
    commut_staf2 = Commut_Staff_R()[Commut_Staff_R()$Timeframe == 'Projected',]
    commut_stud1 = Commut_Stud_R()[Commut_Stud_R()$Timeframe == 'Baseline',]
    commut_stud2 = Commut_Stud_R()[Commut_Stud_R()$Timeframe == 'Projected',]
    
    # food1 = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
    # food2 = FOOD_R[FOOD_R$Timeframe == 'Projected',]
    # energy1 = Energy_R[Energy_R$Timeframe == 'Baseline',]
    # energy2 = Energy_R[Energy_R$Timeframe == 'Projected',]
    # commut_fac1 = Commut_Fac_R[Commut_Fac_R$Timeframe == 'Baseline',]
    # commut_fac2 = Commut_Fac_R[Commut_Fac_R$Timeframe == 'Projected',]
    # commut_staf1 = Commut_Staff_R[Commut_Staff_R$Timeframe == 'Baseline',]
    # commut_staf2 = Commut_Staff_R[Commut_Staff_R$Timeframe == 'Projected',]
    # commut_stud1 = Commut_Stud_R[Commut_Stud_R$Timeframe == 'Baseline',]
    # commut_stud2 = Commut_Stud_R[Commut_Stud_R$Timeframe == 'Projected',]
    
    
    #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
    # Get food total from food tab - convert kg to MT by dividing by 1000
    Cfood1_tot = sum(food1$C_Footprint)/1000
    Cfood2_tot = sum(food2$C_Footprint)/1000
    Nfood1_tot = sum(food1$N_Footprint)/1000
    Nfood2_tot = sum(food2$N_Footprint)/1000
    Pfood1_tot = sum(food1$P_Footprint)/1000
    Pfood2_tot = sum(food2$P_Footprint)/1000
    Wfood1_tot = sum(food1$B_Footprint) # Units = gallons
    Wfood2_tot = sum(food2$B_Footprint) # Units = gallons
    
    # Get commuting total from commuting tab - units are MT
    Ccommut2_fac_tot = sum(commut_fac2$Total_C_Footprint)
    Ccommut2_staf_tot = sum(commut_staf2$Total_C_Footprint)
    Ccommut2_stud_tot = sum(commut_stud2$Total_C_Footprint)
    Ncommut2_fac_tot = sum(commut_fac2$Total_N_Footprint)
    Ncommut2_staf_tot = sum(commut_staf2$Total_N_Footprint)
    Ncommut2_stud_tot = sum(commut_stud2$Total_N_Footprint)
    Ccommut2_tot = Ccommut2_fac_tot+Ccommut2_staf_tot+Ccommut2_stud_tot
    Ncommut2_tot = Ncommut2_fac_tot+Ncommut2_staf_tot+Ncommut2_stud_tot
    
    # Get energy total energy from tab - initial units MT
    Cenergy2_tot = sum(energy2$Total_C_Footprint)
    Nenergy2_tot = sum(energy2$Total_N_Footprint)
    
    # Exchange the food value with the one from food tab
    C_data1$Footprint[C_data1$Category == "Food"] <- Cfood1_tot # Units = MT
    N_data1$Footprint[N_data1$Category == "Food"] <- Nfood1_tot # Units = MT
    P_data1$Footprint[P_data1$Category == "Food"] <- Pfood1_tot # Units = MT
    W_data1$Footprint[W_data1$Category == "Food"] <- Wfood1_tot # Units = MT
    C_data2$Footprint[C_data2$Category == "Food"] <- Cfood2_tot # Units = MT
    N_data2$Footprint[N_data2$Category == "Food"] <- Nfood2_tot # Units = MT
    P_data2$Footprint[P_data2$Category == "Food"] <- Pfood2_tot # Units = gallons
    W_data2$Footprint[W_data2$Category == "Food"] <- Wfood2_tot # Units = gallons
    
    # Exchange the commuting value with the one from commuting tab
    # C_data1$Footprint[C_data1$Category == "Commuting"] <- Ccommut1_tot
    # N_data1$Footprint[N_data1$Category == "Commuting"] <- Ncommut1_tot
    C_data2$Footprint[C_data2$Category == "Commuting"] <- Ccommut2_tot
    N_data2$Footprint[N_data2$Category == "Commuting"] <- Ncommut2_tot
    
    # Exchange the energy value with the one from energy tab
    #C_data1$Footprint[C_data1$Category == "On-Campus Stationary Sources"] <- Cenergy1_tot
    C_data2$Footprint[C_data2$Category == "On-Campus Stationary Sources"] <- Cenergy2_tot
    #N_data1$Footprint[N_data1$Category == "On-Campus Stationary Sources"] <- Nenergy1_tot
    N_data2$Footprint[N_data2$Category == "On-Campus Stationary Sources"] <- Nenergy2_tot
    
    # Convert Water units from gallons to cubic meters (m3)
    W_data1$Footprint = W_data1$Footprint*0.00378541 # Convering gallons to m3
    W_data2$Footprint = W_data2$Footprint*0.00378541 # Convering gallons to m3
    
    #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
    # Add in Percent (%)
    C_data1$Perc_Foot = round(100*C_data1$Footprint/sum(C_data1$Footprint),1)
    C_data2$Perc_Foot = round(100*C_data2$Footprint/sum(C_data2$Footprint),1)
    N_data1$Perc_Foot = round(100*N_data1$Footprint/sum(N_data1$Footprint),1)
    N_data2$Perc_Foot = round(100*N_data2$Footprint/sum(N_data2$Footprint),1)
    P_data1$Perc_Foot = round(100*P_data1$Footprint/sum(P_data1$Footprint),1)
    P_data2$Perc_Foot = round(100*P_data2$Footprint/sum(P_data2$Footprint),1)
    W_data1$Perc_Foot = round(100*W_data1$Footprint/sum(W_data1$Footprint),1)
    W_data2$Perc_Foot = round(100*W_data2$Footprint/sum(W_data2$Footprint),1)
    
    CNPW_data1 = rbind(C_data1,N_data1,P_data1,W_data1)
    CNPW_data2 = rbind(C_data2,N_data2,P_data2,W_data2)
    
    # Change order of categories
    CNPW_data1$Category <- factor(CNPW_data1$Category, levels = worder)
    CNPW_data2$Category <- factor(CNPW_data2$Category, levels = worder)
    
    # For the color Pallete
    lvls = c(levels(factor(CNPW_data1$Category)))
    mypal = brewer.pal(length(lvls),"Paired") # Color Blind Friendly Palette
    #getPalette = colorRampPalette(brewer.pal(9, "Set1"))
    #getPalette = colorRampPalette(brewer.pal(12, "Paired"))
    #mypal = getPalette(length(lvls))
    
    # Stacked Bar Chart
    
    # This first plot is just for the legend
    legen = ggplot(data = CNPW_data1, aes(x = NAME, y=Perc_Foot,fill = Category))+ 
      geom_bar(stat="identity")+ 
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")
    
    # Plotting Percent of C and N
    CNPW3 = ggplot(data = CNPW_data1, aes(x = NAME, y=Perc_Foot,fill = Category))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Baseline")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="Percent of Footprint")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    CNPW4 = ggplot(data = CNPW_data2, aes(x = NAME, y=Perc_Foot,fill = Category))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Projected")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="Percent of Footprint")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    leg4 <- g_legend(legen)
    
    grid.arrange(CNPW3,CNPW4,leg4,nrow=1,ncol=3)
    
  })
  
  # Reactive CNPW_TABLE1 
  CNPW_TABLE1 <- reactive({
    
    #if(input$scenario == "Manual Scenario"){
    # temp1 = COMBO_R[COMBO_R$Timeframe == 'Baseline',]
    temp1 = COMBO_R()[COMBO_R()$Timeframe == 'Baseline',]
    
    C_data1 = temp1[,c('Category','Total_C_Footprint','Timeframe')] # Units = MT
    N_data1 = temp1[,c('Category','Total_N_Footprint','Timeframe')] # Units = MT
    P_data1 = temp1[,c('Category','Total_P_Footprint','Timeframe')] # Units = MT
    W_data1 = temp1[,c('Category','Total_W_Footprint','Timeframe')] # Units = Gallons
    
    C_data1$Footprint = C_data1$Total_C_Footprint
    N_data1$Footprint = N_data1$Total_N_Footprint
    P_data1$Footprint = P_data1$Total_P_Footprint
    W_data1$Footprint = W_data1$Total_W_Footprint
    
    C_data1 = C_data1[,c('Category','Footprint','Timeframe')]
    N_data1 = N_data1[,c('Category','Footprint','Timeframe')]
    P_data1 = P_data1[,c('Category','Footprint','Timeframe')]
    W_data1 = W_data1[,c('Category','Footprint','Timeframe')]
    
    C_data1$NAME = 'Carbon'
    N_data1$NAME = 'Nitrogen'
    P_data1$NAME = 'Phosphorus'
    W_data1$NAME = 'Water'
    
    food1 = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    energy1 = Energy_R()[Energy_R()$Timeframe == 'Baseline',]
    commut_fac1 = Commut_Fac_R()[Commut_Fac_R()$Timeframe == 'Baseline',]
    commut_staf1 = Commut_Staff_R()[Commut_Staff_R()$Timeframe == 'Baseline',]
    commut_stud1 = Commut_Stud_R()[Commut_Stud_R()$Timeframe == 'Baseline',]
    # food1 = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
    # energy1 = Energy_R[Energy_R$Timeframe == 'Baseline',]
    # commut_fac1 = Commut_Fac_R[Commut_Fac_R$Timeframe == 'Baseline',]
    # commut_staf1 = Commut_Staff_R[Commut_Staff_R$Timeframe == 'Baseline',]
    # commut_stud1 = Commut_Stud_R[Commut_Stud_R$Timeframe == 'Baseline',]
    
    #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
    # Get food total from food tab - convert kg to MT by dividing by 1000
    Cfood1_tot = sum(food1$C_Footprint)/1000 # Units = MT
    Nfood1_tot = sum(food1$N_Footprint)/1000 # Units = MT
    Pfood1_tot = sum(food1$P_Footprint)/1000 # Units = MT
    Wfood1_tot = sum(food1$B_Footprint) # Units = gallons
    
    # Exchange the food value with the one from food tab
    C_data1$Footprint[C_data1$Category == "Food"] <- Cfood1_tot # Units = MT
    N_data1$Footprint[N_data1$Category == "Food"] <- Nfood1_tot # Units = MT
    P_data1$Footprint[P_data1$Category == "Food"] <- Pfood1_tot # Units = MT
    W_data1$Footprint[W_data1$Category == "Food"] <- Wfood1_tot # Units = MT
    
    # Convert Water units from gallons to cubic meters (m3)
    W_data1$Footprint = W_data1$Footprint*0.00378541 # Convering gallons to m3
    
    #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
    # Get unique column header before merge
    C_data1$C_Footprint = C_data1$Footprint
    N_data1$N_Footprint = N_data1$Footprint
    P_data1$P_Footprint = P_data1$Footprint
    W_data1$W_Footprint = W_data1$Footprint
    
    combo_table1 = merge(C_data1[,c('Category','C_Footprint')],
                         N_data1[,c('Category','N_Footprint')],by='Category')
    combo_table1 = merge(combo_table1,P_data1[,c('Category','P_Footprint')],by='Category')
    combo_table1 = merge(combo_table1,W_data1[,c('Category','W_Footprint')],by='Category')
    
    # Round decimal places
    combo_table1$C_Footprint = round(combo_table1$C_Footprint,0)
    combo_table1$N_Footprint = round(combo_table1$N_Footprint,0)
    combo_table1$P_Footprint = round(combo_table1$P_Footprint,0)
    combo_table1$W_Footprint = round(combo_table1$W_Footprint,0)
    
    # Rearrange the rows to match the slider rows
    combo_table1 = rbind(combo_table1[combo_table1$Category=='Purchased Electricity',],
                         combo_table1[combo_table1$Category=='Food',],
                         combo_table1[combo_table1$Category=='On-Campus Stationary Sources',],
                         combo_table1[combo_table1$Category=='Direct Transportation Sources',],
                         combo_table1[combo_table1$Category=='Commuting',],
                         combo_table1[combo_table1$Category=='Directly Financed Outsourced Travel',],
                         combo_table1[combo_table1$Category=='Agriculture Sources',],
                         combo_table1[combo_table1$Category=='Refrigerants & Chemicals',],
                         combo_table1[combo_table1$Category=='Wastewater',],
                         combo_table1[combo_table1$Category=='Direct Water Use',])
     
  CNPW_TABLE1 = combo_table1
  
  }) # reactive
  
  # Table of Baseline footprint values
  output$CNPW_TABLE1 <- DT::renderDataTable({
    
    #if(input$scenario == "Manual Scenario"){ # table
      
    combo_table1 = CNPW_TABLE1()
    
    datatable(colnames=c("Category","C Footprint (Metric Tons C equivalents)",
                         "N Footprint (Metric Tons)",
                         "P Footprint (Metric Tons)",
                         "W Footptrint (m<sup>3</sup>)"),
              combo_table1, escape = FALSE)
  }) 
  
  # Table of Projected Footprint values
  CNPW_TABLE2 <- reactive({
    
    #if(input$scenario == "Manual Scenario"){
    # temp2 = COMBO_R[COMBO_R$Timeframe == 'Projected',]
    temp2 = COMBO_R()[COMBO_R()$Timeframe == 'Projected',]
    
    C_data2 = temp2[,c('Category','Total_C_Footprint','Timeframe')] # Units = MT
    N_data2 = temp2[,c('Category','Total_N_Footprint','Timeframe')] # Units = MT
    P_data2 = temp2[,c('Category','Total_P_Footprint','Timeframe')] # Units = MT
    W_data2 = temp2[,c('Category','Total_W_Footprint','Timeframe')] # Units = Gallons
    
    C_data2$Footprint = C_data2$Total_C_Footprint
    N_data2$Footprint = N_data2$Total_N_Footprint
    P_data2$Footprint = P_data2$Total_P_Footprint
    W_data2$Footprint = W_data2$Total_W_Footprint
    
    C_data2 = C_data2[,c('Category','Footprint','Timeframe')]
    N_data2 = N_data2[,c('Category','Footprint','Timeframe')]
    P_data2 = P_data2[,c('Category','Footprint','Timeframe')]
    W_data2 = W_data2[,c('Category','Footprint','Timeframe')]
    
    C_data2$NAME = 'Carbon'
    N_data2$NAME = 'Nitrogen'
    P_data2$NAME = 'Phosphorus'
    W_data2$NAME = 'Water'
    
    food2 = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    energy2 = Energy_R()[Energy_R()$Timeframe == 'Projected',]
    commut_fac2 = Commut_Fac_R()[Commut_Fac_R()$Timeframe == 'Projected',]
    commut_staf2 = Commut_Staff_R()[Commut_Staff_R()$Timeframe == 'Projected',]
    commut_stud2 = Commut_Stud_R()[Commut_Stud_R()$Timeframe == 'Projected',]
    
    # food2 = FOOD_R[FOOD_R$Timeframe == 'Projected',]
    # energy2 = Energy_R[Energy_R$Timeframe == 'Projected',]
    # commut_fac2 = Commut_Fac_R[Commut_Fac_R$Timeframe == 'Projected',]
    # commut_staf2 = Commut_Staff_R[Commut_Staff_R$Timeframe == 'Projected',]
    # commut_stud2 = Commut_Stud_R[Commut_Stud_R$Timeframe == 'Projected',]
    
    #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
    # Get food total from food tab - convert kg to MT by dividing by 1000
    Cfood2_tot = sum(food2$C_Footprint)/1000 # Units = MT
    Nfood2_tot = sum(food2$N_Footprint)/1000 # Units = MT
    Pfood2_tot = sum(food2$P_Footprint)/1000 # Units = MT
    Wfood2_tot = sum(food2$B_Footprint) # Units = gallons
    
    # Get commuting total from commuting tab - units are MT
    Ccommut2_fac_tot = sum(commut_fac2$Total_C_Footprint)
    Ccommut2_staf_tot = sum(commut_staf2$Total_C_Footprint)
    Ccommut2_stud_tot = sum(commut_stud2$Total_C_Footprint)
    Ncommut2_fac_tot = sum(commut_fac2$Total_N_Footprint)
    Ncommut2_staf_tot = sum(commut_staf2$Total_N_Footprint)
    Ncommut2_stud_tot = sum(commut_stud2$Total_N_Footprint)
    Ccommut2_tot = Ccommut2_fac_tot+Ccommut2_staf_tot+Ccommut2_stud_tot
    Ncommut2_tot = Ncommut2_fac_tot+Ncommut2_staf_tot+Ncommut2_stud_tot
    
    # Get energy total energy from tab - initial units MT
    Cenergy2_tot = sum(energy2$Total_C_Footprint)
    Nenergy2_tot = sum(energy2$Total_N_Footprint)
    
    # Exchange the food value with the one from food tab
    C_data2$Footprint[C_data2$Category == "Food"] <- Cfood2_tot # Units = MT
    N_data2$Footprint[N_data2$Category == "Food"] <- Nfood2_tot # Units = MT
    P_data2$Footprint[P_data2$Category == "Food"] <- Pfood2_tot # Units = Gallons
    W_data2$Footprint[W_data2$Category == "Food"] <- Wfood2_tot # Units = Gallons
    
    # Exchange the commuting value with the one from commuting tab
    C_data2$Footprint[C_data2$Category == "Commuting"] <- Ccommut2_tot
    N_data2$Footprint[N_data2$Category == "Commuting"] <- Ncommut2_tot
    
    # Exchange the energy value with the one from energy tab
    C_data2$Footprint[C_data2$Category == "On-Campus Stationary Sources"] <- Cenergy2_tot
    N_data2$Footprint[N_data2$Category == "On-Campus Stationary Sources"] <- Nenergy2_tot
    
    # Convert Water units from gallons to cubic meters (m3)
    W_data2$Footprint = W_data2$Footprint*0.00378541 # Convering gallons to m3
    
    #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
    # Get unique column header before merge
    C_data2$C_Footprint = C_data2$Footprint
    N_data2$N_Footprint = N_data2$Footprint
    P_data2$P_Footprint = P_data2$Footprint
    W_data2$W_Footprint = W_data2$Footprint
    
    combo_table2 = merge(C_data2[,c('Category','C_Footprint')],
                         N_data2[,c('Category','N_Footprint')],by='Category')
    combo_table2 = merge(combo_table2,P_data2[,c('Category','P_Footprint')],by='Category')
    combo_table2 = merge(combo_table2,W_data2[,c('Category','W_Footprint')],by='Category')
    
    # Round decimal places
    combo_table2$C_Footprint = round(combo_table2$C_Footprint,0)
    combo_table2$N_Footprint = round(combo_table2$N_Footprint,0)
    combo_table2$P_Footprint = round(combo_table2$P_Footprint,0)
    combo_table2$W_Footprint = round(combo_table2$W_Footprint,0)
    
    # Rearrange the rows to match the slider rows
    combo_table2 = rbind(combo_table2[combo_table2$Category=='Purchased Electricity',],
                         combo_table2[combo_table2$Category=='Food',],
                         combo_table2[combo_table2$Category=='On-Campus Stationary Sources',],
                         combo_table2[combo_table2$Category=='Direct Transportation Sources',],
                         combo_table2[combo_table2$Category=='Commuting',],
                         combo_table2[combo_table2$Category=='Directly Financed Outsourced Travel',],
                         combo_table2[combo_table2$Category=='Agriculture Sources',],
                         combo_table2[combo_table2$Category=='Refrigerants & Chemicals',],
                         combo_table2[combo_table2$Category=='Wastewater',],
                         combo_table2[combo_table2$Category=='Direct Water Use',])
    CNPW_TABLE2 = combo_table2
    
  }) # reactive 
  
  
  output$CNPW_TABLE2 <- DT::renderDataTable({
    #if(input$scenario == "Manual Scenario"){ # table
      
    combo_table2 = CNPW_TABLE2()
  
    datatable(colnames=c("Category","C Footprint (Metric Tons C equivalents)",
                         "N Footprint (Metric Tons)",
                         "P Footprint (Metric Tons)",
                         "W Footptrint (m<sup>3</sup>)"),
              combo_table2, escape = FALSE)
    
       
  })
  
  
  
  # % Change Table for overall Footprints
  CNPW_TABLE3 <- reactive({
    #if(input$scenario == "Manual Scenario"){
    # temp1 = COMBO_R[COMBO_R$Timeframe == 'Baseline',]
    # temp2 = COMBO_R[COMBO_R$Timeframe == 'Projected',]
    temp1 = COMBO_R()[COMBO_R()$Timeframe == 'Baseline',]
    temp2 = COMBO_R()[COMBO_R()$Timeframe == 'Projected',]
    
    food1 = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    food2 = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    energy1 = Energy_R()[Energy_R()$Timeframe == 'Baseline',]
    energy2 = Energy_R()[Energy_R()$Timeframe == 'Projected',]
    commut_fac1 = Commut_Fac_R()[Commut_Fac_R()$Timeframe == 'Baseline',]
    commut_fac2 = Commut_Fac_R()[Commut_Fac_R()$Timeframe == 'Projected',]
    commut_staf1 = Commut_Staff_R()[Commut_Staff_R()$Timeframe == 'Baseline',]
    commut_staf2 = Commut_Staff_R()[Commut_Staff_R()$Timeframe == 'Projected',]
    commut_stud1 = Commut_Stud_R()[Commut_Stud_R()$Timeframe == 'Baseline',]
    commut_stud2 = Commut_Stud_R()[Commut_Stud_R()$Timeframe == 'Projected',]
    
    # food1 = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
    # food2 = FOOD_R[FOOD_R$Timeframe == 'Projected',]
    # energy1 = Energy_R[Energy_R$Timeframe == 'Baseline',]
    # energy2 = Energy_R[Energy_R$Timeframe == 'Projected',]
    # commut_fac1 = Commut_Fac_R[Commut_Fac_R$Timeframe == 'Baseline',]
    # commut_fac2 = Commut_Fac_R[Commut_Fac_R$Timeframe == 'Projected',]
    # commut_staf1 = Commut_Staff_R[Commut_Staff_R$Timeframe == 'Baseline',]
    # commut_staf2 = Commut_Staff_R[Commut_Staff_R$Timeframe == 'Projected',]
    # commut_stud1 = Commut_Stud_R[Commut_Stud_R$Timeframe == 'Baseline',]
    # commut_stud2 = Commut_Stud_R[Commut_Stud_R$Timeframe == 'Projected',]
    
    # Get food total from food tab - convert kg to MT by dividing by 1000
    Cfood1_tot = sum(food1$C_Footprint)/1000 # Units = MT
    Cfood2_tot = sum(food2$C_Footprint)/1000 # Units = MT
    Nfood1_tot = sum(food1$N_Footprint)/1000 # Units = MT
    Nfood2_tot = sum(food2$N_Footprint)/1000 # Units = MT
    Pfood1_tot = sum(food1$P_Footprint)/1000 # Units = MT
    Pfood2_tot = sum(food2$P_Footprint)/1000 # Units = MT
    Wfood1_tot = sum(food1$B_Footprint) # Units = gallons
    Wfood2_tot = sum(food2$B_Footprint) # Units = gallons
    
    # Get commuting total from commuting tab - units are MT
    Ccommut2_fac_tot = sum(commut_fac2$Total_C_Footprint)
    Ccommut2_staf_tot = sum(commut_staf2$Total_C_Footprint)
    Ccommut2_stud_tot = sum(commut_stud2$Total_C_Footprint)
    Ncommut2_fac_tot = sum(commut_fac2$Total_N_Footprint)
    Ncommut2_staf_tot = sum(commut_staf2$Total_N_Footprint)
    Ncommut2_stud_tot = sum(commut_stud2$Total_N_Footprint)
    Ccommut2_tot = Ccommut2_fac_tot+Ccommut2_staf_tot+Ccommut2_stud_tot
    Ncommut2_tot = Ncommut2_fac_tot+Ncommut2_staf_tot+Ncommut2_stud_tot
    
    # Get energy total energy from tab - initial units MT
    Cenergy2_tot = sum(energy2$Total_C_Footprint)
    Nenergy2_tot = sum(energy2$Total_N_Footprint)
    
    # Exchange the food value with the one from food tab
    temp1$Total_C_Footprint[temp1$Category == "Food"] <- Cfood1_tot # Units = MT
    temp1$Total_N_Footprint[temp1$Category == "Food"] <- Nfood1_tot # Units = MT
    temp1$Total_P_Footprint[temp1$Category == "Food"] <- Pfood1_tot # Units = MT
    temp1$Total_W_Footprint[temp1$Category == "Food"] <- Wfood1_tot # Units = MT
    temp2$Total_C_Footprint[temp2$Category == "Food"] <- Cfood2_tot # Units = MT
    temp2$Total_N_Footprint[temp2$Category == "Food"] <- Nfood2_tot # Units = MT
    temp2$Total_P_Footprint[temp2$Category == "Food"] <- Pfood2_tot # Units = Gallons
    temp2$Total_W_Footprint[temp2$Category == "Food"] <- Wfood2_tot # Units = Gallons
    
    # Exchange the commuting value with the one from commuting tab
    temp2$Total_C_Footprint[temp2$Category == "Commuting"] <- Ccommut2_tot
    temp2$Total_N_Footprint[temp2$Category == "Commuting"] <- Ncommut2_tot
    
    # Exchange the energy value with the one from energy tab
    temp2$Total_C_Footprint[temp2$Category == "On-Campus Stationary Sources"] <- Cenergy2_tot
    temp2$Total_N_Footprint[temp2$Category == "On-Campus Stationary Sources"] <- Nenergy2_tot
    
    # Convert Water units from gallons to cubic meters (m3)
    temp1$Total_W_Footprint = temp1$Total_W_Footprint*0.00378541 # Convering gallons to m3
    temp2$Total_W_Footprint = temp2$Total_W_Footprint*0.00378541 # Convering gallons to m3
    
    #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
    Tot_C_foot1 = sum(temp1$Total_C_Footprint) # Units = MT
    Tot_N_foot1 = sum(temp1$Total_N_Footprint) # Units = MT
    Tot_P_foot1 = sum(temp1$Total_P_Footprint) # Units = MT
    Tot_W_foot1 = sum(temp1$Total_W_Footprint) # Units = Gallons
    
    Tot_C_foot2 = sum(temp2$Total_C_Footprint) # Units = MT
    Tot_N_foot2 = sum(temp2$Total_N_Footprint) # Units = MT
    Tot_P_foot2 = sum(temp2$Total_P_Footprint) # Units = MT
    Tot_W_foot2 = sum(temp2$Total_W_Footprint) # Units = Gallons
    
    all_foot = data.frame(NAME = c("Carbon","Nitrogen","Phosphorus","Water"),
                          Footprint_c = c(Tot_C_foot1,Tot_N_foot1,Tot_P_foot1,Tot_W_foot1),
                          Footprint_p = c(Tot_C_foot2,Tot_N_foot2,Tot_P_foot2,Tot_W_foot2))
    
    all_foot$Difference = all_foot$Footprint_p - all_foot$Footprint_c
    all_foot$Perc_Change = 100*(all_foot$Footprint_p - all_foot$Footprint_c) / all_foot$Footprint_c
    
    names(all_foot) = c('NAME','Baseline_Footprint','Projected_Footprint',
                        'Difference','Perc_Change')
    
    #all_foot = all_foot[,c('NAME','Perc_Change')]
    
    # Round decimal places
    all_foot$Baseline_Footprint = round(all_foot$Baseline_Footprint,0)
    all_foot$Projected_Footprint = round(all_foot$Projected_Footprint,0)
    
    all_foot$Difference = round(all_foot$Difference,0)
    all_foot$Perc_Change = round(all_foot$Perc_Change,0)
    CNPW_TABLE3 = all_foot
    
     
    
  }) # reactive
  
  output$CNPW_TABLE3 <- DT::renderDataTable({ 
    #if(input$scenario == "Manual Scenario"){ # table
      
    
    all_foot = CNPW_TABLE3()
    
    datatable(colnames=c("Footprint","Baseline Footprint (MT or m<sup>3</sup> for water)",
                         "Projected Footprint (MT or m<sup>3</sup> for water)",
                         "Difference (MT or m<sup>3</sup> for water)","% Change in Footprint"),
              as.data.frame(all_foot),  escape = FALSE)
    
  })
  
  # Table for % Change in Footprint by Category
  CNPW_TABLE4 <- reactive({
    #if(input$scenario == "Manual Scenario"){
    # temp1 = COMBO_R[COMBO_R$Timeframe == 'Baseline',]
    # temp2 = COMBO_R[COMBO_R$Timeframe == 'Projected',]
    temp1 = COMBO_R()[COMBO_R()$Timeframe == 'Baseline',]
    temp2 = COMBO_R()[COMBO_R()$Timeframe == 'Projected',]
    
    C_data1 = temp1[,c('Category','Total_C_Footprint','Timeframe')] # Units = MT
    C_data2 = temp2[,c('Category','Total_C_Footprint','Timeframe')] # Units = MT
    N_data1 = temp1[,c('Category','Total_N_Footprint','Timeframe')] # Units = MT
    N_data2 = temp2[,c('Category','Total_N_Footprint','Timeframe')] # Units = MT
    P_data1 = temp1[,c('Category','Total_P_Footprint','Timeframe')] # Units = MT
    P_data2 = temp2[,c('Category','Total_P_Footprint','Timeframe')] # Units = MT
    W_data1 = temp1[,c('Category','Total_W_Footprint','Timeframe')] # Units = Gallons
    W_data2 = temp2[,c('Category','Total_W_Footprint','Timeframe')] # Units = Gallons
    
    C_data1$Footprint = C_data1$Total_C_Footprint
    C_data2$Footprint = C_data2$Total_C_Footprint
    N_data1$Footprint = N_data1$Total_N_Footprint
    N_data2$Footprint = N_data2$Total_N_Footprint
    P_data1$Footprint = P_data1$Total_P_Footprint
    P_data2$Footprint = P_data2$Total_P_Footprint
    W_data1$Footprint = W_data1$Total_W_Footprint
    W_data2$Footprint = W_data2$Total_W_Footprint
    
    C_data1 = C_data1[,c('Category','Footprint','Timeframe')]
    C_data2 = C_data2[,c('Category','Footprint','Timeframe')]
    N_data1 = N_data1[,c('Category','Footprint','Timeframe')]
    N_data2 = N_data2[,c('Category','Footprint','Timeframe')]
    P_data1 = P_data1[,c('Category','Footprint','Timeframe')]
    P_data2 = P_data2[,c('Category','Footprint','Timeframe')]
    W_data1 = W_data1[,c('Category','Footprint','Timeframe')]
    W_data2 = W_data2[,c('Category','Footprint','Timeframe')]
    
    C_data1$NAME = 'Carbon'
    C_data2$NAME = 'Carbon'
    N_data1$NAME = 'Nitrogen'
    N_data2$NAME = 'Nitrogen'
    P_data1$NAME = 'Phosphorus'
    P_data2$NAME = 'Phosphorus'
    W_data1$NAME = 'Water'
    W_data2$NAME = 'Water'
    
    food1 = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    food2 = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    energy1 = Energy_R()[Energy_R()$Timeframe == 'Baseline',]
    energy2 = Energy_R()[Energy_R()$Timeframe == 'Projected',]
    commut_fac1 = Commut_Fac_R()[Commut_Fac_R()$Timeframe == 'Baseline',]
    commut_fac2 = Commut_Fac_R()[Commut_Fac_R()$Timeframe == 'Projected',]
    commut_staf1 = Commut_Staff_R()[Commut_Staff_R()$Timeframe == 'Baseline',]
    commut_staf2 = Commut_Staff_R()[Commut_Staff_R()$Timeframe == 'Projected',]
    commut_stud1 = Commut_Stud_R()[Commut_Stud_R()$Timeframe == 'Baseline',]
    commut_stud2 = Commut_Stud_R()[Commut_Stud_R()$Timeframe == 'Projected',]
    
    
    #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
    # Get food total from food tab - convert kg to MT by dividing by 1000
    Cfood1_tot = sum(food1$C_Footprint)/1000 # Units = MT
    Cfood2_tot = sum(food2$C_Footprint)/1000 # Units = MT
    Nfood1_tot = sum(food1$N_Footprint)/1000 # Units = MT
    Nfood2_tot = sum(food2$N_Footprint)/1000 # Units = MT
    Pfood1_tot = sum(food1$P_Footprint)/1000 # Units = MT
    Pfood2_tot = sum(food2$P_Footprint)/1000 # Units = MT
    Wfood1_tot = sum(food1$B_Footprint)      # Units = Gallons
    Wfood2_tot = sum(food2$B_Footprint)      # Units = Gallons
    
    # Get commuting total from commuting tab - units are MT
    Ccommut2_fac_tot = sum(commut_fac2$Total_C_Footprint)
    Ccommut2_staf_tot = sum(commut_staf2$Total_C_Footprint)
    Ccommut2_stud_tot = sum(commut_stud2$Total_C_Footprint)
    Ncommut2_fac_tot = sum(commut_fac2$Total_N_Footprint)
    Ncommut2_staf_tot = sum(commut_staf2$Total_N_Footprint)
    Ncommut2_stud_tot = sum(commut_stud2$Total_N_Footprint)
    Ccommut2_tot = Ccommut2_fac_tot+Ccommut2_staf_tot+Ccommut2_stud_tot
    Ncommut2_tot = Ncommut2_fac_tot+Ncommut2_staf_tot+Ncommut2_stud_tot
    
    # Get energy total energy from tab - initial units MT
    Cenergy2_tot = sum(energy2$Total_C_Footprint)
    Nenergy2_tot = sum(energy2$Total_N_Footprint)
    
    # Exchange the food value with the one from food tab
    C_data1$Footprint[C_data1$Category == "Food"] <- Cfood1_tot
    N_data1$Footprint[N_data1$Category == "Food"] <- Nfood1_tot
    P_data1$Footprint[P_data1$Category == "Food"] <- Pfood1_tot
    W_data1$Footprint[W_data1$Category == "Food"] <- Wfood1_tot
    C_data2$Footprint[C_data2$Category == "Food"] <- Cfood2_tot
    N_data2$Footprint[N_data2$Category == "Food"] <- Nfood2_tot
    P_data2$Footprint[P_data2$Category == "Food"] <- Pfood2_tot
    W_data2$Footprint[W_data2$Category == "Food"] <- Wfood2_tot
    
    # Exchange the commuting value with the one from commuting tab
    #C_data1$Footprint[C_data1$Category == "Commuting"] <- Ccommut1_tot
    #N_data1$Footprint[N_data1$Category == "Commuting"] <- Ncommut1_tot
    C_data2$Footprint[C_data2$Category == "Commuting"] <- Ccommut2_tot
    N_data2$Footprint[N_data2$Category == "Commuting"] <- Ncommut2_tot
    
    # Exchange the energy value with the one from energy tab
    #C_data1$Footprint[C_data1$Category == "On-Campus Stationary Sources"] <- Cenergy1_tot
    #N_data1$Footprint[N_data1$Category == "On-Campus Stationary Sources"] <- Nenergy1_tot
    C_data2$Footprint[C_data2$Category == "On-Campus Stationary Sources"] <- Cenergy2_tot
    N_data2$Footprint[N_data2$Category == "On-Campus Stationary Sources"] <- Nenergy2_tot
    
    # Convert Water units from gallons to cubic meters (m3)
    W_data1$Footprint = W_data1$Footprint*0.00378541 # Convering gallons to m3
    W_data2$Footprint = W_data2$Footprint*0.00378541 # Convering gallons to m3
    
    #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
    C_data1 = C_data1[,c('Category','Footprint')]
    C_data2 = C_data2[,c('Category','Footprint')]
    N_data1 = N_data1[,c('Category','Footprint')]
    N_data2 = N_data2[,c('Category','Footprint')]
    P_data1 = P_data1[,c('Category','Footprint')]
    P_data2 = P_data2[,c('Category','Footprint')]
    W_data1 = W_data1[,c('Category','Footprint')]
    W_data2 = W_data2[,c('Category','Footprint')]
    
    names(C_data1) = c('Category','C_Footprint_c')
    names(C_data2) = c('Category','C_Footprint_p')
    names(N_data1) = c('Category','N_Footprint_c')
    names(N_data2) = c('Category','N_Footprint_p')
    names(P_data1) = c('Category','P_Footprint_c')
    names(P_data2) = c('Category','P_Footprint_p')
    names(W_data1) = c('Category','W_Footprint_c')
    names(W_data2) = c('Category','W_Footprint_p')
    
    C_data = merge(C_data1,C_data2,by='Category')
    N_data = merge(N_data1,N_data2,by='Category')
    P_data = merge(P_data1,P_data2,by='Category')
    W_data = merge(W_data1,W_data2,by='Category')
    
    C_data$Perc_Change_C = 100*(C_data$C_Footprint_p - C_data$C_Footprint_c) / C_data$C_Footprint_c
    N_data$Perc_Change_N = 100*(N_data$N_Footprint_p - N_data$N_Footprint_c) / N_data$N_Footprint_c
    P_data$Perc_Change_P = 100*(P_data$P_Footprint_p - P_data$P_Footprint_c) / P_data$P_Footprint_c
    W_data$Perc_Change_W = 100*(W_data$W_Footprint_p - W_data$W_Footprint_c) / W_data$W_Footprint_c
    
    combo_table4 = merge(C_data[,c('Category','Perc_Change_C')],
                         N_data[,c('Category','Perc_Change_N')],by='Category')
    combo_table4 = merge(combo_table4,P_data[,c('Category','Perc_Change_P')],by='Category')
    combo_table4 = merge(combo_table4,W_data[,c('Category','Perc_Change_W')],by='Category')
    
    # Round decimal places
    combo_table4$Perc_Change_C = round(combo_table4$Perc_Change_C,0)
    combo_table4$Perc_Change_N = round(combo_table4$Perc_Change_N,0)
    combo_table4$Perc_Change_P = round(combo_table4$Perc_Change_P,0)
    combo_table4$Perc_Change_W = round(combo_table4$Perc_Change_W,0)
    
    # Rearrange the rows to match the slider rows
    
    combo_table4 = rbind(combo_table4[combo_table4$Category=='Purchased Electricity',],
                         combo_table4[combo_table4$Category=='Food',],
                         combo_table4[combo_table4$Category=='On-Campus Stationary Sources',],
                         combo_table4[combo_table4$Category=='Direct Transportation Sources',],
                         combo_table4[combo_table4$Category=='Commuting',],
                         combo_table4[combo_table4$Category=='Directly Financed Outsourced Travel',],
                         combo_table4[combo_table4$Category=='Agriculture Sources',],
                         combo_table4[combo_table4$Category=='Refrigerants & Chemicals',],
                         combo_table4[combo_table4$Category=='Wastewater',],
                         combo_table4[combo_table4$Category=='Direct Water Use',])
    
    
  }) # reactive 
  
  output$CNPW_TABLE4 <- DT::renderDataTable({
    #if(input$scenario == "Manual Scenario"){ # table
      
    combo_table4 = CNPW_TABLE4()
    datatable(colnames=c("Category","% Change in C Footprint",
                         "% Change in N Footprint",
                         "% Change in P Footprint",
                         "% Change in W Footprint"),
              combo_table4)
     
  })
  
  #************************************************************************************
  # COMMUTING PLOTS
  #************************************************************************************
  
  # This it the plot output part
  
  # Initial Units are MT C, kg N
  
  # % of Footprint >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  output$Comm_Plot1 <- renderPlot({
    #if(input$scenario == "Manual Scenario"){ # plot
    
    ## Function to extract legend
    g_legend <- function(a.gplot){ 
      tmp <- ggplot_gtable(ggplot_build(a.gplot)) 
      leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box") 
      legend <- tmp$grobs[[leg]] 
      legend
    }
    
    # CN_commut1_ = Commut_R1[Commut_R1$Timeframe == 'Baseline',]
    # CN_commut2_ = Commut_R1[Commut_R1$Timeframe == 'Projected',]
    CN_commut1_ = Commut_R1()[Commut_R1()$Timeframe == 'Baseline',]
    CN_commut2_ = Commut_R1()[Commut_R1()$Timeframe == 'Projected',]
    
    C_commut1 = CN_commut1_[,c('Category','Sub_category','Total_C_Footprint','Timeframe')]
    C_commut2 = CN_commut2_[,c('Category','Sub_category','Total_C_Footprint','Timeframe')]
    N_commut1 = CN_commut1_[,c('Category','Sub_category','Total_N_Footprint','Timeframe')]
    N_commut2 = CN_commut2_[,c('Category','Sub_category','Total_N_Footprint','Timeframe')]
    
    C_commut1$Footprint = C_commut1$Total_C_Footprint
    C_commut2$Footprint = C_commut2$Total_C_Footprint
    N_commut1$Footprint = N_commut1$Total_N_Footprint
    N_commut2$Footprint = N_commut2$Total_N_Footprint
    
    C_commut1$NAME = 'Carbon'
    C_commut2$NAME = 'Carbon'
    N_commut1$NAME = 'Nitrogen'
    N_commut2$NAME = 'Nitrogen'
    
    
    # Add in Percent (%)
    C_commut1$Perc_Foot = round(100*C_commut1$Footprint/sum(C_commut1$Footprint),1)
    C_commut2$Perc_Foot = round(100*C_commut2$Footprint/sum(C_commut2$Footprint),1)
    N_commut1$Perc_Foot = round(100*N_commut1$Footprint/sum(N_commut1$Footprint),1)
    N_commut2$Perc_Foot = round(100*N_commut2$Footprint/sum(N_commut2$Footprint),1)
    
    
    CN_commut1 = rbind(C_commut1[,c('Sub_category','Perc_Foot','NAME')],
                       N_commut1[,c('Sub_category','Perc_Foot','NAME')])
    CN_commut2 = rbind(C_commut2[,c('Sub_category','Perc_Foot','NAME')],
                       N_commut2[,c('Sub_category','Perc_Foot','NAME')])
    
    # Change order of Sub_category
    #CN_commut1$Sub_category <- factor(CN_commut1$Sub_category, levels = sorder)
    #CN_commut2$Sub_category <- factor(CN_commut2$Sub_category, levels = sorder)
    
    # For the color Pallete
    lvls = c(levels(factor(CN_commut1$Sub_category)))
    mypal = brewer.pal(length(lvls),"Paired") # Color Blind Friendly Palette
    #getPalette = colorRampPalette(brewer.pal(9, "Set1"))
    #getPalette = colorRampPalette(brewer.pal(12, "Paired"))
    #mypal = getPalette(length(lvls))
    
    # Stacked Bar Chart
    
    # This first plot is just for the legend
    legen = ggplot(data = CN_commut1, aes(x = NAME, y=Perc_Foot,fill = Sub_category))+ 
      geom_bar(stat="identity")+ 
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")
    
    # Plotting Percent of C and N
    cn3 = ggplot(data = CN_commut1, aes(x = NAME, y=Perc_Foot,fill = Sub_category))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Baseline")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="Percent of Footprint")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    
    cn4 = ggplot(data = CN_commut2, aes(x = NAME, y=Perc_Foot,fill = Sub_category))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Projected")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="Percent of Footprint")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    leg4 <- g_legend(legen)
    
    grid.arrange(cn3,cn4,leg4,nrow=1,ncol=3)
    
    
  })
  
  # Mass of Footprint >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  output$Comm_Plot2 <- renderPlot({
    #if(input$scenario == "Manual Scenario"){ # plot
      
    ## Function to extract legend
    g_legend <- function(a.gplot){
      tmp <- ggplot_gtable(ggplot_build(a.gplot))
      leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
      legend <- tmp$grobs[[leg]]
      legend
    }
    
    # subsetting out DATA2 from above DATA_all
    #CN_commut1 = Commut_R1[Commut_R1$Timeframe == 'Baseline',]
    #CN_commut2 = Commut_R1[Commut_R1$Timeframe == 'Projected',]
    CN_commut1 = Commut_R1()[Commut_R1()$Timeframe == 'Baseline',]
    CN_commut2 = Commut_R1()[Commut_R1()$Timeframe == 'Projected',]
    
    # Change order of Source
    #CN_commut1$Source <- factor(CN_commut1$Source, levels = sorder)
    #CN_commut2$Source <- factor(CN_commut2$Source, levels = sorder)
    
    C_commut1 = CN_commut1[,c('Category','Sub_category','Total_C_Footprint','Timeframe')]
    C_commut2 = CN_commut2[,c('Category','Sub_category','Total_C_Footprint','Timeframe')]
    N_commut1 = CN_commut1[,c('Category','Sub_category','Total_N_Footprint','Timeframe')]
    N_commut2 = CN_commut2[,c('Category','Sub_category','Total_N_Footprint','Timeframe')]
    
    C_commut1$Footprint = C_commut1$Total_C_Footprint
    C_commut2$Footprint = C_commut2$Total_C_Footprint
    
    # Convert MT to kg in order to plot with C
    N_commut1$Footprint = N_commut1$Total_N_Footprint*1000
    N_commut2$Footprint = N_commut2$Total_N_Footprint*1000
    C_commut1$NAME = 'Carbon'
    C_commut2$NAME = 'Carbon'
    N_commut1$NAME = 'Nitrogen'
    N_commut2$NAME = 'Nitrogen'
    
    CN_commut1 = rbind(C_commut1[,c('Sub_category','Footprint','NAME')],
                       N_commut1[,c('Sub_category','Footprint','NAME')])
    CN_commut2 = rbind(C_commut2[,c('Sub_category','Footprint','NAME')],
                       N_commut2[,c('Sub_category','Footprint','NAME')])
    
    # For the color Pallete
    lvls = c(levels(factor(CN_commut1$Sub_category)))
    mypal = brewer.pal(length(lvls),"Paired") # Color Blind Friendly Palette
    #getPalette = colorRampPalette(brewer.pal(9, "Set1"))
    #getPalette = colorRampPalette(brewer.pal(12, "Paired"))
    #mypal = getPalette(length(lvls))
    
    # This first plot is just for the legend
    legen = ggplot(data = CN_commut1, aes(x = NAME, y=Footprint,fill = Sub_category))+
      geom_bar(stat="identity")+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")
    
    # Plot Mass Comparison of C & N for Commuting
    
    cn1 = ggplot(data = CN_commut1, aes(x = NAME, y=Footprint,fill = Sub_category))+
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Baseline")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="Metric Tons C & kg of N")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      scale_y_continuous(expand=c(0,0))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      scale_fill_manual(values = mypal)+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    cn2 = ggplot(data = CN_commut2, aes(x = NAME, y=Footprint,fill = Sub_category))+
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Projected")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="Metric Tons C & kg of N")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    leg1 <- g_legend(legen)
    grid.arrange(cn1,cn2,leg1,nrow=1,ncol=3)
    
    
    
  }) 
  
  # Table of Baseline footprint >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  output$COMMUT_TABLE1 <- DT::renderDataTable({
    #if(input$scenario == "Manual Scenario"){ # table
      
    # subsetting out DATA2 from above DATA_all
    #CN_commut1 = Commut_R1[Commut_R1$Timeframe == 'Baseline',]
    CN_commut1 = Commut_R1()[Commut_R1()$Timeframe == 'Baseline',]
    
    C_commut1 = CN_commut1[,c('Category','Sub_category','Total_C_Footprint','Timeframe')]
    N_commut1 = CN_commut1[,c('Category','Sub_category','Total_N_Footprint','Timeframe')]
    
    C_commut1$C_Footprint = C_commut1$Total_C_Footprint
    N_commut1$N_Footprint = N_commut1$Total_N_Footprint
    
    # combine footprints
    all_c1 = merge(C_commut1[,c('Sub_category','C_Footprint')],
                   N_commut1[,c('Sub_category','N_Footprint')],by='Sub_category')
    
    # Round decimal places
    all_c1$C_Footprint = round(all_c1$C_Footprint,0)
    all_c1$N_Footprint = round(all_c1$N_Footprint,0)
    
    
    datatable(colnames=c("Sub-Category","C Footprint MT C equivalents",
                         "N Footprint MT"),
              all_c1)
    
    
  })
  
  # Table of Projected Footprint >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  output$COMMUT_TABLE2 <- DT::renderDataTable({
    #if(input$scenario == "Manual Scenario"){ # table
      
    # subsetting out DATA2 from above DATA_all
    #CN_commut2 = Commut_R1[Commut_R1$Timeframe == 'Projected',]
    CN_commut2 = Commut_R1()[Commut_R1()$Timeframe == 'Projected',]
    
    C_commut2 = CN_commut2[,c('Category','Sub_category','Total_C_Footprint','Timeframe')]
    N_commut2 = CN_commut2[,c('Category','Sub_category','Total_N_Footprint','Timeframe')]
    
    C_commut2$C_Footprint = C_commut2$Total_C_Footprint
    N_commut2$N_Footprint = N_commut2$Total_N_Footprint
    
    # combine footprints
    all_c2 = merge(C_commut2[,c('Sub_category','C_Footprint')],
                   N_commut2[,c('Sub_category','N_Footprint')],by='Sub_category')
    
    # Round decimal places
    all_c2$C_Footprint = round(all_c2$C_Footprint,0)
    all_c2$N_Footprint = round(all_c2$N_Footprint,0)
    
    datatable(colnames=c("Sub-Category","C Footprint MT C equivalents",
                         "N Footprint MT"),
              all_c2)
  
  })
  
  # % Change Table
  output$COMMUT_TABLE3 <- DT::renderDataTable({
    #if(input$scenario == "Manual Scenario"){ # table
      
    #CN_commut1 = Commut_R1[Commut_R1$Timeframe == 'Baseline',]
    #CN_commut2 = Commut_R1[Commut_R1$Timeframe == 'Projected',]
    CN_commut1 = Commut_R1()[Commut_R1()$Timeframe == 'Baseline',]
    CN_commut2 = Commut_R1()[Commut_R1()$Timeframe == 'Projected',]
    
    Tot_C_commut1 = sum(CN_commut1$Total_C_Footprint)
    Tot_N_commut1 = sum(CN_commut1$Total_N_Footprint)
    
    Tot_C_commut2 = sum(CN_commut2$Total_C_Footprint)
    Tot_N_commut2 = sum(CN_commut2$Total_N_Footprint)
    
    all_commut = data.frame(NAME = c("Carbon from Commuting","Nitrogen from Commuting"),
                            Footprint_c = c(Tot_C_commut1,Tot_N_commut1),
                            Footprint_p = c(Tot_C_commut2,Tot_N_commut2))
    
    all_commut$Perc_Change = 100*(all_commut$Footprint_p - all_commut$Footprint_c) / all_commut$Footprint_c
    
    all_commut = all_commut[,c('NAME','Perc_Change')]
    
    # Round decimal places
    all_commut$Perc_Change = round(all_commut$Perc_Change,0)
    
    datatable(colnames=c("Commuting Footprint","% Change in Commuting Footprint"),
              all_commut)
    
  })
  
  #************************************************************************************
  # C & N COMMUT SUB PLOTS
  #************************************************************************************
  
  # Units are MT C, kg N 
  
  # This it the plot output part
  
  #**********************************************************
  # Faculty Plots
  output$Comm_SubPlot1 <- renderPlot({
    #if(input$scenario == "Manual Scenario"){ # plot
      
    ## Function to extract legend
    g_legend <- function(a.gplot){ 
      tmp <- ggplot_gtable(ggplot_build(a.gplot)) 
      leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box") 
      legend <- tmp$grobs[[leg]] 
      legend
    }
    
    # Subset out data
    # Commut_sub1a = Commut_Fac_R[Commut_Fac_R$Timeframe == 'Baseline',]
    # Commut_sub2a = Commut_Fac_R[Commut_Fac_R$Timeframe == 'Projected',]
    Commut_sub1a = Commut_Fac_R()[Commut_Fac_R()$Timeframe == 'Baseline',]
    Commut_sub2a = Commut_Fac_R()[Commut_Fac_R()$Timeframe == 'Projected',]
    C_commut_sub1a = Commut_sub1a[,c('Source','Total_C_Footprint')]
    C_commut_sub2a = Commut_sub2a[,c('Source','Total_C_Footprint')]
    N_commut_sub1a = Commut_sub1a[,c('Source','Total_N_Footprint')]
    N_commut_sub2a = Commut_sub2a[,c('Source','Total_N_Footprint')]
    C_commut_sub1a$Footprint = C_commut_sub1a$Total_C_Footprint
    C_commut_sub2a$Footprint = C_commut_sub2a$Total_C_Footprint
    N_commut_sub1a$Footprint = N_commut_sub1a$Total_N_Footprint
    N_commut_sub2a$Footprint = N_commut_sub2a$Total_N_Footprint
    
    # Add in Percent (%)
    C_commut_sub1a$Perc_Foot = round(100*C_commut_sub1a$Footprint/sum(C_commut_sub1a$Footprint),1)
    C_commut_sub2a$Perc_Foot = round(100*C_commut_sub2a$Footprint/sum(C_commut_sub2a$Footprint),1)
    
    N_commut_sub1a$Perc_Foot = round(100*N_commut_sub1a$Footprint/sum(N_commut_sub1a$Footprint),1)
    N_commut_sub2a$Perc_Foot = round(100*N_commut_sub2a$Footprint/sum(N_commut_sub2a$Footprint),1)
    
    C_commut_sub1a$NAME = 'Carbon'
    C_commut_sub2a$NAME = 'Carbon'
    N_commut_sub1a$NAME = 'Nitrogen'
    N_commut_sub2a$NAME = 'Nitrogen'
    C_commut_sub1a$Timeframe = 'Baseline'
    C_commut_sub2a$Timeframe = 'Projected'
    N_commut_sub1a$Timeframe = 'Baseline'
    N_commut_sub2a$Timeframe = 'Projected'
    
    C_commut_fac = rbind(C_commut_sub1a[,c('Source','Footprint','Perc_Foot','NAME','Timeframe')],
                         C_commut_sub2a[,c('Source','Footprint','Perc_Foot','NAME','Timeframe')])
    N_commut_fac = rbind(N_commut_sub1a[,c('Source','Footprint','Perc_Foot','NAME','Timeframe')],
                         N_commut_sub2a[,c('Source','Footprint','Perc_Foot','NAME','Timeframe')])
    
    
    # For the color Pallete
    lvls = c(levels(factor(C_commut_fac$Source)))
    mypal = brewer.pal(length(lvls),"Paired") # Color Blind Friendly Palette
    #getPalette = colorRampPalette(brewer.pal(12, "Paired"))
    
    # Stacked Bar Chart
    
    # This first plot is just for the legend
    legen = ggplot(data = C_commut_fac, aes(x = NAME, y=Perc_Foot,fill = Source))+ 
      geom_bar(stat="identity")+ 
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")
    
    # Plotting Percent of 
    fac1 = ggplot(data = C_commut_fac, aes(x = Timeframe, y=Perc_Foot,fill = Source))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "C - Faculty")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="Percent of Footprint")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    
    fac2 = ggplot(data = C_commut_fac, aes(x = Timeframe, y=Footprint,fill = Source))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "C - Faculty")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="Metric Tons C")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    fac3 = ggplot(data = N_commut_fac, aes(x = Timeframe, y=Perc_Foot,fill = Source))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "N - Faculty")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="Percent of Footprint")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    fac4 = ggplot(data = N_commut_fac, aes(x = Timeframe, y=Footprint,fill = Source))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "N - Faculty")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="Kg of N")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    leg1 <- g_legend(legen)
    
    grid.arrange(fac1,fac2,fac3,fac4,leg1,nrow=1,ncol=5)
    
     
  })
  
  
  #**********************************************************
  # Staff Plots
  output$Comm_SubPlot2 <- renderPlot({
    #if(input$scenario == "Manual Scenario"){ # plot
      
    ## Function to extract legend
    g_legend <- function(a.gplot){ 
      tmp <- ggplot_gtable(ggplot_build(a.gplot)) 
      leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box") 
      legend <- tmp$grobs[[leg]] 
      legend
    }
    
    # Subset out data
    # Commut_sub1b = Commut_Staff_R[Commut_Staff_R$Timeframe == 'Baseline',]
    # Commut_sub2b = Commut_Staff_R[Commut_Staff_R$Timeframe == 'Projected',]
    Commut_sub1b = Commut_Staff_R()[Commut_Staff_R()$Timeframe == 'Baseline',]
    Commut_sub2b = Commut_Staff_R()[Commut_Staff_R()$Timeframe == 'Projected',]
    C_commut_sub1b = Commut_sub1b[,c('Source','Total_C_Footprint')]
    C_commut_sub2b = Commut_sub2b[,c('Source','Total_C_Footprint')]
    N_commut_sub1b = Commut_sub1b[,c('Source','Total_N_Footprint')]
    N_commut_sub2b = Commut_sub2b[,c('Source','Total_N_Footprint')]
    C_commut_sub1b$Footprint = C_commut_sub1b$Total_C_Footprint
    C_commut_sub2b$Footprint = C_commut_sub2b$Total_C_Footprint
    N_commut_sub1b$Footprint = N_commut_sub1b$Total_N_Footprint
    N_commut_sub2b$Footprint = N_commut_sub2b$Total_N_Footprint
    
    # Add in Percent (%)
    C_commut_sub1b$Perc_Foot = round(100*C_commut_sub1b$Footprint/sum(C_commut_sub1b$Footprint),1)
    C_commut_sub2b$Perc_Foot = round(100*C_commut_sub2b$Footprint/sum(C_commut_sub2b$Footprint),1)
    
    N_commut_sub1b$Perc_Foot = round(100*N_commut_sub1b$Footprint/sum(N_commut_sub1b$Footprint),1)
    N_commut_sub2b$Perc_Foot = round(100*N_commut_sub2b$Footprint/sum(N_commut_sub2b$Footprint),1)
    
    C_commut_sub1b$NAME = 'Carbon'
    C_commut_sub2b$NAME = 'Carbon'
    N_commut_sub1b$NAME = 'Nitrogen'
    N_commut_sub2b$NAME = 'Nitrogen'
    C_commut_sub1b$Timeframe = 'Baseline'
    C_commut_sub2b$Timeframe = 'Projected'
    N_commut_sub1b$Timeframe = 'Baseline'
    N_commut_sub2b$Timeframe = 'Projected'
    
    C_commut_staf = rbind(C_commut_sub1b[,c('Source','Footprint','Perc_Foot','NAME','Timeframe')],
                          C_commut_sub2b[,c('Source','Footprint','Perc_Foot','NAME','Timeframe')])
    N_commut_staf = rbind(N_commut_sub1b[,c('Source','Footprint','Perc_Foot','NAME','Timeframe')],
                          N_commut_sub2b[,c('Source','Footprint','Perc_Foot','NAME','Timeframe')])
    
    # For the color Pallete
    lvls = c(levels(factor(C_commut_staf$Source)))
    mypal = brewer.pal(length(lvls),"Paired") # Color Blind Friendly Palette
    #getPalette = colorRampPalette(brewer.pal(12, "Paired"))
    
    # Stacked Bar Chart
    
    # This first plot is just for the legend
    legen = ggplot(data = C_commut_staf, aes(x = NAME, y=Perc_Foot,fill = Source))+ 
      geom_bar(stat="identity")+ 
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")
    
    # Plotting Percent of 
    staf1 = ggplot(data = C_commut_staf, aes(x = Timeframe, y=Perc_Foot,fill = Source))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "C - Staff")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="Percent of Footprint")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    
    staf2 = ggplot(data = C_commut_staf, aes(x = Timeframe, y=Footprint,fill = Source))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "C - Staff")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="Metric Tons C")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    staf3 = ggplot(data = N_commut_staf, aes(x = Timeframe, y=Perc_Foot,fill = Source))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "N - Staff")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="Percent of Footprint")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    staf4 = ggplot(data = N_commut_staf, aes(x = Timeframe, y=Footprint,fill = Source))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "N - Staff")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="Kg of N")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    leg1 <- g_legend(legen)
    
    grid.arrange(staf1,staf2,staf3,staf4,leg1,nrow=1,ncol=5)
    
  })
  
  #**********************************************************
  # Student Plots
  output$Comm_SubPlot3 <- renderPlot({
    #if(input$scenario == "Manual Scenario"){ # plot
      
    ## Function to extract legend
    g_legend <- function(a.gplot){ 
      tmp <- ggplot_gtable(ggplot_build(a.gplot)) 
      leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box") 
      legend <- tmp$grobs[[leg]] 
      legend
    }
    
    # Subset out data
    Commut_sub1c = Commut_Stud_R()[Commut_Stud_R()$Timeframe == 'Baseline',]
    Commut_sub2c = Commut_Stud_R()[Commut_Stud_R()$Timeframe == 'Projected',]
    C_commut_sub1c = Commut_sub1c[,c('Source','Total_C_Footprint')]
    C_commut_sub2c = Commut_sub2c[,c('Source','Total_C_Footprint')]
    N_commut_sub1c = Commut_sub1c[,c('Source','Total_N_Footprint')]
    N_commut_sub2c = Commut_sub2c[,c('Source','Total_N_Footprint')]
    C_commut_sub1c$Footprint = C_commut_sub1c$Total_C_Footprint
    C_commut_sub2c$Footprint = C_commut_sub2c$Total_C_Footprint
    N_commut_sub1c$Footprint = N_commut_sub1c$Total_N_Footprint
    N_commut_sub2c$Footprint = N_commut_sub2c$Total_N_Footprint
    
    # Add in Percent (%)
    C_commut_sub1c$Perc_Foot = round(100*C_commut_sub1c$Footprint/sum(C_commut_sub1c$Footprint),1)
    C_commut_sub2c$Perc_Foot = round(100*C_commut_sub2c$Footprint/sum(C_commut_sub2c$Footprint),1)
    
    N_commut_sub1c$Perc_Foot = round(100*N_commut_sub1c$Footprint/sum(N_commut_sub1c$Footprint),1)
    N_commut_sub2c$Perc_Foot = round(100*N_commut_sub2c$Footprint/sum(N_commut_sub2c$Footprint),1)
    
    C_commut_sub1c$NAME = 'Carbon'
    C_commut_sub2c$NAME = 'Carbon'
    N_commut_sub1c$NAME = 'Nitrogen'
    N_commut_sub2c$NAME = 'Nitrogen'
    C_commut_sub1c$Timeframe = 'Baseline'
    C_commut_sub2c$Timeframe = 'Projected'
    N_commut_sub1c$Timeframe = 'Baseline'
    N_commut_sub2c$Timeframe = 'Projected'
    
    C_commut_stud = rbind(C_commut_sub1c[,c('Source','Footprint','Perc_Foot','NAME','Timeframe')],
                          C_commut_sub2c[,c('Source','Footprint','Perc_Foot','NAME','Timeframe')])
    N_commut_stud = rbind(N_commut_sub1c[,c('Source','Footprint','Perc_Foot','NAME','Timeframe')],
                          N_commut_sub2c[,c('Source','Footprint','Perc_Foot','NAME','Timeframe')])
    
    
    
    # For the color Pallete
    lvls = c(levels(factor(C_commut_stud$Source)))
    mypal = brewer.pal(length(lvls),"Paired") # Color Blind Friendly Palette
    #getPalette = colorRampPalette(brewer.pal(12, "Paired"))
    
    # Stacked Bar Chart
    
    # This first plot is just for the legend
    legen = ggplot(data = C_commut_stud, aes(x = NAME, y=Perc_Foot,fill = Source))+ 
      geom_bar(stat="identity")+ 
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")
    
    # Plotting Percent of 
    stu1 = ggplot(data = C_commut_stud, aes(x = Timeframe, y=Perc_Foot,fill = Source))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "C - Students")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="Percent of Footprint")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    
    stu2 = ggplot(data = C_commut_stud, aes(x = Timeframe, y=Footprint,fill = Source))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "C - Students")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="Metric Tons C")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    stu3 = ggplot(data = N_commut_stud, aes(x = Timeframe, y=Perc_Foot,fill = Source))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "N - Students")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="Percent of Footprint")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    stu4 = ggplot(data = N_commut_stud, aes(x = Timeframe, y=Footprint,fill = Source))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "N - Students")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="Kg of N")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    leg1 <- g_legend(legen)
    
    grid.arrange(stu1,stu2,stu3,stu4,leg1,nrow=1,ncol=5)
    
    
  })
  
  # Table of Baseline Footprint >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  COMMUT_TABLE1a <- reactive({
    #if(input$scenario == "Manual Scenario"){ # table
      
    # subsetting out DATA2 from above DATA_all
    # Commut_sub1a = Commut_Fac_R[Commut_Fac_R$Timeframe == 'Baseline',]
    Commut_sub1a = Commut_Fac_R()[Commut_Fac_R()$Timeframe == 'Baseline',]
    
    C_commut_sub1a = Commut_sub1a[,c('Source','Total_C_Footprint')]
    N_commut_sub1a = Commut_sub1a[,c('Source','Total_N_Footprint')]
    C_commut_sub1a$C_Footprint = C_commut_sub1a$Total_C_Footprint
    N_commut_sub1a$N_Footprint = N_commut_sub1a$Total_N_Footprint
    
    # combine footprints
    all_c1 = merge(C_commut_sub1a[,c('Source','C_Footprint')],
                   N_commut_sub1a[,c('Source','N_Footprint')],by='Source')
    
    # Round decimal places
    all_c1$C_Footprint = round(all_c1$C_Footprint,0)
    all_c1$N_Footprint = round(all_c1$N_Footprint,0)
    all_a1 = all_c1
  })
  
  output$COMMUT_TABLE1a <- DT::renderDataTable({
    all_a1 = COMMUT_TABLE1a()
    datatable(colnames=c("Source","C Footprint MT C equivalents",
                         "N Footprint MT"),
              all_a1)
    
  })
  
  # Table of Projected Footprint >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  COMMUT_TABLE2a <- reactive({
    #if(input$scenario == "Manual Scenario"){ # table
      
    # subsetting out DATA2 from above DATA_all
    # Commut_sub2a = Commut_Fac_R[Commut_Fac_R$Timeframe == 'Projected',]
    Commut_sub2a = Commut_Fac_R()[Commut_Fac_R()$Timeframe == 'Projected',]
    C_commut_sub2a = Commut_sub2a[,c('Source','Total_C_Footprint')]
    N_commut_sub2a = Commut_sub2a[,c('Source','Total_N_Footprint')]
    C_commut_sub2a$C_Footprint = C_commut_sub2a$Total_C_Footprint
    N_commut_sub2a$N_Footprint = N_commut_sub2a$Total_N_Footprint
    
    # combine footprints
    all_c2 = merge(C_commut_sub2a[,c('Source','C_Footprint')],
                   N_commut_sub2a[,c('Source','N_Footprint')],by='Source')
    
    # Round decimal places
    all_c2$C_Footprint = round(all_c2$C_Footprint,0)
    all_c2$N_Footprint = round(all_c2$N_Footprint,0)
    all_a2 = all_c2
  })
  
  output$COMMUT_TABLE2a <- DT::renderDataTable({
    all_a2 = COMMUT_TABLE2a()
    datatable(colnames=c("Source","C Footprint MT C equivalents",
                         "N Footprint MT"),
              all_a2)
    
  })
  
  # % Change Table >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  COMMUT_TABLE3a <- reactive({
    #if(input$scenario == "Manual Scenario"){ # table
      
    # Commut_sub1a = Commut_Fac_R[Commut_Fac_R$Timeframe == 'Baseline',]
    # Commut_sub2a = Commut_Fac_R[Commut_Fac_R$Timeframe == 'Projected',]
    Commut_sub1a = Commut_Fac_R()[Commut_Fac_R()$Timeframe == 'Baseline',]
    Commut_sub2a = Commut_Fac_R()[Commut_Fac_R()$Timeframe == 'Projected',]
    
    Tot_C_commut1 = sum(Commut_sub1a$Total_C_Footprint)
    Tot_N_commut1 = sum(Commut_sub1a$Total_N_Footprint)
    
    Tot_C_commut2 = sum(Commut_sub2a$Total_C_Footprint)
    Tot_N_commut2 = sum(Commut_sub2a$Total_N_Footprint)
    
    all_commut = data.frame(NAME = c("Carbon from Commuting","Nitrogen from Commuting"),
                            Footprint_c = c(Tot_C_commut1,Tot_N_commut1),
                            Footprint_p = c(Tot_C_commut2,Tot_N_commut2))
    
    all_commut$Difference = all_commut$Footprint_p - all_commut$Footprint_c
    all_commut$Perc_Change = 100*(all_commut$Footprint_p - all_commut$Footprint_c) / all_commut$Footprint_c
    
    names(all_commut) = c("NAME","Baseline_Footprint","Projected_Footprint",
                          "Difference","Perc_Change")

    # Round decimal places
    all_commut$Baseline_Footprint = round(all_commut$Baseline_Footprint,0)
    all_commut$Projected_Footprint = round(all_commut$Projected_Footprint,0)
    all_commut$Difference = round(all_commut$Difference,0)
    all_commut$Perc_Change = round(all_commut$Perc_Change,0)
    all_commut_a = all_commut
  })
  
  output$COMMUT_TABLE3a <- DT::renderDataTable({
    all_commut_a = COMMUT_TABLE3a()
    datatable(colnames=c("Faculty Commuting Footprint",
                         "Baseline Footprint (MT)","Projected Footprint (MT)",
                         "Difference in Footprint (MT)",
                         "% Change in Faculty Commuting Footprint"),
              all_commut_a)
  })
  
  # Staff Tables
  
  # Table of Baseline Footprint >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  
  COMMUT_TABLE1b <- reactive({
    #if(input$scenario == "Manual Scenario"){ # table
      
    # subsetting out DATA2 from above DATA_all
    # Commut_sub1a = Commut_Staff_R[Commut_Staff_R$Timeframe == 'Baseline',]
    Commut_sub1b = Commut_Staff_R()[Commut_Staff_R()$Timeframe == 'Baseline',]
    C_commut_sub1b = Commut_sub1b[,c('Source','Total_C_Footprint')]
    N_commut_sub1b = Commut_sub1b[,c('Source','Total_N_Footprint')]
    C_commut_sub1b$C_Footprint = C_commut_sub1b$Total_C_Footprint
    N_commut_sub1b$N_Footprint = N_commut_sub1b$Total_N_Footprint
    
    # combine footprints
    all_c1 = merge(C_commut_sub1b[,c('Source','C_Footprint')],
                   N_commut_sub1b[,c('Source','N_Footprint')],by='Source')
    
    # Round decimal places
    all_c1$C_Footprint = round(all_c1$C_Footprint,0)
    all_c1$N_Footprint = round(all_c1$N_Footprint,0)
    all_b1 = all_c1
  })
  
  output$COMMUT_TABLE1b <- DT::renderDataTable({
    all_b1 = COMMUT_TABLE1b()
    datatable(colnames=c("Source","C Footprint MT C equivalents",
                         "N Footprint MT"),
              all_b1)
  })
  
  # Table of Projected Footprint >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  COMMUT_TABLE2b <- reactive({
    #if(input$scenario == "Manual Scenario"){ # table
      
    # subsetting out DATA2 from above DATA_all
    # Commut_sub2a = Commut_Staff_R[Commut_Staff_R$Timeframe == 'Projected',]
    Commut_sub2b = Commut_Staff_R()[Commut_Staff_R()$Timeframe == 'Projected',]
    C_commut_sub2b = Commut_sub2b[,c('Source','Total_C_Footprint')]
    N_commut_sub2b = Commut_sub2b[,c('Source','Total_N_Footprint')]
    C_commut_sub2b$C_Footprint = C_commut_sub2b$Total_C_Footprint
    N_commut_sub2b$N_Footprint = N_commut_sub2b$Total_N_Footprint
    
    # combine footprints
    all_c2 = merge(C_commut_sub2b[,c('Source','C_Footprint')],
                   N_commut_sub2b[,c('Source','N_Footprint')],by='Source')
    
    # Round decimal places
    all_c2$C_Footprint = round(all_c2$C_Footprint,0)
    all_c2$N_Footprint = round(all_c2$N_Footprint,0)
    all_b2 = all_c2
  })
  
  output$COMMUT_TABLE2b <- DT::renderDataTable({
    all_b2 = COMMUT_TABLE2b()
    datatable(colnames=c("Source","C Footprint MT C equivalents",
                         "N Footprint MT"),
              all_b2)
  })
  
  # % Change Table >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  COMMUT_TABLE3b <- reactive({

    # Commut_sub1a = Commut_Staff_R[Commut_Staff_R$Timeframe == 'Baseline',]
    # Commut_sub2a = Commut_Staff_R[Commut_Staff_R$Timeframe == 'Projected',]
    Commut_sub1b = Commut_Staff_R()[Commut_Staff_R()$Timeframe == 'Baseline',]
    Commut_sub2b = Commut_Staff_R()[Commut_Staff_R()$Timeframe == 'Projected',]
    
    Tot_C_commut1 = sum(Commut_sub1b$Total_C_Footprint)
    Tot_N_commut1 = sum(Commut_sub1b$Total_N_Footprint)
    
    Tot_C_commut2 = sum(Commut_sub2b$Total_C_Footprint)
    Tot_N_commut2 = sum(Commut_sub2b$Total_N_Footprint)
    
    all_commut = data.frame(NAME = c("Carbon from Commuting","Nitrogen from Commuting"),
                            Footprint_c = c(Tot_C_commut1,Tot_N_commut1),
                            Footprint_p = c(Tot_C_commut2,Tot_N_commut2))
    
    all_commut$Difference = all_commut$Footprint_p - all_commut$Footprint_c
    all_commut$Perc_Change = 100*(all_commut$Footprint_p - all_commut$Footprint_c) / all_commut$Footprint_c
    
    names(all_commut) = c("NAME","Baseline_Footprint","Projected_Footprint",
                          "Difference","Perc_Change")
    
    # Round decimal places
    all_commut$Baseline_Footprint = round(all_commut$Baseline_Footprint,0)
    all_commut$Projected_Footprint = round(all_commut$Projected_Footprint,0)
    all_commut$Difference = round(all_commut$Difference,0)
    all_commut$Perc_Change = round(all_commut$Perc_Change,0)
    all_commut_b = all_commut
  })
  
  output$COMMUT_TABLE3b <- DT::renderDataTable({
    all_commut_b = COMMUT_TABLE3b()
    datatable(colnames=c("Staff Commuting Footprint",
                         "Baseline Footprint (MT)","Projected Footprint (MT)",
                         "Difference in Footprint (MT)",
                         "% Change in Staff Commuting Footprint"),
              all_commut_b)
  })
  
  # Student Tables
  
  # Table of Baseline Footprint >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  COMMUT_TABLE1c <- reactive({
    #if(input$scenario == "Manual Scenario"){ # table
      
    # subsetting out DATA2 from above DATA_all
    # Commut_sub1a = Commut_Stud_R[Commut_Stud_R$Timeframe == 'Baseline',]
    Commut_sub1c = Commut_Stud_R()[Commut_Stud_R()$Timeframe == 'Baseline',]
    C_commut_sub1c = Commut_sub1c[,c('Source','Total_C_Footprint')]
    N_commut_sub1c = Commut_sub1c[,c('Source','Total_N_Footprint')]
    C_commut_sub1c$C_Footprint = C_commut_sub1c$Total_C_Footprint
    N_commut_sub1c$N_Footprint = N_commut_sub1c$Total_N_Footprint
    
    # combine footprints
    all_c1 = merge(C_commut_sub1c[,c('Source','C_Footprint')],
                   N_commut_sub1c[,c('Source','N_Footprint')],by='Source')
    
    # Round decimal places
    all_c1$C_Footprint = round(all_c1$C_Footprint,0)
    all_c1$N_Footprint = round(all_c1$N_Footprint,0)
    all_c1 = all_c1
  })
  
  output$COMMUT_TABLE1c <- DT::renderDataTable({
    all_c1 = COMMUT_TABLE1c()
    datatable(colnames=c("Source","C Footprint MT C equivalents",
                         "N Footprint MT"),
              all_c1)
  })
  
  # Table of Projected Footprint >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  COMMUT_TABLE2c <- reactive({
    #if(input$scenario == "Manual Scenario"){ # table
      
    # subsetting out DATA2 from above DATA_all
    # Commut_sub2a = Commut_Stud_R[Commut_Stud_R$Timeframe == 'Projected',]
    Commut_sub2c = Commut_Stud_R()[Commut_Stud_R()$Timeframe == 'Projected',]
    C_commut_sub2c = Commut_sub2c[,c('Source','Total_C_Footprint')]
    N_commut_sub2c = Commut_sub2c[,c('Source','Total_N_Footprint')]
    C_commut_sub2c$C_Footprint = C_commut_sub2c$Total_C_Footprint
    N_commut_sub2c$N_Footprint = N_commut_sub2c$Total_N_Footprint
    
    # combine footprints
    all_c2 = merge(C_commut_sub2c[,c('Source','C_Footprint')],
                   N_commut_sub2c[,c('Source','N_Footprint')],by='Source')
    
    # Round decimal places
    all_c2$C_Footprint = round(all_c2$C_Footprint,0)
    all_c2$N_Footprint = round(all_c2$N_Footprint,0)
    all_c2 = all_c2
  })
  
  output$COMMUT_TABLE2c <- DT::renderDataTable({
    all_c2 = COMMUT_TABLE2c()
    datatable(colnames=c("Source","C Footprint MT C equivalents",
                         "N Footprint MT"),
              all_c2)
  })
  
  # % Change Table >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  COMMUT_TABLE3c <- reactive({

    # Commut_sub1a = Commut_Stud_R[Commut_Stud_R$Timeframe == 'Baseline',]
    # Commut_sub2a = Commut_Stud_R[Commut_Stud_R$Timeframe == 'Projected',]
    Commut_sub1c = Commut_Stud_R()[Commut_Stud_R()$Timeframe == 'Baseline',]
    Commut_sub2c = Commut_Stud_R()[Commut_Stud_R()$Timeframe == 'Projected',]
    
    Tot_C_commut1 = sum(Commut_sub1c$Total_C_Footprint)
    Tot_N_commut1 = sum(Commut_sub1c$Total_N_Footprint)
    
    Tot_C_commut2 = sum(Commut_sub2c$Total_C_Footprint)
    Tot_N_commut2 = sum(Commut_sub2c$Total_N_Footprint)
    
    all_commut = data.frame(NAME = c("Carbon from Commuting","Nitrogen from Commuting"),
                            Footprint_c = c(Tot_C_commut1,Tot_N_commut1),
                            Footprint_p = c(Tot_C_commut2,Tot_N_commut2))
    
    all_commut$Difference = all_commut$Footprint_p - all_commut$Footprint_c
    all_commut$Perc_Change = 100*(all_commut$Footprint_p - all_commut$Footprint_c) / all_commut$Footprint_c
    
    names(all_commut) = c("NAME","Baseline_Footprint","Projected_Footprint",
                          "Difference","Perc_Change")
    
    # Round decimal places
    all_commut$Baseline_Footprint = round(all_commut$Baseline_Footprint,0)
    all_commut$Projected_Footprint = round(all_commut$Projected_Footprint,0)
    all_commut$Difference = round(all_commut$Difference,0)
    all_commut$Perc_Change = round(all_commut$Perc_Change,0)
    all_commut_c = all_commut
  })
  
  output$COMMUT_TABLE3c <- DT::renderDataTable({
    all_commut_c = COMMUT_TABLE3c()
    datatable(colnames=c("Student Commuting Footprint",
                         "Baseline Footprint (MT)","Projected Footprint (MT)",
                         "Difference in Footprint (MT)",
                         "% Change in Student Commuting Footprint"),
              all_commut_c)
  })
  
  
  #************************************************************************************
  # FOOD PLOTS
  #************************************************************************************
  
  # This is the plot output part
  
  output$Food_Plot1 <- renderPlot({
    #if(input$scenario == "Manual Scenario"){ # plot
      
    # Size of text
    PLOTTITLE = 15
    AXISTITLE = 20
    AXISTEXT = 15
    
    ## Function to extract legend
    g_legend <- function(a.gplot){ 
      tmp <- ggplot_gtable(ggplot_build(a.gplot)) 
      leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box") 
      legend <- tmp$grobs[[leg]] 
      legend
    }
    
    food1 = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    food2 = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    # food1 = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
    # food2 = FOOD_R[FOOD_R$Timeframe == 'Projected',]
    
    # Split up by Footprint and recombine
    C_food1 = food1[,c('Category','C_Footprint')]
    N_food1 = food1[,c('Category','N_Footprint')]
    P_food1 = food1[,c('Category','P_Footprint')]
    B_food1 = food1[,c('Category','B_Footprint')]
    G_food1 = food1[,c('Category','G_Footprint')]
    BG_food1 = food1[,c('Category','BG_Footprint')]
    
    C_food2 = food2[,c('Category','C_Footprint')]
    N_food2 = food2[,c('Category','N_Footprint')]
    P_food2 = food2[,c('Category','P_Footprint')]
    B_food2 = food2[,c('Category','B_Footprint')]
    G_food2 = food2[,c('Category','G_Footprint')]
    BG_food2 = food2[,c('Category','BG_Footprint')]
    
    C_food1$Footprint = C_food1$C_Footprint
    N_food1$Footprint = N_food1$N_Footprint
    P_food1$Footprint = P_food1$P_Footprint
    B_food1$Footprint = B_food1$B_Footprint*0.00378541 # Convert gal to m3
    G_food1$Footprint = G_food1$G_Footprint*0.00378541 # Convert gal to m3
    BG_food1$Footprint = BG_food1$BG_Footprint*0.00378541 # Convert gal to m3
    
    C_food2$Footprint = C_food2$C_Footprint
    N_food2$Footprint = N_food2$N_Footprint
    P_food2$Footprint = P_food2$P_Footprint
    B_food2$Footprint = B_food2$B_Footprint*0.00378541 # Convert gal to m3
    G_food2$Footprint = G_food2$G_Footprint*0.00378541 # Convert gal to m3
    BG_food2$Footprint = BG_food2$BG_Footprint*0.00378541 # Convert gal to m3
    
    # Add in Percent (%)
    C_food1$Perc_Foot = round(100*C_food1$Footprint/sum(C_food1$Footprint,na.rm=T),1)
    C_food2$Perc_Foot = round(100*C_food2$Footprint/sum(C_food2$Footprint,na.rm=T),1)
    N_food1$Perc_Foot = round(100*N_food1$Footprint/sum(N_food1$Footprint,na.rm=T),1)
    N_food2$Perc_Foot = round(100*N_food2$Footprint/sum(N_food2$Footprint,na.rm=T),1)
    P_food1$Perc_Foot = round(100*P_food1$Footprint/sum(P_food1$Footprint,na.rm=T),1)
    P_food2$Perc_Foot = round(100*P_food2$Footprint/sum(P_food2$Footprint,na.rm=T),1)
    B_food1$Perc_Foot = round(100*B_food1$Footprint/sum(B_food1$Footprint,na.rm=T),1)
    B_food2$Perc_Foot = round(100*B_food2$Footprint/sum(B_food2$Footprint,na.rm=T),1)
    G_food1$Perc_Foot = round(100*G_food1$Footprint/sum(G_food1$Footprint,na.rm=T),1)
    G_food2$Perc_Foot = round(100*G_food2$Footprint/sum(G_food2$Footprint,na.rm=T),1)
    BG_food1$Perc_Foot = round(100*BG_food1$Footprint/sum(BG_food1$Footprint,na.rm=T),1)
    BG_food2$Perc_Foot = round(100*BG_food2$Footprint/sum(BG_food2$Footprint,na.rm=T),1)
    
    C_food1$NAME = 'Carbon'
    N_food1$NAME = 'Nitrogen'
    P_food1$NAME = 'Phosphorus'
    B_food1$NAME = 'Blue Water'
    G_food1$NAME = 'Green Water'
    BG_food1$NAME = 'Blue/Green Water'
    C_food2$NAME = 'Carbon'
    N_food2$NAME = 'Nitrogen'
    P_food2$NAME = 'Phosphorus'
    B_food2$NAME = 'Blue Water'
    G_food2$NAME = 'Green Water'
    BG_food2$NAME = 'Blue/Green Water'
    
    C_food1$Timeframe = 'Baseline'
    N_food1$Timeframe = 'Baseline'
    P_food1$Timeframe = 'Baseline'
    B_food1$Timeframe = 'Baseline'
    G_food1$Timeframe = 'Baseline'
    BG_food1$Timeframe = 'Baseline'
    C_food2$Timeframe = 'Projected'
    N_food2$Timeframe = 'Projected'
    P_food2$Timeframe = 'Projected'
    B_food2$Timeframe = 'Projected'
    G_food2$Timeframe = 'Projected'
    BG_food2$Timeframe = 'Projected'
    
    C_food = rbind(C_food1[,c('Category','Footprint','Perc_Foot','NAME','Timeframe')],
                   C_food2[,c('Category','Footprint','Perc_Foot','NAME','Timeframe')])
    N_food = rbind(N_food1[,c('Category','Footprint','Perc_Foot','NAME','Timeframe')],
                   N_food2[,c('Category','Footprint','Perc_Foot','NAME','Timeframe')])
    P_food = rbind(P_food1[,c('Category','Footprint','Perc_Foot','NAME','Timeframe')],
                   P_food2[,c('Category','Footprint','Perc_Foot','NAME','Timeframe')])
    B_food = rbind(B_food1[,c('Category','Footprint','Perc_Foot','NAME','Timeframe')],
                   B_food2[,c('Category','Footprint','Perc_Foot','NAME','Timeframe')])
    G_food = rbind(G_food1[,c('Category','Footprint','Perc_Foot','NAME','Timeframe')],
                   G_food2[,c('Category','Footprint','Perc_Foot','NAME','Timeframe')])
    BG_food = rbind(BG_food1[,c('Category','Footprint','Perc_Foot','NAME','Timeframe')],
                    BG_food2[,c('Category','Footprint','Perc_Foot','NAME','Timeframe')])
    
    # Change order of sources
    C_food$Category <- factor(C_food$Category, levels = forder)
    N_food$Category <- factor(N_food$Category, levels = forder)
    P_food$Category <- factor(P_food$Category, levels = forder)
    B_food$Category <- factor(B_food$Category, levels = forder)
    G_food$Category <- factor(G_food$Category, levels = forder)
    BG_food$Category <- factor(BG_food$Category, levels = forder)
    
    # remove column name
    B_food = B_food[ , !(names(B_food) %in% 'B_Footprint')]
    G_food = G_food[ , !(names(G_food) %in% 'G_Footprint')]
    BG_food = BG_food[ , !(names(BG_food) %in% 'BG_Footprint')]
    
    W_food = rbind(B_food,G_food,BG_food)
    W_food1 = W_food[W_food$Timeframe == 'Baseline',]
    W_food2 = W_food[W_food$Timeframe == 'Projected',]
    
    # For the color Pallete
    #lvls = c(levels(factor(C_food$Category)))
    #mypal = brewer.pal(length(lvls),"Paired") # Color Blind Friendly Palette
    #getPalette = colorRampPalette(brewer.pal(9, "Set1"))
    #getPalette = colorRampPalette(brewer.pal(12, "Paired"))
    #mypal = getPalette(length(lvls))
    mypal = c(as.character(food1$Color_codes))
    
    # Stacked Bar Chart
    
    # This first plot is just for the legend
    legen = ggplot(data = C_food, aes(x = Timeframe, y=Perc_Foot,fill = Category))+ 
      geom_bar(stat="identity")+ 
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")
    
    # Plotting Percent of C and N
    c1 = ggplot(data = C_food, aes(x = Timeframe, y=Perc_Foot,fill = Category))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Carbon")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="Percent of Footprint")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=AXISTITLE))+
      theme(axis.text=element_text(size=AXISTEXT))+
      theme(plot.title=element_text(size=PLOTTITLE,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    
    n1 = ggplot(data = N_food, aes(x = Timeframe, y=Perc_Foot,fill = Category))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Nitrogen")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      #labs(x=" ",y="Percent of Footprint")+
      labs(x=" ",y=" ")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=AXISTITLE))+
      theme(axis.text=element_text(size=AXISTEXT))+
      theme(plot.title=element_text(size=PLOTTITLE,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    p1 = ggplot(data = P_food, aes(x = Timeframe, y=Perc_Foot,fill = Category))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Phosphorus")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      #labs(x=" ",y="Percent of Footprint")+
      labs(x=" ",y=" ")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=AXISTITLE))+
      theme(axis.text=element_text(size=AXISTEXT))+
      theme(plot.title=element_text(size=PLOTTITLE,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    b1 = ggplot(data = B_food, aes(x = Timeframe, y=Perc_Foot,fill = Category))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Blue Water")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      #labs(x=" ",y="Percent of Footprint")+
      labs(x=" ",y=" ")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=AXISTITLE))+
      theme(axis.text=element_text(size=AXISTEXT))+
      theme(plot.title=element_text(size=PLOTTITLE,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    g1 = ggplot(data = G_food, aes(x = Timeframe, y=Perc_Foot,fill = Category))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Green Water")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      #labs(x=" ",y="Percent of Footprint")+
      labs(x=" ",y=" ")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=AXISTITLE))+
      theme(axis.text=element_text(size=AXISTEXT))+
      theme(plot.title=element_text(size=PLOTTITLE,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    bg1 = ggplot(data = BG_food, aes(x = Timeframe, y=Perc_Foot,fill = Category))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Blue+Green Water")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      #labs(x=" ",y="Percent of Footprint")+
      labs(x=" ",y=" ")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=AXISTITLE))+
      theme(axis.text=element_text(size=AXISTEXT))+
      theme(plot.title=element_text(size=PLOTTITLE,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    leg1 <- g_legend(legen)
    
    grid.arrange(c1,n1,p1,b1,g1,bg1,leg1,nrow=1,ncol=7)
    #grid.arrange(c1,n1,p1,w1,leg1,nrow=1,ncol=5)
    #grid.arrange(c1,n1,p1,w1,w2,leg1,nrow=1,ncol=6)
    
      
  })
  
  output$Food_Plot2 <- renderPlot({
    #if(input$scenario == "Manual Scenario"){ # plot
      
    # Size of text
    PLOTTITLE = 15
    AXISTITLE = 20
    AXISTEXT = 15
    
    ## Function to extract legend
    g_legend <- function(a.gplot){
      tmp <- ggplot_gtable(ggplot_build(a.gplot))
      leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
      legend <- tmp$grobs[[leg]]
      legend
    }
    
    food1 = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    food2 = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    # food1 = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
    # food2 = FOOD_R[FOOD_R$Timeframe == 'Projected',]
    
    # subsetting out DATA2 from above DATA_all
    C_food1 = food1[,c('Category','C_Footprint')]
    N_food1 = food1[,c('Category','N_Footprint')]
    P_food1 = food1[,c('Category','P_Footprint')]
    B_food1 = food1[,c('Category','B_Footprint')]
    G_food1 = food1[,c('Category','G_Footprint')]
    BG_food1 = food1[,c('Category','BG_Footprint')]
    
    C_food2 = food2[,c('Category','C_Footprint')]
    N_food2 = food2[,c('Category','N_Footprint')]
    P_food2 = food2[,c('Category','P_Footprint')]
    B_food2 = food2[,c('Category','B_Footprint')]
    G_food2 = food2[,c('Category','G_Footprint')]
    BG_food2 = food2[,c('Category','BG_Footprint')]
    
    C_food1$Footprint = C_food1$C_Footprint
    N_food1$Footprint = N_food1$N_Footprint
    P_food1$Footprint = P_food1$P_Footprint
    B_food1$Footprint = B_food1$B_Footprint*0.00378541 # Convert gal to m3
    G_food1$Footprint = G_food1$G_Footprint*0.00378541 # Convert gal to m3
    BG_food1$Footprint = BG_food1$BG_Footprint*0.00378541 # Convert gal to m3
    
    C_food2$Footprint = C_food2$C_Footprint
    N_food2$Footprint = N_food2$N_Footprint
    P_food2$Footprint = P_food2$P_Footprint
    B_food2$Footprint = B_food2$B_Footprint*0.00378541 # Convert gal to m3
    G_food2$Footprint = G_food2$G_Footprint*0.00378541 # Convert gal to m3
    BG_food2$Footprint = BG_food2$BG_Footprint*0.00378541 # Convert gal to m3
    
    C_food1$NAME = 'Carbon'
    N_food1$NAME = 'Nitrogen'
    P_food1$NAME = 'Phosphorus'
    B_food1$NAME = 'Blue Water'
    G_food1$NAME = 'Green Water'
    BG_food1$NAME = 'Blue/Green Water'
    C_food2$NAME = 'Carbon'
    N_food2$NAME = 'Nitrogen'
    P_food2$NAME = 'Phosphorus'
    B_food2$NAME = 'Blue Water'
    G_food2$NAME = 'Green Water'
    BG_food2$NAME = 'Blue/Green Water'
    
    C_food1$Timeframe = 'Baseline'
    N_food1$Timeframe = 'Baseline'
    P_food1$Timeframe = 'Baseline'
    B_food1$Timeframe = 'Baseline'
    G_food1$Timeframe = 'Baseline'
    BG_food1$Timeframe = 'Baseline'
    C_food2$Timeframe = 'Projected'
    N_food2$Timeframe = 'Projected'
    P_food2$Timeframe = 'Projected'
    B_food2$Timeframe = 'Projected'
    G_food2$Timeframe = 'Projected'
    BG_food2$Timeframe = 'Projected'
    
    C_food = rbind(C_food1[,c('Category','Footprint','NAME','Timeframe')],
                   C_food2[,c('Category','Footprint','NAME','Timeframe')])
    N_food = rbind(N_food1[,c('Category','Footprint','NAME','Timeframe')],
                   N_food2[,c('Category','Footprint','NAME','Timeframe')])
    P_food = rbind(P_food1[,c('Category','Footprint','NAME','Timeframe')],
                   P_food2[,c('Category','Footprint','NAME','Timeframe')])
    B_food = rbind(B_food1[,c('Category','Footprint','NAME','Timeframe')],
                   B_food2[,c('Category','Footprint','NAME','Timeframe')])
    G_food = rbind(G_food1[,c('Category','Footprint','NAME','Timeframe')],
                   G_food2[,c('Category','Footprint','NAME','Timeframe')])
    BG_food = rbind(BG_food1[,c('Category','Footprint','NAME','Timeframe')],
                    BG_food2[,c('Category','Footprint','NAME','Timeframe')])
    
    # Change order of Category
    C_food$Category <- factor(C_food$Category, levels = forder)
    N_food$Category <- factor(N_food$Category, levels = forder)
    P_food$Category <- factor(P_food$Category, levels = forder)
    B_food$Category <- factor(B_food$Category, levels = forder)
    G_food$Category <- factor(G_food$Category, levels = forder)
    BG_food$Category <- factor(BG_food$Category, levels = forder)
    
    # For the color Pallete
    #lvls = c(levels(factor(C_food$Category)))
    #mypal = brewer.pal(length(lvls),"Paired") # Color Blind Friendly Palette
    #getPalette = colorRampPalette(brewer.pal(9, "Set1"))
    #getPalette = colorRampPalette(brewer.pal(12, "Paired"))
    #mypal = getPalette(length(lvls))
    mypal = c(as.character(food1$Color_codes))
    
    # This first plot is just for the legend
    legen = ggplot(data = C_food, aes(x = Timeframe, y=Footprint,fill = Category))+
      geom_bar(stat="identity")+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")
    
    # Plot Mass Comparison of C & N for Commuting
    
    c2 = ggplot(data = C_food, aes(x = Timeframe, y=Footprint,fill = Category))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Carbon")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="kg of eCO2")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=AXISTITLE))+
      theme(axis.text=element_text(size=AXISTEXT))+
      theme(plot.title=element_text(size=PLOTTITLE,hjust=0.5))+
      scale_y_continuous(expand=c(0,0))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      scale_fill_manual(values = mypal)+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    n2 = ggplot(data = N_food, aes(x = Timeframe, y=Footprint,fill = Category))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Nitrogen")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="kg of N")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=AXISTITLE))+
      theme(axis.text=element_text(size=AXISTEXT))+
      theme(plot.title=element_text(size=PLOTTITLE,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    p2 = ggplot(data = P_food, aes(x = Timeframe, y=Footprint,fill = Category))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Phosphorus")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="kg of P")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=AXISTITLE))+
      theme(axis.text=element_text(size=AXISTEXT))+
      theme(plot.title=element_text(size=PLOTTITLE,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
   b2 = ggplot(data = B_food, aes(x = Timeframe, y=Footprint,fill = Category))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Blue Water")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y=bquote(m^3 *' of W'))+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=AXISTITLE))+
      theme(axis.text=element_text(size=AXISTEXT))+
      theme(plot.title=element_text(size=PLOTTITLE,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    g2 = ggplot(data = G_food, aes(x = Timeframe, y=Footprint,fill = Category))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Green Water")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y=bquote(m^3 *' of W'))+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=AXISTITLE))+
      theme(axis.text=element_text(size=AXISTEXT))+
      theme(plot.title=element_text(size=PLOTTITLE,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    bg2 = ggplot(data = G_food, aes(x = Timeframe, y=Footprint,fill = Category))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Blue+Green Water")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y=bquote(m^3 *' of W'))+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=AXISTITLE))+
      theme(axis.text=element_text(size=AXISTEXT))+
      theme(plot.title=element_text(size=PLOTTITLE,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    leg2 <- g_legend(legen)
    
    grid.arrange(c2,n2,p2,b2,g2,bg2,leg2,nrow=1,ncol=7)
    
    
  })
  
  # Table of Baseline Footprint >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  Food_TABLE1 <- reactive({
    #if(input$scenario == "Manual Scenario"){ # table
      
    # food1 = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
    food1 = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    
    # subsetting out DATA2 from above DATA_all
    C_food1 = food1[,c('Category','C_Footprint')]
    N_food1 = food1[,c('Category','N_Footprint')]
    P_food1 = food1[,c('Category','P_Footprint')]
    B_food1 = food1[,c('Category','B_Footprint')]
    G_food1 = food1[,c('Category','G_Footprint')]
    BG_food1 = food1[,c('Category','BG_Footprint')]
    
    # combine footprints
    all_food1 = merge(C_food1[,c('Category','C_Footprint')],
                      N_food1[,c('Category','N_Footprint')],by='Category')
    all_food1 = merge(all_food1,P_food1[,c('Category','P_Footprint')],by='Category')
    all_food1 = merge(all_food1,B_food1[,c('Category','B_Footprint')],by='Category')
    all_food1 = merge(all_food1,G_food1[,c('Category','G_Footprint')],by='Category')
    all_food1 = merge(all_food1,BG_food1[,c('Category','BG_Footprint')],by='Category')
    
    # Round decimal places
    all_food1$C_Footprint = round(all_food1$C_Footprint,0)
    all_food1$N_Footprint = round(all_food1$N_Footprint,0)
    all_food1$P_Footprint = round(all_food1$P_Footprint,0)
    all_food1$B_Footprint = round(all_food1$B_Footprint*0.00378541 ,0)# Convert gal to m3
    all_food1$G_Footprint = round(all_food1$G_Footprint*0.00378541,0) # Convert gal to m3
    all_food1$BG_Footprint = round(all_food1$BG_Footprint*0.00378541,0) # Convert gal to m3
    all_food1 = all_food1
  })
  
  output$Food_TABLE1 <- DT::renderDataTable({
    all_food1 = Food_TABLE1()
    datatable(colnames=c("Category","C Footprint (kg C equivalents)",
                         "N Footprint (kg)",
                         "P Footprint (kg)",
                         "Blue Water Footptrint (m<sup>3</sup>)",
                         "Green Water Footptrint (m<sup>3</sup>)",
                         "Blue/Green Water Footptrint (m<sup>3</sup>)"),
              all_food1,escape = FALSE)
     
  })
  
  # Table of Projected Footprint >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  Food_TABLE2 <- reactive({
    #if(input$scenario == "Manual Scenario"){ # table
      
    # food2 = FOOD_R[FOOD_R$Timeframe == 'Projected',]
    food2 = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    
    # subsetting out DATA2 from above DATA_all
    C_food2 = food2[,c('Category','C_Footprint')]
    N_food2 = food2[,c('Category','N_Footprint')]
    P_food2 = food2[,c('Category','P_Footprint')]
    B_food2 = food2[,c('Category','B_Footprint')]
    G_food2 = food2[,c('Category','G_Footprint')]
    BG_food2 = food2[,c('Category','BG_Footprint')]
    
    # combine footprints
    all_food2 = merge(C_food2[,c('Category','C_Footprint')],
                      N_food2[,c('Category','N_Footprint')],by='Category')
    all_food2 = merge(all_food2,P_food2[,c('Category','P_Footprint')],by='Category')
    all_food2 = merge(all_food2,B_food2[,c('Category','B_Footprint')],by='Category')
    all_food2 = merge(all_food2,G_food2[,c('Category','G_Footprint')],by='Category')
    all_food2 = merge(all_food2,BG_food2[,c('Category','BG_Footprint')],by='Category')
    
    # Round decimal places
    all_food2$C_Footprint = round(all_food2$C_Footprint,0)
    all_food2$N_Footprint = round(all_food2$N_Footprint,0)
    all_food2$P_Footprint = round(all_food2$P_Footprint,0)
    all_food2$B_Footprint = round(all_food2$B_Footprint*0.00378541,0) # Convert gal to m3
    all_food2$G_Footprint = round(all_food2$G_Footprint*0.00378541,0) # Convert gal to m3
    all_food2$BG_Footprint = round(all_food2$BG_Footprint*0.00378541,0) # Convert gal to m3
    all_food2 = all_food2
  })
  output$Food_TABLE2 <- DT::renderDataTable({
    all_food2 = Food_TABLE2()
    datatable(colnames=c("Category","C Footprint (kg C equivalents)",
                         "N Footprint (kg)",
                         "P Footprint (kg)",
                         "Blue Water Footptrint (m<sup>3</sup>)",
                         "Green Water Footptrint (m<sup>3</sup>)",
                         "Blue/Green Water Footptrint (m<sup>3</sup>)"),
              all_food2, escape = FALSE)
  })
  
  # % Change Table >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  Food_TABLE3 <- reactive({

    # food1 = FOOD_R[FOOD_R$Timeframe == 'Baseline',]
    # food2 = FOOD_R[FOOD_R$Timeframe == 'Projected',]
    food1 = FOOD_R()[FOOD_R()$Timeframe == 'Baseline',]
    food2 = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
    
    Tot_C_food1 = sum(food1$C_Footprint)
    Tot_N_food1 = sum(food1$N_Footprint)
    Tot_P_food1 = sum(food1$P_Footprint)
    Tot_B_food1 = sum(food1$B_Footprint)
    Tot_G_food1 = sum(food1$G_Footprint)
    Tot_BG_food1 = sum(food1$BG_Footprint)
    
    Tot_C_food2 = sum(food2$C_Footprint)
    Tot_N_food2 = sum(food2$N_Footprint)
    Tot_P_food2 = sum(food2$P_Footprint)
    Tot_B_food2 = sum(food2$B_Footprint)
    Tot_G_food2 = sum(food2$G_Footprint)
    Tot_BG_food2 = sum(food2$BG_Footprint)
    
    all_food = data.frame(NAME = c("Carbon from Food","Nitrogen from Food","Phosphorus from Food","Blue Water from Food",
                                   "Green Water from Food","Blue/Green Water from Food"),
                          Footprint_c = c(Tot_C_food1,Tot_N_food1,Tot_P_food1,
                                          Tot_B_food1,Tot_G_food1,Tot_BG_food1),
                          Footprint_p = c(Tot_C_food2,Tot_N_food2,Tot_P_food2,
                                          Tot_B_food2,Tot_G_food2,Tot_BG_food2))
    
    all_food$Difference = all_food$Footprint_p - all_food$Footprint_c
    all_food$Perc_Change = 100*(all_food$Footprint_p - all_food$Footprint_c) / all_food$Footprint_c
    
    names(all_food) = c('NAME','Baseline_Footprint','Projected_Footprint',
                        "Difference",'Perc_Change')

    # Round decimal places
    all_food$Baseline_Footprint = round(all_food$Baseline_Footprint,0)
    all_food$Projected_Footprint = round(all_food$Projected_Footprint,0)
    all_food$Difference = round(all_food$Difference,0)
    all_food$Perc_Change = round(all_food$Perc_Change,0)
    all_food = all_food
  })
  output$Food_TABLE3 <- DT::renderDataTable({
    all_food = Food_TABLE3()  
    datatable(colnames=c("Food Footprint",
                         "Baseline Footprint (kg or m<sup>3</sup> for water)",
                         "Projected Footprint (kg or m<sup>3</sup> for water)",
                         "Difference in Footprint (kg or m<sup>3</sup> for water)",
                         "% Change in Food Footprint"),
              all_food, escape = FALSE)
  })
  
  
  #************************************************************************************
  # Energy PLOTS
  #************************************************************************************
  
  # This it the plot output part
  
  # Initial Units are MT C, kg N
  
  output$Energy_Plot1 <- renderPlot({
    #if(input$scenario == "Manual Scenario"){ # plot
      
    ## Function to extract legend
    g_legend <- function(a.gplot){ 
      tmp <- ggplot_gtable(ggplot_build(a.gplot)) 
      leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box") 
      legend <- tmp$grobs[[leg]] 
      legend
    }
    
    # CN_energy1_ = Energy_R[Energy_R$Timeframe == 'Baseline',]
    # CN_energy2_ = Energy_R[Energy_R$Timeframe == 'Projected',]
    CN_energy1_ = Energy_R()[Energy_R()$Timeframe == 'Baseline',]
    CN_energy2_ = Energy_R()[Energy_R()$Timeframe == 'Projected',]
    
    C_energy1 = CN_energy1_[,c('Source','Total_C_Footprint')]
    C_energy2 = CN_energy2_[,c('Source','Total_C_Footprint')]
    N_energy1 = CN_energy1_[,c('Source','Total_N_Footprint')]
    N_energy2 = CN_energy2_[,c('Source','Total_N_Footprint')]
    
    C_energy1$Footprint = C_energy1$Total_C_Footprint       
    C_energy2$Footprint = C_energy2$Total_C_Footprint       
    N_energy1$Footprint = N_energy1$Total_N_Footprint       
    N_energy2$Footprint = N_energy2$Total_N_Footprint       
    
    # Add in Percent (%)
    C_energy1$Perc_Foot = round(100*C_energy1$Footprint/sum(C_energy1$Footprint),1)
    C_energy2$Perc_Foot = round(100*C_energy2$Footprint/sum(C_energy2$Footprint),1)
    N_energy1$Perc_Foot = round(100*N_energy1$Footprint/sum(N_energy1$Footprint),1)
    N_energy2$Perc_Foot = round(100*N_energy2$Footprint/sum(N_energy2$Footprint),1)
    
    C_energy1$NAME = 'Carbon'
    C_energy2$NAME = 'Carbon'
    N_energy1$NAME = 'Nitrogen'
    N_energy2$NAME = 'Nitrogen'
    
    C_energy1$Timeframe = 'Baseline'
    C_energy2$Timeframe = 'Projected'
    N_energy1$Timeframe = 'Baseline'
    N_energy2$Timeframe = 'Projected'
    
    # CN_energy1 = rbind(C_energy1[,c('Source','Perc_Foot','NAME')],
    #                    N_energy1[,c('Source','Perc_Foot','NAME')])
    # CN_energy2 = rbind(C_energy2[,c('Source','Perc_Foot','NAME')],
    #                    N_energy2[,c('Source','Perc_Foot','NAME')])
    C_energy = rbind(C_energy1[,c('Source','Perc_Foot','Timeframe')],
                       C_energy2[,c('Source','Perc_Foot','Timeframe')])
    N_energy = rbind(N_energy1[,c('Source','Perc_Foot','Timeframe')],
                       N_energy2[,c('Source','Perc_Foot','Timeframe')])
    
    
    
    # Change order of sources
    # CN_energy1$Source <- factor(CN_energy1$Source, levels = eorder)
    # CN_energy2$Source <- factor(CN_energy2$Source, levels = eorder)
    C_energy$Source <- factor(C_energy$Source, levels = eorder)
    N_energy$Source <- factor(N_energy$Source, levels = eorder)
    
    # remove NA sources
    # CN_energy1 = CN_energy1[complete.cases(CN_energy1), ]
    # CN_energy2 = CN_energy2[complete.cases(CN_energy2), ]
    C_energy = C_energy[complete.cases(C_energy), ]
    N_energy = N_energy[complete.cases(N_energy), ]
    
    # For the color Pallete
    lvls = c(levels(factor(C_energy$Source)))
    #mypal = brewer.pal(length(lvls),"Paired") # Color Blind Friendly Palette
    #getPalette = colorRampPalette(brewer.pal(9, "Set1"))
    #getPalette = colorRampPalette(brewer.pal(12, "Paired"))
    #mypal = getPalette(length(lvls))
    mypal <- colorRampPalette(brewer.pal(12, "Paired"))(length(lvls))
    
    # Stacked Bar Chart
    
    # This first plot is just for the legend
    # legen = ggplot(data = CN_energy, aes(x = NAME, y=Perc_Foot,fill = Source))+ 
    #   geom_bar(stat="identity")+ 
    #   theme(legend.text=element_text(size=15))+
    #   guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
    #   scale_fill_manual(values = mypal)+
    #   theme(legend.position="right",legend.direction="vertical",
    #         legend.box="horizontal")
    # 
    # # Plotting Percent of C and N
    # cn3 = ggplot(data = CN_energy1, aes(x = NAME, y=Perc_Foot,fill = Source))+ 
    #   geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
    #   guides(fill = guide_legend(reverse=F))+
    #   ggtitle( "Baseline")+
    #   theme(axis.text.x = element_text(angle = 45, hjust = 1))+
    #   labs(x=" ",y="Percent of Footprint")+
    #   guides(fill = guide_legend(title="", reverse=FALSE))+
    #   theme(axis.title=element_text(size=25))+
    #   theme(axis.text=element_text(size=20))+
    #   theme(plot.title=element_text(size=20,hjust=0.5))+
    #   theme(legend.text=element_text(size=15))+
    #   guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
    #   scale_y_continuous(expand=c(0,0))+
    #   scale_fill_manual(values = mypal)+
    #   theme(legend.position="right",legend.direction="vertical",
    #         legend.box="horizontal")+
    #   theme(legend.position = "none")+
    #   theme(panel.background = element_blank())+ # remove grey background
    #   theme(axis.line = element_line(colour = "black"))
    # 
    # 
    # cn4 = ggplot(data = CN_energy2, aes(x = NAME, y=Perc_Foot,fill = Source))+ 
    #   geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
    #   guides(fill = guide_legend(reverse=F))+
    #   ggtitle( "Projected")+
    #   theme(axis.text.x = element_text(angle = 45, hjust = 1))+
    #   labs(x=" ",y="Percent of Footprint")+
    #   guides(fill = guide_legend(title="", reverse=FALSE))+
    #   theme(axis.title=element_text(size=25))+
    #   theme(axis.text=element_text(size=20))+
    #   theme(plot.title=element_text(size=20,hjust=0.5))+
    #   theme(legend.text=element_text(size=15))+
    #   guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
    #   scale_y_continuous(expand=c(0,0))+
    #   scale_fill_manual(values = mypal)+
    #   theme(legend.position="right",legend.direction="vertical",
    #         legend.box="horizontal")+
    #   theme(legend.position = "none")+
    #   theme(panel.background = element_blank())+ # remove grey background
    #   theme(axis.line = element_line(colour = "black"))
    # 
    # leg4 <- g_legend(legen)
    # 
    # grid.arrange(cn3,cn4,leg4,nrow=1,ncol=3)
      
    legen = ggplot(data = C_energy, aes(x = Timeframe, y=Perc_Foot,fill = Source))+ 
      geom_bar(stat="identity")+ 
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")
    
    # Plotting Percent of C and N
    cn3 = ggplot(data = C_energy, aes(x = Timeframe, y=Perc_Foot,fill = Source))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Carbon")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="Percent of Footprint")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    
    cn4 = ggplot(data = N_energy, aes(x = Timeframe, y=Perc_Foot,fill = Source))+ 
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Nitrogen")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="Percent of Footprint")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    leg4 <- g_legend(legen)
    
    grid.arrange(cn3,cn4,leg4,nrow=1,ncol=3)
  })
  
  output$Energy_Plot2 <- renderPlot({
    #if(input$scenario == "Manual Scenario"){ # plot
      
    ## Function to extract legend
    g_legend <- function(a.gplot){
      tmp <- ggplot_gtable(ggplot_build(a.gplot))
      leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
      legend <- tmp$grobs[[leg]]
      legend
    }
    
    # subsetting out DATA2 from above DATA_all
    CN_energy1_ = Energy_R()[Energy_R()$Timeframe == 'Baseline',]
    CN_energy2_ = Energy_R()[Energy_R()$Timeframe == 'Projected',]
    
    C_energy1 = CN_energy1_[,c('Source','Total_C_Footprint')]
    C_energy2 = CN_energy2_[,c('Source','Total_C_Footprint')]
    N_energy1 = CN_energy1_[,c('Source','Total_N_Footprint')]
    N_energy2 = CN_energy2_[,c('Source','Total_N_Footprint')]
    
    C_energy1$Footprint = C_energy1$Total_C_Footprint       
    C_energy2$Footprint = C_energy2$Total_C_Footprint
    
    # Convert MT to kg 
    N_energy1$Footprint = N_energy1$Total_N_Footprint*1000     
    N_energy2$Footprint = N_energy2$Total_N_Footprint*1000
    
    C_energy1$NAME = 'Carbon'
    C_energy2$NAME = 'Carbon'
    N_energy1$NAME = 'Nitrogen'
    N_energy2$NAME = 'Nitrogen'
    
    C_energy1$Timeframe = 'Baseline'
    C_energy2$Timeframe = 'Projected'
    N_energy1$Timeframe = 'Baseline'
    N_energy2$Timeframe = 'Projected'
    
    # CN_energy1 = rbind(C_energy1[,c('Source','Footprint','NAME')],
    #                    N_energy1[,c('Source','Footprint','NAME')])
    # CN_energy2 = rbind(C_energy2[,c('Source','Footprint','NAME')],
    #                    N_energy2[,c('Source','Footprint','NAME')])
    C_energy = rbind(C_energy1[,c('Source','Footprint','Timeframe')],
                     C_energy2[,c('Source','Footprint','Timeframe')])
    N_energy = rbind(N_energy1[,c('Source','Footprint','Timeframe')],
                       N_energy2[,c('Source','Footprint','Timeframe')])
    
    # Change order of Source
    # CN_energy1$Source <- factor(CN_energy1$Source, levels = eorder)
    # CN_energy2$Source <- factor(CN_energy2$Source, levels = eorder)
    C_energy$Source <- factor(C_energy$Source, levels = eorder)
    N_energy$Source <- factor(N_energy$Source, levels = eorder)
    
    # remove NA sources
    # CN_energy1 = CN_energy1[complete.cases(CN_energy1), ]
    # CN_energy2 = CN_energy2[complete.cases(CN_energy2), ]
    C_energy = C_energy[complete.cases(C_energy), ]
    N_energy = N_energy[complete.cases(N_energy), ]
    
    # For the color Pallete
    lvls = c(levels(factor(C_energy$Source)))
    #mypal = brewer.pal(length(lvls),"Paired") # Color Blind Friendly Palette
    #getPalette = colorRampPalette(brewer.pal(9, "Set1"))
    #getPalette = colorRampPalette(brewer.pal(12, "Paired"))
    #mypal = getPalette(length(lvls))
    mypal <- colorRampPalette(brewer.pal(12, "Paired"))(length(lvls))
    
    # # This first plot is just for the legend
    # legen = ggplot(data = CN_energy1, aes(x = NAME, y=Footprint,fill = Source))+
    #   geom_bar(stat="identity")+
    #   theme(legend.text=element_text(size=15))+
    #   guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
    #   scale_fill_manual(values = mypal)+
    #   theme(legend.position="right",legend.direction="vertical",
    #         legend.box="horizontal")
    # 
    # # Plot Mass Comparison of C & N for Commuting
    # 
    # cn1 = ggplot(data = CN_energy1, aes(x = NAME, y=Footprint,fill = Source))+
    #   geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
    #   guides(fill = guide_legend(reverse=F))+
    #   ggtitle( "Baseline")+
    #   theme(axis.text.x = element_text(angle = 45, hjust = 1))+
    #   labs(x=" ",y="Metric Tons C & kg of N")+
    #   guides(fill = guide_legend(title="", reverse=FALSE))+
    #   theme(axis.title=element_text(size=25))+
    #   theme(axis.text=element_text(size=20))+
    #   theme(plot.title=element_text(size=20,hjust=0.5))+
    #   scale_y_continuous(expand=c(0,0))+
    #   theme(legend.text=element_text(size=15))+
    #   guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
    #   theme(legend.position="right",legend.direction="vertical",
    #         legend.box="horizontal")+
    #   scale_fill_manual(values = mypal)+
    #   theme(legend.position = "none")+
    #   theme(panel.background = element_blank())+ # remove grey background
    #   theme(axis.line = element_line(colour = "black"))
    # 
    # cn2 = ggplot(data = CN_energy2, aes(x = NAME, y=Footprint,fill = Source))+
    #   geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
    #   guides(fill = guide_legend(reverse=F))+
    #   ggtitle( "Projected")+
    #   theme(axis.text.x = element_text(angle = 45, hjust = 1))+
    #   labs(x=" ",y="Metric Tons C & kg of N")+
    #   guides(fill = guide_legend(title="", reverse=FALSE))+
    #   theme(axis.title=element_text(size=25))+
    #   theme(axis.text=element_text(size=20))+
    #   theme(plot.title=element_text(size=20,hjust=0.5))+
    #   theme(legend.text=element_text(size=15))+
    #   guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
    #   scale_y_continuous(expand=c(0,0))+
    #   scale_fill_manual(values = mypal)+
    #   theme(legend.position="right",legend.direction="vertical",
    #         legend.box="horizontal")+
    #   theme(legend.position = "none")+
    #   theme(panel.background = element_blank())+ # remove grey background
    #   theme(axis.line = element_line(colour = "black"))
    
    # This first plot is just for the legend
    legen = ggplot(data = C_energy, aes(x = Timeframe, y=Footprint,fill = Source))+
      geom_bar(stat="identity")+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")
    
    # Plot Mass Comparison of C & N for Commuting
    
    cn1 = ggplot(data = C_energy, aes(x = Timeframe, y=Footprint,fill = Source))+
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Carbon")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="Metric Tons C & kg of N")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      scale_y_continuous(expand=c(0,0))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      scale_fill_manual(values = mypal)+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    cn2 = ggplot(data = N_energy, aes(x = Timeframe, y=Footprint,fill = Source))+
      geom_bar(stat="identity")+ theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Nitrogen")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="Metric Tons C & kg of N")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(expand=c(0,0))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    leg1 <- g_legend(legen)
    grid.arrange(cn1,cn2,leg1,nrow=1,ncol=3)
      
  }) 
  
  # Table of Baseline Footprint >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  Energy_TABLE1 <- reactive({
    #if(input$scenario == "Manual Scenario"){ # table
      
    # CN_energy1_ = Energy_R[Energy_R$Timeframe == 'Baseline',]
    CN_energy1_ = Energy_R()[Energy_R()$Timeframe == 'Baseline',]
    
    C_energy1 = CN_energy1_ %>% group_by(Source) %>% summarize(C_Footprint = sum(Total_C_Footprint))
    N_energy1 = CN_energy1_ %>% group_by(Source) %>% summarize(N_Footprint = sum(Total_N_Footprint))
    
    # combine footprints
    all_e1 = merge(C_energy1[,c('Source','C_Footprint')],
                   N_energy1[,c('Source','N_Footprint')],by='Source')
    
    # Round decimal places
    all_e1$C_Footprint = round(all_e1$C_Footprint,0)
    all_e1$N_Footprint = round(all_e1$N_Footprint,0)
    all_e1 = all_e1
    
  })
  output$Energy_TABLE1 <- DT::renderDataTable({
    all_e1 = Energy_TABLE1()
    datatable(colnames=c("Source","C Footprint MT C equivalents",
                         "N Footprint MT"),
              all_e1)
  })
  
  # Table of Projected Footprint >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  Energy_TABLE2 <- reactive({
    #if(input$scenario == "Manual Scenario"){ # table
      
    # CN_energy2_ = Energy_R[Energy_R$Timeframe == 'Projected',]
    CN_energy2_ = Energy_R()[Energy_R()$Timeframe == 'Projected',]
    
    C_energy2 = CN_energy2_ %>% group_by(Source) %>% summarize(C_Footprint = sum(Total_C_Footprint))
    N_energy2 = CN_energy2_ %>% group_by(Source) %>% summarize(N_Footprint = sum(Total_N_Footprint))
    
    # combine footprints
    all_e2 = merge(C_energy2[,c('Source','C_Footprint')],
                   N_energy2[,c('Source','N_Footprint')],by='Source')
    
    # Round decimal places
    all_e2$C_Footprint = round(all_e2$C_Footprint,0)
    all_e2$N_Footprint = round(all_e2$N_Footprint,0)
    all_e2 = all_e2
  })
  
  output$Energy_TABLE2 <- DT::renderDataTable({
    all_e2 =  Energy_TABLE2() 
    datatable(colnames=c("Source","C Footprint MT C equivalents",
                         "N Footprint MT"),
              all_e2)
  })
  
  # % Change Table >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  Energy_TABLE3 <- reactive({
    #if(input$scenario == "Manual Scenario"){ # table
      
    # CN_energy1_ = Energy_R[Energy_R$Timeframe == 'Baseline',]
    # CN_energy2_ = Energy_R[Energy_R$Timeframe == 'Projected',]
    CN_energy1_ = Energy_R()[Energy_R()$Timeframe == 'Baseline',]
    CN_energy2_ = Energy_R()[Energy_R()$Timeframe == 'Projected',]
    
    Tot_C_energy1 = sum(CN_energy1_$Total_C_Footprint)
    Tot_N_energy1 = sum(CN_energy1_$Total_N_Footprint)
    
    Tot_C_energy2 = sum(CN_energy2_$Total_C_Footprint)
    Tot_N_energy2 = sum(CN_energy2_$Total_N_Footprint)
    
    
    all_energy = data.frame(NAME = c("Carbon from on campus energy","Nitrogen from on campus energy"),
                            Footprint_c = c(Tot_C_energy1,Tot_N_energy1),
                            Footprint_p = c(Tot_C_energy2,Tot_N_energy2))
    
    all_energy$Difference = all_energy$Footprint_p - all_energy$Footprint_c
    all_energy$Perc_Change = 100*(all_energy$Footprint_p - all_energy$Footprint_c) / all_energy$Footprint_c
    
    names(all_energy) = c('NAME','Baseline_Footprint','Projected_Footprint',
                          'Difference','Perc_Change')

    # Round decimal places
    all_energy$Baseline_Footprint = round(all_energy$Baseline_Footprint,0)
    all_energy$Projected_Footprint = round(all_energy$Projected_Footprint,0)
    all_energy$Difference = round(all_energy$Difference,0)
    all_energy$Perc_Change = round(all_energy$Perc_Change,0)
    all_energy = all_energy
  })
  
  output$Energy_TABLE3 <- DT::renderDataTable({
    all_energy = Energy_TABLE3()
    datatable(colnames=c("Energy Footprint",
                         "Baseline Footprint (MT)","Projected Footprint (MT)",
                         "Difference in Footprint (MT)",
                         "% Change in Energy Footprint"),
              all_energy)
  })
  
  
  
  #************************************************************************************
  # Damage Cost PLOTS
  #************************************************************************************
  
  # ???Initial Units are MT C, kg N
  
  output$Cost_Plot1 <- renderPlot({
    #if(input$scenario == "Manual Scenario"){ # plot
      
    ## Function to extract legend
    g_legend <- function(a.gplot){ 
      tmp <- ggplot_gtable(ggplot_build(a.gplot)) 
      leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box") 
      legend <- tmp$grobs[[leg]] 
      legend
    }
    
    COST = COST_R()
    FOOD = FOOD_COST_R()
    
    COST1 = COST[COST$Timeframe == 'Baseline',]
    COST2 = COST[COST$Timeframe == 'Projected',]
    FOOD1 = FOOD[FOOD$Timeframe == 'Baseline',]
    FOOD2 = FOOD[FOOD$Timeframe == 'Projected',]
    
    # Summarize by Category
    COST1_ = COST1 %>% group_by(Category) %>% summarise(C_Cost_min = sum(C_Cost_min,na.rm=T),
                                                        C_Cost_max = sum(C_Cost_max,na.rm=T),
                                                        C_Cost_mid = sum(C_Cost_mid,na.rm=T))
    COST2_ = COST2 %>% group_by(Category) %>% summarise(C_Cost_min = sum(C_Cost_min,na.rm=T),
                                                        C_Cost_max = sum(C_Cost_max,na.rm=T),
                                                        C_Cost_mid = sum(C_Cost_mid,na.rm=T))
    
    FOOD1_ = FOOD1 %>% group_by(Category) %>% summarise(C_Cost_min = sum(C_Cost_min,na.rm=T),
                                                        C_Cost_max = sum(C_Cost_max,na.rm=T),
                                                        C_Cost_mid = sum(C_Cost_mid,na.rm=T))
    FOOD2_ = FOOD2 %>% group_by(Category) %>% summarise(C_Cost_min = sum(C_Cost_min,na.rm=T),
                                                        C_Cost_max = sum(C_Cost_max,na.rm=T),
                                                        C_Cost_mid = sum(C_Cost_mid,na.rm=T))
    
    COSTER1 = rbind(COST1_,
                    data.frame(Category='Food',
                               C_Cost_min = sum(FOOD1_$C_Cost_min,na.rm=T),
                               C_Cost_max = sum(FOOD1_$C_Cost_max,na.rm=T),
                               C_Cost_mid = sum(FOOD1_$C_Cost_mid,na.rm=T)))
    COSTER2 = rbind(COST2_,
                    data.frame(Category='Food',
                               C_Cost_min = sum(FOOD2_$C_Cost_min,na.rm=T),
                               C_Cost_max = sum(FOOD2_$C_Cost_max,na.rm=T),
                               C_Cost_mid = sum(FOOD2_$C_Cost_mid,na.rm=T)))
    
    
    #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
    # Recombine 'Baseline' and 'Projected'
    COSTER1$Timeframe = 'Baseline'
    COSTER2$Timeframe = "Projected"
    
    plot1 = rbind(COSTER1,COSTER2)
    
    # Change order of categories
    costorder1 = c('Purchased Electricity',
                   'Food',
                   'On-Campus Stationary Sources',
                   'Direct Transportation Sources',
                   'Commuting',
                   'Agriculture Sources',
                   'Refrigerants & Chemicals',
                   'Wastewater',
                   'Direct Water Use'
    )
    
    # Change order of categories
    plot1$Category <- 
      factor(plot1$Category, 
             levels = costorder1)
    
    # For the color Pallete
    lvls = c(levels(factor(plot1$Category)))
    #mypal = brewer.pal(length(lvls),"Paired") # Color Blind Friendly Palette
    mypal = brewer.pal(length(lvls),"Set1") # Color Blind Friendly Palette
    #getPalette = colorRampPalette(brewer.pal(9, "Set1"))
    #getPalette = colorRampPalette(brewer.pal(12, "Paired"))
    #mypal = getPalette(length(lvls))
    #mypal = c('orange','yellow','green','blue')
    
    # This first plot is just for the legend
    legen = ggplot(data = plot1)+ 
      geom_bar(aes(x="", y=C_Cost_min, fill=Category), stat="identity", width = 1)+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")
    
    # Stacked Bar Chart
    p1 = ggplot(data = plot1, aes(x = Timeframe, y=C_Cost_min,fill = Category))+ 
      geom_bar(stat="identity")+ 
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Minimum Damage Costs \n($2 per tone C equivalent)")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=20))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=15,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(labels=scales::dollar_format())+
      # scale_y_continuous(labels=scales::dollar_format(),
      #                    breaks= seq(0, 12000000, by=2000000),
      #                    limits = c(0,12000000))+
      scale_fill_manual(values = mypal)+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    p2 = ggplot(data = plot1, aes(x = Timeframe, y=C_Cost_max,fill = Category))+ 
      geom_bar(stat="identity")+ 
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Maximum Damage Costs \n($50 per tone C equivalent)")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=20))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=15,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(labels=scales::dollar_format())+
      # scale_y_continuous(labels=scales::dollar_format(),
      #                    breaks= seq(0, 12000000, by=2000000),
      #                    limits = c(0,12000000))+
      scale_fill_manual(values = mypal)+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    p3 = ggplot(data = plot1, aes(x = Timeframe, y=C_Cost_mid,fill = Category))+ 
      geom_bar(stat="identity")+ 
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Average Damage Costs \n($30 per tone C equivalent)")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=20))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=15,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(labels=scales::dollar_format())+
      # scale_y_continuous(labels=scales::dollar_format(),
      #                    breaks= seq(0, 12000000, by=2000000),
      #                    limits = c(0,12000000))+
      scale_fill_manual(values = mypal)+
      theme(legend.position = "none")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    leg1 <- g_legend(legen)
    grid.arrange(p1,p2,p3,leg1,nrow=1,ncol=4)
      
  })
  
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  # Table of Carbon Costs >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  COST_TABLE1 <- reactive({
    #if(input$scenario == "Manual Scenario"){ # table
      
    FOOD = FOOD_COST_R()
    COST = COST_R()
    COST1 = COST[COST$Timeframe == 'Baseline',]
    COST2 = COST[COST$Timeframe == 'Projected',]
    FOOD1 = FOOD[FOOD$Timeframe == 'Baseline',]
    FOOD2 = FOOD[FOOD$Timeframe == 'Projected',]
    
    
    # Summarize by Category
    COST1_ = COST1 %>% group_by(Category) %>% summarise(C_Cost_min = sum(C_Cost_min,na.rm=T),
                                                        C_Cost_max = sum(C_Cost_max,na.rm=T),
                                                        C_Cost_mid = sum(C_Cost_mid,na.rm=T))
    COST2_ = COST2 %>% group_by(Category) %>% summarise(C_Cost_min = sum(C_Cost_min,na.rm=T),
                                                        C_Cost_max = sum(C_Cost_max,na.rm=T),
                                                        C_Cost_mid = sum(C_Cost_mid,na.rm=T))
    
    FOOD1_ = FOOD1 %>% group_by(Category) %>% summarise(C_Cost_min = sum(C_Cost_min,na.rm=T),
                                                        C_Cost_max = sum(C_Cost_max,na.rm=T),
                                                        C_Cost_mid = sum(C_Cost_mid,na.rm=T))
    FOOD2_ = FOOD2 %>% group_by(Category) %>% summarise(C_Cost_min = sum(C_Cost_min,na.rm=T),
                                                        C_Cost_max = sum(C_Cost_max,na.rm=T),
                                                        C_Cost_mid = sum(C_Cost_mid,na.rm=T))
    
    COSTER1 = rbind(COST1_,
                    data.frame(Category='Food',
                               C_Cost_min = sum(FOOD1_$C_Cost_min,na.rm=T),
                               C_Cost_max = sum(FOOD1_$C_Cost_max,na.rm=T),
                               C_Cost_mid = sum(FOOD1_$C_Cost_mid,na.rm=T)))
    COSTER2 = rbind(COST2_,
                    data.frame(Category='Food',
                               C_Cost_min = sum(FOOD2_$C_Cost_min,na.rm=T),
                               C_Cost_max = sum(FOOD2_$C_Cost_max,na.rm=T),
                               C_Cost_mid = sum(FOOD2_$C_Cost_mid,na.rm=T)))
    
    #*********************************************************************
    
    # Recombine 'Baseline' and 'Projected'
    COSTER1$Timeframe = 'Baseline'
    COSTER2$Timeframe = "Projected"
    
    names(COSTER1)[which(colnames(COSTER1)=="C_Cost_min")] = "C_Cost_min_c"
    names(COSTER1)[which(colnames(COSTER1)=="C_Cost_max")] = "C_Cost_max_c"
    names(COSTER1)[which(colnames(COSTER1)=="C_Cost_mid")] = "C_Cost_mid_c"
    
    names(COSTER2)[which(colnames(COSTER2)=="C_Cost_min")] = "C_Cost_min_p"
    names(COSTER2)[which(colnames(COSTER2)=="C_Cost_max")] = "C_Cost_max_p"
    names(COSTER2)[which(colnames(COSTER2)=="C_Cost_mid")] = "C_Cost_mid_p"
    
    # Combine for table
    COSTER = merge(COSTER1,COSTER2,by='Category')
    COSTER = COSTER[,c('Category','C_Cost_min_c','C_Cost_min_p',
                       'C_Cost_max_c','C_Cost_max_p',
                       'C_Cost_mid_c','C_Cost_mid_p')]
    
    COSTER = rbind(COSTER[COSTER$Category == 'Purchased Electricity',],
                   COSTER[COSTER$Category == 'Food',],
                   COSTER[COSTER$Category == 'On-Campus Stationary Sources',],
                   COSTER[COSTER$Category == 'Direct Transportation Sources',],
                   COSTER[COSTER$Category == 'Commuting',],
                   COSTER[COSTER$Category == 'Agriculture Sources',],
                   COSTER[COSTER$Category == 'Refrigerants & Chemicals',],
                   COSTER[COSTER$Category == 'Wastewater',],
                   COSTER[COSTER$Category == 'Direct Water Use',])
    
    # Round decimal places
    COSTER$C_Cost_min_c = round(COSTER$C_Cost_min_c,0)
    COSTER$C_Cost_min_p = round(COSTER$C_Cost_min_p,0)
    COSTER$C_Cost_max_c = round(COSTER$C_Cost_max_c,0)
    COSTER$C_Cost_max_p = round(COSTER$C_Cost_max_p,0)
    COSTER$C_Cost_mid_c = round(COSTER$C_Cost_mid_c,0)
    COSTER$C_Cost_mid_p = round(COSTER$C_Cost_mid_p,0)
    
    # Add in column totals
    totals = data.frame(Category = 'Total Costs',
                        C_Cost_min_c = sum(COSTER$C_Cost_min_c),
                        C_Cost_min_p = sum(COSTER$C_Cost_min_p),
                        C_Cost_max_c = sum(COSTER$C_Cost_max_c),
                        C_Cost_max_p = sum(COSTER$C_Cost_max_p),
                        C_Cost_mid_c = sum(COSTER$C_Cost_mid_c),
                        C_Cost_mid_p = sum(COSTER$C_Cost_mid_p)) 
    COSTER = rbind(COSTER,totals)
    
    COSTER$Difference_min = COSTER$C_Cost_min_p - COSTER$C_Cost_min_c
    COSTER$Difference_max = COSTER$C_Cost_max_p - COSTER$C_Cost_max_c
    COSTER$Difference_mid = COSTER$C_Cost_mid_p - COSTER$C_Cost_mid_c
    
    COSTER$Perc_Change_min = 100*(COSTER$C_Cost_min_p - COSTER$C_Cost_min_c) / abs(COSTER$C_Cost_min_c)
    COSTER$Perc_Change_max = 100*(COSTER$C_Cost_max_p - COSTER$C_Cost_max_c) / abs(COSTER$C_Cost_max_c)
    COSTER$Perc_Change_mid = 100*(COSTER$C_Cost_mid_p - COSTER$C_Cost_mid_c) / abs(COSTER$C_Cost_mid_c)
    
    COSTER$Perc_Change_min = round(COSTER$Perc_Change_min,0)
    COSTER$Perc_Change_max = round(COSTER$Perc_Change_max,0)
    COSTER$Perc_Change_mid = round(COSTER$Perc_Change_mid,0)
    
    COSTER= COSTER[,c('Category','C_Cost_min_c','C_Cost_min_p','Difference_min','Perc_Change_min',
                      'C_Cost_max_c','C_Cost_max_p','Difference_max','Perc_Change_max',
                      'C_Cost_mid_c','C_Cost_mid_p','Difference_mid','Perc_Change_mid')]
    
    names(COSTER) = c('Category',
                      'C_Cost_min_Baseline','C_Cost_min_Projected','Difference_min','Perc_Change_min',
                      'C_Cost_max_Baseline','C_Cost_max_Projected','Difference_max','Perc_Change_max',
                      'C_Cost_Avg_Baseline','C_Cost_Avg_Projected','Difference_Avg','Perc_Change_Avg')
    
    COSTER1 = COSTER 
  })
  
  output$COST_TABLE1 <- DT::renderDataTable({
    COSTER1 = COST_TABLE1()
    datatable(colnames=c("Category","C Cost Min. Baseline","C Cost Min. Projected",
                         "Cost Difference Min.","Percent Change Min.",
                         "C Cost Max. Baseline","C Cost Max. Projected",
                         "Cost Difference Max.","Percent Change Max.",
                         "C Cost Avg. Baseline","C Cost Avg. Projected",
                         "Cost Difference Avg.","Percent Change Avg."),
              COSTER1) %>% formatCurrency(c("C_Cost_min_Baseline","C_Cost_min_Projected",
                                           "C_Cost_max_Baseline","C_Cost_max_Projected",
                                           "C_Cost_Avg_Baseline","C_Cost_Avg_Projected"),digits=0)
      
  })
  
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  # Table of Carbon Costs >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  COST_TABLE2a <- reactive({
    #if(input$scenario == "Manual Scenario"){ # table
      
    Ncosts = data.frame(Media = c('Atmosphere','Atmosphere','Atmosphere','Atmosphere',
                                  'Atmosphere','Terrestrial','Terrestrial','Terrestrial',
                                  'Terrestrial','Freshwater','Freshwater','Freshwater',
                                  'Groundwater','Groundwater','Coastal'),
                        Damage_or_Benefit = 
                          c('Human respiratory health - NOx',
                            'Human respiratory health - NH3',
                            'Visibility - NOx, NH3',
                            'Greenhouse gas damages - N2O',
                            'Climate cooling benefits - NOx, NH3',
                            'Damage to structures - NOx, NH3',
                            'Ozone damage to crops - NOx',
                            'UV damage to crops - N2O',
                            'Ozone damage to forests - NOx',
                            'Lake waterfront property values',
                            'Recreational Freshwater use',
                            'Endangered species protection',
                            'Replacement with bottled water',
                            'Treatment of private well water ',
                            'Recreational use of estuary'),
                        Damage_Costs = 
                          c(32.20,6.87,0.43,15.07,-5.02,0.12,2.11,1.48,1.24,
                            0.23,0.19,0.01,0.15,0.60,7.11))
    
  })
  
  output$COST_TABLE2a <- DT::renderDataTable({
    Ncosts = COST_TABLE2a()
    datatable(colnames=c("Media where impact is observed",
                         "Damage or benefit associated with reactive N emission",
                         #"Percent Change Min.",
                         "2016 US damage costs ($/kg N)"),Ncosts) %>% 
      formatCurrency(c("Damage_Costs"),digits=2)
  })
  
  
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  # N Damage Costs Per Category
  output$Cost_Plot2 <- renderPlot({
    #if(input$scenario == "Manual Scenario"){ # plot
      
    FOOD = FOOD_COST_R()
    COST = COST_R()
    COST1 = COST[COST$Timeframe == 'Baseline',]
    COST2 = COST[COST$Timeframe == 'Projected',]
    FOOD1 = FOOD[FOOD$Timeframe == 'Baseline',]
    FOOD2 = FOOD[FOOD$Timeframe == 'Projected',]
    
    
    # Summarize by Category
    COST1_ = COST1 %>% group_by(Category) %>% summarise(N_Cost = sum(N_Cost_Total,na.rm=T))
    COST2_ = COST2 %>% group_by(Category) %>% summarise(N_Cost = sum(N_Cost_Total,na.rm=T))
    
    FOOD1_ = FOOD1 %>% group_by(Category) %>% summarise(N_Cost_virtual = sum(N_Cost_virtual,na.rm=T))
    FOOD2_ = FOOD2 %>% group_by(Category) %>% summarise(N_Cost_virtual = sum(N_Cost_virtual,na.rm=T))
    
    COST1_2 = rbind(COST1_,
                    data.frame(Category="Food Production",
                               N_Cost = sum(FOOD1_$N_Cost_virtual,na.rm=T)))
    COST2_2 = rbind(COST2_,
                    data.frame(Category="Food Production",
                               N_Cost = sum(FOOD2_$N_Cost_virtual,na.rm=T)))
    
    
    #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
    # Recombine 'Baseline' and 'Projected'
    COST1_2$Timeframe = 'Baseline'
    COST2_2$Timeframe = "Projected"
    
    plot2 = rbind(COST1_2,COST2_2)
    
    costorder2 = c('Purchased Electricity',
                   'Food Production',
                   #'Food Waste',
                   'On-Campus Stationary Sources',
                   'Direct Transportation Sources',
                   'Commuting',
                   'Agriculture Sources',
                   'Refrigerants & Chemicals',
                   'Wastewater',
                   'Direct Water Use'
    )
    
    # Change order of categories
    plot2$Category <- 
      factor(plot2$Category, 
             levels = costorder2)
    
    
    # For the color Pallete
    lvls = c(levels(factor(plot2$Category)))
    #mypal = brewer.pal(length(lvls),"Paired") # Color Blind Friendly Palette
    mypal = brewer.pal(length(lvls),"Set3") # Color Blind Friendly Palette
    #getPalette = colorRampPalette(brewer.pal(9, "Set1"))
    #getPalette = colorRampPalette(brewer.pal(12, "Paired"))
    #mypal = getPalette(length(lvls))
    #mypal = c('orange','yellow','green','blue')
    
    # Stacked Bar Chart
    ggplot(data = plot2, aes(x = Timeframe, y=N_Cost,fill = Category))+ 
      geom_bar(stat="identity")+ 
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Damage Costs")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(labels=scales::dollar_format())+
      # scale_y_continuous(labels=scales::dollar_format(),
      #                    breaks= seq(0, 12000000, by=2000000),
      #                    limits = c(0,12000000))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
  })
  
  
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  # Table of N Costs by Category >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
  COST_TABLE2 <- reactive({
    #if(input$scenario == "Manual Scenario"){ # table
      
    FOOD = FOOD_COST_R()
    COST = COST_R()
    COST1 = COST[COST$Timeframe == 'Baseline',]
    COST2 = COST[COST$Timeframe == 'Projected',]
    FOOD1 = FOOD[FOOD$Timeframe == 'Baseline',]
    FOOD2 = FOOD[FOOD$Timeframe == 'Projected',]
    
    # Summarize by Category
    COST1_ = COST1 %>% group_by(Category) %>% summarise(N_Cost = sum(N_Cost_Total,na.rm=T))
    COST2_ = COST2 %>% group_by(Category) %>% summarise(N_Cost = sum(N_Cost_Total,na.rm=T))
    
    FOOD1_ = FOOD1 %>% group_by(Category) %>% summarise(N_Cost_virtual = sum(N_Cost_virtual,na.rm=T))
    FOOD2_ = FOOD2 %>% group_by(Category) %>% summarise(N_Cost_virtual = sum(N_Cost_virtual,na.rm=T))
    
    COST1_2 = rbind(COST1_,
                    data.frame(Category="Food Production",
                               N_Cost = sum(FOOD1_$N_Cost_virtual,na.rm=T)))
    COST2_2 = rbind(COST2_,
                    data.frame(Category="Food Production",
                               N_Cost = sum(FOOD2_$N_Cost_virtual,na.rm=T)))
    
    
    #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
    # Recombine 'Baseline' and 'Projected'
    COST1_2$Timeframe = 'Baseline'
    COST2_2$Timeframe = "Projected"
    
    names(COST1_2)[which(colnames(COST1_2)=="N_Cost")] = "N_Cost_c"
    names(COST2_2)[which(colnames(COST2_2)=="N_Cost")] = "N_Cost_p"
    
    # Combine for table
    COSTER = merge(COST1_2,COST2_2,by='Category')
    COSTER = COSTER[,c('Category','N_Cost_c','N_Cost_p')]
    
    # Change order of table  
    COSTER = rbind(COSTER[COSTER$Category == 'Purchased Electricity',],
                   COSTER[COSTER$Category == 'Food Production',],
                   COSTER[COSTER$Category == 'On-Campus Stationary Sources',],
                   COSTER[COSTER$Category == 'Direct Transportation Sources',],
                   COSTER[COSTER$Category == 'Commuting',],
                   COSTER[COSTER$Category == 'Agriculture Sources',],
                   COSTER[COSTER$Category == 'Refrigerants & Chemicals',],
                   COSTER[COSTER$Category == 'Wastewater',],
                   COSTER[COSTER$Category == 'Direct Water Use',])
    
    # Round decimal places
    COSTER$N_Cost_c = round(COSTER$N_Cost_c,0)
    COSTER$N_Cost_p = round(COSTER$N_Cost_p,0)
    
    # Add in column totals
    totals = data.frame(Category = 'Total Costs',
                        N_Cost_c = sum(COSTER$N_Cost_c),
                        N_Cost_p = sum(COSTER$N_Cost_p)) 
    COSTER = rbind(COSTER,totals)
    
    COSTER$Difference = COSTER$N_Cost_p - COSTER$N_Cost_c
    COSTER$Perc_Change = 100*(COSTER$N_Cost_p - COSTER$N_Cost_c) / COSTER$N_Cost_c
    COSTER$Perc_Change = round(COSTER$Perc_Change,0)
    
    names(COSTER) = c("Category","N_Cost_Baseline","N_Cost_Projected","Difference","Perc_Change")
    COSTER2 = COSTER
  })
  
  output$COST_TABLE2 <- DT::renderDataTable({
    COSTER2 = COST_TABLE2()
    datatable(colnames=c("Category","N Cost Baseline","N Cost Projected",
                         "Difference in Cost","Percent Change"),
              COSTER2) %>% formatCurrency(c("N_Cost_Baseline","N_Cost_Projected","Difference"),digits=0)
  })
  
  
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  #**************************************************************
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  # Plot of N Damage costs by Health, Agriculture, Ecosystem, and Climate
  output$Cost_Plot3 <- renderPlot({
    #if(input$scenario == "Manual Scenario"){ # plot
      
    FOOD = FOOD_COST_R()
    COST = COST_R()
    COST1 = COST[COST$Timeframe == 'Baseline',]
    COST2 = COST[COST$Timeframe == 'Projected',]
    FOOD1 = FOOD[FOOD$Timeframe == 'Baseline',]
    FOOD2 = FOOD[FOOD$Timeframe == 'Projected',]
    
    
    #********************************************************************************
    
    
    #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    temp1 = 
      data.frame(Category = c('Health','Agriculture','Ecosystems','Climate'),
                 Value = c(sum(COST1$N_Cost_NOx_atm_h,na.rm=T) + 
                             sum(COST1$N_Cost_NH3_atm_h,na.rm=T) + 
                             sum(COST1$N_Cost_NOx_ter_h,na.rm=T) + 
                             sum(COST1$N_Cost_NH3_ter_h,na.rm=T) +
                             sum(COST1$N_Cost_aquaGround_h,na.rm=T)+
                             sum(FOOD1$N_Cost_NOx_atm_h,na.rm=T) + 
                             sum(FOOD1$N_Cost_NH3_atm_h,na.rm=T) + 
                             sum(FOOD1$N_Cost_NOx_ter_h,na.rm=T) + 
                             sum(FOOD1$N_Cost_NH3_ter_h,na.rm=T) +
                             sum(FOOD1$N_Cost_aquaGround_h,na.rm=T),
                           sum(COST1$N_Cost_NOx_ter_a,na.rm=T) + 
                             sum(COST1$N_Cost_N2O_ter_a,na.rm=T)+
                             sum(FOOD1$N_Cost_NOx_ter_a,na.rm=T) + 
                             sum(FOOD1$N_Cost_N2O_ter_a,na.rm=T),
                           sum(COST1$N_Cost_NOx_atm_e,na.rm=T) + 
                             sum(COST1$N_Cost_NH3_atm_e,na.rm=T) +
                             sum(COST1$N_Cost_NOx_ter_e,na.rm=T) + 
                             sum(COST1$N_Cost_aquaFresh_e,na.rm=T) +
                             sum(COST1$N_Cost_aquaCoast_e,na.rm=T) +
                             sum(FOOD1$N_Cost_NOx_atm_e,na.rm=T) + 
                             sum(FOOD1$N_Cost_NH3_atm_e,na.rm=T) +
                             sum(FOOD1$N_Cost_NOx_ter_e,na.rm=T) + 
                             sum(FOOD1$N_Cost_aquaFresh_e,na.rm=T) +
                             sum(FOOD1$N_Cost_aquaCoast_e,na.rm=T),
                           sum(COST1$N_Cost_N2O_atm_c,na.rm=T) + 
                             sum(COST1$N_Cost_NOx_atm_c,na.rm=T) + 
                             sum(COST1$N_Cost_NH3_atm_c,na.rm=T) + 
                             sum(FOOD1$N_Cost_N2O_atm_c,na.rm=T) + 
                             sum(FOOD1$N_Cost_NOx_atm_c,na.rm=T) + 
                             sum(FOOD1$N_Cost_NH3_atm_c,na.rm=T)  
                 ))
    
    temp2 = 
      data.frame(Category = c('Health','Agriculture','Ecosystems','Climate'),
                 Value = c(sum(COST2$N_Cost_NOx_atm_h,na.rm=T) + 
                             sum(COST2$N_Cost_NH3_atm_h,na.rm=T) + 
                             sum(COST2$N_Cost_NOx_ter_h,na.rm=T) + 
                             sum(COST2$N_Cost_NH3_ter_h,na.rm=T) +
                             sum(COST2$N_Cost_aquaGround_h,na.rm=T)+
                             sum(FOOD2$N_Cost_NOx_atm_h,na.rm=T) + 
                             sum(FOOD2$N_Cost_NH3_atm_h,na.rm=T) + 
                             sum(FOOD2$N_Cost_NOx_ter_h,na.rm=T) + 
                             sum(FOOD2$N_Cost_NH3_ter_h,na.rm=T) +
                             sum(FOOD2$N_Cost_aquaGround_h,na.rm=T),
                           sum(COST2$N_Cost_NOx_ter_a,na.rm=T) + 
                             sum(COST2$N_Cost_N2O_ter_a,na.rm=T)+
                             sum(FOOD2$N_Cost_NOx_ter_a,na.rm=T) + 
                             sum(FOOD2$N_Cost_N2O_ter_a,na.rm=T),
                           sum(COST2$N_Cost_NOx_atm_e,na.rm=T) + 
                             sum(COST2$N_Cost_NH3_atm_e,na.rm=T) +
                             sum(COST2$N_Cost_NOx_ter_e,na.rm=T) + 
                             sum(COST2$N_Cost_aquaFresh_e,na.rm=T) +
                             sum(COST2$N_Cost_aquaCoast_e,na.rm=T) +
                             sum(FOOD2$N_Cost_NOx_atm_e,na.rm=T) + 
                             sum(FOOD2$N_Cost_NH3_atm_e,na.rm=T) +
                             sum(FOOD2$N_Cost_NOx_ter_e,na.rm=T) + 
                             sum(FOOD2$N_Cost_aquaFresh_e,na.rm=T) +
                             sum(FOOD2$N_Cost_aquaCoast_e,na.rm=T),
                           sum(COST2$N_Cost_N2O_atm_c,na.rm=T) + 
                             sum(COST2$N_Cost_NOx_atm_c,na.rm=T) + 
                             sum(COST2$N_Cost_NH3_atm_c,na.rm=T) + 
                             sum(FOOD2$N_Cost_N2O_atm_c,na.rm=T) + 
                             sum(FOOD2$N_Cost_NOx_atm_c,na.rm=T) + 
                             sum(FOOD2$N_Cost_NH3_atm_c,na.rm=T)  
                 ))
    
    #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
    # Recombine 'Baseline' and 'Projected'
    temp1$Timeframe = 'Baseline'
    temp2$Timeframe = "Projected"
    
    plot3 = rbind(temp1,temp2)
    
    # Change order of categories
    plot3$Category <- 
      factor(plot3$Category, 
             levels = c('Health','Agriculture','Ecosystems','Climate'))
    
    # For the color Pallete
    #lvls = c(levels(factor(plot3$Category)))
    #mypal = brewer.pal(length(lvls),"Paired") # Color Blind Friendly Palette
    #mypal = brewer.pal(length(lvls),"Set1") # Color Blind Friendly Palette
    #getPalette = colorRampPalette(brewer.pal(9, "Set1"))
    #getPalette = colorRampPalette(brewer.pal(12, "Paired"))
    #mypal = getPalette(length(lvls))
    mypal = c('orange','yellow','green','blue')
    
    # Get max & min
    roundUp <- function(x) 10^ceiling(log10(x)) # round to nearest power of 10. 
    ymin1 = abs(round(min(plot3$Value),0))
    ymax1 = round(max(plot3$Value),0)
    ymin = roundUp(ymin1)
    ymax = roundUp(ymax1)
    yminby1 = ymin/10
    ymaxby1 = ymax/10
    yby = ifelse(ymaxby1>=yminby1,ymaxby1,yminby1)
    
    # Stacked Bar Chart
    ggplot(data = plot3, aes(x = Timeframe, y=Value,fill = Category))+ 
      geom_bar(stat="identity")+ 
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Damage Costs")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      #scale_y_continuous(labels=scales::dollar_format())+
      scale_y_continuous(labels=scales::dollar_format(),
                         breaks= seq(-ymin, ymax, by=yby),
                         limits = c(-ymin,ymax))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black"))
    
    
  })
  
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  # Table of N Costs by Health, Agriculture, Ecosystem, and Climate >>>>>>>>>>>>
  COST_TABLE3 <- reactive({
    #if(input$scenario == "Manual Scenario"){ # table
      
    FOOD = FOOD_COST_R()
    COST = COST_R()
    COST1 = COST[COST$Timeframe == 'Baseline',]
    COST2 = COST[COST$Timeframe == 'Projected',]
    FOOD1 = FOOD[FOOD$Timeframe == 'Baseline',]
    FOOD2 = FOOD[FOOD$Timeframe == 'Projected',]
    
    
    #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    temp1 = 
      data.frame(Category = c('Health','Agriculture','Ecosystems','Climate'),
                 Value = c(sum(COST1$N_Cost_NOx_atm_h,na.rm=T) + 
                             sum(COST1$N_Cost_NH3_atm_h,na.rm=T) + 
                             sum(COST1$N_Cost_NOx_ter_h,na.rm=T) + 
                             sum(COST1$N_Cost_NH3_ter_h,na.rm=T) +
                             sum(COST1$N_Cost_aquaGround_h,na.rm=T)+
                             sum(FOOD1$N_Cost_NOx_atm_h,na.rm=T) + 
                             sum(FOOD1$N_Cost_NH3_atm_h,na.rm=T) + 
                             sum(FOOD1$N_Cost_NOx_ter_h,na.rm=T) + 
                             sum(FOOD1$N_Cost_NH3_ter_h,na.rm=T) +
                             sum(FOOD1$N_Cost_aquaGround_h,na.rm=T),
                           sum(COST1$N_Cost_NOx_ter_a,na.rm=T) + 
                             sum(COST1$N_Cost_N2O_ter_a,na.rm=T)+
                             sum(FOOD1$N_Cost_NOx_ter_a,na.rm=T) + 
                             sum(FOOD1$N_Cost_N2O_ter_a,na.rm=T),
                           sum(COST1$N_Cost_NOx_atm_e,na.rm=T) + 
                             sum(COST1$N_Cost_NH3_atm_e,na.rm=T) +
                             sum(COST1$N_Cost_NOx_ter_e,na.rm=T) + 
                             sum(COST1$N_Cost_aquaFresh_e,na.rm=T) +
                             sum(COST1$N_Cost_aquaCoast_e,na.rm=T) +
                             sum(FOOD1$N_Cost_NOx_atm_e,na.rm=T) + 
                             sum(FOOD1$N_Cost_NH3_atm_e,na.rm=T) +
                             sum(FOOD1$N_Cost_NOx_ter_e,na.rm=T) + 
                             sum(FOOD1$N_Cost_aquaFresh_e,na.rm=T) +
                             sum(FOOD1$N_Cost_aquaCoast_e,na.rm=T),
                           sum(COST1$N_Cost_N2O_atm_c,na.rm=T) + 
                             sum(COST1$N_Cost_NOx_atm_c,na.rm=T) + 
                             sum(COST1$N_Cost_NH3_atm_c,na.rm=T) + 
                             sum(FOOD1$N_Cost_N2O_atm_c,na.rm=T) + 
                             sum(FOOD1$N_Cost_NOx_atm_c,na.rm=T) + 
                             sum(FOOD1$N_Cost_NH3_atm_c,na.rm=T)  
                 ))
    
    temp2 = 
      data.frame(Category = c('Health','Agriculture','Ecosystems','Climate'),
                 Value = c(sum(COST2$N_Cost_NOx_atm_h,na.rm=T) + 
                             sum(COST2$N_Cost_NH3_atm_h,na.rm=T) + 
                             sum(COST2$N_Cost_NOx_ter_h,na.rm=T) + 
                             sum(COST2$N_Cost_NH3_ter_h,na.rm=T) +
                             sum(COST2$N_Cost_aquaGround_h,na.rm=T)+
                             sum(FOOD2$N_Cost_NOx_atm_h,na.rm=T) + 
                             sum(FOOD2$N_Cost_NH3_atm_h,na.rm=T) + 
                             sum(FOOD2$N_Cost_NOx_ter_h,na.rm=T) + 
                             sum(FOOD2$N_Cost_NH3_ter_h,na.rm=T) +
                             sum(FOOD2$N_Cost_aquaGround_h,na.rm=T),
                           sum(COST2$N_Cost_NOx_ter_a,na.rm=T) + 
                             sum(COST2$N_Cost_N2O_ter_a,na.rm=T)+
                             sum(FOOD2$N_Cost_NOx_ter_a,na.rm=T) + 
                             sum(FOOD2$N_Cost_N2O_ter_a,na.rm=T),
                           sum(COST2$N_Cost_NOx_atm_e,na.rm=T) + 
                             sum(COST2$N_Cost_NH3_atm_e,na.rm=T) +
                             sum(COST2$N_Cost_NOx_ter_e,na.rm=T) + 
                             sum(COST2$N_Cost_aquaFresh_e,na.rm=T) +
                             sum(COST2$N_Cost_aquaCoast_e,na.rm=T) +
                             sum(FOOD2$N_Cost_NOx_atm_e,na.rm=T) + 
                             sum(FOOD2$N_Cost_NH3_atm_e,na.rm=T) +
                             sum(FOOD2$N_Cost_NOx_ter_e,na.rm=T) + 
                             sum(FOOD2$N_Cost_aquaFresh_e,na.rm=T) +
                             sum(FOOD2$N_Cost_aquaCoast_e,na.rm=T),
                           sum(COST2$N_Cost_N2O_atm_c,na.rm=T) + 
                             sum(COST2$N_Cost_NOx_atm_c,na.rm=T) + 
                             sum(COST2$N_Cost_NH3_atm_c,na.rm=T) + 
                             sum(FOOD2$N_Cost_N2O_atm_c,na.rm=T) + 
                             sum(FOOD2$N_Cost_NOx_atm_c,na.rm=T) + 
                             sum(FOOD2$N_Cost_NH3_atm_c,na.rm=T)  
                 ))
    
    #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
    # Recombine 'Baseline' and 'Projected'
    temp1$Timeframe = 'Baseline'
    temp2$Timeframe = "Projected"
    
    names(temp1)[which(colnames(temp1)=="Value")] = "Value_c"
    names(temp2)[which(colnames(temp2)=="Value")] = "Value_p"
    
    # Combine for table
    COSTER = merge(temp1,temp2,by='Category')
    COSTER = COSTER[,c('Category','Value_c','Value_p')]
    
    # Change order of categories
    COSTER = rbind(COSTER[COSTER$Category == 'Health',],
                   COSTER[COSTER$Category == 'Agriculture',],
                   COSTER[COSTER$Category == 'Ecosystems',],
                   COSTER[COSTER$Category == 'Climate',])
    
    # Round decimal places
    COSTER$Value_c = round(COSTER$Value_c,0)
    COSTER$Value_p = round(COSTER$Value_p,0)
    
    # Add in column totals
    totals = data.frame(Category = 'Total Costs',
                        Value_c = sum(COSTER$Value_c),
                        Value_p = sum(COSTER$Value_p)) 
    COSTER = rbind(COSTER,totals)
    
    COSTER$Difference = COSTER$Value_p - COSTER$Value_c
    COSTER$Perc_Change = 100*(COSTER$Value_p - COSTER$Value_c) / abs(COSTER$Value_c)
    COSTER$Perc_Change = round(COSTER$Perc_Change,0)
    names(COSTER) = c("Category","N_Cost_Baseline","N_Cost_Projected","Difference","Perc_Change")
    COSTE3 = COSTER
  })
  
  output$COST_TABLE3 <- DT::renderDataTable({
    COSTER3 = COST_TABLE3()
    datatable(colnames=c("Category","N Cost Baseline","N Cost Projected",
                         "Difference in Cost","Percent Change"),
              COSTER3) %>% formatCurrency(c("N_Cost_Baseline","N_Cost_Projected","Difference"),digits=0)
  })
  
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  #**************************************************************
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  # Plot of N Costs by Atmosph, Terrestrial, Fresh, Ground, and coast Water
  output$Cost_Plot4 <- renderPlot({ 
    #if(input$scenario == "Manual Scenario"){ # plot
      
    FOOD = FOOD_COST_R()
    COST = COST_R()
    COST1 = COST[COST$Timeframe == 'Baseline',]
    COST2 = COST[COST$Timeframe == 'Projected',]
    FOOD1 = FOOD[FOOD$Timeframe == 'Baseline',]
    FOOD2 = FOOD[FOOD$Timeframe == 'Projected',]
    
    
    #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    #************************************************************************
    temps1 = 
      data.frame(Category = c('Atmosphere','Terrestrial','Freshwater','Groundwater','Coastal water'),
                 Value = c(sum(COST1$N_Cost_NOx_atm_h,na.rm=T) + 
                             sum(COST1$N_Cost_NH3_atm_h,na.rm=T) + 
                             sum(COST1$N_Cost_N2O_atm_c,na.rm=T) + 
                             sum(COST1$N_Cost_NH3_atm_e,na.rm=T) +
                             sum(COST1$N_Cost_NOx_atm_e,na.rm=T) + 
                             sum(COST1$N_Cost_NOx_atm_c,na.rm=T) + 
                             sum(COST1$N_Cost_NH3_atm_c,na.rm=T) +
                             sum(FOOD1$N_Cost_NOx_atm_h,na.rm=T) +
                             sum(FOOD1$N_Cost_NH3_atm_h,na.rm=T) + 
                             sum(FOOD1$N_Cost_N2O_atm_c,na.rm=T) + 
                             sum(FOOD1$N_Cost_NH3_atm_e,na.rm=T) +
                             sum(FOOD1$N_Cost_NOx_atm_e,na.rm=T) + 
                             sum(FOOD1$N_Cost_NOx_atm_c,na.rm=T) + 
                             sum(FOOD1$N_Cost_NH3_atm_c,na.rm=T),
                           sum(COST1$N_Cost_NOx_ter_a,na.rm=T) + 
                             sum(COST1$N_Cost_N2O_ter_a,na.rm=T)+
                             sum(COST1$N_Cost_NOx_ter_e,na.rm=T) + 
                             sum(COST1$N_Cost_NOx_ter_h,na.rm=T) + 
                             sum(COST1$N_Cost_NH3_ter_h,na.rm=T) +
                             sum(FOOD1$N_Cost_NOx_ter_a,na.rm=T) + 
                             sum(FOOD1$N_Cost_N2O_ter_a,na.rm=T)+
                             sum(FOOD1$N_Cost_NOx_ter_e,na.rm=T) + 
                             sum(FOOD1$N_Cost_NOx_ter_h,na.rm=T) + 
                             sum(FOOD1$N_Cost_NH3_ter_h,na.rm=T),
                           sum(COST1$N_Cost_aquaFresh_e,na.rm=T) +
                             sum(FOOD1$N_Cost_aquaFresh_e,na.rm=T),
                           sum(COST1$N_Cost_aquaGround_h,na.rm=T)+
                             sum(FOOD1$N_Cost_aquaGround_h,na.rm=T),
                           sum(COST1$N_Cost_aquaCoast_e,na.rm=T) + 
                             sum(FOOD1$N_Cost_aquaCoast_e,na.rm=T)))
    
    temps2 = 
      data.frame(Category = c('Atmosphere','Terrestrial','Freshwater','Groundwater','Coastal water'),
                 Value = c(sum(COST2$N_Cost_NOx_atm_h,na.rm=T) + 
                             sum(COST2$N_Cost_NH3_atm_h,na.rm=T) + 
                             sum(COST2$N_Cost_N2O_atm_c,na.rm=T) + 
                             sum(COST2$N_Cost_NH3_atm_e,na.rm=T) +
                             sum(COST2$N_Cost_NOx_atm_e,na.rm=T) + 
                             sum(COST2$N_Cost_NOx_atm_c,na.rm=T) + 
                             sum(COST2$N_Cost_NH3_atm_c,na.rm=T) +
                             sum(FOOD2$N_Cost_NOx_atm_h,na.rm=T) +
                             sum(FOOD2$N_Cost_NH3_atm_h,na.rm=T) + 
                             sum(FOOD2$N_Cost_N2O_atm_c,na.rm=T) + 
                             sum(FOOD2$N_Cost_NH3_atm_e,na.rm=T) +
                             sum(FOOD2$N_Cost_NOx_atm_e,na.rm=T) + 
                             sum(FOOD2$N_Cost_NOx_atm_c,na.rm=T) + 
                             sum(FOOD2$N_Cost_NH3_atm_c,na.rm=T),
                           sum(COST2$N_Cost_NOx_ter_a,na.rm=T) + 
                             sum(COST2$N_Cost_N2O_ter_a,na.rm=T)+
                             sum(COST2$N_Cost_NOx_ter_e,na.rm=T) + 
                             sum(COST2$N_Cost_NOx_ter_h,na.rm=T) + 
                             sum(COST2$N_Cost_NH3_ter_h,na.rm=T) +
                             sum(FOOD2$N_Cost_NOx_ter_a,na.rm=T) + 
                             sum(FOOD2$N_Cost_N2O_ter_a,na.rm=T)+
                             sum(FOOD2$N_Cost_NOx_ter_e,na.rm=T) + 
                             sum(FOOD2$N_Cost_NOx_ter_h,na.rm=T) + 
                             sum(FOOD2$N_Cost_NH3_ter_h,na.rm=T),
                           sum(COST2$N_Cost_aquaFresh_e,na.rm=T) +
                             sum(FOOD2$N_Cost_aquaFresh_e,na.rm=T),
                           sum(COST2$N_Cost_aquaGround_h,na.rm=T)+
                             sum(FOOD2$N_Cost_aquaGround_h,na.rm=T),
                           sum(COST2$N_Cost_aquaCoast_e,na.rm=T) + 
                             sum(FOOD2$N_Cost_aquaCoast_e,na.rm=T)))
    
    #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    # Recombine 'Baseline' and 'Projected'
    temps1$Timeframe = 'Baseline'
    temps2$Timeframe = "Projected"
    
    plot4 = rbind(temps1,temps2)
    
    # Change order of categories
    plot4$Category <- 
      factor(plot4$Category, 
             levels = c('Atmosphere','Terrestrial',
                        'Freshwater','Groundwater','Coastal water'))
    
    # For the color Pallete
    lvls = c(levels(factor(plot4$Category)))
    #mypal = brewer.pal(length(lvls),"Paired") # Color Blind Friendly Palette
    mypal = brewer.pal(length(lvls),"Set1") # Color Blind Friendly Palette
    #getPalette = colorRampPalette(brewer.pal(9, "Set1"))
    #getPalette = colorRampPalette(brewer.pal(12, "Paired"))
    #mypal = getPalette(length(lvls))
    #mypal = c('orange','yellow','green','blue')
    
    # Stacked Bar Chart
    ggplot(data = plot4, aes(x = Timeframe, y=Value,fill = Category))+ 
      geom_bar(stat="identity")+ 
      guides(fill = guide_legend(reverse=F))+
      ggtitle( "Damage Costs")+
      theme(axis.text.x = element_text(angle = 45, hjust = 1))+
      labs(x=" ",y="")+
      guides(fill = guide_legend(title="", reverse=FALSE))+
      theme(axis.title=element_text(size=25))+
      theme(axis.text=element_text(size=20))+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_y_continuous(labels=scales::dollar_format())+
      # scale_y_continuous(labels=scales::dollar_format(),
      #                    breaks= seq(0, 12000000, by=2000000),
      #                    limits = c(0,12000000))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")+
      theme(panel.background = element_blank())+ # remove grey background
      theme(axis.line = element_line(colour = "black")) 
    
    
  })
  
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  # Table of N Costs by Atmosph, Terrestrial, Fresh, Ground, and Coastal Water >>>>>
  COST_TABLE4 <- reactive({
    #if(input$scenario == "Manual Scenario"){ # table
      
    FOOD = FOOD_COST_R()
    COST = COST_R()
    COST1 = COST[COST$Timeframe == 'Baseline',]
    COST2 = COST[COST$Timeframe == 'Projected',]
    FOOD1 = FOOD[FOOD$Timeframe == 'Baseline',]
    FOOD2 = FOOD[FOOD$Timeframe == 'Projected',]
    
    #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    temp1 = 
      data.frame(Category = c('Atmosphere','Terrestrial','Freshwater','Groundwater','Coastal water'),
                 Value = c(sum(COST1$N_Cost_NOx_atm_h,na.rm=T) + 
                             sum(COST1$N_Cost_NH3_atm_h,na.rm=T) + 
                             sum(COST1$N_Cost_N2O_atm_c,na.rm=T) + 
                             sum(COST1$N_Cost_NH3_atm_e,na.rm=T) +
                             sum(COST1$N_Cost_NOx_atm_e,na.rm=T) + 
                             sum(COST1$N_Cost_NOx_atm_c,na.rm=T) + 
                             sum(COST1$N_Cost_NH3_atm_c,na.rm=T) +
                             sum(FOOD1$N_Cost_NOx_atm_h,na.rm=T) +
                             sum(FOOD1$N_Cost_NH3_atm_h,na.rm=T) + 
                             sum(FOOD1$N_Cost_N2O_atm_c,na.rm=T) + 
                             sum(FOOD1$N_Cost_NH3_atm_e,na.rm=T) +
                             sum(FOOD1$N_Cost_NOx_atm_e,na.rm=T) + 
                             sum(FOOD1$N_Cost_NOx_atm_c,na.rm=T) + 
                             sum(FOOD1$N_Cost_NH3_atm_c,na.rm=T),
                           sum(COST1$N_Cost_NOx_ter_a,na.rm=T) + 
                             sum(COST1$N_Cost_N2O_ter_a,na.rm=T)+
                             sum(COST1$N_Cost_NOx_ter_e,na.rm=T) + 
                             sum(COST1$N_Cost_NOx_ter_h,na.rm=T) + 
                             sum(COST1$N_Cost_NH3_ter_h,na.rm=T) +
                             sum(FOOD1$N_Cost_NOx_ter_a,na.rm=T) + 
                             sum(FOOD1$N_Cost_N2O_ter_a,na.rm=T)+
                             sum(FOOD1$N_Cost_NOx_ter_e,na.rm=T) + 
                             sum(FOOD1$N_Cost_NOx_ter_h,na.rm=T) + 
                             sum(FOOD1$N_Cost_NH3_ter_h,na.rm=T),
                           sum(COST1$N_Cost_aquaFresh_e,na.rm=T) +
                             sum(FOOD1$N_Cost_aquaFresh_e,na.rm=T),
                           sum(COST1$N_Cost_aquaGround_h,na.rm=T)+
                             sum(FOOD1$N_Cost_aquaGround_h,na.rm=T),
                           sum(COST1$N_Cost_aquaCoast_e,na.rm=T) + 
                             sum(FOOD1$N_Cost_aquaCoast_e,na.rm=T)))
    
    temp2 = 
      data.frame(Category = c('Atmosphere','Terrestrial','Freshwater','Groundwater','Coastal water'),
                 Value = c(sum(COST2$N_Cost_NOx_atm_h,na.rm=T) + 
                             sum(COST2$N_Cost_NH3_atm_h,na.rm=T) + 
                             sum(COST2$N_Cost_N2O_atm_c,na.rm=T) + 
                             sum(COST2$N_Cost_NH3_atm_e,na.rm=T) +
                             sum(COST2$N_Cost_NOx_atm_e,na.rm=T) + 
                             sum(COST2$N_Cost_NOx_atm_c,na.rm=T) + 
                             sum(COST2$N_Cost_NH3_atm_c,na.rm=T) +
                             sum(FOOD2$N_Cost_NOx_atm_h,na.rm=T) +
                             sum(FOOD2$N_Cost_NH3_atm_h,na.rm=T) + 
                             sum(FOOD2$N_Cost_N2O_atm_c,na.rm=T) + 
                             sum(FOOD2$N_Cost_NH3_atm_e,na.rm=T) +
                             sum(FOOD2$N_Cost_NOx_atm_e,na.rm=T) + 
                             sum(FOOD2$N_Cost_NOx_atm_c,na.rm=T) + 
                             sum(FOOD2$N_Cost_NH3_atm_c,na.rm=T),
                           sum(COST2$N_Cost_NOx_ter_a,na.rm=T) + 
                             sum(COST2$N_Cost_N2O_ter_a,na.rm=T)+
                             sum(COST2$N_Cost_NOx_ter_e,na.rm=T) + 
                             sum(COST2$N_Cost_NOx_ter_h,na.rm=T) + 
                             sum(COST2$N_Cost_NH3_ter_h,na.rm=T) +
                             sum(FOOD2$N_Cost_NOx_ter_a,na.rm=T) + 
                             sum(FOOD2$N_Cost_N2O_ter_a,na.rm=T)+
                             sum(FOOD2$N_Cost_NOx_ter_e,na.rm=T) + 
                             sum(FOOD2$N_Cost_NOx_ter_h,na.rm=T) + 
                             sum(FOOD2$N_Cost_NH3_ter_h,na.rm=T),
                           sum(COST2$N_Cost_aquaFresh_e,na.rm=T) +
                             sum(FOOD2$N_Cost_aquaFresh_e,na.rm=T),
                           sum(COST2$N_Cost_aquaGround_h,na.rm=T)+
                             sum(FOOD2$N_Cost_aquaGround_h,na.rm=T),
                           sum(COST2$N_Cost_aquaCoast_e,na.rm=T) + 
                             sum(FOOD2$N_Cost_aquaCoast_e,na.rm=T)))
    
    #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
    # Recombine 'Baseline' and 'Projected'
    temp1$Timeframe = 'Baseline'
    temp2$Timeframe = "Projected"
    
    names(temp1)[which(colnames(temp1)=="Value")] = "Value_c"
    names(temp2)[which(colnames(temp2)=="Value")] = "Value_p"
    
    # Combine for table
    COSTER = merge(temp1,temp2,by='Category')
    COSTER = COSTER[,c('Category','Value_c','Value_p')]
    
    # Change order of categories
    COSTER = rbind(COSTER[COSTER$Category == 'Atmosphere',],
                   COSTER[COSTER$Category == 'Terrestrial',],
                   COSTER[COSTER$Category == 'Freshwater',],
                   COSTER[COSTER$Category == 'Groundwater',],
                   COSTER[COSTER$Category == 'Coastal water',])
    
    # Round decimal places
    COSTER$Value_c = round(COSTER$Value_c,0)
    COSTER$Value_p = round(COSTER$Value_p,0)
    
    # Add in column totals
    totals = data.frame(Category = 'Total Costs',
                        Value_c = sum(COSTER$Value_c),
                        Value_p = sum(COSTER$Value_p)) 
    COSTER = rbind(COSTER,totals)
    
    COSTER$Difference = COSTER$Value_p - COSTER$Value_c
    COSTER$Perc_Change = 100*(COSTER$Value_p - COSTER$Value_c) / abs(COSTER$Value_c)
    COSTER$Perc_Change = round(COSTER$Perc_Change,0)
    names(COSTER) = c("Category","N_Cost_Baseline","N_Cost_Projected","Difference","Perc_Change")
    COSTER4 = COSTER
  })
  
  output$COST_TABLE4 <- DT::renderDataTable({
    COSTER4 = COST_TABLE4()
    datatable(colnames=c("Category","N Cost Baseline","N Cost Projected",
                         "Difference in Cost","Percent Change"),
              COSTER4) %>% formatCurrency(c("N_Cost_Baseline","N_Cost_Projected","Difference"),digits=0)
  })
  
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  # Plot of N Costs by N form (NOx, N2O, NH3, and N to Water)
  output$Cost_Plot5 <- renderPlot({ 
    #if(input$scenario == "Manual Scenario"){ # plot
      
    ## Function to extract legend
    g_legend <- function(a.gplot){ 
      tmp <- ggplot_gtable(ggplot_build(a.gplot)) 
      leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box") 
      legend <- tmp$grobs[[leg]] 
      legend
    }
    
    FOOD = FOOD_COST_R()
    COST = COST_R()
    COST1 = COST[COST$Timeframe == 'Baseline',]
    COST2 = COST[COST$Timeframe == 'Projected',]
    FOOD1 = FOOD[FOOD$Timeframe == 'Baseline',]
    FOOD2 = FOOD[FOOD$Timeframe == 'Projected',]
    
    
    #************************************************************************
    temper1 = 
      data.frame(Category = c('NOx','N2O','NH3','N to Water'),
                 Value = c(sum(COST1$N_Cost_NOx_atm_h,na.rm=T) + 
                             sum(COST1$N_Cost_NOx_ter_a,na.rm=T) +
                             sum(COST1$N_Cost_NOx_atm_e,na.rm=T) + 
                             sum(COST1$N_Cost_NOx_atm_c,na.rm=T) + 
                             sum(COST1$N_Cost_NOx_ter_e,na.rm=T) + 
                             sum(COST1$N_Cost_NOx_ter_h,na.rm=T) +
                             sum(FOOD1$N_Cost_NOx_atm_h,na.rm=T) + 
                             sum(FOOD1$N_Cost_NOx_ter_a,na.rm=T) +
                             sum(FOOD1$N_Cost_NOx_atm_e,na.rm=T) + 
                             sum(FOOD1$N_Cost_NOx_atm_c,na.rm=T) + 
                             sum(FOOD1$N_Cost_NOx_ter_e,na.rm=T) + 
                             sum(FOOD1$N_Cost_NOx_ter_h,na.rm=T),
                           sum(COST1$N_Cost_N2O_atm_c,na.rm=T) + 
                             sum(COST1$N_Cost_N2O_ter_a,na.rm=T)+
                             sum(FOOD1$N_Cost_N2O_atm_c,na.rm=T) + 
                             sum(FOOD1$N_Cost_N2O_ter_a,na.rm=T),
                           sum(COST1$N_Cost_NH3_ter_h,na.rm=T) +
                             sum(COST1$N_Cost_NH3_atm_c,na.rm=T) +
                             sum(COST1$N_Cost_NH3_atm_h,na.rm=T) + 
                             sum(COST1$N_Cost_NH3_atm_e,na.rm=T) +
                             sum(FOOD1$N_Cost_NH3_ter_h,na.rm=T) +
                             sum(FOOD1$N_Cost_NH3_atm_c,na.rm=T) +
                             sum(FOOD1$N_Cost_NH3_atm_h,na.rm=T) + 
                             sum(FOOD1$N_Cost_NH3_atm_e,na.rm=T),
                           sum(COST1$N_Cost_aquaGround_h,na.rm=T)+
                             sum(COST1$N_Cost_aquaFresh_e,na.rm=T) +
                             sum(COST1$N_Cost_aquaCoast_e,na.rm=T) +
                             sum(FOOD1$N_Cost_aquaGround_h,na.rm=T)+
                             sum(FOOD1$N_Cost_aquaFresh_e,na.rm=T) +
                             sum(FOOD1$N_Cost_aquaCoast_e,na.rm=T) 
                 ))
    
    temper2 = 
      data.frame(Category = c('NOx','N2O','NH3','N to Water'),
                 Value = c(sum(COST2$N_Cost_NOx_atm_h,na.rm=T) + 
                             sum(COST2$N_Cost_NOx_ter_a,na.rm=T) +
                             sum(COST2$N_Cost_NOx_atm_e,na.rm=T) + 
                             sum(COST2$N_Cost_NOx_atm_c,na.rm=T) + 
                             sum(COST2$N_Cost_NOx_ter_e,na.rm=T) + 
                             sum(COST2$N_Cost_NOx_ter_h,na.rm=T) +
                             sum(FOOD2$N_Cost_NOx_atm_h,na.rm=T) + 
                             sum(FOOD2$N_Cost_NOx_ter_a,na.rm=T) +
                             sum(FOOD2$N_Cost_NOx_atm_e,na.rm=T) + 
                             sum(FOOD2$N_Cost_NOx_atm_c,na.rm=T) + 
                             sum(FOOD2$N_Cost_NOx_ter_e,na.rm=T) + 
                             sum(FOOD2$N_Cost_NOx_ter_h,na.rm=T),
                           sum(COST2$N_Cost_N2O_atm_c,na.rm=T) + 
                             sum(COST2$N_Cost_N2O_ter_a,na.rm=T)+
                             sum(FOOD2$N_Cost_N2O_atm_c,na.rm=T) + 
                             sum(FOOD2$N_Cost_N2O_ter_a,na.rm=T),
                           sum(COST2$N_Cost_NH3_ter_h,na.rm=T) +
                             sum(COST2$N_Cost_NH3_atm_c,na.rm=T) +
                             sum(COST2$N_Cost_NH3_atm_h,na.rm=T) + 
                             sum(COST2$N_Cost_NH3_atm_e,na.rm=T) +
                             sum(FOOD2$N_Cost_NH3_ter_h,na.rm=T) +
                             sum(FOOD2$N_Cost_NH3_atm_c,na.rm=T) +
                             sum(FOOD2$N_Cost_NH3_atm_h,na.rm=T) + 
                             sum(FOOD2$N_Cost_NH3_atm_e,na.rm=T),
                           sum(COST2$N_Cost_aquaGround_h,na.rm=T)+
                             sum(COST2$N_Cost_aquaFresh_e,na.rm=T) +
                             sum(COST2$N_Cost_aquaCoast_e,na.rm=T) +
                             sum(FOOD2$N_Cost_aquaGround_h,na.rm=T)+
                             sum(FOOD2$N_Cost_aquaFresh_e,na.rm=T) +
                             sum(FOOD2$N_Cost_aquaCoast_e,na.rm=T) 
                 ))
    
    #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    # Recombine 'Baseline' and 'Projected'
    temper1$Timeframe = 'Baseline'
    temper2$Timeframe = "Projected"
    
    # Add in Percent (%)
    temper1$Perc_Cost = round(100*temper1$Value/sum(temper1$Value))
    temper2$Perc_Cost = round(100*temper2$Value/sum(temper2$Value))
    
    # Change order of categories
    #temper1$Category <- factor(temper1$Category, levels = worder)
    #temper2$Category <- factor(temper2$Category, levels = worder)
    
    # gives common variable names
    temper1$variable = temper1$Category
    temper1$value = temper1$Perc_Cost
    temper1$value2 = paste0(temper1$value,'%')
    temper2$variable = temper2$Category
    temper2$value = temper2$Perc_Cost
    temper2$value2 = paste0(temper2$value,'%')
    
    # Compute the position of the text labels as the cumulative sum of the proportion
    temper1 <- temper1 %>%
      arrange(desc(variable)) %>%
      mutate(lab.ypos = cumsum(value) - 0.5*value)
    temper2 <- temper2 %>%
      arrange(desc(variable)) %>%
      mutate(lab.ypos = cumsum(value) - 0.5*value)
    
    # For the color Pallete
    lvls = c(levels(factor(temper1$Category)))
    mypal = brewer.pal(length(lvls),"Set1") # Color Blind Friendly Palette
    #getPalette = colorRampPalette(brewer.pal(9, "Set1"))
    #getPalette = colorRampPalette(brewer.pal(12, "Paired"))
    #mypal = getPalette(length(lvls))
    
    # This first plot is just for the legend
    legen = ggplot(data = temper1)+ 
      geom_bar(aes(x="", y=value, fill=Category), stat="identity", width = 1)+
      theme(legend.text=element_text(size=15))+
      guides(fill = guide_legend(ncol=1,title="", reverse=FALSE))+
      scale_fill_manual(values = mypal)+
      theme(legend.position="right",legend.direction="vertical",
            legend.box="horizontal")
    
    # Pie Chart Baseline
    p1 = ggplot(data=temper1)+
      geom_bar(aes(x="", y=value, fill=Category), stat="identity", width = 1)+
      coord_polar("y", start=0,  direction = -1)+
      theme_void()+
      ggtitle( "Baseline")+
      geom_text_repel(aes(x=1.3, y = lab.ypos, label = value2),size=6)+
      guides(colour = guide_legend(reverse=T))+
      scale_fill_manual(values = mypal)+
      theme(legend.position = "none")+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      guides(fill=guide_legend(title="Categories"))#+
    
    # Pie Chart Projected
    p2 = ggplot(data=temper2)+
      geom_bar(aes(x="", y=value, fill=Category), stat="identity", width = 1)+
      coord_polar("y", start=0,  direction = -1)+
      theme_void()+
      ggtitle( "Projected")+
      geom_text_repel(aes(x=1.3, y = lab.ypos, label = value2),size=6)+
      guides(colour = guide_legend(reverse=T))+
      scale_fill_manual(values = mypal)+
      theme(legend.position = "none")+
      theme(plot.title=element_text(size=20,hjust=0.5))+
      guides(fill=guide_legend(title="Categories"))#+
    
    leg1 <- g_legend(legen)
    
    grid.arrange(p1,p2,leg1,nrow=1,ncol=3)
    
     
  })
  
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  # Table of N Costs by N form (NOx, N2O, NH3, and N to Water) >>>>>>>>>>>>>>>>
  COST_TABLE5 <- reactive({
    #if(input$scenario == "Manual Scenario"){ # table
      
    FOOD = FOOD_COST_R()
    COST = COST_R()
    COST1 = COST[COST$Timeframe == 'Baseline',]
    COST2 = COST[COST$Timeframe == 'Projected',]
    FOOD1 = FOOD[FOOD$Timeframe == 'Baseline',]
    FOOD2 = FOOD[FOOD$Timeframe == 'Projected',]
    
    #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    #************************************************************************
    temp1 = 
      data.frame(Category = c('NOx','N2O','NH3','N to Water'),
                 Value = c(sum(COST1$N_Cost_NOx_atm_h,na.rm=T) + 
                             sum(COST1$N_Cost_NOx_ter_a,na.rm=T) +
                             sum(COST1$N_Cost_NOx_atm_e,na.rm=T) + 
                             sum(COST1$N_Cost_NOx_atm_c,na.rm=T) + 
                             sum(COST1$N_Cost_NOx_ter_e,na.rm=T) + 
                             sum(COST1$N_Cost_NOx_ter_h,na.rm=T) +
                             sum(FOOD1$N_Cost_NOx_atm_h,na.rm=T) + 
                             sum(FOOD1$N_Cost_NOx_ter_a,na.rm=T) +
                             sum(FOOD1$N_Cost_NOx_atm_e,na.rm=T) + 
                             sum(FOOD1$N_Cost_NOx_atm_c,na.rm=T) + 
                             sum(FOOD1$N_Cost_NOx_ter_e,na.rm=T) + 
                             sum(FOOD1$N_Cost_NOx_ter_h,na.rm=T),
                           sum(COST1$N_Cost_N2O_atm_c,na.rm=T) + 
                             sum(COST1$N_Cost_N2O_ter_a,na.rm=T)+
                             sum(FOOD1$N_Cost_N2O_atm_c,na.rm=T) + 
                             sum(FOOD1$N_Cost_N2O_ter_a,na.rm=T),
                           sum(COST1$N_Cost_NH3_ter_h,na.rm=T) +
                             sum(COST1$N_Cost_NH3_atm_c,na.rm=T) +
                             sum(COST1$N_Cost_NH3_atm_h,na.rm=T) + 
                             sum(COST1$N_Cost_NH3_atm_e,na.rm=T) +
                             sum(FOOD1$N_Cost_NH3_ter_h,na.rm=T) +
                             sum(FOOD1$N_Cost_NH3_atm_c,na.rm=T) +
                             sum(FOOD1$N_Cost_NH3_atm_h,na.rm=T) + 
                             sum(FOOD1$N_Cost_NH3_atm_e,na.rm=T),
                           sum(COST1$N_Cost_aquaGround_h,na.rm=T)+
                             sum(COST1$N_Cost_aquaFresh_e,na.rm=T) +
                             sum(COST1$N_Cost_aquaCoast_e,na.rm=T) +
                             sum(FOOD1$N_Cost_aquaGround_h,na.rm=T)+
                             sum(FOOD1$N_Cost_aquaFresh_e,na.rm=T) +
                             sum(FOOD1$N_Cost_aquaCoast_e,na.rm=T) 
                 ))
    
    temp2 = 
      data.frame(Category = c('NOx','N2O','NH3','N to Water'),
                 Value = c(sum(COST2$N_Cost_NOx_atm_h,na.rm=T) + 
                             sum(COST2$N_Cost_NOx_ter_a,na.rm=T) +
                             sum(COST2$N_Cost_NOx_atm_e,na.rm=T) + 
                             sum(COST2$N_Cost_NOx_atm_c,na.rm=T) + 
                             sum(COST2$N_Cost_NOx_ter_e,na.rm=T) + 
                             sum(COST2$N_Cost_NOx_ter_h,na.rm=T) +
                             sum(FOOD2$N_Cost_NOx_atm_h,na.rm=T) + 
                             sum(FOOD2$N_Cost_NOx_ter_a,na.rm=T) +
                             sum(FOOD2$N_Cost_NOx_atm_e,na.rm=T) + 
                             sum(FOOD2$N_Cost_NOx_atm_c,na.rm=T) + 
                             sum(FOOD2$N_Cost_NOx_ter_e,na.rm=T) + 
                             sum(FOOD2$N_Cost_NOx_ter_h,na.rm=T),
                           sum(COST2$N_Cost_N2O_atm_c,na.rm=T) + 
                             sum(COST2$N_Cost_N2O_ter_a,na.rm=T)+
                             sum(FOOD2$N_Cost_N2O_atm_c,na.rm=T) + 
                             sum(FOOD2$N_Cost_N2O_ter_a,na.rm=T),
                           sum(COST2$N_Cost_NH3_ter_h,na.rm=T) +
                             sum(COST2$N_Cost_NH3_atm_c,na.rm=T) +
                             sum(COST2$N_Cost_NH3_atm_h,na.rm=T) + 
                             sum(COST2$N_Cost_NH3_atm_e,na.rm=T) +
                             sum(FOOD2$N_Cost_NH3_ter_h,na.rm=T) +
                             sum(FOOD2$N_Cost_NH3_atm_c,na.rm=T) +
                             sum(FOOD2$N_Cost_NH3_atm_h,na.rm=T) + 
                             sum(FOOD2$N_Cost_NH3_atm_e,na.rm=T),
                           sum(COST2$N_Cost_aquaGround_h,na.rm=T)+
                             sum(COST2$N_Cost_aquaFresh_e,na.rm=T) +
                             sum(COST2$N_Cost_aquaCoast_e,na.rm=T) +
                             sum(FOOD2$N_Cost_aquaGround_h,na.rm=T)+
                             sum(FOOD2$N_Cost_aquaFresh_e,na.rm=T) +
                             sum(FOOD2$N_Cost_aquaCoast_e,na.rm=T) 
                 ))
    
    #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  
    # Recombine 'Baseline' and 'Projected'
    temp1$Timeframe = 'Baseline'
    temp2$Timeframe = "Projected"
    
    names(temp1)[which(colnames(temp1)=="Value")] = "Value_c"
    names(temp2)[which(colnames(temp2)=="Value")] = "Value_p"
    
    # Combine for table
    COSTER = merge(temp1,temp2,by='Category')
    COSTER = COSTER[,c('Category','Value_c','Value_p')]
    
    # Change order of categories
    COSTER = rbind(COSTER[COSTER$Category == 'NOx',],
                   COSTER[COSTER$Category == 'N2O',],
                   COSTER[COSTER$Category == 'NH3',],
                   COSTER[COSTER$Category == 'N to Water',])
    
    # Round decimal places
    COSTER$Value_c = round(COSTER$Value_c,0)
    COSTER$Value_p = round(COSTER$Value_p,0)
    
    # Add in column totals
    totals = data.frame(Category = 'Total Costs',
                        Value_c = sum(COSTER$Value_c),
                        Value_p = sum(COSTER$Value_p)) 
    COSTER = rbind(COSTER,totals)
    
    COSTER$Difference = COSTER$Value_p - COSTER$Value_c
    COSTER$Perc_Change = 100*(COSTER$Value_p - COSTER$Value_c) / abs(COSTER$Value_c)
    COSTER$Perc_Change = round(COSTER$Perc_Change,0)
    names(COSTER) = c("Category","N_Cost_Baseline","N_Cost_Projected","Difference","Perc_Change")
    COSTER5 = COSTER
  })
  
  output$COST_TABLE5 <- DT::renderDataTable({
    COSTER5 = COST_TABLE5()
    datatable(colnames=c("Category","N Cost Baseline","N Cost Projected",
                         "Difference in Cost","Percent Change"),
              COSTER5) %>% formatCurrency(c("N_Cost_Baseline","N_Cost_Projected","Difference"),digits=0)
  })
  
  
  # Downloadable csv of selected dataset from C,N,P,W Footprint Output
  output$downloadData <- downloadHandler(
      filename = function()
        if(input$Table_CNPW=="Baseline Footprint") {
          "Baseline_CNPW_Footprint.csv"
        } else if(input$Table_CNPW=="Projected Footprint"){ 
          "Projected_CNPW_Footprint.csv"
        } else if(input$Table_CNPW=="% Change in Footprint"){
            "Perc_Change_CNPW_Footprint.csv"
        } else if(input$Table_CNPW=="% Change in Footprint by Category"){
           "Perc_Change_CNPW_Footprint_Categories.csv"
        },
        
      content = function(file) 
        if(input$Table_CNPW=="Baseline Footprint") {
          write.csv(CNPW_TABLE1(), file, row.names = FALSE)
        } else if(input$Table_CNPW=="Projected Footprint"){
          write.csv(CNPW_TABLE2(), file, row.names = FALSE) 
        } else if(input$Table_CNPW=="% Change in Footprint"){
          write.csv(CNPW_TABLE3(), file, row.names = FALSE)  
        } else if(input$Table_CNPW=="% Change in Footprint by Category"){
          write.csv(CNPW_TABLE4(), file, row.names = FALSE) 
          }
      )

  output$downloadData2 <- downloadHandler(
    filename = function()
      if(input$Table_Commut=="Baseline Faculty Footprint"){
        "BaselineFacultyCommutingFootprint.csv"
      } else if(input$Table_Commut=="Projected Faculty Footprint"){
        "ProjectedFacultyCommutingFootprint.csv"
      } else if(input$Table_Commut=="% Change in Faculty Footprint"){
        "Perc_Change_FacultyCommutingFootprint.csv"
      } else if(input$Table_Commut=="Baseline Staff Footprint"){
        "BaselineStaffCommutingFootprint.csv"
      } else if(input$Table_Commut=="Projected Staff Footprint"){
        "ProjectedStaffCommutingFootprint.csv"
      } else if(input$Table_Commut=="% Change in Staff Footprint"){
        "Perc_Change_StaffCommutingFootprint.csv"
      } else if(input$Table_Commut=="Baseline Student Footprint"){
        "BaselineStudentCommutingFootprint.csv"
      } else if(input$Table_Commut=="Projected Student Footprint"){
        "ProjectedStudentCommutingFootprint.csv"
      } else if(input$Table_Commut=="% Change in Student Footprint"){
        "Perc_Change_StudentCommutingFootprint.csv"
      },
    
    content = function(file) 
      if(input$Table_Commut=="Baseline Faculty Footprint"){
        write.csv(COMMUT_TABLE1a(), file, row.names = FALSE) 
      } else if(input$Table_Commut=="Projected Faculty Footprint"){
        write.csv(COMMUT_TABLE2a(), file, row.names = FALSE)  
      } else if(input$Table_Commut=="% Change in Faculty Footprint"){
        write.csv(COMMUT_TABLE3a(), file, row.names = FALSE) 
        
      } else if(input$Table_Commut=="Baseline Staff Footprint"){
        write.csv(COMMUT_TABLE1b(), file, row.names = FALSE) 
      } else if(input$Table_Commut=="Projected Staff Footprint"){
        write.csv(COMMUT_TABLE2b(), file, row.names = FALSE)  
      } else if(input$Table_Commut=="% Change in Staff Footprint"){
        write.csv(COMMUT_TABLE3b(), file, row.names = FALSE)
        
      } else if(input$Table_Commut=="Baseline Student Footprint"){
        write.csv(COMMUT_TABLE1c(), file, row.names = FALSE) 
      } else if(input$Table_Commut=="Projected Student Footprint"){
        write.csv(COMMUT_TABLE2c(), file, row.names = FALSE)  
      } else if(input$Table_Commut=="% Change in Student Footprint"){
        write.csv(COMMUT_TABLE3c(), file, row.names = FALSE) 
      }
  )
  
  output$downloadData3 <- downloadHandler(
    filename = function()
      if(input$Table_Food=="Baseline Food Footprint") {
        "Baseline_Food_Footprint.csv"
      } else if(input$Table_Food=="Projected Food Footprint"){ 
        "Projected_Food_Footprint.csv"
      } else if(input$Table_Food=="% Change in Food Footprint"){
        "Perc_Change_Food_Footprint.csv"
      },
    
    content = function(file) 
      if(input$Table_Food=="Baseline Food Footprint") {
        write.csv(Food_TABLE1(), file, row.names = FALSE)
      } else if(input$Table_Food=="Projected Food Footprint"){
        write.csv(Food_TABLE2(), file, row.names = FALSE) 
      } else if(input$Table_Food=="% Change in Food Footprint"){
        write.csv(Food_TABLE3(), file, row.names = FALSE)  
      } 
  )
  
  output$downloadData4 <- downloadHandler(
    filename = function()
      if(input$Table_Energy=="Baseline Energy Footprint") {
        "Baseline_Energy_Footprint.csv"
      } else if(input$Table_Energy=="Projected Energy Footprint"){ 
        "Projected_Energy_Footprint.csv"
      } else if(input$Table_Energy=="% Change in Energy Footprint"){
        "Perc_Change_Energy_Footprint.csv"
      },
    
    content = function(file) 
      if(input$Table_Energy=="Baseline Energy Footprint") {
        write.csv(Energy_TABLE1(), file, row.names = FALSE)
      } else if(input$Table_Energy=="Projected Energy Footprint"){
        write.csv(Energy_TABLE2(), file, row.names = FALSE) 
      } else if(input$Table_Energy=="% Change in Energy Footprint"){
        write.csv(Energy_TABLE3(), file, row.names = FALSE)  
      } 
  )
  

output$downloadData5 <- downloadHandler(
  filename = function()
    if(input$Table_Cost=="C Damage Costs") {
      "C_Damage_Costs.csv"
    } else if(input$Table_Cost=="N Damage Cost Table (used for calculations)"){ 
      "N_Damage_Cost_Calc_Table.csv"
    } else if(input$Table_Cost=="N Damage Costs by Source"){
      "N_Damage_Costs_by_Source.csv"
    } else if(input$Table_Cost=="N Damage Costs by Sector"){
      "N_Damage_Costs_by_Sector.csv"
    } else if(input$Table_Cost=="N Damage Costs by Media"){
      "N_Damage_Costs_by_Media.csv"
    } else if(input$Table_Cost=="N Damage Costs by N Type"){
      "N_Damage_Costs_by_N_Type.csv"
    },
  
  content = function(file) 
    if(input$Table_Cost=="C Damage Costs") {
      write.csv(COST_TABLE1(), file, row.names = FALSE)
    } else if(input$Table_Cost=="N Damage Cost Table (used for calculations)"){
      write.csv(COST_TABLE2a(), file, row.names = FALSE) 
    } else if(input$Table_Cost=="N Damage Costs by Source"){
      write.csv(COST_TABLE2(), file, row.names = FALSE)
    } else if(input$Table_Cost=="N Damage Costs by Sector"){
      write.csv(COST_TABLE3(), file, row.names = FALSE)  
    } else if(input$Table_Cost=="N Damage Costs by Media"){
      write.csv(COST_TABLE4(), file, row.names = FALSE) 
    } else if(input$Table_Cost=="N Damage Costs by N Type"){
      write.csv(COST_TABLE5(), file, row.names = FALSE) 
    })

# Reactive BAU vs. Scenarios 
BAUvsScenario_TABLE1 <- reactive({
  
  #if(input$scenario == "Manual Scenario"){
  # temp2 = COMBO_R[COMBO_R$Timeframe == 'Projected',]
  temp1 = COMBO_R_BAU[COMBO_R_BAU$Timeframe == 'Projected',]
  temp2 = COMBO_R()[COMBO_R()$Timeframe == 'Projected',]
  
  food1 = FOOD_R_BAU[FOOD_R_BAU$Timeframe == 'Projected',]
  food2 = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
  energy1 = Energy_R_BAU[Energy_R_BAU$Timeframe == 'Projected',]
  energy2 = Energy_R()[Energy_R()$Timeframe == 'Projected',]
  commut_fac1 = Commut_Fac_R_BAU[Commut_Fac_R_BAU$Timeframe == 'Projected',]
  commut_fac2 = Commut_Fac_R()[Commut_Fac_R()$Timeframe == 'Projected',]
  commut_staf1 = Commut_Staff_R_BAU[Commut_Staff_R_BAU$Timeframe == 'Projected',]
  commut_staf2 = Commut_Staff_R()[Commut_Staff_R()$Timeframe == 'Projected',]
  commut_stud1 = Commut_Stud_R_BAU[Commut_Stud_R_BAU$Timeframe == 'Projected',]
  commut_stud2 = Commut_Stud_R()[Commut_Stud_R()$Timeframe == 'Projected',]
  
  # food2 = FOOD_R[FOOD_R$Timeframe == 'Projected',]
  # energy2 = Energy_R[Energy_R$Timeframe == 'Projected',]
  # commut_fac2 = Commut_Fac_R[Commut_Fac_R$Timeframe == 'Projected',]
  # commut_staf2 = Commut_Staff_R[Commut_Staff_R$Timeframe == 'Projected',]
  # commut_stud2 = Commut_Stud_R[Commut_Stud_R$Timeframe == 'Projected',]
  
  # Get food total from food tab - convert kg to MT by dividing by 1000
  Cfood1_tot = sum(food1$C_Footprint)/1000 # Units = MT
  Cfood2_tot = sum(food2$C_Footprint)/1000 # Units = MT
  Nfood1_tot = sum(food1$N_Footprint)/1000 # Units = MT
  Nfood2_tot = sum(food2$N_Footprint)/1000 # Units = MT
  Pfood1_tot = sum(food1$P_Footprint)/1000 # Units = MT
  Pfood2_tot = sum(food2$P_Footprint)/1000 # Units = MT
  Wfood1_tot = sum(food1$B_Footprint) # Units = gallons
  Wfood2_tot = sum(food2$B_Footprint) # Units = gallons
  
  # Get commuting total from commuting tab - units are MT
  Ccommut1_fac_tot = sum(commut_fac1$Total_C_Footprint)
  Ccommut1_staf_tot = sum(commut_staf1$Total_C_Footprint)
  Ccommut1_stud_tot = sum(commut_stud1$Total_C_Footprint)
  Ncommut1_fac_tot = sum(commut_fac1$Total_N_Footprint)
  Ncommut1_staf_tot = sum(commut_staf1$Total_N_Footprint)
  Ncommut1_stud_tot = sum(commut_stud1$Total_N_Footprint)
  Ccommut1_tot = Ccommut1_fac_tot+Ccommut1_staf_tot+Ccommut1_stud_tot
  Ncommut1_tot = Ncommut1_fac_tot+Ncommut1_staf_tot+Ncommut1_stud_tot
  
  Ccommut2_fac_tot = sum(commut_fac2$Total_C_Footprint)
  Ccommut2_staf_tot = sum(commut_staf2$Total_C_Footprint)
  Ccommut2_stud_tot = sum(commut_stud2$Total_C_Footprint)
  Ncommut2_fac_tot = sum(commut_fac2$Total_N_Footprint)
  Ncommut2_staf_tot = sum(commut_staf2$Total_N_Footprint)
  Ncommut2_stud_tot = sum(commut_stud2$Total_N_Footprint)
  Ccommut2_tot = Ccommut2_fac_tot+Ccommut2_staf_tot+Ccommut2_stud_tot
  Ncommut2_tot = Ncommut2_fac_tot+Ncommut2_staf_tot+Ncommut2_stud_tot
  
  # Get energy total energy from tab - initial units MT
  Cenergy1_tot = sum(energy1$Total_C_Footprint)
  Nenergy1_tot = sum(energy1$Total_N_Footprint)
  Cenergy2_tot = sum(energy2$Total_C_Footprint)
  Nenergy2_tot = sum(energy2$Total_N_Footprint)
  
  # Exchange the food value with the one from food tab
  temp1$Total_C_Footprint[temp1$Category == "Food"] <- Cfood1_tot # Units = MT
  temp1$Total_N_Footprint[temp1$Category == "Food"] <- Nfood1_tot # Units = MT
  temp1$Total_P_Footprint[temp1$Category == "Food"] <- Pfood1_tot # Units = MT
  temp1$Total_W_Footprint[temp1$Category == "Food"] <- Wfood1_tot # Units = MT
  temp2$Total_C_Footprint[temp2$Category == "Food"] <- Cfood2_tot # Units = MT
  temp2$Total_N_Footprint[temp2$Category == "Food"] <- Nfood2_tot # Units = MT
  temp2$Total_P_Footprint[temp2$Category == "Food"] <- Pfood2_tot # Units = Gallons
  temp2$Total_W_Footprint[temp2$Category == "Food"] <- Wfood2_tot # Units = Gallons
  
  # Exchange the commuting value with the one from commuting tab
  temp1$Total_C_Footprint[temp1$Category == "Commuting"] <- Ccommut1_tot
  temp1$Total_N_Footprint[temp1$Category == "Commuting"] <- Ncommut1_tot
  temp2$Total_C_Footprint[temp2$Category == "Commuting"] <- Ccommut2_tot
  temp2$Total_N_Footprint[temp2$Category == "Commuting"] <- Ncommut2_tot
  
  # Exchange the energy value with the one from energy tab
  temp1$Total_C_Footprint[temp1$Category == "On-Campus Stationary Sources"] <- Cenergy1_tot
  temp1$Total_N_Footprint[temp1$Category == "On-Campus Stationary Sources"] <- Nenergy1_tot
  temp2$Total_C_Footprint[temp2$Category == "On-Campus Stationary Sources"] <- Cenergy2_tot
  temp2$Total_N_Footprint[temp2$Category == "On-Campus Stationary Sources"] <- Nenergy2_tot
  
  # Convert Water units from gallons to cubic meters (m3)
  temp1$Total_W_Footprint = temp1$Total_W_Footprint*0.00378541 # Converting gallons to m3
  temp2$Total_W_Footprint = temp2$Total_W_Footprint*0.00378541 # Converting gallons to m3
  
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  Tot_C_foot1 = sum(temp1$Total_C_Footprint) # Units = MT
  Tot_N_foot1 = sum(temp1$Total_N_Footprint) # Units = MT
  Tot_P_foot1 = sum(temp1$Total_P_Footprint) # Units = MT
  Tot_W_foot1 = sum(temp1$Total_W_Footprint) # Units = Gallons
  
  Tot_C_foot2 = sum(temp2$Total_C_Footprint) # Units = MT
  Tot_N_foot2 = sum(temp2$Total_N_Footprint) # Units = MT
  Tot_P_foot2 = sum(temp2$Total_P_Footprint) # Units = MT
  Tot_W_foot2 = sum(temp2$Total_W_Footprint) # Units = Gallons
  
  all_foot_BAU = data.frame(NAME = c("Carbon","Nitrogen","Phosphorus","Water"),
                            Footprint_b = c(Tot_C_foot1,Tot_N_foot1,Tot_P_foot1,Tot_W_foot1),
                            Footprint_p = c(Tot_C_foot2,Tot_N_foot2,Tot_P_foot2,Tot_W_foot2))
  
  all_foot_BAU$Difference = all_foot_BAU$Footprint_p - all_foot_BAU$Footprint_b
  all_foot_BAU$Perc_Change = 100*(all_foot_BAU$Footprint_p - all_foot_BAU$Footprint_b) / all_foot_BAU$Footprint_b
  
  names(all_foot_BAU) = c('NAME','BAU_Footprint','Projected_Footprint',
                          'Difference','Perc_Change')
  
  #all_foot_BAU = all_foot_BAU[,c('NAME','Perc_Change')]
  
  # Round decimal places
  all_foot_BAU$BAU_Footprint = round(all_foot_BAU$BAU_Footprint,0)
  all_foot_BAU$Projected_Footprint = round(all_foot_BAU$Projected_Footprint,0)
  all_foot_BAU$Difference = round(all_foot_BAU$Difference,1)
  all_foot_BAU$Perc_Change = round(all_foot_BAU$Perc_Change,1)
  BAUvsScenario_TABLE1 = all_foot_BAU
  
  #} # Scenario
  
}) # reactive

output$BAUvsScenario_TABLE1 <- DT::renderDataTable({ 
  #if(input$scenario == "Manual Scenario"){ # table
  
  all_foot_BAU_ = BAUvsScenario_TABLE1()
  
  datatable(colnames=c("Footprint","BAU Footprint (MT or m<sup>3</sup> for water)",
                       "Scenario Footprint (MT or m<sup>3</sup> for water)",
                       "Difference (MT or m<sup>3</sup> for water)","% Change in Footprint"),
            as.data.frame(all_foot_BAU_),  escape = FALSE)
  
})

# Reactive BAU vs. Scenarios for Food
BAUvsScenario_TABLE2 <- reactive({
  
  #if(input$scenario == "Manual Scenario"){
  temp1 = COMBO_R_BAU[COMBO_R_BAU$Timeframe == 'Projected',]
  temp2 = COMBO_R()[COMBO_R()$Timeframe == 'Projected',]
  # temp2 = COMBO_R[COMBO_R$Timeframe == 'Projected',]
  
  food1 = FOOD_R_BAU[FOOD_R_BAU$Timeframe == 'Projected',]
  food2 = FOOD_R()[FOOD_R()$Timeframe == 'Projected',]
  # food2 = FOOD_R[FOOD_R$Timeframe == 'Projected',]
  
  # Get food total from food tab - convert kg to MT by dividing by 1000
  Cfood1_tot = sum(food1$C_Footprint)/1000 # Units = MT
  Cfood2_tot = sum(food2$C_Footprint)/1000 # Units = MT
  Nfood1_tot = sum(food1$N_Footprint)/1000 # Units = MT
  Nfood2_tot = sum(food2$N_Footprint)/1000 # Units = MT
  Pfood1_tot = sum(food1$P_Footprint)/1000 # Units = MT
  Pfood2_tot = sum(food2$P_Footprint)/1000 # Units = MT
  Wfood1_tot = sum(food1$B_Footprint) # Units = gallons
  Wfood2_tot = sum(food2$B_Footprint) # Units = gallons
  
  Wfood1_tot = Wfood1_tot*0.00378541 # Converting gallons to m3
  Wfood2_tot = Wfood2_tot*0.00378541 # Converting gallons to m3
  
  #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
  food_foot_BAU = data.frame(NAME = c("Carbon","Nitrogen","Phosphorus","Water"),
                            Footprint_b = c(Cfood1_tot,Nfood1_tot,Pfood1_tot,Wfood1_tot),
                            Footprint_p = c(Cfood2_tot,Nfood2_tot,Pfood2_tot,Wfood2_tot))
  
  food_foot_BAU$Difference = food_foot_BAU$Footprint_p - food_foot_BAU$Footprint_b
  food_foot_BAU$Perc_Change = 100*(food_foot_BAU$Footprint_p - food_foot_BAU$Footprint_b) / food_foot_BAU$Footprint_b
  
  names(food_foot_BAU) = c('NAME','BAU_Footprint','Projected_Footprint',
                          'Difference','Perc_Change')
  

  # Round decimal places
  food_foot_BAU$BAU_Footprint = round(food_foot_BAU$BAU_Footprint,0)
  food_foot_BAU$Projected_Footprint = round(food_foot_BAU$Projected_Footprint,0)
  food_foot_BAU$Difference = round(food_foot_BAU$Difference,1)
  food_foot_BAU$Perc_Change = round(food_foot_BAU$Perc_Change,1)
  BAUvsScenario_TABLE2 = food_foot_BAU

}) # reactive

 
output$BAUvsScenario_TABLE2 <- DT::renderDataTable({ 
  #if(input$scenario == "Manual Scenario"){ # table
  
  all_foot_BAU_2 = BAUvsScenario_TABLE2()
  
  datatable(colnames=c("Footprint","BAU Footprint (MT or m<sup>3</sup> for water)",
                       "Scenario Footprint (MT or m<sup>3</sup> for water)",
                       "Difference (MT or m<sup>3</sup> for water)","% Change in Footprint"),
            as.data.frame(all_foot_BAU_2),  escape = FALSE)
  
})


}

shinyApp(ui = ui, server = server)
